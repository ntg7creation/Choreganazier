{"version":3,"file":"WeekWindow-lzPDjke-.js","sources":["../../node_modules/@mui/material/Grid/GridContext.js","../../node_modules/@mui/material/Grid/gridClasses.js","../../node_modules/@mui/material/Grid/Grid.js","../../node_modules/rrule/dist/esm/weekday.js","../../node_modules/rrule/dist/esm/helpers.js","../../node_modules/rrule/dist/esm/dateutil.js","../../node_modules/rrule/dist/esm/iterresult.js","../../node_modules/rrule/dist/esm/callbackiterresult.js","../../node_modules/rrule/dist/esm/nlp/i18n.js","../../node_modules/rrule/dist/esm/nlp/totext.js","../../node_modules/rrule/dist/esm/nlp/parsetext.js","../../node_modules/rrule/dist/esm/types.js","../../node_modules/rrule/dist/esm/nlp/index.js","../../node_modules/rrule/dist/esm/datetime.js","../../node_modules/rrule/dist/esm/parseoptions.js","../../node_modules/rrule/dist/esm/parsestring.js","../../node_modules/rrule/dist/esm/datewithzone.js","../../node_modules/rrule/dist/esm/optionstostring.js","../../node_modules/rrule/dist/esm/cache.js","../../node_modules/rrule/dist/esm/masks.js","../../node_modules/rrule/dist/esm/iterinfo/yearinfo.js","../../node_modules/rrule/dist/esm/iterinfo/monthinfo.js","../../node_modules/rrule/dist/esm/iterinfo/easter.js","../../node_modules/rrule/dist/esm/iterinfo/index.js","../../node_modules/rrule/dist/esm/iter/poslist.js","../../node_modules/rrule/dist/esm/iter/index.js","../../node_modules/rrule/dist/esm/rrule.js","../../node_modules/rrule/dist/esm/iterset.js","../../node_modules/rrule/dist/esm/rrulestr.js","../../node_modules/rrule/dist/esm/rruleset.js","../../node_modules/three/examples/jsm/nodes/core/constants.js","../../node_modules/three/examples/jsm/nodes/core/NodeUtils.js","../../node_modules/three/examples/jsm/nodes/core/Node.js","../../node_modules/three/examples/jsm/nodes/core/TempNode.js","../../node_modules/three/examples/jsm/nodes/utils/ArrayElementNode.js","../../node_modules/three/examples/jsm/nodes/utils/ConvertNode.js","../../node_modules/three/examples/jsm/nodes/utils/JoinNode.js","../../node_modules/three/examples/jsm/nodes/utils/SplitNode.js","../../node_modules/three/examples/jsm/nodes/utils/SetNode.js","../../node_modules/three/examples/jsm/nodes/core/InputNode.js","../../node_modules/three/examples/jsm/nodes/core/ConstNode.js","../../node_modules/three/examples/jsm/nodes/shadernode/ShaderNode.js","../../node_modules/three/examples/jsm/nodes/core/AssignNode.js","../../node_modules/three/examples/jsm/nodes/core/VaryingNode.js","../../node_modules/three/examples/jsm/nodes/core/AttributeNode.js","../../node_modules/three/examples/jsm/nodes/core/BypassNode.js","../../node_modules/three/examples/jsm/nodes/core/CacheNode.js","../../node_modules/three/examples/jsm/nodes/core/ContextNode.js","../../node_modules/three/examples/jsm/nodes/core/IndexNode.js","../../node_modules/three/examples/jsm/nodes/core/LightingModel.js","../../node_modules/three/examples/jsm/nodes/core/VarNode.js","../../node_modules/three/examples/jsm/nodes/core/PropertyNode.js","../../node_modules/three/examples/jsm/nodes/core/ParameterNode.js","../../node_modules/three/examples/jsm/nodes/code/CodeNode.js","../../node_modules/three/examples/jsm/nodes/code/FunctionNode.js","../../node_modules/three/examples/jsm/nodes/core/UniformGroupNode.js","../../node_modules/three/examples/jsm/nodes/core/UniformNode.js","../../node_modules/three/examples/jsm/nodes/accessors/UVNode.js","../../node_modules/three/examples/jsm/nodes/accessors/TextureSizeNode.js","../../node_modules/three/examples/jsm/nodes/math/OperatorNode.js","../../node_modules/three/examples/jsm/nodes/math/MathNode.js","../../node_modules/three/examples/jsm/nodes/display/ColorSpaceNode.js","../../node_modules/three/examples/jsm/nodes/code/ExpressionNode.js","../../node_modules/three/examples/jsm/nodes/utils/MaxMipLevelNode.js","../../node_modules/three/examples/jsm/nodes/accessors/TextureNode.js","../../node_modules/three/examples/jsm/nodes/accessors/BufferNode.js","../../node_modules/three/examples/jsm/nodes/accessors/UniformsNode.js","../../node_modules/three/examples/jsm/nodes/accessors/ReferenceNode.js","../../node_modules/three/examples/jsm/nodes/accessors/MaterialReferenceNode.js","../../node_modules/three/examples/jsm/nodes/accessors/CameraNode.js","../../node_modules/three/examples/jsm/nodes/accessors/Object3DNode.js","../../node_modules/three/examples/jsm/nodes/accessors/ModelNode.js","../../node_modules/three/examples/jsm/nodes/accessors/NormalNode.js","../../node_modules/three/examples/jsm/nodes/accessors/MaterialNode.js","../../node_modules/three/examples/jsm/nodes/accessors/PositionNode.js","../../node_modules/three/examples/jsm/nodes/accessors/ModelViewProjectionNode.js","../../node_modules/three/examples/jsm/nodes/accessors/BufferAttributeNode.js","../../node_modules/three/examples/jsm/nodes/accessors/InstanceNode.js","../../node_modules/three/examples/jsm/nodes/accessors/TangentNode.js","../../node_modules/three/examples/jsm/nodes/accessors/BatchNode.js","../../node_modules/three/examples/jsm/nodes/accessors/SkinningNode.js","../../node_modules/three/examples/jsm/nodes/utils/LoopNode.js","../../node_modules/three/examples/jsm/nodes/accessors/MorphNode.js","../../node_modules/three/examples/jsm/nodes/accessors/ReflectVectorNode.js","../../node_modules/three/examples/jsm/nodes/accessors/CubeTextureNode.js","../../node_modules/three/examples/jsm/nodes/lighting/LightingNode.js","../../node_modules/three/examples/jsm/nodes/lighting/AnalyticLightNode.js","../../node_modules/three/examples/jsm/nodes/lighting/LightsNode.js","../../node_modules/three/examples/jsm/nodes/lighting/AONode.js","../../node_modules/three/examples/jsm/nodes/lighting/LightingContextNode.js","../../node_modules/three/examples/jsm/nodes/accessors/BitangentNode.js","../../node_modules/three/examples/jsm/nodes/accessors/AccessorsUtils.js","../../node_modules/three/examples/jsm/nodes/math/CondNode.js","../../node_modules/three/examples/jsm/nodes/pmrem/PMREMUtils.js","../../node_modules/three/examples/jsm/nodes/pmrem/PMREMNode.js","../../node_modules/three/examples/jsm/nodes/lighting/EnvironmentNode.js","../../node_modules/three/examples/jsm/nodes/lighting/IrradianceNode.js","../../node_modules/three/examples/jsm/nodes/display/ViewportNode.js","../../node_modules/three/examples/jsm/nodes/display/ViewportTextureNode.js","../../node_modules/three/examples/jsm/nodes/display/ViewportDepthTextureNode.js","../../node_modules/three/examples/jsm/nodes/display/ViewportDepthNode.js","../../node_modules/three/examples/jsm/nodes/accessors/ClippingNode.js","../../node_modules/three/examples/jsm/nodes/display/FrontFacingNode.js","../../node_modules/three/examples/jsm/nodes/materials/NodeMaterial.js","../../node_modules/three/examples/jsm/nodes/core/StackNode.js","../../node_modules/three/examples/jsm/nodes/utils/EquirectUVNode.js","../../node_modules/three/examples/jsm/nodes/core/StructTypeNode.js","../../node_modules/three/examples/jsm/nodes/core/OutputStructNode.js","../../node_modules/three/examples/jsm/nodes/math/HashNode.js","../../node_modules/three/examples/jsm/nodes/math/MathUtils.js","../../node_modules/three/examples/jsm/nodes/math/TriNoise3D.js","../../node_modules/three/examples/jsm/nodes/utils/DiscardNode.js","../../node_modules/three/examples/jsm/nodes/utils/FunctionOverloadingNode.js","../../node_modules/three/examples/jsm/nodes/utils/MatcapUVNode.js","../../node_modules/three/examples/jsm/nodes/utils/TimerNode.js","../../node_modules/three/examples/jsm/nodes/utils/OscNode.js","../../node_modules/three/examples/jsm/nodes/utils/PackingNode.js","../../node_modules/three/examples/jsm/nodes/utils/RemapNode.js","../../node_modules/three/examples/jsm/nodes/utils/RotateUVNode.js","../../node_modules/three/examples/jsm/nodes/utils/RotateNode.js","../../node_modules/three/examples/jsm/nodes/utils/SpriteSheetUVNode.js","../../node_modules/three/examples/jsm/nodes/utils/StorageArrayElementNode.js","../../node_modules/three/examples/jsm/nodes/utils/TriplanarTexturesNode.js","../../node_modules/three/examples/jsm/nodes/utils/ReflectorNode.js","../../node_modules/three/examples/jsm/nodes/accessors/VertexColorNode.js","../../node_modules/three/examples/jsm/nodes/accessors/RendererReferenceNode.js","../../node_modules/three/examples/jsm/nodes/accessors/TextureBicubicNode.js","../../node_modules/three/examples/jsm/nodes/accessors/PointUVNode.js","../../node_modules/three/examples/jsm/nodes/accessors/SceneNode.js","../../node_modules/three/examples/jsm/renderers/webgpu/utils/WebGPUConstants.js","../../node_modules/three/examples/jsm/nodes/accessors/StorageBufferNode.js","../../node_modules/three/examples/jsm/nodes/accessors/StorageTextureNode.js","../../node_modules/three/examples/jsm/nodes/accessors/Texture3DNode.js","../../node_modules/three/examples/jsm/nodes/accessors/UserDataNode.js","../../node_modules/three/examples/jsm/nodes/display/BlendModeNode.js","../../node_modules/three/examples/jsm/nodes/display/BumpMapNode.js","../../node_modules/three/examples/jsm/nodes/display/ColorAdjustmentNode.js","../../node_modules/three/examples/jsm/nodes/display/NormalMapNode.js","../../node_modules/three/examples/jsm/nodes/display/PosterizeNode.js","../../node_modules/three/examples/jsm/nodes/display/ToneMappingNode.js","../../node_modules/three/examples/jsm/nodes/display/ViewportSharedTextureNode.js","../../node_modules/three/examples/jsm/nodes/display/PassNode.js","../../node_modules/three/examples/jsm/objects/QuadMesh.js","../../node_modules/three/examples/jsm/nodes/display/GaussianBlurNode.js","../../node_modules/three/examples/jsm/nodes/display/AfterImageNode.js","../../node_modules/three/examples/jsm/nodes/display/AnamorphicNode.js","../../node_modules/three/examples/jsm/nodes/display/SobelOperatorNode.js","../../node_modules/three/examples/jsm/nodes/display/DepthOfFieldNode.js","../../node_modules/three/examples/jsm/nodes/display/DotScreenNode.js","../../node_modules/three/examples/jsm/nodes/display/RGBShiftNode.js","../../node_modules/three/examples/jsm/nodes/code/FunctionCallNode.js","../../node_modules/three/examples/jsm/nodes/code/ScriptableValueNode.js","../../node_modules/three/examples/jsm/nodes/code/ScriptableNode.js","../../node_modules/three/examples/jsm/nodes/fog/FogNode.js","../../node_modules/three/examples/jsm/nodes/fog/FogRangeNode.js","../../node_modules/three/examples/jsm/nodes/fog/FogExp2Node.js","../../node_modules/three/examples/jsm/nodes/geometry/RangeNode.js","../../node_modules/three/examples/jsm/nodes/gpgpu/ComputeNode.js","../../node_modules/three/examples/jsm/nodes/lighting/LightNode.js","../../node_modules/three/examples/jsm/nodes/lighting/LightUtils.js","../../node_modules/three/examples/jsm/nodes/lighting/PointLightNode.js","../../node_modules/three/examples/jsm/nodes/lighting/DirectionalLightNode.js","../../node_modules/three/examples/jsm/nodes/lighting/RectAreaLightNode.js","../../node_modules/three/examples/jsm/nodes/lighting/SpotLightNode.js","../../node_modules/three/examples/jsm/lights/IESSpotLight.js","../../node_modules/three/examples/jsm/nodes/lighting/IESSpotLightNode.js","../../node_modules/three/examples/jsm/nodes/lighting/AmbientLightNode.js","../../node_modules/three/examples/jsm/nodes/lighting/HemisphereLightNode.js","../../node_modules/three/examples/jsm/nodes/procedural/CheckerNode.js","../../node_modules/three/examples/jsm/nodes/materials/InstancedPointsNodeMaterial.js","../../node_modules/three/examples/jsm/nodes/materials/LineBasicNodeMaterial.js","../../node_modules/three/examples/jsm/nodes/materials/LineDashedNodeMaterial.js","../../node_modules/three/examples/jsm/nodes/materials/Line2NodeMaterial.js","../../node_modules/three/examples/jsm/nodes/materials/MeshNormalNodeMaterial.js","../../node_modules/three/examples/jsm/nodes/materials/MeshBasicNodeMaterial.js","../../node_modules/three/examples/jsm/nodes/functions/BSDF/F_Schlick.js","../../node_modules/three/examples/jsm/nodes/functions/BSDF/BRDF_Lambert.js","../../node_modules/three/examples/jsm/nodes/functions/PhongLightingModel.js","../../node_modules/three/examples/jsm/nodes/materials/MeshLambertNodeMaterial.js","../../node_modules/three/examples/jsm/nodes/materials/MeshPhongNodeMaterial.js","../../node_modules/three/examples/jsm/nodes/functions/material/getGeometryRoughness.js","../../node_modules/three/examples/jsm/nodes/functions/material/getRoughness.js","../../node_modules/three/examples/jsm/nodes/functions/BSDF/V_GGX_SmithCorrelated.js","../../node_modules/three/examples/jsm/nodes/functions/BSDF/V_GGX_SmithCorrelated_Anisotropic.js","../../node_modules/three/examples/jsm/nodes/functions/BSDF/D_GGX.js","../../node_modules/three/examples/jsm/nodes/functions/BSDF/D_GGX_Anisotropic.js","../../node_modules/three/examples/jsm/nodes/functions/BSDF/BRDF_GGX.js","../../node_modules/three/examples/jsm/nodes/functions/BSDF/DFGApprox.js","../../node_modules/three/examples/jsm/nodes/functions/BSDF/EnvironmentBRDF.js","../../node_modules/three/examples/jsm/nodes/functions/BSDF/Schlick_to_F0.js","../../node_modules/three/examples/jsm/nodes/functions/BSDF/BRDF_Sheen.js","../../node_modules/three/examples/jsm/nodes/functions/BSDF/LTC.js","../../node_modules/three/examples/jsm/nodes/functions/PhysicalLightingModel.js","../../node_modules/three/examples/jsm/nodes/materials/MeshStandardNodeMaterial.js","../../node_modules/three/examples/jsm/nodes/materials/MeshPhysicalNodeMaterial.js","../../node_modules/three/examples/jsm/nodes/materials/MeshSSSNodeMaterial.js","../../node_modules/three/examples/jsm/nodes/functions/ToonLightingModel.js","../../node_modules/three/examples/jsm/nodes/materials/MeshToonNodeMaterial.js","../../node_modules/three/examples/jsm/nodes/materials/MeshMatcapNodeMaterial.js","../../node_modules/three/examples/jsm/nodes/materials/PointsNodeMaterial.js","../../node_modules/three/examples/jsm/nodes/materials/SpriteNodeMaterial.js","../../node_modules/three/examples/jsm/nodes/functions/ShadowMaskModel.js","../../node_modules/three/examples/jsm/nodes/materials/ShadowNodeMaterial.js","../../node_modules/three/examples/jsm/nodes/materials/VolumeNodeMaterial.js","../../node_modules/three/examples/jsm/nodes/loaders/NodeMaterialLoader.js","../../src/Menus/WeekWindow.jsx"],"sourcesContent":["'use client';\n\nimport * as React from 'react';\n\n/**\n * @ignore - internal component.\n */\nconst GridContext = /*#__PURE__*/React.createContext();\nif (process.env.NODE_ENV !== 'production') {\n  GridContext.displayName = 'GridContext';\n}\nexport default GridContext;","import generateUtilityClasses from '@mui/utils/generateUtilityClasses';\nimport generateUtilityClass from '@mui/utils/generateUtilityClass';\nexport function getGridUtilityClass(slot) {\n  return generateUtilityClass('MuiGrid', slot);\n}\nconst SPACINGS = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10];\nconst DIRECTIONS = ['column-reverse', 'column', 'row-reverse', 'row'];\nconst WRAPS = ['nowrap', 'wrap-reverse', 'wrap'];\nconst GRID_SIZES = ['auto', true, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12];\nconst gridClasses = generateUtilityClasses('MuiGrid', ['root', 'container', 'item', 'zeroMinWidth',\n// spacings\n...SPACINGS.map(spacing => `spacing-xs-${spacing}`),\n// direction values\n...DIRECTIONS.map(direction => `direction-xs-${direction}`),\n// wrap values\n...WRAPS.map(wrap => `wrap-xs-${wrap}`),\n// grid sizes for all breakpoints\n...GRID_SIZES.map(size => `grid-xs-${size}`), ...GRID_SIZES.map(size => `grid-sm-${size}`), ...GRID_SIZES.map(size => `grid-md-${size}`), ...GRID_SIZES.map(size => `grid-lg-${size}`), ...GRID_SIZES.map(size => `grid-xl-${size}`)]);\nexport default gridClasses;","'use client';\n\n// A grid component using the following libs as inspiration.\n//\n// For the implementation:\n// - https://getbootstrap.com/docs/4.3/layout/grid/\n// - https://github.com/kristoferjoseph/flexboxgrid/blob/master/src/css/flexboxgrid.css\n// - https://github.com/roylee0704/react-flexbox-grid\n// - https://material.angularjs.org/latest/layout/introduction\n//\n// Follow this flexbox Guide to better understand the underlying model:\n// - https://css-tricks.com/snippets/css/a-guide-to-flexbox/\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nconst _excluded = [\"className\", \"columns\", \"columnSpacing\", \"component\", \"container\", \"direction\", \"item\", \"rowSpacing\", \"spacing\", \"wrap\", \"zeroMinWidth\"];\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport { handleBreakpoints, unstable_resolveBreakpointValues as resolveBreakpointValues } from '@mui/system';\nimport { extendSxProp } from '@mui/system/styleFunctionSx';\nimport composeClasses from '@mui/utils/composeClasses';\nimport requirePropFactory from '../utils/requirePropFactory';\nimport styled from '../styles/styled';\nimport { useDefaultProps } from '../DefaultPropsProvider';\nimport useTheme from '../styles/useTheme';\nimport GridContext from './GridContext';\nimport gridClasses, { getGridUtilityClass } from './gridClasses';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nfunction getOffset(val) {\n  const parse = parseFloat(val);\n  return `${parse}${String(val).replace(String(parse), '') || 'px'}`;\n}\nexport function generateGrid({\n  theme,\n  ownerState\n}) {\n  let size;\n  return theme.breakpoints.keys.reduce((globalStyles, breakpoint) => {\n    // Use side effect over immutability for better performance.\n    let styles = {};\n    if (ownerState[breakpoint]) {\n      size = ownerState[breakpoint];\n    }\n    if (!size) {\n      return globalStyles;\n    }\n    if (size === true) {\n      // For the auto layouting\n      styles = {\n        flexBasis: 0,\n        flexGrow: 1,\n        maxWidth: '100%'\n      };\n    } else if (size === 'auto') {\n      styles = {\n        flexBasis: 'auto',\n        flexGrow: 0,\n        flexShrink: 0,\n        maxWidth: 'none',\n        width: 'auto'\n      };\n    } else {\n      const columnsBreakpointValues = resolveBreakpointValues({\n        values: ownerState.columns,\n        breakpoints: theme.breakpoints.values\n      });\n      const columnValue = typeof columnsBreakpointValues === 'object' ? columnsBreakpointValues[breakpoint] : columnsBreakpointValues;\n      if (columnValue === undefined || columnValue === null) {\n        return globalStyles;\n      }\n      // Keep 7 significant numbers.\n      const width = `${Math.round(size / columnValue * 10e7) / 10e5}%`;\n      let more = {};\n      if (ownerState.container && ownerState.item && ownerState.columnSpacing !== 0) {\n        const themeSpacing = theme.spacing(ownerState.columnSpacing);\n        if (themeSpacing !== '0px') {\n          const fullWidth = `calc(${width} + ${getOffset(themeSpacing)})`;\n          more = {\n            flexBasis: fullWidth,\n            maxWidth: fullWidth\n          };\n        }\n      }\n\n      // Close to the bootstrap implementation:\n      // https://github.com/twbs/bootstrap/blob/8fccaa2439e97ec72a4b7dc42ccc1f649790adb0/scss/mixins/_grid.scss#L41\n      styles = _extends({\n        flexBasis: width,\n        flexGrow: 0,\n        maxWidth: width\n      }, more);\n    }\n\n    // No need for a media query for the first size.\n    if (theme.breakpoints.values[breakpoint] === 0) {\n      Object.assign(globalStyles, styles);\n    } else {\n      globalStyles[theme.breakpoints.up(breakpoint)] = styles;\n    }\n    return globalStyles;\n  }, {});\n}\nexport function generateDirection({\n  theme,\n  ownerState\n}) {\n  const directionValues = resolveBreakpointValues({\n    values: ownerState.direction,\n    breakpoints: theme.breakpoints.values\n  });\n  return handleBreakpoints({\n    theme\n  }, directionValues, propValue => {\n    const output = {\n      flexDirection: propValue\n    };\n    if (propValue.indexOf('column') === 0) {\n      output[`& > .${gridClasses.item}`] = {\n        maxWidth: 'none'\n      };\n    }\n    return output;\n  });\n}\n\n/**\n * Extracts zero value breakpoint keys before a non-zero value breakpoint key.\n * @example { xs: 0, sm: 0, md: 2, lg: 0, xl: 0 } or [0, 0, 2, 0, 0]\n * @returns [xs, sm]\n */\nfunction extractZeroValueBreakpointKeys({\n  breakpoints,\n  values\n}) {\n  let nonZeroKey = '';\n  Object.keys(values).forEach(key => {\n    if (nonZeroKey !== '') {\n      return;\n    }\n    if (values[key] !== 0) {\n      nonZeroKey = key;\n    }\n  });\n  const sortedBreakpointKeysByValue = Object.keys(breakpoints).sort((a, b) => {\n    return breakpoints[a] - breakpoints[b];\n  });\n  return sortedBreakpointKeysByValue.slice(0, sortedBreakpointKeysByValue.indexOf(nonZeroKey));\n}\nexport function generateRowGap({\n  theme,\n  ownerState\n}) {\n  const {\n    container,\n    rowSpacing\n  } = ownerState;\n  let styles = {};\n  if (container && rowSpacing !== 0) {\n    const rowSpacingValues = resolveBreakpointValues({\n      values: rowSpacing,\n      breakpoints: theme.breakpoints.values\n    });\n    let zeroValueBreakpointKeys;\n    if (typeof rowSpacingValues === 'object') {\n      zeroValueBreakpointKeys = extractZeroValueBreakpointKeys({\n        breakpoints: theme.breakpoints.values,\n        values: rowSpacingValues\n      });\n    }\n    styles = handleBreakpoints({\n      theme\n    }, rowSpacingValues, (propValue, breakpoint) => {\n      var _zeroValueBreakpointK;\n      const themeSpacing = theme.spacing(propValue);\n      if (themeSpacing !== '0px') {\n        return {\n          marginTop: `-${getOffset(themeSpacing)}`,\n          [`& > .${gridClasses.item}`]: {\n            paddingTop: getOffset(themeSpacing)\n          }\n        };\n      }\n      if ((_zeroValueBreakpointK = zeroValueBreakpointKeys) != null && _zeroValueBreakpointK.includes(breakpoint)) {\n        return {};\n      }\n      return {\n        marginTop: 0,\n        [`& > .${gridClasses.item}`]: {\n          paddingTop: 0\n        }\n      };\n    });\n  }\n  return styles;\n}\nexport function generateColumnGap({\n  theme,\n  ownerState\n}) {\n  const {\n    container,\n    columnSpacing\n  } = ownerState;\n  let styles = {};\n  if (container && columnSpacing !== 0) {\n    const columnSpacingValues = resolveBreakpointValues({\n      values: columnSpacing,\n      breakpoints: theme.breakpoints.values\n    });\n    let zeroValueBreakpointKeys;\n    if (typeof columnSpacingValues === 'object') {\n      zeroValueBreakpointKeys = extractZeroValueBreakpointKeys({\n        breakpoints: theme.breakpoints.values,\n        values: columnSpacingValues\n      });\n    }\n    styles = handleBreakpoints({\n      theme\n    }, columnSpacingValues, (propValue, breakpoint) => {\n      var _zeroValueBreakpointK2;\n      const themeSpacing = theme.spacing(propValue);\n      if (themeSpacing !== '0px') {\n        return {\n          width: `calc(100% + ${getOffset(themeSpacing)})`,\n          marginLeft: `-${getOffset(themeSpacing)}`,\n          [`& > .${gridClasses.item}`]: {\n            paddingLeft: getOffset(themeSpacing)\n          }\n        };\n      }\n      if ((_zeroValueBreakpointK2 = zeroValueBreakpointKeys) != null && _zeroValueBreakpointK2.includes(breakpoint)) {\n        return {};\n      }\n      return {\n        width: '100%',\n        marginLeft: 0,\n        [`& > .${gridClasses.item}`]: {\n          paddingLeft: 0\n        }\n      };\n    });\n  }\n  return styles;\n}\nexport function resolveSpacingStyles(spacing, breakpoints, styles = {}) {\n  // undefined/null or `spacing` <= 0\n  if (!spacing || spacing <= 0) {\n    return [];\n  }\n  // in case of string/number `spacing`\n  if (typeof spacing === 'string' && !Number.isNaN(Number(spacing)) || typeof spacing === 'number') {\n    return [styles[`spacing-xs-${String(spacing)}`]];\n  }\n  // in case of object `spacing`\n  const spacingStyles = [];\n  breakpoints.forEach(breakpoint => {\n    const value = spacing[breakpoint];\n    if (Number(value) > 0) {\n      spacingStyles.push(styles[`spacing-${breakpoint}-${String(value)}`]);\n    }\n  });\n  return spacingStyles;\n}\n\n// Default CSS values\n// flex: '0 1 auto',\n// flexDirection: 'row',\n// alignItems: 'flex-start',\n// flexWrap: 'nowrap',\n// justifyContent: 'flex-start',\nconst GridRoot = styled('div', {\n  name: 'MuiGrid',\n  slot: 'Root',\n  overridesResolver: (props, styles) => {\n    const {\n      ownerState\n    } = props;\n    const {\n      container,\n      direction,\n      item,\n      spacing,\n      wrap,\n      zeroMinWidth,\n      breakpoints\n    } = ownerState;\n    let spacingStyles = [];\n\n    // in case of grid item\n    if (container) {\n      spacingStyles = resolveSpacingStyles(spacing, breakpoints, styles);\n    }\n    const breakpointsStyles = [];\n    breakpoints.forEach(breakpoint => {\n      const value = ownerState[breakpoint];\n      if (value) {\n        breakpointsStyles.push(styles[`grid-${breakpoint}-${String(value)}`]);\n      }\n    });\n    return [styles.root, container && styles.container, item && styles.item, zeroMinWidth && styles.zeroMinWidth, ...spacingStyles, direction !== 'row' && styles[`direction-xs-${String(direction)}`], wrap !== 'wrap' && styles[`wrap-xs-${String(wrap)}`], ...breakpointsStyles];\n  }\n})(({\n  ownerState\n}) => _extends({\n  boxSizing: 'border-box'\n}, ownerState.container && {\n  display: 'flex',\n  flexWrap: 'wrap',\n  width: '100%'\n}, ownerState.item && {\n  margin: 0 // For instance, it's useful when used with a `figure` element.\n}, ownerState.zeroMinWidth && {\n  minWidth: 0\n}, ownerState.wrap !== 'wrap' && {\n  flexWrap: ownerState.wrap\n}), generateDirection, generateRowGap, generateColumnGap, generateGrid);\nexport function resolveSpacingClasses(spacing, breakpoints) {\n  // undefined/null or `spacing` <= 0\n  if (!spacing || spacing <= 0) {\n    return [];\n  }\n  // in case of string/number `spacing`\n  if (typeof spacing === 'string' && !Number.isNaN(Number(spacing)) || typeof spacing === 'number') {\n    return [`spacing-xs-${String(spacing)}`];\n  }\n  // in case of object `spacing`\n  const classes = [];\n  breakpoints.forEach(breakpoint => {\n    const value = spacing[breakpoint];\n    if (Number(value) > 0) {\n      const className = `spacing-${breakpoint}-${String(value)}`;\n      classes.push(className);\n    }\n  });\n  return classes;\n}\nconst useUtilityClasses = ownerState => {\n  const {\n    classes,\n    container,\n    direction,\n    item,\n    spacing,\n    wrap,\n    zeroMinWidth,\n    breakpoints\n  } = ownerState;\n  let spacingClasses = [];\n\n  // in case of grid item\n  if (container) {\n    spacingClasses = resolveSpacingClasses(spacing, breakpoints);\n  }\n  const breakpointsClasses = [];\n  breakpoints.forEach(breakpoint => {\n    const value = ownerState[breakpoint];\n    if (value) {\n      breakpointsClasses.push(`grid-${breakpoint}-${String(value)}`);\n    }\n  });\n  const slots = {\n    root: ['root', container && 'container', item && 'item', zeroMinWidth && 'zeroMinWidth', ...spacingClasses, direction !== 'row' && `direction-xs-${String(direction)}`, wrap !== 'wrap' && `wrap-xs-${String(wrap)}`, ...breakpointsClasses]\n  };\n  return composeClasses(slots, getGridUtilityClass, classes);\n};\nconst Grid = /*#__PURE__*/React.forwardRef(function Grid(inProps, ref) {\n  const themeProps = useDefaultProps({\n    props: inProps,\n    name: 'MuiGrid'\n  });\n  const {\n    breakpoints\n  } = useTheme();\n  const props = extendSxProp(themeProps);\n  const {\n      className,\n      columns: columnsProp,\n      columnSpacing: columnSpacingProp,\n      component = 'div',\n      container = false,\n      direction = 'row',\n      item = false,\n      rowSpacing: rowSpacingProp,\n      spacing = 0,\n      wrap = 'wrap',\n      zeroMinWidth = false\n    } = props,\n    other = _objectWithoutPropertiesLoose(props, _excluded);\n  const rowSpacing = rowSpacingProp || spacing;\n  const columnSpacing = columnSpacingProp || spacing;\n  const columnsContext = React.useContext(GridContext);\n\n  // columns set with default breakpoint unit of 12\n  const columns = container ? columnsProp || 12 : columnsContext;\n  const breakpointsValues = {};\n  const otherFiltered = _extends({}, other);\n  breakpoints.keys.forEach(breakpoint => {\n    if (other[breakpoint] != null) {\n      breakpointsValues[breakpoint] = other[breakpoint];\n      delete otherFiltered[breakpoint];\n    }\n  });\n  const ownerState = _extends({}, props, {\n    columns,\n    container,\n    direction,\n    item,\n    rowSpacing,\n    columnSpacing,\n    wrap,\n    zeroMinWidth,\n    spacing\n  }, breakpointsValues, {\n    breakpoints: breakpoints.keys\n  });\n  const classes = useUtilityClasses(ownerState);\n  return /*#__PURE__*/_jsx(GridContext.Provider, {\n    value: columns,\n    children: /*#__PURE__*/_jsx(GridRoot, _extends({\n      ownerState: ownerState,\n      className: clsx(classes.root, className),\n      as: component,\n      ref: ref\n    }, otherFiltered))\n  });\n});\nprocess.env.NODE_ENV !== \"production\" ? Grid.propTypes /* remove-proptypes */ = {\n  // ┌────────────────────────────── Warning ──────────────────────────────┐\n  // │ These PropTypes are generated from the TypeScript type definitions. │\n  // │    To update them, edit the d.ts file and run `pnpm proptypes`.     │\n  // └─────────────────────────────────────────────────────────────────────┘\n  /**\n   * The content of the component.\n   */\n  children: PropTypes.node,\n  /**\n   * Override or extend the styles applied to the component.\n   */\n  classes: PropTypes.object,\n  /**\n   * @ignore\n   */\n  className: PropTypes.string,\n  /**\n   * The number of columns.\n   * @default 12\n   */\n  columns: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.number), PropTypes.number, PropTypes.object]),\n  /**\n   * Defines the horizontal space between the type `item` components.\n   * It overrides the value of the `spacing` prop.\n   */\n  columnSpacing: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.number, PropTypes.string])), PropTypes.number, PropTypes.object, PropTypes.string]),\n  /**\n   * The component used for the root node.\n   * Either a string to use a HTML element or a component.\n   */\n  component: PropTypes.elementType,\n  /**\n   * If `true`, the component will have the flex *container* behavior.\n   * You should be wrapping *items* with a *container*.\n   * @default false\n   */\n  container: PropTypes.bool,\n  /**\n   * Defines the `flex-direction` style property.\n   * It is applied for all screen sizes.\n   * @default 'row'\n   */\n  direction: PropTypes.oneOfType([PropTypes.oneOf(['column-reverse', 'column', 'row-reverse', 'row']), PropTypes.arrayOf(PropTypes.oneOf(['column-reverse', 'column', 'row-reverse', 'row'])), PropTypes.object]),\n  /**\n   * If `true`, the component will have the flex *item* behavior.\n   * You should be wrapping *items* with a *container*.\n   * @default false\n   */\n  item: PropTypes.bool,\n  /**\n   * If a number, it sets the number of columns the grid item uses.\n   * It can't be greater than the total number of columns of the container (12 by default).\n   * If 'auto', the grid item's width matches its content.\n   * If false, the prop is ignored.\n   * If true, the grid item's width grows to use the space available in the grid container.\n   * The value is applied for the `lg` breakpoint and wider screens if not overridden.\n   * @default false\n   */\n  lg: PropTypes.oneOfType([PropTypes.oneOf(['auto']), PropTypes.number, PropTypes.bool]),\n  /**\n   * If a number, it sets the number of columns the grid item uses.\n   * It can't be greater than the total number of columns of the container (12 by default).\n   * If 'auto', the grid item's width matches its content.\n   * If false, the prop is ignored.\n   * If true, the grid item's width grows to use the space available in the grid container.\n   * The value is applied for the `md` breakpoint and wider screens if not overridden.\n   * @default false\n   */\n  md: PropTypes.oneOfType([PropTypes.oneOf(['auto']), PropTypes.number, PropTypes.bool]),\n  /**\n   * Defines the vertical space between the type `item` components.\n   * It overrides the value of the `spacing` prop.\n   */\n  rowSpacing: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.number, PropTypes.string])), PropTypes.number, PropTypes.object, PropTypes.string]),\n  /**\n   * If a number, it sets the number of columns the grid item uses.\n   * It can't be greater than the total number of columns of the container (12 by default).\n   * If 'auto', the grid item's width matches its content.\n   * If false, the prop is ignored.\n   * If true, the grid item's width grows to use the space available in the grid container.\n   * The value is applied for the `sm` breakpoint and wider screens if not overridden.\n   * @default false\n   */\n  sm: PropTypes.oneOfType([PropTypes.oneOf(['auto']), PropTypes.number, PropTypes.bool]),\n  /**\n   * Defines the space between the type `item` components.\n   * It can only be used on a type `container` component.\n   * @default 0\n   */\n  spacing: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.number, PropTypes.string])), PropTypes.number, PropTypes.object, PropTypes.string]),\n  /**\n   * The system prop that allows defining system overrides as well as additional CSS styles.\n   */\n  sx: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.func, PropTypes.object, PropTypes.bool])), PropTypes.func, PropTypes.object]),\n  /**\n   * Defines the `flex-wrap` style property.\n   * It's applied for all screen sizes.\n   * @default 'wrap'\n   */\n  wrap: PropTypes.oneOf(['nowrap', 'wrap-reverse', 'wrap']),\n  /**\n   * If a number, it sets the number of columns the grid item uses.\n   * It can't be greater than the total number of columns of the container (12 by default).\n   * If 'auto', the grid item's width matches its content.\n   * If false, the prop is ignored.\n   * If true, the grid item's width grows to use the space available in the grid container.\n   * The value is applied for the `xl` breakpoint and wider screens if not overridden.\n   * @default false\n   */\n  xl: PropTypes.oneOfType([PropTypes.oneOf(['auto']), PropTypes.number, PropTypes.bool]),\n  /**\n   * If a number, it sets the number of columns the grid item uses.\n   * It can't be greater than the total number of columns of the container (12 by default).\n   * If 'auto', the grid item's width matches its content.\n   * If false, the prop is ignored.\n   * If true, the grid item's width grows to use the space available in the grid container.\n   * The value is applied for all the screen sizes with the lowest priority.\n   * @default false\n   */\n  xs: PropTypes.oneOfType([PropTypes.oneOf(['auto']), PropTypes.number, PropTypes.bool]),\n  /**\n   * If `true`, it sets `min-width: 0` on the item.\n   * Refer to the limitations section of the documentation to better understand the use case.\n   * @default false\n   */\n  zeroMinWidth: PropTypes.bool\n} : void 0;\nif (process.env.NODE_ENV !== 'production') {\n  const requireProp = requirePropFactory('Grid', Grid);\n  // eslint-disable-next-line no-useless-concat\n  Grid['propTypes' + ''] = _extends({}, Grid.propTypes, {\n    direction: requireProp('container'),\n    lg: requireProp('item'),\n    md: requireProp('item'),\n    sm: requireProp('item'),\n    spacing: requireProp('container'),\n    wrap: requireProp('container'),\n    xs: requireProp('item'),\n    zeroMinWidth: requireProp('item')\n  });\n}\nexport default Grid;","// =============================================================================\n// Weekday\n// =============================================================================\nexport var ALL_WEEKDAYS = [\n    'MO',\n    'TU',\n    'WE',\n    'TH',\n    'FR',\n    'SA',\n    'SU',\n];\nvar Weekday = /** @class */ (function () {\n    function Weekday(weekday, n) {\n        if (n === 0)\n            throw new Error(\"Can't create weekday with n == 0\");\n        this.weekday = weekday;\n        this.n = n;\n    }\n    Weekday.fromStr = function (str) {\n        return new Weekday(ALL_WEEKDAYS.indexOf(str));\n    };\n    // __call__ - Cannot call the object directly, do it through\n    // e.g. RRule.TH.nth(-1) instead,\n    Weekday.prototype.nth = function (n) {\n        return this.n === n ? this : new Weekday(this.weekday, n);\n    };\n    // __eq__\n    Weekday.prototype.equals = function (other) {\n        return this.weekday === other.weekday && this.n === other.n;\n    };\n    // __repr__\n    Weekday.prototype.toString = function () {\n        var s = ALL_WEEKDAYS[this.weekday];\n        if (this.n)\n            s = (this.n > 0 ? '+' : '') + String(this.n) + s;\n        return s;\n    };\n    Weekday.prototype.getJsWeekday = function () {\n        return this.weekday === 6 ? 0 : this.weekday + 1;\n    };\n    return Weekday;\n}());\nexport { Weekday };\n//# sourceMappingURL=weekday.js.map","// =============================================================================\n// Helper functions\n// =============================================================================\nimport { ALL_WEEKDAYS } from './weekday';\nexport var isPresent = function (value) {\n    return value !== null && value !== undefined;\n};\nexport var isNumber = function (value) {\n    return typeof value === 'number';\n};\nexport var isWeekdayStr = function (value) {\n    return typeof value === 'string' && ALL_WEEKDAYS.includes(value);\n};\nexport var isArray = Array.isArray;\n/**\n * Simplified version of python's range()\n */\nexport var range = function (start, end) {\n    if (end === void 0) { end = start; }\n    if (arguments.length === 1) {\n        end = start;\n        start = 0;\n    }\n    var rang = [];\n    for (var i = start; i < end; i++)\n        rang.push(i);\n    return rang;\n};\nexport var clone = function (array) {\n    return [].concat(array);\n};\nexport var repeat = function (value, times) {\n    var i = 0;\n    var array = [];\n    if (isArray(value)) {\n        for (; i < times; i++)\n            array[i] = [].concat(value);\n    }\n    else {\n        for (; i < times; i++)\n            array[i] = value;\n    }\n    return array;\n};\nexport var toArray = function (item) {\n    if (isArray(item)) {\n        return item;\n    }\n    return [item];\n};\nexport function padStart(item, targetLength, padString) {\n    if (padString === void 0) { padString = ' '; }\n    var str = String(item);\n    targetLength = targetLength >> 0;\n    if (str.length > targetLength) {\n        return String(str);\n    }\n    targetLength = targetLength - str.length;\n    if (targetLength > padString.length) {\n        padString += repeat(padString, targetLength / padString.length);\n    }\n    return padString.slice(0, targetLength) + String(str);\n}\n/**\n * Python like split\n */\nexport var split = function (str, sep, num) {\n    var splits = str.split(sep);\n    return num\n        ? splits.slice(0, num).concat([splits.slice(num).join(sep)])\n        : splits;\n};\n/**\n * closure/goog/math/math.js:modulo\n * Copyright 2006 The Closure Library Authors.\n * The % operator in JavaScript returns the remainder of a / b, but differs from\n * some other languages in that the result will have the same sign as the\n * dividend. For example, -1 % 8 == -1, whereas in some other languages\n * (such as Python) the result would be 7. This function emulates the more\n * correct modulo behavior, which is useful for certain applications such as\n * calculating an offset index in a circular list.\n *\n * @param {number} a The dividend.\n * @param {number} b The divisor.\n * @return {number} a % b where the result is between 0 and b (either 0 <= x < b\n * or b < x <= 0, depending on the sign of b).\n */\nexport var pymod = function (a, b) {\n    var r = a % b;\n    // If r and b differ in sign, add b to wrap the result to the correct sign.\n    return r * b < 0 ? r + b : r;\n};\n/**\n * @see: <http://docs.python.org/library/functions.html#divmod>\n */\nexport var divmod = function (a, b) {\n    return { div: Math.floor(a / b), mod: pymod(a, b) };\n};\nexport var empty = function (obj) {\n    return !isPresent(obj) || obj.length === 0;\n};\n/**\n * Python-like boolean\n *\n * @return {Boolean} value of an object/primitive, taking into account\n * the fact that in Python an empty list's/tuple's\n * boolean value is False, whereas in JS it's true\n */\nexport var notEmpty = function (obj) {\n    return !empty(obj);\n};\n/**\n * Return true if a value is in an array\n */\nexport var includes = function (arr, val) {\n    return notEmpty(arr) && arr.indexOf(val) !== -1;\n};\n//# sourceMappingURL=helpers.js.map","import { padStart } from './helpers';\nexport var datetime = function (y, m, d, h, i, s) {\n    if (h === void 0) { h = 0; }\n    if (i === void 0) { i = 0; }\n    if (s === void 0) { s = 0; }\n    return new Date(Date.UTC(y, m - 1, d, h, i, s));\n};\n/**\n * General date-related utilities.\n * Also handles several incompatibilities between JavaScript and Python\n *\n */\nexport var MONTH_DAYS = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];\n/**\n * Number of milliseconds of one day\n */\nexport var ONE_DAY = 1000 * 60 * 60 * 24;\n/**\n * @see: <http://docs.python.org/library/datetime.html#datetime.MAXYEAR>\n */\nexport var MAXYEAR = 9999;\n/**\n * Python uses 1-Jan-1 as the base for calculating ordinals but we don't\n * want to confuse the JS engine with milliseconds > Number.MAX_NUMBER,\n * therefore we use 1-Jan-1970 instead\n */\nexport var ORDINAL_BASE = datetime(1970, 1, 1);\n/**\n * Python: MO-SU: 0 - 6\n * JS: SU-SAT 0 - 6\n */\nexport var PY_WEEKDAYS = [6, 0, 1, 2, 3, 4, 5];\n/**\n * py_date.timetuple()[7]\n */\nexport var getYearDay = function (date) {\n    var dateNoTime = new Date(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate());\n    return (Math.ceil((dateNoTime.valueOf() - new Date(date.getUTCFullYear(), 0, 1).valueOf()) /\n        ONE_DAY) + 1);\n};\nexport var isLeapYear = function (year) {\n    return (year % 4 === 0 && year % 100 !== 0) || year % 400 === 0;\n};\nexport var isDate = function (value) {\n    return value instanceof Date;\n};\nexport var isValidDate = function (value) {\n    return isDate(value) && !isNaN(value.getTime());\n};\n/**\n * @return {Number} the date's timezone offset in ms\n */\nexport var tzOffset = function (date) {\n    return date.getTimezoneOffset() * 60 * 1000;\n};\n/**\n * @see: <http://www.mcfedries.com/JavaScript/DaysBetween.asp>\n */\nexport var daysBetween = function (date1, date2) {\n    // The number of milliseconds in one day\n    // Convert both dates to milliseconds\n    var date1ms = date1.getTime();\n    var date2ms = date2.getTime();\n    // Calculate the difference in milliseconds\n    var differencems = date1ms - date2ms;\n    // Convert back to days and return\n    return Math.round(differencems / ONE_DAY);\n};\n/**\n * @see: <http://docs.python.org/library/datetime.html#datetime.date.toordinal>\n */\nexport var toOrdinal = function (date) {\n    return daysBetween(date, ORDINAL_BASE);\n};\n/**\n * @see - <http://docs.python.org/library/datetime.html#datetime.date.fromordinal>\n */\nexport var fromOrdinal = function (ordinal) {\n    return new Date(ORDINAL_BASE.getTime() + ordinal * ONE_DAY);\n};\nexport var getMonthDays = function (date) {\n    var month = date.getUTCMonth();\n    return month === 1 && isLeapYear(date.getUTCFullYear())\n        ? 29\n        : MONTH_DAYS[month];\n};\n/**\n * @return {Number} python-like weekday\n */\nexport var getWeekday = function (date) {\n    return PY_WEEKDAYS[date.getUTCDay()];\n};\n/**\n * @see: <http://docs.python.org/library/calendar.html#calendar.monthrange>\n */\nexport var monthRange = function (year, month) {\n    var date = datetime(year, month + 1, 1);\n    return [getWeekday(date), getMonthDays(date)];\n};\n/**\n * @see: <http://docs.python.org/library/datetime.html#datetime.datetime.combine>\n */\nexport var combine = function (date, time) {\n    time = time || date;\n    return new Date(Date.UTC(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), time.getHours(), time.getMinutes(), time.getSeconds(), time.getMilliseconds()));\n};\nexport var clone = function (date) {\n    var dolly = new Date(date.getTime());\n    return dolly;\n};\nexport var cloneDates = function (dates) {\n    var clones = [];\n    for (var i = 0; i < dates.length; i++) {\n        clones.push(clone(dates[i]));\n    }\n    return clones;\n};\n/**\n * Sorts an array of Date or Time objects\n */\nexport var sort = function (dates) {\n    dates.sort(function (a, b) {\n        return a.getTime() - b.getTime();\n    });\n};\nexport var timeToUntilString = function (time, utc) {\n    if (utc === void 0) { utc = true; }\n    var date = new Date(time);\n    return [\n        padStart(date.getUTCFullYear().toString(), 4, '0'),\n        padStart(date.getUTCMonth() + 1, 2, '0'),\n        padStart(date.getUTCDate(), 2, '0'),\n        'T',\n        padStart(date.getUTCHours(), 2, '0'),\n        padStart(date.getUTCMinutes(), 2, '0'),\n        padStart(date.getUTCSeconds(), 2, '0'),\n        utc ? 'Z' : '',\n    ].join('');\n};\nexport var untilStringToDate = function (until) {\n    var re = /^(\\d{4})(\\d{2})(\\d{2})(T(\\d{2})(\\d{2})(\\d{2})Z?)?$/;\n    var bits = re.exec(until);\n    if (!bits)\n        throw new Error(\"Invalid UNTIL value: \".concat(until));\n    return new Date(Date.UTC(parseInt(bits[1], 10), parseInt(bits[2], 10) - 1, parseInt(bits[3], 10), parseInt(bits[5], 10) || 0, parseInt(bits[6], 10) || 0, parseInt(bits[7], 10) || 0));\n};\nvar dateTZtoISO8601 = function (date, timeZone) {\n    // date format for sv-SE is almost ISO8601\n    var dateStr = date.toLocaleString('sv-SE', { timeZone: timeZone });\n    // '2023-02-07 10:41:36'\n    return dateStr.replace(' ', 'T') + 'Z';\n};\nexport var dateInTimeZone = function (date, timeZone) {\n    var localTimeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;\n    // Date constructor can only reliably parse dates in ISO8601 format\n    var dateInLocalTZ = new Date(dateTZtoISO8601(date, localTimeZone));\n    var dateInTargetTZ = new Date(dateTZtoISO8601(date, timeZone !== null && timeZone !== void 0 ? timeZone : 'UTC'));\n    var tzOffset = dateInTargetTZ.getTime() - dateInLocalTZ.getTime();\n    return new Date(date.getTime() - tzOffset);\n};\n//# sourceMappingURL=dateutil.js.map","/**\n * This class helps us to emulate python's generators, sorta.\n */\nvar IterResult = /** @class */ (function () {\n    function IterResult(method, args) {\n        this.minDate = null;\n        this.maxDate = null;\n        this._result = [];\n        this.total = 0;\n        this.method = method;\n        this.args = args;\n        if (method === 'between') {\n            this.maxDate = args.inc\n                ? args.before\n                : new Date(args.before.getTime() - 1);\n            this.minDate = args.inc ? args.after : new Date(args.after.getTime() + 1);\n        }\n        else if (method === 'before') {\n            this.maxDate = args.inc ? args.dt : new Date(args.dt.getTime() - 1);\n        }\n        else if (method === 'after') {\n            this.minDate = args.inc ? args.dt : new Date(args.dt.getTime() + 1);\n        }\n    }\n    /**\n     * Possibly adds a date into the result.\n     *\n     * @param {Date} date - the date isn't necessarly added to the result\n     * list (if it is too late/too early)\n     * @return {Boolean} true if it makes sense to continue the iteration\n     * false if we're done.\n     */\n    IterResult.prototype.accept = function (date) {\n        ++this.total;\n        var tooEarly = this.minDate && date < this.minDate;\n        var tooLate = this.maxDate && date > this.maxDate;\n        if (this.method === 'between') {\n            if (tooEarly)\n                return true;\n            if (tooLate)\n                return false;\n        }\n        else if (this.method === 'before') {\n            if (tooLate)\n                return false;\n        }\n        else if (this.method === 'after') {\n            if (tooEarly)\n                return true;\n            this.add(date);\n            return false;\n        }\n        return this.add(date);\n    };\n    /**\n     *\n     * @param {Date} date that is part of the result.\n     * @return {Boolean} whether we are interested in more values.\n     */\n    IterResult.prototype.add = function (date) {\n        this._result.push(date);\n        return true;\n    };\n    /**\n     * 'before' and 'after' return only one date, whereas 'all'\n     * and 'between' an array.\n     *\n     * @return {Date,Array?}\n     */\n    IterResult.prototype.getValue = function () {\n        var res = this._result;\n        switch (this.method) {\n            case 'all':\n            case 'between':\n                return res;\n            case 'before':\n            case 'after':\n            default:\n                return (res.length ? res[res.length - 1] : null);\n        }\n    };\n    IterResult.prototype.clone = function () {\n        return new IterResult(this.method, this.args);\n    };\n    return IterResult;\n}());\nexport default IterResult;\n//# sourceMappingURL=iterresult.js.map","import { __extends } from \"tslib\";\nimport IterResult from './iterresult';\n/**\n * IterResult subclass that calls a callback function on each add,\n * and stops iterating when the callback returns false.\n */\nvar CallbackIterResult = /** @class */ (function (_super) {\n    __extends(CallbackIterResult, _super);\n    function CallbackIterResult(method, args, iterator) {\n        var _this = _super.call(this, method, args) || this;\n        _this.iterator = iterator;\n        return _this;\n    }\n    CallbackIterResult.prototype.add = function (date) {\n        if (this.iterator(date, this._result.length)) {\n            this._result.push(date);\n            return true;\n        }\n        return false;\n    };\n    return CallbackIterResult;\n}(IterResult));\nexport default CallbackIterResult;\n//# sourceMappingURL=callbackiterresult.js.map","// =============================================================================\n// i18n\n// =============================================================================\nvar ENGLISH = {\n    dayNames: [\n        'Sunday',\n        'Monday',\n        'Tuesday',\n        'Wednesday',\n        'Thursday',\n        'Friday',\n        'Saturday',\n    ],\n    monthNames: [\n        'January',\n        'February',\n        'March',\n        'April',\n        'May',\n        'June',\n        'July',\n        'August',\n        'September',\n        'October',\n        'November',\n        'December',\n    ],\n    tokens: {\n        SKIP: /^[ \\r\\n\\t]+|^\\.$/,\n        number: /^[1-9][0-9]*/,\n        numberAsText: /^(one|two|three)/i,\n        every: /^every/i,\n        'day(s)': /^days?/i,\n        'weekday(s)': /^weekdays?/i,\n        'week(s)': /^weeks?/i,\n        'hour(s)': /^hours?/i,\n        'minute(s)': /^minutes?/i,\n        'month(s)': /^months?/i,\n        'year(s)': /^years?/i,\n        on: /^(on|in)/i,\n        at: /^(at)/i,\n        the: /^the/i,\n        first: /^first/i,\n        second: /^second/i,\n        third: /^third/i,\n        nth: /^([1-9][0-9]*)(\\.|th|nd|rd|st)/i,\n        last: /^last/i,\n        for: /^for/i,\n        'time(s)': /^times?/i,\n        until: /^(un)?til/i,\n        monday: /^mo(n(day)?)?/i,\n        tuesday: /^tu(e(s(day)?)?)?/i,\n        wednesday: /^we(d(n(esday)?)?)?/i,\n        thursday: /^th(u(r(sday)?)?)?/i,\n        friday: /^fr(i(day)?)?/i,\n        saturday: /^sa(t(urday)?)?/i,\n        sunday: /^su(n(day)?)?/i,\n        january: /^jan(uary)?/i,\n        february: /^feb(ruary)?/i,\n        march: /^mar(ch)?/i,\n        april: /^apr(il)?/i,\n        may: /^may/i,\n        june: /^june?/i,\n        july: /^july?/i,\n        august: /^aug(ust)?/i,\n        september: /^sep(t(ember)?)?/i,\n        october: /^oct(ober)?/i,\n        november: /^nov(ember)?/i,\n        december: /^dec(ember)?/i,\n        comma: /^(,\\s*|(and|or)\\s*)+/i,\n    },\n};\nexport default ENGLISH;\n//# sourceMappingURL=i18n.js.map","import ENGLISH from './i18n';\nimport { RRule } from '../rrule';\nimport { isArray, isNumber, isPresent } from '../helpers';\n// =============================================================================\n// Helper functions\n// =============================================================================\n/**\n * Return true if a value is in an array\n */\nvar contains = function (arr, val) {\n    return arr.indexOf(val) !== -1;\n};\nvar defaultGetText = function (id) { return id.toString(); };\nvar defaultDateFormatter = function (year, month, day) { return \"\".concat(month, \" \").concat(day, \", \").concat(year); };\n/**\n *\n * @param {RRule} rrule\n * Optional:\n * @param {Function} gettext function\n * @param {Object} language definition\n * @constructor\n */\nvar ToText = /** @class */ (function () {\n    function ToText(rrule, gettext, language, dateFormatter) {\n        if (gettext === void 0) { gettext = defaultGetText; }\n        if (language === void 0) { language = ENGLISH; }\n        if (dateFormatter === void 0) { dateFormatter = defaultDateFormatter; }\n        this.text = [];\n        this.language = language || ENGLISH;\n        this.gettext = gettext;\n        this.dateFormatter = dateFormatter;\n        this.rrule = rrule;\n        this.options = rrule.options;\n        this.origOptions = rrule.origOptions;\n        if (this.origOptions.bymonthday) {\n            var bymonthday = [].concat(this.options.bymonthday);\n            var bynmonthday = [].concat(this.options.bynmonthday);\n            bymonthday.sort(function (a, b) { return a - b; });\n            bynmonthday.sort(function (a, b) { return b - a; });\n            // 1, 2, 3, .., -5, -4, -3, ..\n            this.bymonthday = bymonthday.concat(bynmonthday);\n            if (!this.bymonthday.length)\n                this.bymonthday = null;\n        }\n        if (isPresent(this.origOptions.byweekday)) {\n            var byweekday = !isArray(this.origOptions.byweekday)\n                ? [this.origOptions.byweekday]\n                : this.origOptions.byweekday;\n            var days = String(byweekday);\n            this.byweekday = {\n                allWeeks: byweekday.filter(function (weekday) {\n                    return !weekday.n;\n                }),\n                someWeeks: byweekday.filter(function (weekday) {\n                    return Boolean(weekday.n);\n                }),\n                isWeekdays: days.indexOf('MO') !== -1 &&\n                    days.indexOf('TU') !== -1 &&\n                    days.indexOf('WE') !== -1 &&\n                    days.indexOf('TH') !== -1 &&\n                    days.indexOf('FR') !== -1 &&\n                    days.indexOf('SA') === -1 &&\n                    days.indexOf('SU') === -1,\n                isEveryDay: days.indexOf('MO') !== -1 &&\n                    days.indexOf('TU') !== -1 &&\n                    days.indexOf('WE') !== -1 &&\n                    days.indexOf('TH') !== -1 &&\n                    days.indexOf('FR') !== -1 &&\n                    days.indexOf('SA') !== -1 &&\n                    days.indexOf('SU') !== -1,\n            };\n            var sortWeekDays = function (a, b) {\n                return a.weekday - b.weekday;\n            };\n            this.byweekday.allWeeks.sort(sortWeekDays);\n            this.byweekday.someWeeks.sort(sortWeekDays);\n            if (!this.byweekday.allWeeks.length)\n                this.byweekday.allWeeks = null;\n            if (!this.byweekday.someWeeks.length)\n                this.byweekday.someWeeks = null;\n        }\n        else {\n            this.byweekday = null;\n        }\n    }\n    /**\n     * Test whether the rrule can be fully converted to text.\n     *\n     * @param {RRule} rrule\n     * @return {Boolean}\n     */\n    ToText.isFullyConvertible = function (rrule) {\n        var canConvert = true;\n        if (!(rrule.options.freq in ToText.IMPLEMENTED))\n            return false;\n        if (rrule.origOptions.until && rrule.origOptions.count)\n            return false;\n        for (var key in rrule.origOptions) {\n            if (contains(['dtstart', 'tzid', 'wkst', 'freq'], key))\n                return true;\n            if (!contains(ToText.IMPLEMENTED[rrule.options.freq], key))\n                return false;\n        }\n        return canConvert;\n    };\n    ToText.prototype.isFullyConvertible = function () {\n        return ToText.isFullyConvertible(this.rrule);\n    };\n    /**\n     * Perform the conversion. Only some of the frequencies are supported.\n     * If some of the rrule's options aren't supported, they'll\n     * be omitted from the output an \"(~ approximate)\" will be appended.\n     *\n     * @return {*}\n     */\n    ToText.prototype.toString = function () {\n        var gettext = this.gettext;\n        if (!(this.options.freq in ToText.IMPLEMENTED)) {\n            return gettext('RRule error: Unable to fully convert this rrule to text');\n        }\n        this.text = [gettext('every')];\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        this[RRule.FREQUENCIES[this.options.freq]]();\n        if (this.options.until) {\n            this.add(gettext('until'));\n            var until = this.options.until;\n            this.add(this.dateFormatter(until.getUTCFullYear(), this.language.monthNames[until.getUTCMonth()], until.getUTCDate()));\n        }\n        else if (this.options.count) {\n            this.add(gettext('for'))\n                .add(this.options.count.toString())\n                .add(this.plural(this.options.count) ? gettext('times') : gettext('time'));\n        }\n        if (!this.isFullyConvertible())\n            this.add(gettext('(~ approximate)'));\n        return this.text.join('');\n    };\n    ToText.prototype.HOURLY = function () {\n        var gettext = this.gettext;\n        if (this.options.interval !== 1)\n            this.add(this.options.interval.toString());\n        this.add(this.plural(this.options.interval) ? gettext('hours') : gettext('hour'));\n    };\n    ToText.prototype.MINUTELY = function () {\n        var gettext = this.gettext;\n        if (this.options.interval !== 1)\n            this.add(this.options.interval.toString());\n        this.add(this.plural(this.options.interval)\n            ? gettext('minutes')\n            : gettext('minute'));\n    };\n    ToText.prototype.DAILY = function () {\n        var gettext = this.gettext;\n        if (this.options.interval !== 1)\n            this.add(this.options.interval.toString());\n        if (this.byweekday && this.byweekday.isWeekdays) {\n            this.add(this.plural(this.options.interval)\n                ? gettext('weekdays')\n                : gettext('weekday'));\n        }\n        else {\n            this.add(this.plural(this.options.interval) ? gettext('days') : gettext('day'));\n        }\n        if (this.origOptions.bymonth) {\n            this.add(gettext('in'));\n            this._bymonth();\n        }\n        if (this.bymonthday) {\n            this._bymonthday();\n        }\n        else if (this.byweekday) {\n            this._byweekday();\n        }\n        else if (this.origOptions.byhour) {\n            this._byhour();\n        }\n    };\n    ToText.prototype.WEEKLY = function () {\n        var gettext = this.gettext;\n        if (this.options.interval !== 1) {\n            this.add(this.options.interval.toString()).add(this.plural(this.options.interval) ? gettext('weeks') : gettext('week'));\n        }\n        if (this.byweekday && this.byweekday.isWeekdays) {\n            if (this.options.interval === 1) {\n                this.add(this.plural(this.options.interval)\n                    ? gettext('weekdays')\n                    : gettext('weekday'));\n            }\n            else {\n                this.add(gettext('on')).add(gettext('weekdays'));\n            }\n        }\n        else if (this.byweekday && this.byweekday.isEveryDay) {\n            this.add(this.plural(this.options.interval) ? gettext('days') : gettext('day'));\n        }\n        else {\n            if (this.options.interval === 1)\n                this.add(gettext('week'));\n            if (this.origOptions.bymonth) {\n                this.add(gettext('in'));\n                this._bymonth();\n            }\n            if (this.bymonthday) {\n                this._bymonthday();\n            }\n            else if (this.byweekday) {\n                this._byweekday();\n            }\n            if (this.origOptions.byhour) {\n                this._byhour();\n            }\n        }\n    };\n    ToText.prototype.MONTHLY = function () {\n        var gettext = this.gettext;\n        if (this.origOptions.bymonth) {\n            if (this.options.interval !== 1) {\n                this.add(this.options.interval.toString()).add(gettext('months'));\n                if (this.plural(this.options.interval))\n                    this.add(gettext('in'));\n            }\n            else {\n                // this.add(gettext('MONTH'))\n            }\n            this._bymonth();\n        }\n        else {\n            if (this.options.interval !== 1) {\n                this.add(this.options.interval.toString());\n            }\n            this.add(this.plural(this.options.interval)\n                ? gettext('months')\n                : gettext('month'));\n        }\n        if (this.bymonthday) {\n            this._bymonthday();\n        }\n        else if (this.byweekday && this.byweekday.isWeekdays) {\n            this.add(gettext('on')).add(gettext('weekdays'));\n        }\n        else if (this.byweekday) {\n            this._byweekday();\n        }\n    };\n    ToText.prototype.YEARLY = function () {\n        var gettext = this.gettext;\n        if (this.origOptions.bymonth) {\n            if (this.options.interval !== 1) {\n                this.add(this.options.interval.toString());\n                this.add(gettext('years'));\n            }\n            else {\n                // this.add(gettext('YEAR'))\n            }\n            this._bymonth();\n        }\n        else {\n            if (this.options.interval !== 1) {\n                this.add(this.options.interval.toString());\n            }\n            this.add(this.plural(this.options.interval) ? gettext('years') : gettext('year'));\n        }\n        if (this.bymonthday) {\n            this._bymonthday();\n        }\n        else if (this.byweekday) {\n            this._byweekday();\n        }\n        if (this.options.byyearday) {\n            this.add(gettext('on the'))\n                .add(this.list(this.options.byyearday, this.nth, gettext('and')))\n                .add(gettext('day'));\n        }\n        if (this.options.byweekno) {\n            this.add(gettext('in'))\n                .add(this.plural(this.options.byweekno.length)\n                ? gettext('weeks')\n                : gettext('week'))\n                .add(this.list(this.options.byweekno, undefined, gettext('and')));\n        }\n    };\n    ToText.prototype._bymonthday = function () {\n        var gettext = this.gettext;\n        if (this.byweekday && this.byweekday.allWeeks) {\n            this.add(gettext('on'))\n                .add(this.list(this.byweekday.allWeeks, this.weekdaytext, gettext('or')))\n                .add(gettext('the'))\n                .add(this.list(this.bymonthday, this.nth, gettext('or')));\n        }\n        else {\n            this.add(gettext('on the')).add(this.list(this.bymonthday, this.nth, gettext('and')));\n        }\n        // this.add(gettext('DAY'))\n    };\n    ToText.prototype._byweekday = function () {\n        var gettext = this.gettext;\n        if (this.byweekday.allWeeks && !this.byweekday.isWeekdays) {\n            this.add(gettext('on')).add(this.list(this.byweekday.allWeeks, this.weekdaytext));\n        }\n        if (this.byweekday.someWeeks) {\n            if (this.byweekday.allWeeks)\n                this.add(gettext('and'));\n            this.add(gettext('on the')).add(this.list(this.byweekday.someWeeks, this.weekdaytext, gettext('and')));\n        }\n    };\n    ToText.prototype._byhour = function () {\n        var gettext = this.gettext;\n        this.add(gettext('at')).add(this.list(this.origOptions.byhour, undefined, gettext('and')));\n    };\n    ToText.prototype._bymonth = function () {\n        this.add(this.list(this.options.bymonth, this.monthtext, this.gettext('and')));\n    };\n    ToText.prototype.nth = function (n) {\n        n = parseInt(n.toString(), 10);\n        var nth;\n        var gettext = this.gettext;\n        if (n === -1)\n            return gettext('last');\n        var npos = Math.abs(n);\n        switch (npos) {\n            case 1:\n            case 21:\n            case 31:\n                nth = npos + gettext('st');\n                break;\n            case 2:\n            case 22:\n                nth = npos + gettext('nd');\n                break;\n            case 3:\n            case 23:\n                nth = npos + gettext('rd');\n                break;\n            default:\n                nth = npos + gettext('th');\n        }\n        return n < 0 ? nth + ' ' + gettext('last') : nth;\n    };\n    ToText.prototype.monthtext = function (m) {\n        return this.language.monthNames[m - 1];\n    };\n    ToText.prototype.weekdaytext = function (wday) {\n        var weekday = isNumber(wday) ? (wday + 1) % 7 : wday.getJsWeekday();\n        return ((wday.n ? this.nth(wday.n) + ' ' : '') +\n            this.language.dayNames[weekday]);\n    };\n    ToText.prototype.plural = function (n) {\n        return n % 100 !== 1;\n    };\n    ToText.prototype.add = function (s) {\n        this.text.push(' ');\n        this.text.push(s);\n        return this;\n    };\n    ToText.prototype.list = function (arr, callback, finalDelim, delim) {\n        var _this = this;\n        if (delim === void 0) { delim = ','; }\n        if (!isArray(arr)) {\n            arr = [arr];\n        }\n        var delimJoin = function (array, delimiter, finalDelimiter) {\n            var list = '';\n            for (var i = 0; i < array.length; i++) {\n                if (i !== 0) {\n                    if (i === array.length - 1) {\n                        list += ' ' + finalDelimiter + ' ';\n                    }\n                    else {\n                        list += delimiter + ' ';\n                    }\n                }\n                list += array[i];\n            }\n            return list;\n        };\n        callback =\n            callback ||\n                function (o) {\n                    return o.toString();\n                };\n        var realCallback = function (arg) {\n            return callback && callback.call(_this, arg);\n        };\n        if (finalDelim) {\n            return delimJoin(arr.map(realCallback), delim, finalDelim);\n        }\n        else {\n            return arr.map(realCallback).join(delim + ' ');\n        }\n    };\n    return ToText;\n}());\nexport default ToText;\n//# sourceMappingURL=totext.js.map","import ENGLISH from './i18n';\nimport { RRule } from '../rrule';\n// =============================================================================\n// Parser\n// =============================================================================\nvar Parser = /** @class */ (function () {\n    function Parser(rules) {\n        this.done = true;\n        this.rules = rules;\n    }\n    Parser.prototype.start = function (text) {\n        this.text = text;\n        this.done = false;\n        return this.nextSymbol();\n    };\n    Parser.prototype.isDone = function () {\n        return this.done && this.symbol === null;\n    };\n    Parser.prototype.nextSymbol = function () {\n        var best;\n        var bestSymbol;\n        this.symbol = null;\n        this.value = null;\n        do {\n            if (this.done)\n                return false;\n            var rule = void 0;\n            best = null;\n            for (var name_1 in this.rules) {\n                rule = this.rules[name_1];\n                var match = rule.exec(this.text);\n                if (match) {\n                    if (best === null || match[0].length > best[0].length) {\n                        best = match;\n                        bestSymbol = name_1;\n                    }\n                }\n            }\n            if (best != null) {\n                this.text = this.text.substr(best[0].length);\n                if (this.text === '')\n                    this.done = true;\n            }\n            if (best == null) {\n                this.done = true;\n                this.symbol = null;\n                this.value = null;\n                return;\n            }\n        } while (bestSymbol === 'SKIP');\n        this.symbol = bestSymbol;\n        this.value = best;\n        return true;\n    };\n    Parser.prototype.accept = function (name) {\n        if (this.symbol === name) {\n            if (this.value) {\n                var v = this.value;\n                this.nextSymbol();\n                return v;\n            }\n            this.nextSymbol();\n            return true;\n        }\n        return false;\n    };\n    Parser.prototype.acceptNumber = function () {\n        return this.accept('number');\n    };\n    Parser.prototype.expect = function (name) {\n        if (this.accept(name))\n            return true;\n        throw new Error('expected ' + name + ' but found ' + this.symbol);\n    };\n    return Parser;\n}());\nexport default function parseText(text, language) {\n    if (language === void 0) { language = ENGLISH; }\n    var options = {};\n    var ttr = new Parser(language.tokens);\n    if (!ttr.start(text))\n        return null;\n    S();\n    return options;\n    function S() {\n        // every [n]\n        ttr.expect('every');\n        var n = ttr.acceptNumber();\n        if (n)\n            options.interval = parseInt(n[0], 10);\n        if (ttr.isDone())\n            throw new Error('Unexpected end');\n        switch (ttr.symbol) {\n            case 'day(s)':\n                options.freq = RRule.DAILY;\n                if (ttr.nextSymbol()) {\n                    AT();\n                    F();\n                }\n                break;\n            // FIXME Note: every 2 weekdays != every two weeks on weekdays.\n            // DAILY on weekdays is not a valid rule\n            case 'weekday(s)':\n                options.freq = RRule.WEEKLY;\n                options.byweekday = [RRule.MO, RRule.TU, RRule.WE, RRule.TH, RRule.FR];\n                ttr.nextSymbol();\n                AT();\n                F();\n                break;\n            case 'week(s)':\n                options.freq = RRule.WEEKLY;\n                if (ttr.nextSymbol()) {\n                    ON();\n                    AT();\n                    F();\n                }\n                break;\n            case 'hour(s)':\n                options.freq = RRule.HOURLY;\n                if (ttr.nextSymbol()) {\n                    ON();\n                    F();\n                }\n                break;\n            case 'minute(s)':\n                options.freq = RRule.MINUTELY;\n                if (ttr.nextSymbol()) {\n                    ON();\n                    F();\n                }\n                break;\n            case 'month(s)':\n                options.freq = RRule.MONTHLY;\n                if (ttr.nextSymbol()) {\n                    ON();\n                    F();\n                }\n                break;\n            case 'year(s)':\n                options.freq = RRule.YEARLY;\n                if (ttr.nextSymbol()) {\n                    ON();\n                    F();\n                }\n                break;\n            case 'monday':\n            case 'tuesday':\n            case 'wednesday':\n            case 'thursday':\n            case 'friday':\n            case 'saturday':\n            case 'sunday':\n                options.freq = RRule.WEEKLY;\n                var key = ttr.symbol\n                    .substr(0, 2)\n                    .toUpperCase();\n                options.byweekday = [RRule[key]];\n                if (!ttr.nextSymbol())\n                    return;\n                // TODO check for duplicates\n                while (ttr.accept('comma')) {\n                    if (ttr.isDone())\n                        throw new Error('Unexpected end');\n                    var wkd = decodeWKD();\n                    if (!wkd) {\n                        throw new Error('Unexpected symbol ' + ttr.symbol + ', expected weekday');\n                    }\n                    options.byweekday.push(RRule[wkd]);\n                    ttr.nextSymbol();\n                }\n                AT();\n                MDAYs();\n                F();\n                break;\n            case 'january':\n            case 'february':\n            case 'march':\n            case 'april':\n            case 'may':\n            case 'june':\n            case 'july':\n            case 'august':\n            case 'september':\n            case 'october':\n            case 'november':\n            case 'december':\n                options.freq = RRule.YEARLY;\n                options.bymonth = [decodeM()];\n                if (!ttr.nextSymbol())\n                    return;\n                // TODO check for duplicates\n                while (ttr.accept('comma')) {\n                    if (ttr.isDone())\n                        throw new Error('Unexpected end');\n                    var m = decodeM();\n                    if (!m) {\n                        throw new Error('Unexpected symbol ' + ttr.symbol + ', expected month');\n                    }\n                    options.bymonth.push(m);\n                    ttr.nextSymbol();\n                }\n                ON();\n                F();\n                break;\n            default:\n                throw new Error('Unknown symbol');\n        }\n    }\n    function ON() {\n        var on = ttr.accept('on');\n        var the = ttr.accept('the');\n        if (!(on || the))\n            return;\n        do {\n            var nth = decodeNTH();\n            var wkd = decodeWKD();\n            var m = decodeM();\n            // nth <weekday> | <weekday>\n            if (nth) {\n                // ttr.nextSymbol()\n                if (wkd) {\n                    ttr.nextSymbol();\n                    if (!options.byweekday)\n                        options.byweekday = [];\n                    options.byweekday.push(RRule[wkd].nth(nth));\n                }\n                else {\n                    if (!options.bymonthday)\n                        options.bymonthday = [];\n                    options.bymonthday.push(nth);\n                    ttr.accept('day(s)');\n                }\n                // <weekday>\n            }\n            else if (wkd) {\n                ttr.nextSymbol();\n                if (!options.byweekday)\n                    options.byweekday = [];\n                options.byweekday.push(RRule[wkd]);\n            }\n            else if (ttr.symbol === 'weekday(s)') {\n                ttr.nextSymbol();\n                if (!options.byweekday) {\n                    options.byweekday = [RRule.MO, RRule.TU, RRule.WE, RRule.TH, RRule.FR];\n                }\n            }\n            else if (ttr.symbol === 'week(s)') {\n                ttr.nextSymbol();\n                var n = ttr.acceptNumber();\n                if (!n) {\n                    throw new Error('Unexpected symbol ' + ttr.symbol + ', expected week number');\n                }\n                options.byweekno = [parseInt(n[0], 10)];\n                while (ttr.accept('comma')) {\n                    n = ttr.acceptNumber();\n                    if (!n) {\n                        throw new Error('Unexpected symbol ' + ttr.symbol + '; expected monthday');\n                    }\n                    options.byweekno.push(parseInt(n[0], 10));\n                }\n            }\n            else if (m) {\n                ttr.nextSymbol();\n                if (!options.bymonth)\n                    options.bymonth = [];\n                options.bymonth.push(m);\n            }\n            else {\n                return;\n            }\n        } while (ttr.accept('comma') || ttr.accept('the') || ttr.accept('on'));\n    }\n    function AT() {\n        var at = ttr.accept('at');\n        if (!at)\n            return;\n        do {\n            var n = ttr.acceptNumber();\n            if (!n) {\n                throw new Error('Unexpected symbol ' + ttr.symbol + ', expected hour');\n            }\n            options.byhour = [parseInt(n[0], 10)];\n            while (ttr.accept('comma')) {\n                n = ttr.acceptNumber();\n                if (!n) {\n                    throw new Error('Unexpected symbol ' + ttr.symbol + '; expected hour');\n                }\n                options.byhour.push(parseInt(n[0], 10));\n            }\n        } while (ttr.accept('comma') || ttr.accept('at'));\n    }\n    function decodeM() {\n        switch (ttr.symbol) {\n            case 'january':\n                return 1;\n            case 'february':\n                return 2;\n            case 'march':\n                return 3;\n            case 'april':\n                return 4;\n            case 'may':\n                return 5;\n            case 'june':\n                return 6;\n            case 'july':\n                return 7;\n            case 'august':\n                return 8;\n            case 'september':\n                return 9;\n            case 'october':\n                return 10;\n            case 'november':\n                return 11;\n            case 'december':\n                return 12;\n            default:\n                return false;\n        }\n    }\n    function decodeWKD() {\n        switch (ttr.symbol) {\n            case 'monday':\n            case 'tuesday':\n            case 'wednesday':\n            case 'thursday':\n            case 'friday':\n            case 'saturday':\n            case 'sunday':\n                return ttr.symbol.substr(0, 2).toUpperCase();\n            default:\n                return false;\n        }\n    }\n    function decodeNTH() {\n        switch (ttr.symbol) {\n            case 'last':\n                ttr.nextSymbol();\n                return -1;\n            case 'first':\n                ttr.nextSymbol();\n                return 1;\n            case 'second':\n                ttr.nextSymbol();\n                return ttr.accept('last') ? -2 : 2;\n            case 'third':\n                ttr.nextSymbol();\n                return ttr.accept('last') ? -3 : 3;\n            case 'nth':\n                var v = parseInt(ttr.value[1], 10);\n                if (v < -366 || v > 366)\n                    throw new Error('Nth out of range: ' + v);\n                ttr.nextSymbol();\n                return ttr.accept('last') ? -v : v;\n            default:\n                return false;\n        }\n    }\n    function MDAYs() {\n        ttr.accept('on');\n        ttr.accept('the');\n        var nth = decodeNTH();\n        if (!nth)\n            return;\n        options.bymonthday = [nth];\n        ttr.nextSymbol();\n        while (ttr.accept('comma')) {\n            nth = decodeNTH();\n            if (!nth) {\n                throw new Error('Unexpected symbol ' + ttr.symbol + '; expected monthday');\n            }\n            options.bymonthday.push(nth);\n            ttr.nextSymbol();\n        }\n    }\n    function F() {\n        if (ttr.symbol === 'until') {\n            var date = Date.parse(ttr.text);\n            if (!date)\n                throw new Error('Cannot parse until date:' + ttr.text);\n            options.until = new Date(date);\n        }\n        else if (ttr.accept('for')) {\n            options.count = parseInt(ttr.value[0], 10);\n            ttr.expect('number');\n            // ttr.expect('times')\n        }\n    }\n}\n//# sourceMappingURL=parsetext.js.map","export var Frequency;\n(function (Frequency) {\n    Frequency[Frequency[\"YEARLY\"] = 0] = \"YEARLY\";\n    Frequency[Frequency[\"MONTHLY\"] = 1] = \"MONTHLY\";\n    Frequency[Frequency[\"WEEKLY\"] = 2] = \"WEEKLY\";\n    Frequency[Frequency[\"DAILY\"] = 3] = \"DAILY\";\n    Frequency[Frequency[\"HOURLY\"] = 4] = \"HOURLY\";\n    Frequency[Frequency[\"MINUTELY\"] = 5] = \"MINUTELY\";\n    Frequency[Frequency[\"SECONDLY\"] = 6] = \"SECONDLY\";\n})(Frequency || (Frequency = {}));\nexport function freqIsDailyOrGreater(freq) {\n    return freq < Frequency.HOURLY;\n}\n//# sourceMappingURL=types.js.map","import ToText from './totext';\nimport parseText from './parsetext';\nimport { RRule } from '../rrule';\nimport { Frequency } from '../types';\nimport ENGLISH from './i18n';\n/* !\n * rrule.js - Library for working with recurrence rules for calendar dates.\n * https://github.com/jakubroztocil/rrule\n *\n * Copyright 2010, Jakub Roztocil and Lars Schoning\n * Licenced under the BSD licence.\n * https://github.com/jakubroztocil/rrule/blob/master/LICENCE\n *\n */\n/**\n *\n * Implementation of RRule.fromText() and RRule::toText().\n *\n *\n * On the client side, this file needs to be included\n * when those functions are used.\n *\n */\n// =============================================================================\n// fromText\n// =============================================================================\n/**\n * Will be able to convert some of the below described rules from\n * text format to a rule object.\n *\n *\n * RULES\n *\n * Every ([n])\n * day(s)\n * | [weekday], ..., (and) [weekday]\n * | weekday(s)\n * | week(s)\n * | month(s)\n * | [month], ..., (and) [month]\n * | year(s)\n *\n *\n * Plus 0, 1, or multiple of these:\n *\n * on [weekday], ..., (or) [weekday] the [monthday], [monthday], ... (or) [monthday]\n *\n * on [weekday], ..., (and) [weekday]\n *\n * on the [monthday], [monthday], ... (and) [monthday] (day of the month)\n *\n * on the [nth-weekday], ..., (and) [nth-weekday] (of the month/year)\n *\n *\n * Plus 0 or 1 of these:\n *\n * for [n] time(s)\n *\n * until [date]\n *\n * Plus (.)\n *\n *\n * Definitely no supported for parsing:\n *\n * (for year):\n * in week(s) [n], ..., (and) [n]\n *\n * on the [yearday], ..., (and) [n] day of the year\n * on day [yearday], ..., (and) [n]\n *\n *\n * NON-TERMINALS\n *\n * [n]: 1, 2 ..., one, two, three ..\n * [month]: January, February, March, April, May, ... December\n * [weekday]: Monday, ... Sunday\n * [nth-weekday]: first [weekday], 2nd [weekday], ... last [weekday], ...\n * [monthday]: first, 1., 2., 1st, 2nd, second, ... 31st, last day, 2nd last day, ..\n * [date]:\n * - [month] (0-31(,) ([year])),\n * - (the) 0-31.(1-12.([year])),\n * - (the) 0-31/(1-12/([year])),\n * - [weekday]\n *\n * [year]: 0000, 0001, ... 01, 02, ..\n *\n * Definitely not supported for parsing:\n *\n * [yearday]: first, 1., 2., 1st, 2nd, second, ... 366th, last day, 2nd last day, ..\n *\n * @param {String} text\n * @return {Object, Boolean} the rule, or null.\n */\nvar fromText = function (text, language) {\n    if (language === void 0) { language = ENGLISH; }\n    return new RRule(parseText(text, language) || undefined);\n};\nvar common = [\n    'count',\n    'until',\n    'interval',\n    'byweekday',\n    'bymonthday',\n    'bymonth',\n];\nToText.IMPLEMENTED = [];\nToText.IMPLEMENTED[Frequency.HOURLY] = common;\nToText.IMPLEMENTED[Frequency.MINUTELY] = common;\nToText.IMPLEMENTED[Frequency.DAILY] = ['byhour'].concat(common);\nToText.IMPLEMENTED[Frequency.WEEKLY] = common;\nToText.IMPLEMENTED[Frequency.MONTHLY] = common;\nToText.IMPLEMENTED[Frequency.YEARLY] = ['byweekno', 'byyearday'].concat(common);\n// =============================================================================\n// Export\n// =============================================================================\nvar toText = function (rrule, gettext, language, dateFormatter) {\n    return new ToText(rrule, gettext, language, dateFormatter).toString();\n};\nvar isFullyConvertible = ToText.isFullyConvertible;\nexport { fromText, parseText, isFullyConvertible, toText };\n//# sourceMappingURL=index.js.map","import { __extends } from \"tslib\";\nimport { Frequency } from './types';\nimport { pymod, divmod, empty, includes } from './helpers';\nimport { getWeekday, MAXYEAR, monthRange } from './dateutil';\nvar Time = /** @class */ (function () {\n    function Time(hour, minute, second, millisecond) {\n        this.hour = hour;\n        this.minute = minute;\n        this.second = second;\n        this.millisecond = millisecond || 0;\n    }\n    Time.prototype.getHours = function () {\n        return this.hour;\n    };\n    Time.prototype.getMinutes = function () {\n        return this.minute;\n    };\n    Time.prototype.getSeconds = function () {\n        return this.second;\n    };\n    Time.prototype.getMilliseconds = function () {\n        return this.millisecond;\n    };\n    Time.prototype.getTime = function () {\n        return ((this.hour * 60 * 60 + this.minute * 60 + this.second) * 1000 +\n            this.millisecond);\n    };\n    return Time;\n}());\nexport { Time };\nvar DateTime = /** @class */ (function (_super) {\n    __extends(DateTime, _super);\n    function DateTime(year, month, day, hour, minute, second, millisecond) {\n        var _this = _super.call(this, hour, minute, second, millisecond) || this;\n        _this.year = year;\n        _this.month = month;\n        _this.day = day;\n        return _this;\n    }\n    DateTime.fromDate = function (date) {\n        return new this(date.getUTCFullYear(), date.getUTCMonth() + 1, date.getUTCDate(), date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds(), date.valueOf() % 1000);\n    };\n    DateTime.prototype.getWeekday = function () {\n        return getWeekday(new Date(this.getTime()));\n    };\n    DateTime.prototype.getTime = function () {\n        return new Date(Date.UTC(this.year, this.month - 1, this.day, this.hour, this.minute, this.second, this.millisecond)).getTime();\n    };\n    DateTime.prototype.getDay = function () {\n        return this.day;\n    };\n    DateTime.prototype.getMonth = function () {\n        return this.month;\n    };\n    DateTime.prototype.getYear = function () {\n        return this.year;\n    };\n    DateTime.prototype.addYears = function (years) {\n        this.year += years;\n    };\n    DateTime.prototype.addMonths = function (months) {\n        this.month += months;\n        if (this.month > 12) {\n            var yearDiv = Math.floor(this.month / 12);\n            var monthMod = pymod(this.month, 12);\n            this.month = monthMod;\n            this.year += yearDiv;\n            if (this.month === 0) {\n                this.month = 12;\n                --this.year;\n            }\n        }\n    };\n    DateTime.prototype.addWeekly = function (days, wkst) {\n        if (wkst > this.getWeekday()) {\n            this.day += -(this.getWeekday() + 1 + (6 - wkst)) + days * 7;\n        }\n        else {\n            this.day += -(this.getWeekday() - wkst) + days * 7;\n        }\n        this.fixDay();\n    };\n    DateTime.prototype.addDaily = function (days) {\n        this.day += days;\n        this.fixDay();\n    };\n    DateTime.prototype.addHours = function (hours, filtered, byhour) {\n        if (filtered) {\n            // Jump to one iteration before next day\n            this.hour += Math.floor((23 - this.hour) / hours) * hours;\n        }\n        for (;;) {\n            this.hour += hours;\n            var _a = divmod(this.hour, 24), dayDiv = _a.div, hourMod = _a.mod;\n            if (dayDiv) {\n                this.hour = hourMod;\n                this.addDaily(dayDiv);\n            }\n            if (empty(byhour) || includes(byhour, this.hour))\n                break;\n        }\n    };\n    DateTime.prototype.addMinutes = function (minutes, filtered, byhour, byminute) {\n        if (filtered) {\n            // Jump to one iteration before next day\n            this.minute +=\n                Math.floor((1439 - (this.hour * 60 + this.minute)) / minutes) * minutes;\n        }\n        for (;;) {\n            this.minute += minutes;\n            var _a = divmod(this.minute, 60), hourDiv = _a.div, minuteMod = _a.mod;\n            if (hourDiv) {\n                this.minute = minuteMod;\n                this.addHours(hourDiv, false, byhour);\n            }\n            if ((empty(byhour) || includes(byhour, this.hour)) &&\n                (empty(byminute) || includes(byminute, this.minute))) {\n                break;\n            }\n        }\n    };\n    DateTime.prototype.addSeconds = function (seconds, filtered, byhour, byminute, bysecond) {\n        if (filtered) {\n            // Jump to one iteration before next day\n            this.second +=\n                Math.floor((86399 - (this.hour * 3600 + this.minute * 60 + this.second)) /\n                    seconds) * seconds;\n        }\n        for (;;) {\n            this.second += seconds;\n            var _a = divmod(this.second, 60), minuteDiv = _a.div, secondMod = _a.mod;\n            if (minuteDiv) {\n                this.second = secondMod;\n                this.addMinutes(minuteDiv, false, byhour, byminute);\n            }\n            if ((empty(byhour) || includes(byhour, this.hour)) &&\n                (empty(byminute) || includes(byminute, this.minute)) &&\n                (empty(bysecond) || includes(bysecond, this.second))) {\n                break;\n            }\n        }\n    };\n    DateTime.prototype.fixDay = function () {\n        if (this.day <= 28) {\n            return;\n        }\n        var daysinmonth = monthRange(this.year, this.month - 1)[1];\n        if (this.day <= daysinmonth) {\n            return;\n        }\n        while (this.day > daysinmonth) {\n            this.day -= daysinmonth;\n            ++this.month;\n            if (this.month === 13) {\n                this.month = 1;\n                ++this.year;\n                if (this.year > MAXYEAR) {\n                    return;\n                }\n            }\n            daysinmonth = monthRange(this.year, this.month - 1)[1];\n        }\n    };\n    DateTime.prototype.add = function (options, filtered) {\n        var freq = options.freq, interval = options.interval, wkst = options.wkst, byhour = options.byhour, byminute = options.byminute, bysecond = options.bysecond;\n        switch (freq) {\n            case Frequency.YEARLY:\n                return this.addYears(interval);\n            case Frequency.MONTHLY:\n                return this.addMonths(interval);\n            case Frequency.WEEKLY:\n                return this.addWeekly(interval, wkst);\n            case Frequency.DAILY:\n                return this.addDaily(interval);\n            case Frequency.HOURLY:\n                return this.addHours(interval, filtered, byhour);\n            case Frequency.MINUTELY:\n                return this.addMinutes(interval, filtered, byhour, byminute);\n            case Frequency.SECONDLY:\n                return this.addSeconds(interval, filtered, byhour, byminute, bysecond);\n        }\n    };\n    return DateTime;\n}(Time));\nexport { DateTime };\n//# sourceMappingURL=datetime.js.map","import { __assign } from \"tslib\";\nimport { freqIsDailyOrGreater } from './types';\nimport { includes, notEmpty, isPresent, isNumber, isArray, isWeekdayStr, } from './helpers';\nimport { RRule, defaultKeys, DEFAULT_OPTIONS } from './rrule';\nimport { getWeekday, isDate, isValidDate } from './dateutil';\nimport { Weekday } from './weekday';\nimport { Time } from './datetime';\nexport function initializeOptions(options) {\n    var invalid = [];\n    var keys = Object.keys(options);\n    // Shallow copy for options and origOptions and check for invalid\n    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n        var key = keys_1[_i];\n        if (!includes(defaultKeys, key))\n            invalid.push(key);\n        if (isDate(options[key]) && !isValidDate(options[key])) {\n            invalid.push(key);\n        }\n    }\n    if (invalid.length) {\n        throw new Error('Invalid options: ' + invalid.join(', '));\n    }\n    return __assign({}, options);\n}\nexport function parseOptions(options) {\n    var opts = __assign(__assign({}, DEFAULT_OPTIONS), initializeOptions(options));\n    if (isPresent(opts.byeaster))\n        opts.freq = RRule.YEARLY;\n    if (!(isPresent(opts.freq) && RRule.FREQUENCIES[opts.freq])) {\n        throw new Error(\"Invalid frequency: \".concat(opts.freq, \" \").concat(options.freq));\n    }\n    if (!opts.dtstart)\n        opts.dtstart = new Date(new Date().setMilliseconds(0));\n    if (!isPresent(opts.wkst)) {\n        opts.wkst = RRule.MO.weekday;\n    }\n    else if (isNumber(opts.wkst)) {\n        // cool, just keep it like that\n    }\n    else {\n        opts.wkst = opts.wkst.weekday;\n    }\n    if (isPresent(opts.bysetpos)) {\n        if (isNumber(opts.bysetpos))\n            opts.bysetpos = [opts.bysetpos];\n        for (var i = 0; i < opts.bysetpos.length; i++) {\n            var v = opts.bysetpos[i];\n            if (v === 0 || !(v >= -366 && v <= 366)) {\n                throw new Error('bysetpos must be between 1 and 366,' + ' or between -366 and -1');\n            }\n        }\n    }\n    if (!(Boolean(opts.byweekno) ||\n        notEmpty(opts.byweekno) ||\n        notEmpty(opts.byyearday) ||\n        Boolean(opts.bymonthday) ||\n        notEmpty(opts.bymonthday) ||\n        isPresent(opts.byweekday) ||\n        isPresent(opts.byeaster))) {\n        switch (opts.freq) {\n            case RRule.YEARLY:\n                if (!opts.bymonth)\n                    opts.bymonth = opts.dtstart.getUTCMonth() + 1;\n                opts.bymonthday = opts.dtstart.getUTCDate();\n                break;\n            case RRule.MONTHLY:\n                opts.bymonthday = opts.dtstart.getUTCDate();\n                break;\n            case RRule.WEEKLY:\n                opts.byweekday = [getWeekday(opts.dtstart)];\n                break;\n        }\n    }\n    // bymonth\n    if (isPresent(opts.bymonth) && !isArray(opts.bymonth)) {\n        opts.bymonth = [opts.bymonth];\n    }\n    // byyearday\n    if (isPresent(opts.byyearday) &&\n        !isArray(opts.byyearday) &&\n        isNumber(opts.byyearday)) {\n        opts.byyearday = [opts.byyearday];\n    }\n    // bymonthday\n    if (!isPresent(opts.bymonthday)) {\n        opts.bymonthday = [];\n        opts.bynmonthday = [];\n    }\n    else if (isArray(opts.bymonthday)) {\n        var bymonthday = [];\n        var bynmonthday = [];\n        for (var i = 0; i < opts.bymonthday.length; i++) {\n            var v = opts.bymonthday[i];\n            if (v > 0) {\n                bymonthday.push(v);\n            }\n            else if (v < 0) {\n                bynmonthday.push(v);\n            }\n        }\n        opts.bymonthday = bymonthday;\n        opts.bynmonthday = bynmonthday;\n    }\n    else if (opts.bymonthday < 0) {\n        opts.bynmonthday = [opts.bymonthday];\n        opts.bymonthday = [];\n    }\n    else {\n        opts.bynmonthday = [];\n        opts.bymonthday = [opts.bymonthday];\n    }\n    // byweekno\n    if (isPresent(opts.byweekno) && !isArray(opts.byweekno)) {\n        opts.byweekno = [opts.byweekno];\n    }\n    // byweekday / bynweekday\n    if (!isPresent(opts.byweekday)) {\n        opts.bynweekday = null;\n    }\n    else if (isNumber(opts.byweekday)) {\n        opts.byweekday = [opts.byweekday];\n        opts.bynweekday = null;\n    }\n    else if (isWeekdayStr(opts.byweekday)) {\n        opts.byweekday = [Weekday.fromStr(opts.byweekday).weekday];\n        opts.bynweekday = null;\n    }\n    else if (opts.byweekday instanceof Weekday) {\n        if (!opts.byweekday.n || opts.freq > RRule.MONTHLY) {\n            opts.byweekday = [opts.byweekday.weekday];\n            opts.bynweekday = null;\n        }\n        else {\n            opts.bynweekday = [[opts.byweekday.weekday, opts.byweekday.n]];\n            opts.byweekday = null;\n        }\n    }\n    else {\n        var byweekday = [];\n        var bynweekday = [];\n        for (var i = 0; i < opts.byweekday.length; i++) {\n            var wday = opts.byweekday[i];\n            if (isNumber(wday)) {\n                byweekday.push(wday);\n                continue;\n            }\n            else if (isWeekdayStr(wday)) {\n                byweekday.push(Weekday.fromStr(wday).weekday);\n                continue;\n            }\n            if (!wday.n || opts.freq > RRule.MONTHLY) {\n                byweekday.push(wday.weekday);\n            }\n            else {\n                bynweekday.push([wday.weekday, wday.n]);\n            }\n        }\n        opts.byweekday = notEmpty(byweekday) ? byweekday : null;\n        opts.bynweekday = notEmpty(bynweekday) ? bynweekday : null;\n    }\n    // byhour\n    if (!isPresent(opts.byhour)) {\n        opts.byhour = opts.freq < RRule.HOURLY ? [opts.dtstart.getUTCHours()] : null;\n    }\n    else if (isNumber(opts.byhour)) {\n        opts.byhour = [opts.byhour];\n    }\n    // byminute\n    if (!isPresent(opts.byminute)) {\n        opts.byminute =\n            opts.freq < RRule.MINUTELY ? [opts.dtstart.getUTCMinutes()] : null;\n    }\n    else if (isNumber(opts.byminute)) {\n        opts.byminute = [opts.byminute];\n    }\n    // bysecond\n    if (!isPresent(opts.bysecond)) {\n        opts.bysecond =\n            opts.freq < RRule.SECONDLY ? [opts.dtstart.getUTCSeconds()] : null;\n    }\n    else if (isNumber(opts.bysecond)) {\n        opts.bysecond = [opts.bysecond];\n    }\n    return { parsedOptions: opts };\n}\nexport function buildTimeset(opts) {\n    var millisecondModulo = opts.dtstart.getTime() % 1000;\n    if (!freqIsDailyOrGreater(opts.freq)) {\n        return [];\n    }\n    var timeset = [];\n    opts.byhour.forEach(function (hour) {\n        opts.byminute.forEach(function (minute) {\n            opts.bysecond.forEach(function (second) {\n                timeset.push(new Time(hour, minute, second, millisecondModulo));\n            });\n        });\n    });\n    return timeset;\n}\n//# sourceMappingURL=parseoptions.js.map","import { __assign } from \"tslib\";\nimport { Frequency } from './types';\nimport { Weekday } from './weekday';\nimport { untilStringToDate } from './dateutil';\nimport { Days } from './rrule';\nexport function parseString(rfcString) {\n    var options = rfcString\n        .split('\\n')\n        .map(parseLine)\n        .filter(function (x) { return x !== null; });\n    return __assign(__assign({}, options[0]), options[1]);\n}\nexport function parseDtstart(line) {\n    var options = {};\n    var dtstartWithZone = /DTSTART(?:;TZID=([^:=]+?))?(?::|=)([^;\\s]+)/i.exec(line);\n    if (!dtstartWithZone) {\n        return options;\n    }\n    var tzid = dtstartWithZone[1], dtstart = dtstartWithZone[2];\n    if (tzid) {\n        options.tzid = tzid;\n    }\n    options.dtstart = untilStringToDate(dtstart);\n    return options;\n}\nfunction parseLine(rfcString) {\n    rfcString = rfcString.replace(/^\\s+|\\s+$/, '');\n    if (!rfcString.length)\n        return null;\n    var header = /^([A-Z]+?)[:;]/.exec(rfcString.toUpperCase());\n    if (!header) {\n        return parseRrule(rfcString);\n    }\n    var key = header[1];\n    switch (key.toUpperCase()) {\n        case 'RRULE':\n        case 'EXRULE':\n            return parseRrule(rfcString);\n        case 'DTSTART':\n            return parseDtstart(rfcString);\n        default:\n            throw new Error(\"Unsupported RFC prop \".concat(key, \" in \").concat(rfcString));\n    }\n}\nfunction parseRrule(line) {\n    var strippedLine = line.replace(/^RRULE:/i, '');\n    var options = parseDtstart(strippedLine);\n    var attrs = line.replace(/^(?:RRULE|EXRULE):/i, '').split(';');\n    attrs.forEach(function (attr) {\n        var _a = attr.split('='), key = _a[0], value = _a[1];\n        switch (key.toUpperCase()) {\n            case 'FREQ':\n                options.freq = Frequency[value.toUpperCase()];\n                break;\n            case 'WKST':\n                options.wkst = Days[value.toUpperCase()];\n                break;\n            case 'COUNT':\n            case 'INTERVAL':\n            case 'BYSETPOS':\n            case 'BYMONTH':\n            case 'BYMONTHDAY':\n            case 'BYYEARDAY':\n            case 'BYWEEKNO':\n            case 'BYHOUR':\n            case 'BYMINUTE':\n            case 'BYSECOND':\n                var num = parseNumber(value);\n                var optionKey = key.toLowerCase();\n                // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n                // @ts-ignore\n                options[optionKey] = num;\n                break;\n            case 'BYWEEKDAY':\n            case 'BYDAY':\n                options.byweekday = parseWeekday(value);\n                break;\n            case 'DTSTART':\n            case 'TZID':\n                // for backwards compatibility\n                var dtstart = parseDtstart(line);\n                options.tzid = dtstart.tzid;\n                options.dtstart = dtstart.dtstart;\n                break;\n            case 'UNTIL':\n                options.until = untilStringToDate(value);\n                break;\n            case 'BYEASTER':\n                options.byeaster = Number(value);\n                break;\n            default:\n                throw new Error(\"Unknown RRULE property '\" + key + \"'\");\n        }\n    });\n    return options;\n}\nfunction parseNumber(value) {\n    if (value.indexOf(',') !== -1) {\n        var values = value.split(',');\n        return values.map(parseIndividualNumber);\n    }\n    return parseIndividualNumber(value);\n}\nfunction parseIndividualNumber(value) {\n    if (/^[+-]?\\d+$/.test(value)) {\n        return Number(value);\n    }\n    return value;\n}\nfunction parseWeekday(value) {\n    var days = value.split(',');\n    return days.map(function (day) {\n        if (day.length === 2) {\n            // MO, TU, ...\n            return Days[day]; // wday instanceof Weekday\n        }\n        // -1MO, +3FR, 1SO, 13TU ...\n        var parts = day.match(/^([+-]?\\d{1,2})([A-Z]{2})$/);\n        if (!parts || parts.length < 3) {\n            throw new SyntaxError(\"Invalid weekday string: \".concat(day));\n        }\n        var n = Number(parts[1]);\n        var wdaypart = parts[2];\n        var wday = Days[wdaypart].weekday;\n        return new Weekday(wday, n);\n    });\n}\n//# sourceMappingURL=parsestring.js.map","import { dateInTimeZone, timeToUntilString } from './dateutil';\nvar DateWithZone = /** @class */ (function () {\n    function DateWithZone(date, tzid) {\n        if (isNaN(date.getTime())) {\n            throw new RangeError('Invalid date passed to DateWithZone');\n        }\n        this.date = date;\n        this.tzid = tzid;\n    }\n    Object.defineProperty(DateWithZone.prototype, \"isUTC\", {\n        get: function () {\n            return !this.tzid || this.tzid.toUpperCase() === 'UTC';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    DateWithZone.prototype.toString = function () {\n        var datestr = timeToUntilString(this.date.getTime(), this.isUTC);\n        if (!this.isUTC) {\n            return \";TZID=\".concat(this.tzid, \":\").concat(datestr);\n        }\n        return \":\".concat(datestr);\n    };\n    DateWithZone.prototype.getTime = function () {\n        return this.date.getTime();\n    };\n    DateWithZone.prototype.rezonedDate = function () {\n        if (this.isUTC) {\n            return this.date;\n        }\n        return dateInTimeZone(this.date, this.tzid);\n    };\n    return DateWithZone;\n}());\nexport { DateWithZone };\n//# sourceMappingURL=datewithzone.js.map","import { RRule, DEFAULT_OPTIONS } from './rrule';\nimport { includes, isPresent, isArray, isNumber, toArray } from './helpers';\nimport { Weekday } from './weekday';\nimport { timeToUntilString } from './dateutil';\nimport { DateWithZone } from './datewithzone';\nexport function optionsToString(options) {\n    var rrule = [];\n    var dtstart = '';\n    var keys = Object.keys(options);\n    var defaultKeys = Object.keys(DEFAULT_OPTIONS);\n    for (var i = 0; i < keys.length; i++) {\n        if (keys[i] === 'tzid')\n            continue;\n        if (!includes(defaultKeys, keys[i]))\n            continue;\n        var key = keys[i].toUpperCase();\n        var value = options[keys[i]];\n        var outValue = '';\n        if (!isPresent(value) || (isArray(value) && !value.length))\n            continue;\n        switch (key) {\n            case 'FREQ':\n                outValue = RRule.FREQUENCIES[options.freq];\n                break;\n            case 'WKST':\n                if (isNumber(value)) {\n                    outValue = new Weekday(value).toString();\n                }\n                else {\n                    outValue = value.toString();\n                }\n                break;\n            case 'BYWEEKDAY':\n                /*\n                  NOTE: BYWEEKDAY is a special case.\n                  RRule() deconstructs the rule.options.byweekday array\n                  into an array of Weekday arguments.\n                  On the other hand, rule.origOptions is an array of Weekdays.\n                  We need to handle both cases here.\n                  It might be worth change RRule to keep the Weekdays.\n        \n                  Also, BYWEEKDAY (used by RRule) vs. BYDAY (RFC)\n        \n                  */\n                key = 'BYDAY';\n                outValue = toArray(value)\n                    .map(function (wday) {\n                    if (wday instanceof Weekday) {\n                        return wday;\n                    }\n                    if (isArray(wday)) {\n                        return new Weekday(wday[0], wday[1]);\n                    }\n                    return new Weekday(wday);\n                })\n                    .toString();\n                break;\n            case 'DTSTART':\n                dtstart = buildDtstart(value, options.tzid);\n                break;\n            case 'UNTIL':\n                outValue = timeToUntilString(value, !options.tzid);\n                break;\n            default:\n                if (isArray(value)) {\n                    var strValues = [];\n                    for (var j = 0; j < value.length; j++) {\n                        strValues[j] = String(value[j]);\n                    }\n                    outValue = strValues.toString();\n                }\n                else {\n                    outValue = String(value);\n                }\n        }\n        if (outValue) {\n            rrule.push([key, outValue]);\n        }\n    }\n    var rules = rrule\n        .map(function (_a) {\n        var key = _a[0], value = _a[1];\n        return \"\".concat(key, \"=\").concat(value.toString());\n    })\n        .join(';');\n    var ruleString = '';\n    if (rules !== '') {\n        ruleString = \"RRULE:\".concat(rules);\n    }\n    return [dtstart, ruleString].filter(function (x) { return !!x; }).join('\\n');\n}\nfunction buildDtstart(dtstart, tzid) {\n    if (!dtstart) {\n        return '';\n    }\n    return 'DTSTART' + new DateWithZone(new Date(dtstart), tzid).toString();\n}\n//# sourceMappingURL=optionstostring.js.map","import IterResult from './iterresult';\nimport { clone, cloneDates } from './dateutil';\nimport { isArray } from './helpers';\nfunction argsMatch(left, right) {\n    if (Array.isArray(left)) {\n        if (!Array.isArray(right))\n            return false;\n        if (left.length !== right.length)\n            return false;\n        return left.every(function (date, i) { return date.getTime() === right[i].getTime(); });\n    }\n    if (left instanceof Date) {\n        return right instanceof Date && left.getTime() === right.getTime();\n    }\n    return left === right;\n}\nvar Cache = /** @class */ (function () {\n    function Cache() {\n        this.all = false;\n        this.before = [];\n        this.after = [];\n        this.between = [];\n    }\n    /**\n     * @param {String} what - all/before/after/between\n     * @param {Array,Date} value - an array of dates, one date, or null\n     * @param {Object?} args - _iter arguments\n     */\n    Cache.prototype._cacheAdd = function (what, value, args) {\n        if (value) {\n            value = value instanceof Date ? clone(value) : cloneDates(value);\n        }\n        if (what === 'all') {\n            this.all = value;\n        }\n        else {\n            args._value = value;\n            this[what].push(args);\n        }\n    };\n    /**\n     * @return false - not in the cache\n     * @return null  - cached, but zero occurrences (before/after)\n     * @return Date  - cached (before/after)\n     * @return []    - cached, but zero occurrences (all/between)\n     * @return [Date1, DateN] - cached (all/between)\n     */\n    Cache.prototype._cacheGet = function (what, args) {\n        var cached = false;\n        var argsKeys = args ? Object.keys(args) : [];\n        var findCacheDiff = function (item) {\n            for (var i = 0; i < argsKeys.length; i++) {\n                var key = argsKeys[i];\n                if (!argsMatch(args[key], item[key])) {\n                    return true;\n                }\n            }\n            return false;\n        };\n        var cachedObject = this[what];\n        if (what === 'all') {\n            cached = this.all;\n        }\n        else if (isArray(cachedObject)) {\n            // Let's see whether we've already called the\n            // 'what' method with the same 'args'\n            for (var i = 0; i < cachedObject.length; i++) {\n                var item = cachedObject[i];\n                if (argsKeys.length && findCacheDiff(item))\n                    continue;\n                cached = item._value;\n                break;\n            }\n        }\n        if (!cached && this.all) {\n            // Not in the cache, but we already know all the occurrences,\n            // so we can find the correct dates from the cached ones.\n            var iterResult = new IterResult(what, args);\n            for (var i = 0; i < this.all.length; i++) {\n                if (!iterResult.accept(this.all[i]))\n                    break;\n            }\n            cached = iterResult.getValue();\n            this._cacheAdd(what, cached, args);\n        }\n        return isArray(cached)\n            ? cloneDates(cached)\n            : cached instanceof Date\n                ? clone(cached)\n                : cached;\n    };\n    return Cache;\n}());\nexport { Cache };\n//# sourceMappingURL=cache.js.map","import { __spreadArray } from \"tslib\";\nimport { range, repeat } from './helpers';\n// =============================================================================\n// Date masks\n// =============================================================================\n// Every mask is 7 days longer to handle cross-year weekly periods.\nvar M365MASK = __spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([], repeat(1, 31), true), repeat(2, 28), true), repeat(3, 31), true), repeat(4, 30), true), repeat(5, 31), true), repeat(6, 30), true), repeat(7, 31), true), repeat(8, 31), true), repeat(9, 30), true), repeat(10, 31), true), repeat(11, 30), true), repeat(12, 31), true), repeat(1, 7), true);\nvar M366MASK = __spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([], repeat(1, 31), true), repeat(2, 29), true), repeat(3, 31), true), repeat(4, 30), true), repeat(5, 31), true), repeat(6, 30), true), repeat(7, 31), true), repeat(8, 31), true), repeat(9, 30), true), repeat(10, 31), true), repeat(11, 30), true), repeat(12, 31), true), repeat(1, 7), true);\nvar M28 = range(1, 29);\nvar M29 = range(1, 30);\nvar M30 = range(1, 31);\nvar M31 = range(1, 32);\nvar MDAY366MASK = __spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([], M31, true), M29, true), M31, true), M30, true), M31, true), M30, true), M31, true), M31, true), M30, true), M31, true), M30, true), M31, true), M31.slice(0, 7), true);\nvar MDAY365MASK = __spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([], M31, true), M28, true), M31, true), M30, true), M31, true), M30, true), M31, true), M31, true), M30, true), M31, true), M30, true), M31, true), M31.slice(0, 7), true);\nvar NM28 = range(-28, 0);\nvar NM29 = range(-29, 0);\nvar NM30 = range(-30, 0);\nvar NM31 = range(-31, 0);\nvar NMDAY366MASK = __spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([], NM31, true), NM29, true), NM31, true), NM30, true), NM31, true), NM30, true), NM31, true), NM31, true), NM30, true), NM31, true), NM30, true), NM31, true), NM31.slice(0, 7), true);\nvar NMDAY365MASK = __spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([], NM31, true), NM28, true), NM31, true), NM30, true), NM31, true), NM30, true), NM31, true), NM31, true), NM30, true), NM31, true), NM30, true), NM31, true), NM31.slice(0, 7), true);\nvar M366RANGE = [0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335, 366];\nvar M365RANGE = [0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334, 365];\nvar WDAYMASK = (function () {\n    var wdaymask = [];\n    for (var i = 0; i < 55; i++)\n        wdaymask = wdaymask.concat(range(7));\n    return wdaymask;\n})();\nexport { WDAYMASK, M365MASK, M365RANGE, M366MASK, M366RANGE, MDAY365MASK, MDAY366MASK, NMDAY365MASK, NMDAY366MASK, };\n//# sourceMappingURL=masks.js.map","import { __assign } from \"tslib\";\nimport { datetime, getWeekday, isLeapYear, toOrdinal } from '../dateutil';\nimport { empty, repeat, pymod, includes } from '../helpers';\nimport { M365MASK, MDAY365MASK, NMDAY365MASK, WDAYMASK, M365RANGE, M366MASK, MDAY366MASK, NMDAY366MASK, M366RANGE, } from '../masks';\nexport function rebuildYear(year, options) {\n    var firstyday = datetime(year, 1, 1);\n    var yearlen = isLeapYear(year) ? 366 : 365;\n    var nextyearlen = isLeapYear(year + 1) ? 366 : 365;\n    var yearordinal = toOrdinal(firstyday);\n    var yearweekday = getWeekday(firstyday);\n    var result = __assign(__assign({ yearlen: yearlen, nextyearlen: nextyearlen, yearordinal: yearordinal, yearweekday: yearweekday }, baseYearMasks(year)), { wnomask: null });\n    if (empty(options.byweekno)) {\n        return result;\n    }\n    result.wnomask = repeat(0, yearlen + 7);\n    var firstwkst;\n    var wyearlen;\n    var no1wkst = (firstwkst = pymod(7 - yearweekday + options.wkst, 7));\n    if (no1wkst >= 4) {\n        no1wkst = 0;\n        // Number of days in the year, plus the days we got\n        // from last year.\n        wyearlen = result.yearlen + pymod(yearweekday - options.wkst, 7);\n    }\n    else {\n        // Number of days in the year, minus the days we\n        // left in last year.\n        wyearlen = yearlen - no1wkst;\n    }\n    var div = Math.floor(wyearlen / 7);\n    var mod = pymod(wyearlen, 7);\n    var numweeks = Math.floor(div + mod / 4);\n    for (var j = 0; j < options.byweekno.length; j++) {\n        var n = options.byweekno[j];\n        if (n < 0) {\n            n += numweeks + 1;\n        }\n        if (!(n > 0 && n <= numweeks)) {\n            continue;\n        }\n        var i = void 0;\n        if (n > 1) {\n            i = no1wkst + (n - 1) * 7;\n            if (no1wkst !== firstwkst) {\n                i -= 7 - firstwkst;\n            }\n        }\n        else {\n            i = no1wkst;\n        }\n        for (var k = 0; k < 7; k++) {\n            result.wnomask[i] = 1;\n            i++;\n            if (result.wdaymask[i] === options.wkst)\n                break;\n        }\n    }\n    if (includes(options.byweekno, 1)) {\n        // Check week number 1 of next year as well\n        // orig-TODO : Check -numweeks for next year.\n        var i = no1wkst + numweeks * 7;\n        if (no1wkst !== firstwkst)\n            i -= 7 - firstwkst;\n        if (i < yearlen) {\n            // If week starts in next year, we\n            // don't care about it.\n            for (var j = 0; j < 7; j++) {\n                result.wnomask[i] = 1;\n                i += 1;\n                if (result.wdaymask[i] === options.wkst)\n                    break;\n            }\n        }\n    }\n    if (no1wkst) {\n        // Check last week number of last year as\n        // well. If no1wkst is 0, either the year\n        // started on week start, or week number 1\n        // got days from last year, so there are no\n        // days from last year's last week number in\n        // this year.\n        var lnumweeks = void 0;\n        if (!includes(options.byweekno, -1)) {\n            var lyearweekday = getWeekday(datetime(year - 1, 1, 1));\n            var lno1wkst = pymod(7 - lyearweekday.valueOf() + options.wkst, 7);\n            var lyearlen = isLeapYear(year - 1) ? 366 : 365;\n            var weekst = void 0;\n            if (lno1wkst >= 4) {\n                lno1wkst = 0;\n                weekst = lyearlen + pymod(lyearweekday - options.wkst, 7);\n            }\n            else {\n                weekst = yearlen - no1wkst;\n            }\n            lnumweeks = Math.floor(52 + pymod(weekst, 7) / 4);\n        }\n        else {\n            lnumweeks = -1;\n        }\n        if (includes(options.byweekno, lnumweeks)) {\n            for (var i = 0; i < no1wkst; i++)\n                result.wnomask[i] = 1;\n        }\n    }\n    return result;\n}\nfunction baseYearMasks(year) {\n    var yearlen = isLeapYear(year) ? 366 : 365;\n    var firstyday = datetime(year, 1, 1);\n    var wday = getWeekday(firstyday);\n    if (yearlen === 365) {\n        return {\n            mmask: M365MASK,\n            mdaymask: MDAY365MASK,\n            nmdaymask: NMDAY365MASK,\n            wdaymask: WDAYMASK.slice(wday),\n            mrange: M365RANGE,\n        };\n    }\n    return {\n        mmask: M366MASK,\n        mdaymask: MDAY366MASK,\n        nmdaymask: NMDAY366MASK,\n        wdaymask: WDAYMASK.slice(wday),\n        mrange: M366RANGE,\n    };\n}\n//# sourceMappingURL=yearinfo.js.map","import { RRule } from '../rrule';\nimport { empty, repeat, pymod } from '../helpers';\nexport function rebuildMonth(year, month, yearlen, mrange, wdaymask, options) {\n    var result = {\n        lastyear: year,\n        lastmonth: month,\n        nwdaymask: [],\n    };\n    var ranges = [];\n    if (options.freq === RRule.YEARLY) {\n        if (empty(options.bymonth)) {\n            ranges = [[0, yearlen]];\n        }\n        else {\n            for (var j = 0; j < options.bymonth.length; j++) {\n                month = options.bymonth[j];\n                ranges.push(mrange.slice(month - 1, month + 1));\n            }\n        }\n    }\n    else if (options.freq === RRule.MONTHLY) {\n        ranges = [mrange.slice(month - 1, month + 1)];\n    }\n    if (empty(ranges)) {\n        return result;\n    }\n    // Weekly frequency won't get here, so we may not\n    // care about cross-year weekly periods.\n    result.nwdaymask = repeat(0, yearlen);\n    for (var j = 0; j < ranges.length; j++) {\n        var rang = ranges[j];\n        var first = rang[0];\n        var last = rang[1] - 1;\n        for (var k = 0; k < options.bynweekday.length; k++) {\n            var i = void 0;\n            var _a = options.bynweekday[k], wday = _a[0], n = _a[1];\n            if (n < 0) {\n                i = last + (n + 1) * 7;\n                i -= pymod(wdaymask[i] - wday, 7);\n            }\n            else {\n                i = first + (n - 1) * 7;\n                i += pymod(7 - wdaymask[i] + wday, 7);\n            }\n            if (first <= i && i <= last)\n                result.nwdaymask[i] = 1;\n        }\n    }\n    return result;\n}\n//# sourceMappingURL=monthinfo.js.map","export function easter(y, offset) {\n    if (offset === void 0) { offset = 0; }\n    var a = y % 19;\n    var b = Math.floor(y / 100);\n    var c = y % 100;\n    var d = Math.floor(b / 4);\n    var e = b % 4;\n    var f = Math.floor((b + 8) / 25);\n    var g = Math.floor((b - f + 1) / 3);\n    var h = Math.floor(19 * a + b - d - g + 15) % 30;\n    var i = Math.floor(c / 4);\n    var k = c % 4;\n    var l = Math.floor(32 + 2 * e + 2 * i - h - k) % 7;\n    var m = Math.floor((a + 11 * h + 22 * l) / 451);\n    var month = Math.floor((h + l - 7 * m + 114) / 31);\n    var day = ((h + l - 7 * m + 114) % 31) + 1;\n    var date = Date.UTC(y, month - 1, day + offset);\n    var yearStart = Date.UTC(y, 0, 1);\n    return [Math.ceil((date - yearStart) / (1000 * 60 * 60 * 24))];\n}\n//# sourceMappingURL=easter.js.map","import { notEmpty, repeat, range, isPresent } from '../helpers';\nimport { Frequency } from '../types';\nimport { rebuildYear } from './yearinfo';\nimport { rebuildMonth } from './monthinfo';\nimport { easter } from './easter';\nimport { Time } from '../datetime';\nimport { datetime, sort, toOrdinal } from '../dateutil';\n// =============================================================================\n// Iterinfo\n// =============================================================================\nvar Iterinfo = /** @class */ (function () {\n    // eslint-disable-next-line no-empty-function\n    function Iterinfo(options) {\n        this.options = options;\n    }\n    Iterinfo.prototype.rebuild = function (year, month) {\n        var options = this.options;\n        if (year !== this.lastyear) {\n            this.yearinfo = rebuildYear(year, options);\n        }\n        if (notEmpty(options.bynweekday) &&\n            (month !== this.lastmonth || year !== this.lastyear)) {\n            var _a = this.yearinfo, yearlen = _a.yearlen, mrange = _a.mrange, wdaymask = _a.wdaymask;\n            this.monthinfo = rebuildMonth(year, month, yearlen, mrange, wdaymask, options);\n        }\n        if (isPresent(options.byeaster)) {\n            this.eastermask = easter(year, options.byeaster);\n        }\n    };\n    Object.defineProperty(Iterinfo.prototype, \"lastyear\", {\n        get: function () {\n            return this.monthinfo ? this.monthinfo.lastyear : null;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Iterinfo.prototype, \"lastmonth\", {\n        get: function () {\n            return this.monthinfo ? this.monthinfo.lastmonth : null;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Iterinfo.prototype, \"yearlen\", {\n        get: function () {\n            return this.yearinfo.yearlen;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Iterinfo.prototype, \"yearordinal\", {\n        get: function () {\n            return this.yearinfo.yearordinal;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Iterinfo.prototype, \"mrange\", {\n        get: function () {\n            return this.yearinfo.mrange;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Iterinfo.prototype, \"wdaymask\", {\n        get: function () {\n            return this.yearinfo.wdaymask;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Iterinfo.prototype, \"mmask\", {\n        get: function () {\n            return this.yearinfo.mmask;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Iterinfo.prototype, \"wnomask\", {\n        get: function () {\n            return this.yearinfo.wnomask;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Iterinfo.prototype, \"nwdaymask\", {\n        get: function () {\n            return this.monthinfo ? this.monthinfo.nwdaymask : [];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Iterinfo.prototype, \"nextyearlen\", {\n        get: function () {\n            return this.yearinfo.nextyearlen;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Iterinfo.prototype, \"mdaymask\", {\n        get: function () {\n            return this.yearinfo.mdaymask;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Iterinfo.prototype, \"nmdaymask\", {\n        get: function () {\n            return this.yearinfo.nmdaymask;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Iterinfo.prototype.ydayset = function () {\n        return [range(this.yearlen), 0, this.yearlen];\n    };\n    Iterinfo.prototype.mdayset = function (_, month) {\n        var start = this.mrange[month - 1];\n        var end = this.mrange[month];\n        var set = repeat(null, this.yearlen);\n        for (var i = start; i < end; i++)\n            set[i] = i;\n        return [set, start, end];\n    };\n    Iterinfo.prototype.wdayset = function (year, month, day) {\n        // We need to handle cross-year weeks here.\n        var set = repeat(null, this.yearlen + 7);\n        var i = toOrdinal(datetime(year, month, day)) - this.yearordinal;\n        var start = i;\n        for (var j = 0; j < 7; j++) {\n            set[i] = i;\n            ++i;\n            if (this.wdaymask[i] === this.options.wkst)\n                break;\n        }\n        return [set, start, i];\n    };\n    Iterinfo.prototype.ddayset = function (year, month, day) {\n        var set = repeat(null, this.yearlen);\n        var i = toOrdinal(datetime(year, month, day)) - this.yearordinal;\n        set[i] = i;\n        return [set, i, i + 1];\n    };\n    Iterinfo.prototype.htimeset = function (hour, _, second, millisecond) {\n        var _this = this;\n        var set = [];\n        this.options.byminute.forEach(function (minute) {\n            set = set.concat(_this.mtimeset(hour, minute, second, millisecond));\n        });\n        sort(set);\n        return set;\n    };\n    Iterinfo.prototype.mtimeset = function (hour, minute, _, millisecond) {\n        var set = this.options.bysecond.map(function (second) { return new Time(hour, minute, second, millisecond); });\n        sort(set);\n        return set;\n    };\n    Iterinfo.prototype.stimeset = function (hour, minute, second, millisecond) {\n        return [new Time(hour, minute, second, millisecond)];\n    };\n    Iterinfo.prototype.getdayset = function (freq) {\n        switch (freq) {\n            case Frequency.YEARLY:\n                return this.ydayset.bind(this);\n            case Frequency.MONTHLY:\n                return this.mdayset.bind(this);\n            case Frequency.WEEKLY:\n                return this.wdayset.bind(this);\n            case Frequency.DAILY:\n                return this.ddayset.bind(this);\n            default:\n                return this.ddayset.bind(this);\n        }\n    };\n    Iterinfo.prototype.gettimeset = function (freq) {\n        switch (freq) {\n            case Frequency.HOURLY:\n                return this.htimeset.bind(this);\n            case Frequency.MINUTELY:\n                return this.mtimeset.bind(this);\n            case Frequency.SECONDLY:\n                return this.stimeset.bind(this);\n        }\n    };\n    return Iterinfo;\n}());\nexport default Iterinfo;\n//# sourceMappingURL=index.js.map","import { combine, fromOrdinal, sort } from '../dateutil';\nimport { pymod, isPresent, includes } from '../helpers';\nexport function buildPoslist(bysetpos, timeset, start, end, ii, dayset) {\n    var poslist = [];\n    for (var j = 0; j < bysetpos.length; j++) {\n        var daypos = void 0;\n        var timepos = void 0;\n        var pos = bysetpos[j];\n        if (pos < 0) {\n            daypos = Math.floor(pos / timeset.length);\n            timepos = pymod(pos, timeset.length);\n        }\n        else {\n            daypos = Math.floor((pos - 1) / timeset.length);\n            timepos = pymod(pos - 1, timeset.length);\n        }\n        var tmp = [];\n        for (var k = start; k < end; k++) {\n            var val = dayset[k];\n            if (!isPresent(val))\n                continue;\n            tmp.push(val);\n        }\n        var i = void 0;\n        if (daypos < 0) {\n            i = tmp.slice(daypos)[0];\n        }\n        else {\n            i = tmp[daypos];\n        }\n        var time = timeset[timepos];\n        var date = fromOrdinal(ii.yearordinal + i);\n        var res = combine(date, time);\n        // XXX: can this ever be in the array?\n        // - compare the actual date instead?\n        if (!includes(poslist, res))\n            poslist.push(res);\n    }\n    sort(poslist);\n    return poslist;\n}\n//# sourceMappingURL=poslist.js.map","import { freqIsDailyOrGreater } from '../types';\nimport { combine, fromOrdinal, MAXYEAR } from '../dateutil';\nimport Iterinfo from '../iterinfo/index';\nimport { RRule } from '../rrule';\nimport { buildTimeset } from '../parseoptions';\nimport { notEmpty, includes, isPresent } from '../helpers';\nimport { DateWithZone } from '../datewithzone';\nimport { buildPoslist } from './poslist';\nimport { DateTime } from '../datetime';\nexport function iter(iterResult, options) {\n    var dtstart = options.dtstart, freq = options.freq, interval = options.interval, until = options.until, bysetpos = options.bysetpos;\n    var count = options.count;\n    if (count === 0 || interval === 0) {\n        return emitResult(iterResult);\n    }\n    var counterDate = DateTime.fromDate(dtstart);\n    var ii = new Iterinfo(options);\n    ii.rebuild(counterDate.year, counterDate.month);\n    var timeset = makeTimeset(ii, counterDate, options);\n    for (;;) {\n        var _a = ii.getdayset(freq)(counterDate.year, counterDate.month, counterDate.day), dayset = _a[0], start = _a[1], end = _a[2];\n        var filtered = removeFilteredDays(dayset, start, end, ii, options);\n        if (notEmpty(bysetpos)) {\n            var poslist = buildPoslist(bysetpos, timeset, start, end, ii, dayset);\n            for (var j = 0; j < poslist.length; j++) {\n                var res = poslist[j];\n                if (until && res > until) {\n                    return emitResult(iterResult);\n                }\n                if (res >= dtstart) {\n                    var rezonedDate = rezoneIfNeeded(res, options);\n                    if (!iterResult.accept(rezonedDate)) {\n                        return emitResult(iterResult);\n                    }\n                    if (count) {\n                        --count;\n                        if (!count) {\n                            return emitResult(iterResult);\n                        }\n                    }\n                }\n            }\n        }\n        else {\n            for (var j = start; j < end; j++) {\n                var currentDay = dayset[j];\n                if (!isPresent(currentDay)) {\n                    continue;\n                }\n                var date = fromOrdinal(ii.yearordinal + currentDay);\n                for (var k = 0; k < timeset.length; k++) {\n                    var time = timeset[k];\n                    var res = combine(date, time);\n                    if (until && res > until) {\n                        return emitResult(iterResult);\n                    }\n                    if (res >= dtstart) {\n                        var rezonedDate = rezoneIfNeeded(res, options);\n                        if (!iterResult.accept(rezonedDate)) {\n                            return emitResult(iterResult);\n                        }\n                        if (count) {\n                            --count;\n                            if (!count) {\n                                return emitResult(iterResult);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        if (options.interval === 0) {\n            return emitResult(iterResult);\n        }\n        // Handle frequency and interval\n        counterDate.add(options, filtered);\n        if (counterDate.year > MAXYEAR) {\n            return emitResult(iterResult);\n        }\n        if (!freqIsDailyOrGreater(freq)) {\n            timeset = ii.gettimeset(freq)(counterDate.hour, counterDate.minute, counterDate.second, 0);\n        }\n        ii.rebuild(counterDate.year, counterDate.month);\n    }\n}\nfunction isFiltered(ii, currentDay, options) {\n    var bymonth = options.bymonth, byweekno = options.byweekno, byweekday = options.byweekday, byeaster = options.byeaster, bymonthday = options.bymonthday, bynmonthday = options.bynmonthday, byyearday = options.byyearday;\n    return ((notEmpty(bymonth) && !includes(bymonth, ii.mmask[currentDay])) ||\n        (notEmpty(byweekno) && !ii.wnomask[currentDay]) ||\n        (notEmpty(byweekday) && !includes(byweekday, ii.wdaymask[currentDay])) ||\n        (notEmpty(ii.nwdaymask) && !ii.nwdaymask[currentDay]) ||\n        (byeaster !== null && !includes(ii.eastermask, currentDay)) ||\n        ((notEmpty(bymonthday) || notEmpty(bynmonthday)) &&\n            !includes(bymonthday, ii.mdaymask[currentDay]) &&\n            !includes(bynmonthday, ii.nmdaymask[currentDay])) ||\n        (notEmpty(byyearday) &&\n            ((currentDay < ii.yearlen &&\n                !includes(byyearday, currentDay + 1) &&\n                !includes(byyearday, -ii.yearlen + currentDay)) ||\n                (currentDay >= ii.yearlen &&\n                    !includes(byyearday, currentDay + 1 - ii.yearlen) &&\n                    !includes(byyearday, -ii.nextyearlen + currentDay - ii.yearlen)))));\n}\nfunction rezoneIfNeeded(date, options) {\n    return new DateWithZone(date, options.tzid).rezonedDate();\n}\nfunction emitResult(iterResult) {\n    return iterResult.getValue();\n}\nfunction removeFilteredDays(dayset, start, end, ii, options) {\n    var filtered = false;\n    for (var dayCounter = start; dayCounter < end; dayCounter++) {\n        var currentDay = dayset[dayCounter];\n        filtered = isFiltered(ii, currentDay, options);\n        if (filtered)\n            dayset[currentDay] = null;\n    }\n    return filtered;\n}\nfunction makeTimeset(ii, counterDate, options) {\n    var freq = options.freq, byhour = options.byhour, byminute = options.byminute, bysecond = options.bysecond;\n    if (freqIsDailyOrGreater(freq)) {\n        return buildTimeset(options);\n    }\n    if ((freq >= RRule.HOURLY &&\n        notEmpty(byhour) &&\n        !includes(byhour, counterDate.hour)) ||\n        (freq >= RRule.MINUTELY &&\n            notEmpty(byminute) &&\n            !includes(byminute, counterDate.minute)) ||\n        (freq >= RRule.SECONDLY &&\n            notEmpty(bysecond) &&\n            !includes(bysecond, counterDate.second))) {\n        return [];\n    }\n    return ii.gettimeset(freq)(counterDate.hour, counterDate.minute, counterDate.second, counterDate.millisecond);\n}\n//# sourceMappingURL=index.js.map","import { isValidDate } from './dateutil';\nimport IterResult from './iterresult';\nimport CallbackIterResult from './callbackiterresult';\nimport { fromText, parseText, toText, isFullyConvertible } from './nlp/index';\nimport { Frequency, } from './types';\nimport { parseOptions, initializeOptions } from './parseoptions';\nimport { parseString } from './parsestring';\nimport { optionsToString } from './optionstostring';\nimport { Cache } from './cache';\nimport { Weekday } from './weekday';\nimport { iter } from './iter/index';\n// =============================================================================\n// RRule\n// =============================================================================\nexport var Days = {\n    MO: new Weekday(0),\n    TU: new Weekday(1),\n    WE: new Weekday(2),\n    TH: new Weekday(3),\n    FR: new Weekday(4),\n    SA: new Weekday(5),\n    SU: new Weekday(6),\n};\nexport var DEFAULT_OPTIONS = {\n    freq: Frequency.YEARLY,\n    dtstart: null,\n    interval: 1,\n    wkst: Days.MO,\n    count: null,\n    until: null,\n    tzid: null,\n    bysetpos: null,\n    bymonth: null,\n    bymonthday: null,\n    bynmonthday: null,\n    byyearday: null,\n    byweekno: null,\n    byweekday: null,\n    bynweekday: null,\n    byhour: null,\n    byminute: null,\n    bysecond: null,\n    byeaster: null,\n};\nexport var defaultKeys = Object.keys(DEFAULT_OPTIONS);\n/**\n *\n * @param {Options?} options - see <http://labix.org/python-dateutil/#head-cf004ee9a75592797e076752b2a889c10f445418>\n * - The only required option is `freq`, one of RRule.YEARLY, RRule.MONTHLY, ...\n * @constructor\n */\nvar RRule = /** @class */ (function () {\n    function RRule(options, noCache) {\n        if (options === void 0) { options = {}; }\n        if (noCache === void 0) { noCache = false; }\n        // RFC string\n        this._cache = noCache ? null : new Cache();\n        // used by toString()\n        this.origOptions = initializeOptions(options);\n        var parsedOptions = parseOptions(options).parsedOptions;\n        this.options = parsedOptions;\n    }\n    RRule.parseText = function (text, language) {\n        return parseText(text, language);\n    };\n    RRule.fromText = function (text, language) {\n        return fromText(text, language);\n    };\n    RRule.fromString = function (str) {\n        return new RRule(RRule.parseString(str) || undefined);\n    };\n    RRule.prototype._iter = function (iterResult) {\n        return iter(iterResult, this.options);\n    };\n    RRule.prototype._cacheGet = function (what, args) {\n        if (!this._cache)\n            return false;\n        return this._cache._cacheGet(what, args);\n    };\n    RRule.prototype._cacheAdd = function (what, value, args) {\n        if (!this._cache)\n            return;\n        return this._cache._cacheAdd(what, value, args);\n    };\n    /**\n     * @param {Function} iterator - optional function that will be called\n     * on each date that is added. It can return false\n     * to stop the iteration.\n     * @return Array containing all recurrences.\n     */\n    RRule.prototype.all = function (iterator) {\n        if (iterator) {\n            return this._iter(new CallbackIterResult('all', {}, iterator));\n        }\n        var result = this._cacheGet('all');\n        if (result === false) {\n            result = this._iter(new IterResult('all', {}));\n            this._cacheAdd('all', result);\n        }\n        return result;\n    };\n    /**\n     * Returns all the occurrences of the rrule between after and before.\n     * The inc keyword defines what happens if after and/or before are\n     * themselves occurrences. With inc == True, they will be included in the\n     * list, if they are found in the recurrence set.\n     *\n     * @return Array\n     */\n    RRule.prototype.between = function (after, before, inc, iterator) {\n        if (inc === void 0) { inc = false; }\n        if (!isValidDate(after) || !isValidDate(before)) {\n            throw new Error('Invalid date passed in to RRule.between');\n        }\n        var args = {\n            before: before,\n            after: after,\n            inc: inc,\n        };\n        if (iterator) {\n            return this._iter(new CallbackIterResult('between', args, iterator));\n        }\n        var result = this._cacheGet('between', args);\n        if (result === false) {\n            result = this._iter(new IterResult('between', args));\n            this._cacheAdd('between', result, args);\n        }\n        return result;\n    };\n    /**\n     * Returns the last recurrence before the given datetime instance.\n     * The inc keyword defines what happens if dt is an occurrence.\n     * With inc == True, if dt itself is an occurrence, it will be returned.\n     *\n     * @return Date or null\n     */\n    RRule.prototype.before = function (dt, inc) {\n        if (inc === void 0) { inc = false; }\n        if (!isValidDate(dt)) {\n            throw new Error('Invalid date passed in to RRule.before');\n        }\n        var args = { dt: dt, inc: inc };\n        var result = this._cacheGet('before', args);\n        if (result === false) {\n            result = this._iter(new IterResult('before', args));\n            this._cacheAdd('before', result, args);\n        }\n        return result;\n    };\n    /**\n     * Returns the first recurrence after the given datetime instance.\n     * The inc keyword defines what happens if dt is an occurrence.\n     * With inc == True, if dt itself is an occurrence, it will be returned.\n     *\n     * @return Date or null\n     */\n    RRule.prototype.after = function (dt, inc) {\n        if (inc === void 0) { inc = false; }\n        if (!isValidDate(dt)) {\n            throw new Error('Invalid date passed in to RRule.after');\n        }\n        var args = { dt: dt, inc: inc };\n        var result = this._cacheGet('after', args);\n        if (result === false) {\n            result = this._iter(new IterResult('after', args));\n            this._cacheAdd('after', result, args);\n        }\n        return result;\n    };\n    /**\n     * Returns the number of recurrences in this set. It will have go trough\n     * the whole recurrence, if this hasn't been done before.\n     */\n    RRule.prototype.count = function () {\n        return this.all().length;\n    };\n    /**\n     * Converts the rrule into its string representation\n     *\n     * @see <http://www.ietf.org/rfc/rfc2445.txt>\n     * @return String\n     */\n    RRule.prototype.toString = function () {\n        return optionsToString(this.origOptions);\n    };\n    /**\n     * Will convert all rules described in nlp:ToText\n     * to text.\n     */\n    RRule.prototype.toText = function (gettext, language, dateFormatter) {\n        return toText(this, gettext, language, dateFormatter);\n    };\n    RRule.prototype.isFullyConvertibleToText = function () {\n        return isFullyConvertible(this);\n    };\n    /**\n     * @return a RRule instance with the same freq and options\n     * as this one (cache is not cloned)\n     */\n    RRule.prototype.clone = function () {\n        return new RRule(this.origOptions);\n    };\n    // RRule class 'constants'\n    RRule.FREQUENCIES = [\n        'YEARLY',\n        'MONTHLY',\n        'WEEKLY',\n        'DAILY',\n        'HOURLY',\n        'MINUTELY',\n        'SECONDLY',\n    ];\n    RRule.YEARLY = Frequency.YEARLY;\n    RRule.MONTHLY = Frequency.MONTHLY;\n    RRule.WEEKLY = Frequency.WEEKLY;\n    RRule.DAILY = Frequency.DAILY;\n    RRule.HOURLY = Frequency.HOURLY;\n    RRule.MINUTELY = Frequency.MINUTELY;\n    RRule.SECONDLY = Frequency.SECONDLY;\n    RRule.MO = Days.MO;\n    RRule.TU = Days.TU;\n    RRule.WE = Days.WE;\n    RRule.TH = Days.TH;\n    RRule.FR = Days.FR;\n    RRule.SA = Days.SA;\n    RRule.SU = Days.SU;\n    RRule.parseString = parseString;\n    RRule.optionsToString = optionsToString;\n    return RRule;\n}());\nexport { RRule };\n//# sourceMappingURL=rrule.js.map","import { DateWithZone } from './datewithzone';\nimport { iter } from './iter';\nimport { sort } from './dateutil';\nexport function iterSet(iterResult, _rrule, _exrule, _rdate, _exdate, tzid) {\n    var _exdateHash = {};\n    var _accept = iterResult.accept;\n    function evalExdate(after, before) {\n        _exrule.forEach(function (rrule) {\n            rrule.between(after, before, true).forEach(function (date) {\n                _exdateHash[Number(date)] = true;\n            });\n        });\n    }\n    _exdate.forEach(function (date) {\n        var zonedDate = new DateWithZone(date, tzid).rezonedDate();\n        _exdateHash[Number(zonedDate)] = true;\n    });\n    iterResult.accept = function (date) {\n        var dt = Number(date);\n        if (isNaN(dt))\n            return _accept.call(this, date);\n        if (!_exdateHash[dt]) {\n            evalExdate(new Date(dt - 1), new Date(dt + 1));\n            if (!_exdateHash[dt]) {\n                _exdateHash[dt] = true;\n                return _accept.call(this, date);\n            }\n        }\n        return true;\n    };\n    if (iterResult.method === 'between') {\n        evalExdate(iterResult.args.after, iterResult.args.before);\n        iterResult.accept = function (date) {\n            var dt = Number(date);\n            if (!_exdateHash[dt]) {\n                _exdateHash[dt] = true;\n                return _accept.call(this, date);\n            }\n            return true;\n        };\n    }\n    for (var i = 0; i < _rdate.length; i++) {\n        var zonedDate = new DateWithZone(_rdate[i], tzid).rezonedDate();\n        if (!iterResult.accept(new Date(zonedDate.getTime())))\n            break;\n    }\n    _rrule.forEach(function (rrule) {\n        iter(iterResult, rrule.options);\n    });\n    var res = iterResult._result;\n    sort(res);\n    switch (iterResult.method) {\n        case 'all':\n        case 'between':\n            return res;\n        case 'before':\n            return ((res.length && res[res.length - 1]) || null);\n        case 'after':\n        default:\n            return ((res.length && res[0]) || null);\n    }\n}\n//# sourceMappingURL=iterset.js.map","import { __assign } from \"tslib\";\nimport { RRule } from './rrule';\nimport { RRuleSet } from './rruleset';\nimport { untilStringToDate } from './dateutil';\nimport { includes, split } from './helpers';\nimport { parseString, parseDtstart } from './parsestring';\n/**\n * RRuleStr\n * To parse a set of rrule strings\n */\nvar DEFAULT_OPTIONS = {\n    dtstart: null,\n    cache: false,\n    unfold: false,\n    forceset: false,\n    compatible: false,\n    tzid: null,\n};\nexport function parseInput(s, options) {\n    var rrulevals = [];\n    var rdatevals = [];\n    var exrulevals = [];\n    var exdatevals = [];\n    var parsedDtstart = parseDtstart(s);\n    var dtstart = parsedDtstart.dtstart;\n    var tzid = parsedDtstart.tzid;\n    var lines = splitIntoLines(s, options.unfold);\n    lines.forEach(function (line) {\n        var _a;\n        if (!line)\n            return;\n        var _b = breakDownLine(line), name = _b.name, parms = _b.parms, value = _b.value;\n        switch (name.toUpperCase()) {\n            case 'RRULE':\n                if (parms.length) {\n                    throw new Error(\"unsupported RRULE parm: \".concat(parms.join(',')));\n                }\n                rrulevals.push(parseString(line));\n                break;\n            case 'RDATE':\n                var _c = (_a = /RDATE(?:;TZID=([^:=]+))?/i.exec(line)) !== null && _a !== void 0 ? _a : [], rdateTzid = _c[1];\n                if (rdateTzid && !tzid) {\n                    tzid = rdateTzid;\n                }\n                rdatevals = rdatevals.concat(parseRDate(value, parms));\n                break;\n            case 'EXRULE':\n                if (parms.length) {\n                    throw new Error(\"unsupported EXRULE parm: \".concat(parms.join(',')));\n                }\n                exrulevals.push(parseString(value));\n                break;\n            case 'EXDATE':\n                exdatevals = exdatevals.concat(parseRDate(value, parms));\n                break;\n            case 'DTSTART':\n                break;\n            default:\n                throw new Error('unsupported property: ' + name);\n        }\n    });\n    return {\n        dtstart: dtstart,\n        tzid: tzid,\n        rrulevals: rrulevals,\n        rdatevals: rdatevals,\n        exrulevals: exrulevals,\n        exdatevals: exdatevals,\n    };\n}\nfunction buildRule(s, options) {\n    var _a = parseInput(s, options), rrulevals = _a.rrulevals, rdatevals = _a.rdatevals, exrulevals = _a.exrulevals, exdatevals = _a.exdatevals, dtstart = _a.dtstart, tzid = _a.tzid;\n    var noCache = options.cache === false;\n    if (options.compatible) {\n        options.forceset = true;\n        options.unfold = true;\n    }\n    if (options.forceset ||\n        rrulevals.length > 1 ||\n        rdatevals.length ||\n        exrulevals.length ||\n        exdatevals.length) {\n        var rset_1 = new RRuleSet(noCache);\n        rset_1.dtstart(dtstart);\n        rset_1.tzid(tzid || undefined);\n        rrulevals.forEach(function (val) {\n            rset_1.rrule(new RRule(groomRruleOptions(val, dtstart, tzid), noCache));\n        });\n        rdatevals.forEach(function (date) {\n            rset_1.rdate(date);\n        });\n        exrulevals.forEach(function (val) {\n            rset_1.exrule(new RRule(groomRruleOptions(val, dtstart, tzid), noCache));\n        });\n        exdatevals.forEach(function (date) {\n            rset_1.exdate(date);\n        });\n        if (options.compatible && options.dtstart)\n            rset_1.rdate(dtstart);\n        return rset_1;\n    }\n    var val = rrulevals[0] || {};\n    return new RRule(groomRruleOptions(val, val.dtstart || options.dtstart || dtstart, val.tzid || options.tzid || tzid), noCache);\n}\nexport function rrulestr(s, options) {\n    if (options === void 0) { options = {}; }\n    return buildRule(s, initializeOptions(options));\n}\nfunction groomRruleOptions(val, dtstart, tzid) {\n    return __assign(__assign({}, val), { dtstart: dtstart, tzid: tzid });\n}\nfunction initializeOptions(options) {\n    var invalid = [];\n    var keys = Object.keys(options);\n    var defaultKeys = Object.keys(DEFAULT_OPTIONS);\n    keys.forEach(function (key) {\n        if (!includes(defaultKeys, key))\n            invalid.push(key);\n    });\n    if (invalid.length) {\n        throw new Error('Invalid options: ' + invalid.join(', '));\n    }\n    return __assign(__assign({}, DEFAULT_OPTIONS), options);\n}\nfunction extractName(line) {\n    if (line.indexOf(':') === -1) {\n        return {\n            name: 'RRULE',\n            value: line,\n        };\n    }\n    var _a = split(line, ':', 1), name = _a[0], value = _a[1];\n    return {\n        name: name,\n        value: value,\n    };\n}\nfunction breakDownLine(line) {\n    var _a = extractName(line), name = _a.name, value = _a.value;\n    var parms = name.split(';');\n    if (!parms)\n        throw new Error('empty property name');\n    return {\n        name: parms[0].toUpperCase(),\n        parms: parms.slice(1),\n        value: value,\n    };\n}\nfunction splitIntoLines(s, unfold) {\n    if (unfold === void 0) { unfold = false; }\n    s = s && s.trim();\n    if (!s)\n        throw new Error('Invalid empty string');\n    // More info about 'unfold' option\n    // Go head to http://www.ietf.org/rfc/rfc2445.txt\n    if (!unfold) {\n        return s.split(/\\s/);\n    }\n    var lines = s.split('\\n');\n    var i = 0;\n    while (i < lines.length) {\n        // TODO\n        var line = (lines[i] = lines[i].replace(/\\s+$/g, ''));\n        if (!line) {\n            lines.splice(i, 1);\n        }\n        else if (i > 0 && line[0] === ' ') {\n            lines[i - 1] += line.slice(1);\n            lines.splice(i, 1);\n        }\n        else {\n            i += 1;\n        }\n    }\n    return lines;\n}\nfunction validateDateParm(parms) {\n    parms.forEach(function (parm) {\n        if (!/(VALUE=DATE(-TIME)?)|(TZID=)/.test(parm)) {\n            throw new Error('unsupported RDATE/EXDATE parm: ' + parm);\n        }\n    });\n}\nfunction parseRDate(rdateval, parms) {\n    validateDateParm(parms);\n    return rdateval.split(',').map(function (datestr) { return untilStringToDate(datestr); });\n}\n//# sourceMappingURL=rrulestr.js.map","import { __extends } from \"tslib\";\nimport { RRule } from './rrule';\nimport { sort, timeToUntilString } from './dateutil';\nimport { includes } from './helpers';\nimport { iterSet } from './iterset';\nimport { rrulestr } from './rrulestr';\nimport { optionsToString } from './optionstostring';\nfunction createGetterSetter(fieldName) {\n    var _this = this;\n    return function (field) {\n        if (field !== undefined) {\n            _this[\"_\".concat(fieldName)] = field;\n        }\n        if (_this[\"_\".concat(fieldName)] !== undefined) {\n            return _this[\"_\".concat(fieldName)];\n        }\n        for (var i = 0; i < _this._rrule.length; i++) {\n            var field_1 = _this._rrule[i].origOptions[fieldName];\n            if (field_1) {\n                return field_1;\n            }\n        }\n    };\n}\nvar RRuleSet = /** @class */ (function (_super) {\n    __extends(RRuleSet, _super);\n    /**\n     *\n     * @param {Boolean?} noCache\n     * The same stratagy as RRule on cache, default to false\n     * @constructor\n     */\n    function RRuleSet(noCache) {\n        if (noCache === void 0) { noCache = false; }\n        var _this = _super.call(this, {}, noCache) || this;\n        _this.dtstart = createGetterSetter.apply(_this, ['dtstart']);\n        _this.tzid = createGetterSetter.apply(_this, ['tzid']);\n        _this._rrule = [];\n        _this._rdate = [];\n        _this._exrule = [];\n        _this._exdate = [];\n        return _this;\n    }\n    RRuleSet.prototype._iter = function (iterResult) {\n        return iterSet(iterResult, this._rrule, this._exrule, this._rdate, this._exdate, this.tzid());\n    };\n    /**\n     * Adds an RRule to the set\n     *\n     * @param {RRule}\n     */\n    RRuleSet.prototype.rrule = function (rrule) {\n        _addRule(rrule, this._rrule);\n    };\n    /**\n     * Adds an EXRULE to the set\n     *\n     * @param {RRule}\n     */\n    RRuleSet.prototype.exrule = function (rrule) {\n        _addRule(rrule, this._exrule);\n    };\n    /**\n     * Adds an RDate to the set\n     *\n     * @param {Date}\n     */\n    RRuleSet.prototype.rdate = function (date) {\n        _addDate(date, this._rdate);\n    };\n    /**\n     * Adds an EXDATE to the set\n     *\n     * @param {Date}\n     */\n    RRuleSet.prototype.exdate = function (date) {\n        _addDate(date, this._exdate);\n    };\n    /**\n     * Get list of included rrules in this recurrence set.\n     *\n     * @return List of rrules\n     */\n    RRuleSet.prototype.rrules = function () {\n        return this._rrule.map(function (e) { return rrulestr(e.toString()); });\n    };\n    /**\n     * Get list of excluded rrules in this recurrence set.\n     *\n     * @return List of exrules\n     */\n    RRuleSet.prototype.exrules = function () {\n        return this._exrule.map(function (e) { return rrulestr(e.toString()); });\n    };\n    /**\n     * Get list of included datetimes in this recurrence set.\n     *\n     * @return List of rdates\n     */\n    RRuleSet.prototype.rdates = function () {\n        return this._rdate.map(function (e) { return new Date(e.getTime()); });\n    };\n    /**\n     * Get list of included datetimes in this recurrence set.\n     *\n     * @return List of exdates\n     */\n    RRuleSet.prototype.exdates = function () {\n        return this._exdate.map(function (e) { return new Date(e.getTime()); });\n    };\n    RRuleSet.prototype.valueOf = function () {\n        var result = [];\n        if (!this._rrule.length && this._dtstart) {\n            result = result.concat(optionsToString({ dtstart: this._dtstart }));\n        }\n        this._rrule.forEach(function (rrule) {\n            result = result.concat(rrule.toString().split('\\n'));\n        });\n        this._exrule.forEach(function (exrule) {\n            result = result.concat(exrule\n                .toString()\n                .split('\\n')\n                .map(function (line) { return line.replace(/^RRULE:/, 'EXRULE:'); })\n                .filter(function (line) { return !/^DTSTART/.test(line); }));\n        });\n        if (this._rdate.length) {\n            result.push(rdatesToString('RDATE', this._rdate, this.tzid()));\n        }\n        if (this._exdate.length) {\n            result.push(rdatesToString('EXDATE', this._exdate, this.tzid()));\n        }\n        return result;\n    };\n    /**\n     * to generate recurrence field such as:\n     * DTSTART:19970902T010000Z\n     * RRULE:FREQ=YEARLY;COUNT=2;BYDAY=TU\n     * RRULE:FREQ=YEARLY;COUNT=1;BYDAY=TH\n     */\n    RRuleSet.prototype.toString = function () {\n        return this.valueOf().join('\\n');\n    };\n    /**\n     * Create a new RRuleSet Object completely base on current instance\n     */\n    RRuleSet.prototype.clone = function () {\n        var rrs = new RRuleSet(!!this._cache);\n        this._rrule.forEach(function (rule) { return rrs.rrule(rule.clone()); });\n        this._exrule.forEach(function (rule) { return rrs.exrule(rule.clone()); });\n        this._rdate.forEach(function (date) { return rrs.rdate(new Date(date.getTime())); });\n        this._exdate.forEach(function (date) { return rrs.exdate(new Date(date.getTime())); });\n        return rrs;\n    };\n    return RRuleSet;\n}(RRule));\nexport { RRuleSet };\nfunction _addRule(rrule, collection) {\n    if (!(rrule instanceof RRule)) {\n        throw new TypeError(String(rrule) + ' is not RRule instance');\n    }\n    if (!includes(collection.map(String), String(rrule))) {\n        collection.push(rrule);\n    }\n}\nfunction _addDate(date, collection) {\n    if (!(date instanceof Date)) {\n        throw new TypeError(String(date) + ' is not Date instance');\n    }\n    if (!includes(collection.map(Number), Number(date))) {\n        collection.push(date);\n        sort(collection);\n    }\n}\nfunction rdatesToString(param, rdates, tzid) {\n    var isUTC = !tzid || tzid.toUpperCase() === 'UTC';\n    var header = isUTC ? \"\".concat(param, \":\") : \"\".concat(param, \";TZID=\").concat(tzid, \":\");\n    var dateString = rdates\n        .map(function (rdate) { return timeToUntilString(rdate.valueOf(), isUTC); })\n        .join(',');\n    return \"\".concat(header).concat(dateString);\n}\n//# sourceMappingURL=rruleset.js.map","export const NodeShaderStage = {\n\tVERTEX: 'vertex',\n\tFRAGMENT: 'fragment'\n};\n\nexport const NodeUpdateType = {\n\tNONE: 'none',\n\tFRAME: 'frame',\n\tRENDER: 'render',\n\tOBJECT: 'object'\n};\n\nexport const NodeType = {\n\tBOOLEAN: 'bool',\n\tINTEGER: 'int',\n\tFLOAT: 'float',\n\tVECTOR2: 'vec2',\n\tVECTOR3: 'vec3',\n\tVECTOR4: 'vec4',\n\tMATRIX2: 'mat2',\n\tMATRIX3: 'mat3',\n\tMATRIX4: 'mat4'\n};\n\nexport const defaultShaderStages = [ 'fragment', 'vertex' ];\nexport const defaultBuildStages = [ 'setup', 'analyze', 'generate' ];\nexport const shaderStages = [ ...defaultShaderStages, 'compute' ];\nexport const vectorComponents = [ 'x', 'y', 'z', 'w' ];\n","import { Color, Matrix3, Matrix4, Vector2, Vector3, Vector4 } from 'three';\n\nexport function getCacheKey( object, force = false ) {\n\n\tlet cacheKey = '{';\n\n\tif ( object.isNode === true ) {\n\n\t\tcacheKey += object.id;\n\n\t}\n\n\tfor ( const { property, childNode } of getNodeChildren( object ) ) {\n\n\t\tcacheKey += ',' + property.slice( 0, - 4 ) + ':' + childNode.getCacheKey( force );\n\n\t}\n\n\tcacheKey += '}';\n\n\treturn cacheKey;\n\n}\n\nexport function* getNodeChildren( node, toJSON = false ) {\n\n\tfor ( const property in node ) {\n\n\t\t// Ignore private properties.\n\t\tif ( property.startsWith( '_' ) === true ) continue;\n\n\t\tconst object = node[ property ];\n\n\t\tif ( Array.isArray( object ) === true ) {\n\n\t\t\tfor ( let i = 0; i < object.length; i ++ ) {\n\n\t\t\t\tconst child = object[ i ];\n\n\t\t\t\tif ( child && ( child.isNode === true || toJSON && typeof child.toJSON === 'function' ) ) {\n\n\t\t\t\t\tyield { property, index: i, childNode: child };\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( object && object.isNode === true ) {\n\n\t\t\tyield { property, childNode: object };\n\n\t\t} else if ( typeof object === 'object' ) {\n\n\t\t\tfor ( const subProperty in object ) {\n\n\t\t\t\tconst child = object[ subProperty ];\n\n\t\t\t\tif ( child && ( child.isNode === true || toJSON && typeof child.toJSON === 'function' ) ) {\n\n\t\t\t\t\tyield { property, index: subProperty, childNode: child };\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nexport function getValueType( value ) {\n\n\tif ( value === undefined || value === null ) return null;\n\n\tconst typeOf = typeof value;\n\n\tif ( value.isNode === true ) {\n\n\t\treturn 'node';\n\n\t} else if ( typeOf === 'number' ) {\n\n\t\treturn 'float';\n\n\t} else if ( typeOf === 'boolean' ) {\n\n\t\treturn 'bool';\n\n\t} else if ( typeOf === 'string' ) {\n\n\t\treturn 'string';\n\n\t} else if ( typeOf === 'function' ) {\n\n\t\treturn 'shader';\n\n\t} else if ( value.isVector2 === true ) {\n\n\t\treturn 'vec2';\n\n\t} else if ( value.isVector3 === true ) {\n\n\t\treturn 'vec3';\n\n\t} else if ( value.isVector4 === true ) {\n\n\t\treturn 'vec4';\n\n\t} else if ( value.isMatrix3 === true ) {\n\n\t\treturn 'mat3';\n\n\t} else if ( value.isMatrix4 === true ) {\n\n\t\treturn 'mat4';\n\n\t} else if ( value.isColor === true ) {\n\n\t\treturn 'color';\n\n\t} else if ( value instanceof ArrayBuffer ) {\n\n\t\treturn 'ArrayBuffer';\n\n\t}\n\n\treturn null;\n\n}\n\nexport function getValueFromType( type, ...params ) {\n\n\tconst last4 = type ? type.slice( - 4 ) : undefined;\n\n\tif ( params.length === 1 ) { // ensure same behaviour as in NodeBuilder.format()\n\n\t\tif ( last4 === 'vec2' ) params = [ params[ 0 ], params[ 0 ] ];\n\t\telse if ( last4 === 'vec3' ) params = [ params[ 0 ], params[ 0 ], params[ 0 ] ];\n\t\telse if ( last4 === 'vec4' ) params = [ params[ 0 ], params[ 0 ], params[ 0 ], params[ 0 ] ];\n\n\t}\n\n\tif ( type === 'color' ) {\n\n\t\treturn new Color( ...params );\n\n\t} else if ( last4 === 'vec2' ) {\n\n\t\treturn new Vector2( ...params );\n\n\t} else if ( last4 === 'vec3' ) {\n\n\t\treturn new Vector3( ...params );\n\n\t} else if ( last4 === 'vec4' ) {\n\n\t\treturn new Vector4( ...params );\n\n\t} else if ( last4 === 'mat3' ) {\n\n\t\treturn new Matrix3( ...params );\n\n\t} else if ( last4 === 'mat4' ) {\n\n\t\treturn new Matrix4( ...params );\n\n\t} else if ( type === 'bool' ) {\n\n\t\treturn params[ 0 ] || false;\n\n\t} else if ( ( type === 'float' ) || ( type === 'int' ) || ( type === 'uint' ) ) {\n\n\t\treturn params[ 0 ] || 0;\n\n\t} else if ( type === 'string' ) {\n\n\t\treturn params[ 0 ] || '';\n\n\t} else if ( type === 'ArrayBuffer' ) {\n\n\t\treturn base64ToArrayBuffer( params[ 0 ] );\n\n\t}\n\n\treturn null;\n\n}\n\nexport function arrayBufferToBase64( arrayBuffer ) {\n\n\tlet chars = '';\n\n\tconst array = new Uint8Array( arrayBuffer );\n\n\tfor ( let i = 0; i < array.length; i ++ ) {\n\n\t\tchars += String.fromCharCode( array[ i ] );\n\n\t}\n\n\treturn btoa( chars );\n\n}\n\nexport function base64ToArrayBuffer( base64 ) {\n\n\treturn Uint8Array.from( atob( base64 ), c => c.charCodeAt( 0 ) ).buffer;\n\n}\n","import { EventDispatcher } from 'three';\nimport { NodeUpdateType } from './constants.js';\nimport { getNodeChildren, getCacheKey } from './NodeUtils.js';\nimport { MathUtils } from 'three';\n\nconst NodeClasses = new Map();\n\nlet _nodeId = 0;\n\nclass Node extends EventDispatcher {\n\n\tconstructor( nodeType = null ) {\n\n\t\tsuper();\n\n\t\tthis.nodeType = nodeType;\n\n\t\tthis.updateType = NodeUpdateType.NONE;\n\t\tthis.updateBeforeType = NodeUpdateType.NONE;\n\t\tthis.updateAfterType = NodeUpdateType.NONE;\n\n\t\tthis.uuid = MathUtils.generateUUID();\n\n\t\tthis.version = 0;\n\n\t\tthis._cacheKey = null;\n\t\tthis._cacheKeyVersion = 0;\n\n\t\tthis.global = false;\n\n\t\tthis.isNode = true;\n\n\t\tObject.defineProperty( this, 'id', { value: _nodeId ++ } );\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t}\n\n\tget type() {\n\n\t\treturn this.constructor.type;\n\n\t}\n\n\tonUpdate( callback, updateType ) {\n\n\t\tthis.updateType = updateType;\n\t\tthis.update = callback.bind( this.getSelf() );\n\n\t\treturn this;\n\n\t}\n\n\tonFrameUpdate( callback ) {\n\n\t\treturn this.onUpdate( callback, NodeUpdateType.FRAME );\n\n\t}\n\n\tonRenderUpdate( callback ) {\n\n\t\treturn this.onUpdate( callback, NodeUpdateType.RENDER );\n\n\t}\n\n\tonObjectUpdate( callback ) {\n\n\t\treturn this.onUpdate( callback, NodeUpdateType.OBJECT );\n\n\t}\n\n\tonReference( callback ) {\n\n\t\tthis.updateReference = callback.bind( this.getSelf() );\n\n\t\treturn this;\n\n\t}\n\n\tgetSelf() {\n\n\t\t// Returns non-node object.\n\n\t\treturn this.self || this;\n\n\t}\n\n\tupdateReference( /*state*/ ) {\n\n\t\treturn this;\n\n\t}\n\n\tisGlobal( /*builder*/ ) {\n\n\t\treturn this.global;\n\n\t}\n\n\t* getChildren() {\n\n\t\tfor ( const { childNode } of getNodeChildren( this ) ) {\n\n\t\t\tyield childNode;\n\n\t\t}\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n\ttraverse( callback ) {\n\n\t\tcallback( this );\n\n\t\tfor ( const childNode of this.getChildren() ) {\n\n\t\t\tchildNode.traverse( callback );\n\n\t\t}\n\n\t}\n\n\tgetCacheKey( force = false ) {\n\n\t\tforce = force || this.version !== this._cacheKeyVersion;\n\n\t\tif ( force === true || this._cacheKey === null ) {\n\n\t\t\tthis._cacheKey = getCacheKey( this, force );\n\t\t\tthis._cacheKeyVersion = this.version;\n\n\t\t}\n\n\t\treturn this._cacheKey;\n\n\t}\n\n\tgetHash( /*builder*/ ) {\n\n\t\treturn this.uuid;\n\n\t}\n\n\tgetUpdateType() {\n\n\t\treturn this.updateType;\n\n\t}\n\n\tgetUpdateBeforeType() {\n\n\t\treturn this.updateBeforeType;\n\n\t}\n\n\tgetUpdateAfterType() {\n\n\t\treturn this.updateAfterType;\n\n\t}\n\n\tgetElementType( builder ) {\n\n\t\tconst type = this.getNodeType( builder );\n\t\tconst elementType = builder.getElementType( type );\n\n\t\treturn elementType;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tconst nodeProperties = builder.getNodeProperties( this );\n\n\t\tif ( nodeProperties.outputNode ) {\n\n\t\t\treturn nodeProperties.outputNode.getNodeType( builder );\n\n\t\t}\n\n\t\treturn this.nodeType;\n\n\t}\n\n\tgetShared( builder ) {\n\n\t\tconst hash = this.getHash( builder );\n\t\tconst nodeFromHash = builder.getNodeFromHash( hash );\n\n\t\treturn nodeFromHash || this;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst nodeProperties = builder.getNodeProperties( this );\n\n\t\tlet index = 0;\n\n\t\tfor ( const childNode of this.getChildren() ) {\n\n\t\t\tnodeProperties[ 'node' + index ++ ] = childNode;\n\n\t\t}\n\n\t\t// return a outputNode if exists\n\t\treturn null;\n\n\t}\n\n\tconstruct( builder ) { // @deprecated, r157\n\n\t\tconsole.warn( 'THREE.Node: construct() is deprecated. Use setup() instead.' );\n\n\t\treturn this.setup( builder );\n\n\t}\n\n\tincreaseUsage( builder ) {\n\n\t\tconst nodeData = builder.getDataFromNode( this );\n\t\tnodeData.usageCount = nodeData.usageCount === undefined ? 1 : nodeData.usageCount + 1;\n\n\t\treturn nodeData.usageCount;\n\n\t}\n\n\tanalyze( builder ) {\n\n\t\tconst usageCount = this.increaseUsage( builder );\n\n\t\tif ( usageCount === 1 ) {\n\n\t\t\t// node flow children\n\n\t\t\tconst nodeProperties = builder.getNodeProperties( this );\n\n\t\t\tfor ( const childNode of Object.values( nodeProperties ) ) {\n\n\t\t\t\tif ( childNode && childNode.isNode === true ) {\n\n\t\t\t\t\tchildNode.build( builder );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst { outputNode } = builder.getNodeProperties( this );\n\n\t\tif ( outputNode && outputNode.isNode === true ) {\n\n\t\t\treturn outputNode.build( builder, output );\n\n\t\t}\n\n\t}\n\n\tupdateBefore( /*frame*/ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tupdateAfter( /*frame*/ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tupdate( /*frame*/ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tbuild( builder, output = null ) {\n\n\t\tconst refNode = this.getShared( builder );\n\n\t\tif ( this !== refNode ) {\n\n\t\t\treturn refNode.build( builder, output );\n\n\t\t}\n\n\t\tbuilder.addNode( this );\n\t\tbuilder.addChain( this );\n\n\t\t/* Build stages expected results:\n\t\t\t- \"setup\"\t\t-> Node\n\t\t\t- \"analyze\"\t\t-> null\n\t\t\t- \"generate\"\t-> String\n\t\t*/\n\t\tlet result = null;\n\n\t\tconst buildStage = builder.getBuildStage();\n\n\t\tif ( buildStage === 'setup' ) {\n\n\t\t\tthis.updateReference( builder );\n\n\t\t\tconst properties = builder.getNodeProperties( this );\n\n\t\t\tif ( properties.initialized !== true ) {\n\n\t\t\t\tconst stackNodesBeforeSetup = builder.stack.nodes.length;\n\n\t\t\t\tproperties.initialized = true;\n\t\t\t\tproperties.outputNode = this.setup( builder );\n\n\t\t\t\tif ( properties.outputNode !== null && builder.stack.nodes.length !== stackNodesBeforeSetup ) {\n\n\t\t\t\t\tproperties.outputNode = builder.stack;\n\n\t\t\t\t}\n\n\t\t\t\tfor ( const childNode of Object.values( properties ) ) {\n\n\t\t\t\t\tif ( childNode && childNode.isNode === true ) {\n\n\t\t\t\t\t\tchildNode.build( builder );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( buildStage === 'analyze' ) {\n\n\t\t\tthis.analyze( builder );\n\n\t\t} else if ( buildStage === 'generate' ) {\n\n\t\t\tconst isGenerateOnce = this.generate.length === 1;\n\n\t\t\tif ( isGenerateOnce ) {\n\n\t\t\t\tconst type = this.getNodeType( builder );\n\t\t\t\tconst nodeData = builder.getDataFromNode( this );\n\n\t\t\t\tresult = nodeData.snippet;\n\n\t\t\t\tif ( result === undefined ) {\n\n\t\t\t\t\tresult = this.generate( builder ) || '';\n\n\t\t\t\t\tnodeData.snippet = result;\n\n\t\t\t\t}\n\n\t\t\t\tresult = builder.format( result, type, output );\n\n\t\t\t} else {\n\n\t\t\t\tresult = this.generate( builder, output ) || '';\n\n\t\t\t}\n\n\t\t}\n\n\t\tbuilder.removeChain( this );\n\n\t\treturn result;\n\n\t}\n\n\tgetSerializeChildren() {\n\n\t\treturn getNodeChildren( this );\n\n\t}\n\n\tserialize( json ) {\n\n\t\tconst nodeChildren = this.getSerializeChildren();\n\n\t\tconst inputNodes = {};\n\n\t\tfor ( const { property, index, childNode } of nodeChildren ) {\n\n\t\t\tif ( index !== undefined ) {\n\n\t\t\t\tif ( inputNodes[ property ] === undefined ) {\n\n\t\t\t\t\tinputNodes[ property ] = Number.isInteger( index ) ? [] : {};\n\n\t\t\t\t}\n\n\t\t\t\tinputNodes[ property ][ index ] = childNode.toJSON( json.meta ).uuid;\n\n\t\t\t} else {\n\n\t\t\t\tinputNodes[ property ] = childNode.toJSON( json.meta ).uuid;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( Object.keys( inputNodes ).length > 0 ) {\n\n\t\t\tjson.inputNodes = inputNodes;\n\n\t\t}\n\n\t}\n\n\tdeserialize( json ) {\n\n\t\tif ( json.inputNodes !== undefined ) {\n\n\t\t\tconst nodes = json.meta.nodes;\n\n\t\t\tfor ( const property in json.inputNodes ) {\n\n\t\t\t\tif ( Array.isArray( json.inputNodes[ property ] ) ) {\n\n\t\t\t\t\tconst inputArray = [];\n\n\t\t\t\t\tfor ( const uuid of json.inputNodes[ property ] ) {\n\n\t\t\t\t\t\tinputArray.push( nodes[ uuid ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tthis[ property ] = inputArray;\n\n\t\t\t\t} else if ( typeof json.inputNodes[ property ] === 'object' ) {\n\n\t\t\t\t\tconst inputObject = {};\n\n\t\t\t\t\tfor ( const subProperty in json.inputNodes[ property ] ) {\n\n\t\t\t\t\t\tconst uuid = json.inputNodes[ property ][ subProperty ];\n\n\t\t\t\t\t\tinputObject[ subProperty ] = nodes[ uuid ];\n\n\t\t\t\t\t}\n\n\t\t\t\t\tthis[ property ] = inputObject;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconst uuid = json.inputNodes[ property ];\n\n\t\t\t\t\tthis[ property ] = nodes[ uuid ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst { uuid, type } = this;\n\t\tconst isRoot = ( meta === undefined || typeof meta === 'string' );\n\n\t\tif ( isRoot ) {\n\n\t\t\tmeta = {\n\t\t\t\ttextures: {},\n\t\t\t\timages: {},\n\t\t\t\tnodes: {}\n\t\t\t};\n\n\t\t}\n\n\t\t// serialize\n\n\t\tlet data = meta.nodes[ uuid ];\n\n\t\tif ( data === undefined ) {\n\n\t\t\tdata = {\n\t\t\t\tuuid,\n\t\t\t\ttype,\n\t\t\t\tmeta,\n\t\t\t\tmetadata: {\n\t\t\t\t\tversion: 4.6,\n\t\t\t\t\ttype: 'Node',\n\t\t\t\t\tgenerator: 'Node.toJSON'\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tif ( isRoot !== true ) meta.nodes[ data.uuid ] = data;\n\n\t\t\tthis.serialize( data );\n\n\t\t\tdelete data.meta;\n\n\t\t}\n\n\t\t// TODO: Copied from Object3D.toJSON\n\n\t\tfunction extractFromCache( cache ) {\n\n\t\t\tconst values = [];\n\n\t\t\tfor ( const key in cache ) {\n\n\t\t\t\tconst data = cache[ key ];\n\t\t\t\tdelete data.metadata;\n\t\t\t\tvalues.push( data );\n\n\t\t\t}\n\n\t\t\treturn values;\n\n\t\t}\n\n\t\tif ( isRoot ) {\n\n\t\t\tconst textures = extractFromCache( meta.textures );\n\t\t\tconst images = extractFromCache( meta.images );\n\t\t\tconst nodes = extractFromCache( meta.nodes );\n\n\t\t\tif ( textures.length > 0 ) data.textures = textures;\n\t\t\tif ( images.length > 0 ) data.images = images;\n\t\t\tif ( nodes.length > 0 ) data.nodes = nodes;\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n}\n\nexport default Node;\n\nexport function addNodeClass( type, nodeClass ) {\n\n\tif ( typeof nodeClass !== 'function' || ! type ) throw new Error( `Node class ${ type } is not a class` );\n\tif ( NodeClasses.has( type ) ) {\n\n\t\tconsole.warn( `Redefinition of node class ${ type }` );\n\t\treturn;\n\n\t}\n\n\tNodeClasses.set( type, nodeClass );\n\tnodeClass.type = type;\n\n}\n\nexport function createNodeFromType( type ) {\n\n\tconst Class = NodeClasses.get( type );\n\n\tif ( Class !== undefined ) {\n\n\t\treturn new Class();\n\n\t}\n\n}\n","import Node, { addNodeClass } from './Node.js';\n\nclass TempNode extends Node {\n\n\tconstructor( type ) {\n\n\t\tsuper( type );\n\n\t\tthis.isTempNode = true;\n\n\t}\n\n\thasDependencies( builder ) {\n\n\t\treturn builder.getDataFromNode( this ).usageCount > 1;\n\n\t}\n\n\tbuild( builder, output ) {\n\n\t\tconst buildStage = builder.getBuildStage();\n\n\t\tif ( buildStage === 'generate' ) {\n\n\t\t\tconst type = builder.getVectorType( this.getNodeType( builder, output ) );\n\t\t\tconst nodeData = builder.getDataFromNode( this );\n\n\t\t\tif ( nodeData.propertyName !== undefined ) {\n\n\t\t\t\treturn builder.format( nodeData.propertyName, type, output );\n\n\t\t\t} else if ( type !== 'void' && output !== 'void' && this.hasDependencies( builder ) ) {\n\n\t\t\t\tconst snippet = super.build( builder, type );\n\n\t\t\t\tconst nodeVar = builder.getVarFromNode( this, null, type );\n\t\t\t\tconst propertyName = builder.getPropertyName( nodeVar );\n\n\t\t\t\tbuilder.addLineFlowCode( `${propertyName} = ${snippet}` );\n\n\t\t\t\tnodeData.snippet = snippet;\n\t\t\t\tnodeData.propertyName = propertyName;\n\n\t\t\t\treturn builder.format( nodeData.propertyName, type, output );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn super.build( builder, output );\n\n\t}\n\n}\n\nexport default TempNode;\n\naddNodeClass( 'TempNode', TempNode );\n","import Node, { addNodeClass } from '../core/Node.js';\n\nclass ArrayElementNode extends Node { // @TODO: If extending from TempNode it breaks webgpu_compute\n\n\tconstructor( node, indexNode ) {\n\n\t\tsuper();\n\n\t\tthis.node = node;\n\t\tthis.indexNode = indexNode;\n\n\t\tthis.isArrayElementNode = true;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.node.getElementType( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst nodeSnippet = this.node.build( builder );\n\t\tconst indexSnippet = this.indexNode.build( builder, 'uint' );\n\n\t\treturn `${nodeSnippet}[ ${indexSnippet} ]`;\n\n\t}\n\n}\n\nexport default ArrayElementNode;\n\naddNodeClass( 'ArrayElementNode', ArrayElementNode );\n","import Node, { addNodeClass } from '../core/Node.js';\n\nclass ConvertNode extends Node {\n\n\tconstructor( node, convertTo ) {\n\n\t\tsuper();\n\n\t\tthis.node = node;\n\t\tthis.convertTo = convertTo;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tconst requestType = this.node.getNodeType( builder );\n\n\t\tlet convertTo = null;\n\n\t\tfor ( const overloadingType of this.convertTo.split( '|' ) ) {\n\n\t\t\tif ( convertTo === null || builder.getTypeLength( requestType ) === builder.getTypeLength( overloadingType ) ) {\n\n\t\t\t\tconvertTo = overloadingType;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn convertTo;\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.convertTo = this.convertTo;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.convertTo = data.convertTo;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst node = this.node;\n\t\tconst type = this.getNodeType( builder );\n\n\t\tconst snippet = node.build( builder, type );\n\n\t\treturn builder.format( snippet, type, output );\n\n\t}\n\n}\n\nexport default ConvertNode;\n\naddNodeClass( 'ConvertNode', ConvertNode );\n","import { addNodeClass } from '../core/Node.js';\nimport TempNode from '../core/TempNode.js';\n\nclass JoinNode extends TempNode {\n\n\tconstructor( nodes = [], nodeType = null ) {\n\n\t\tsuper( nodeType );\n\n\t\tthis.nodes = nodes;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tif ( this.nodeType !== null ) {\n\n\t\t\treturn builder.getVectorType( this.nodeType );\n\n\t\t}\n\n\t\treturn builder.getTypeFromLength( this.nodes.reduce( ( count, cur ) => count + builder.getTypeLength( cur.getNodeType( builder ) ), 0 ) );\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst type = this.getNodeType( builder );\n\t\tconst nodes = this.nodes;\n\n\t\tconst primitiveType = builder.getComponentType( type );\n\n\t\tconst snippetValues = [];\n\n\t\tfor ( const input of nodes ) {\n\n\t\t\tlet inputSnippet = input.build( builder );\n\n\t\t\tconst inputPrimitiveType = builder.getComponentType( input.getNodeType( builder ) );\n\n\t\t\tif ( inputPrimitiveType !== primitiveType ) {\n\n\t\t\t\tinputSnippet = builder.format( inputSnippet, inputPrimitiveType, primitiveType );\n\n\t\t\t}\n\n\t\t\tsnippetValues.push( inputSnippet );\n\n\t\t}\n\n\t\tconst snippet = `${ builder.getType( type ) }( ${ snippetValues.join( ', ' ) } )`;\n\n\t\treturn builder.format( snippet, type, output );\n\n\t}\n\n}\n\nexport default JoinNode;\n\naddNodeClass( 'JoinNode', JoinNode );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { vectorComponents } from '../core/constants.js';\n\nconst stringVectorComponents = vectorComponents.join( '' );\n\nclass SplitNode extends Node {\n\n\tconstructor( node, components = 'x' ) {\n\n\t\tsuper();\n\n\t\tthis.node = node;\n\t\tthis.components = components;\n\n\t\tthis.isSplitNode = true;\n\n\t}\n\n\tgetVectorLength() {\n\n\t\tlet vectorLength = this.components.length;\n\n\t\tfor ( const c of this.components ) {\n\n\t\t\tvectorLength = Math.max( vectorComponents.indexOf( c ) + 1, vectorLength );\n\n\t\t}\n\n\t\treturn vectorLength;\n\n\t}\n\n\tgetComponentType( builder ) {\n\n\t\treturn builder.getComponentType( this.node.getNodeType( builder ) );\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn builder.getTypeFromLength( this.components.length, this.getComponentType( builder ) );\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst node = this.node;\n\t\tconst nodeTypeLength = builder.getTypeLength( node.getNodeType( builder ) );\n\n\t\tlet snippet = null;\n\n\t\tif ( nodeTypeLength > 1 ) {\n\n\t\t\tlet type = null;\n\n\t\t\tconst componentsLength = this.getVectorLength();\n\n\t\t\tif ( componentsLength >= nodeTypeLength ) {\n\n\t\t\t\t// needed expand the input node\n\n\t\t\t\ttype = builder.getTypeFromLength( this.getVectorLength(), this.getComponentType( builder ) );\n\n\t\t\t}\n\n\t\t\tconst nodeSnippet = node.build( builder, type );\n\n\t\t\tif ( this.components.length === nodeTypeLength && this.components === stringVectorComponents.slice( 0, this.components.length ) ) {\n\n\t\t\t\t// unnecessary swizzle\n\n\t\t\t\tsnippet = builder.format( nodeSnippet, type, output );\n\n\t\t\t} else {\n\n\t\t\t\tsnippet = builder.format( `${nodeSnippet}.${this.components}`, this.getNodeType( builder ), output );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// ignore .components if .node returns float/integer\n\n\t\t\tsnippet = node.build( builder, output );\n\n\t\t}\n\n\t\treturn snippet;\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.components = this.components;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.components = data.components;\n\n\t}\n\n}\n\nexport default SplitNode;\n\naddNodeClass( 'SplitNode', SplitNode );\n","import { addNodeClass } from '../core/Node.js';\nimport TempNode from '../core/TempNode.js';\nimport { vectorComponents } from '../core/constants.js';\n\nclass SetNode extends TempNode {\n\n\tconstructor( sourceNode, components, targetNode ) {\n\n\t\tsuper();\n\n\t\tthis.sourceNode = sourceNode;\n\t\tthis.components = components;\n\t\tthis.targetNode = targetNode;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.sourceNode.getNodeType( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst { sourceNode, components, targetNode } = this;\n\n\t\tconst sourceType = this.getNodeType( builder );\n\t\tconst targetType = builder.getTypeFromLength( components.length );\n\n\t\tconst targetSnippet = targetNode.build( builder, targetType );\n\t\tconst sourceSnippet = sourceNode.build( builder, sourceType );\n\n\t\tconst length = builder.getTypeLength( sourceType );\n\t\tconst snippetValues = [];\n\n\t\tfor ( let i = 0; i < length; i ++ ) {\n\n\t\t\tconst component = vectorComponents[ i ];\n\n\t\t\tif ( component === components[ 0 ] ) {\n\n\t\t\t\tsnippetValues.push( targetSnippet );\n\n\t\t\t\ti += components.length - 1;\n\n\t\t\t} else {\n\n\t\t\t\tsnippetValues.push( sourceSnippet + '.' + component );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn `${ builder.getType( sourceType ) }( ${ snippetValues.join( ', ' ) } )`;\n\n\t}\n\n}\n\nexport default SetNode;\n\naddNodeClass( 'SetNode', SetNode );\n","import Node, { addNodeClass } from './Node.js';\nimport { getValueType, getValueFromType, arrayBufferToBase64 } from './NodeUtils.js';\n\nclass InputNode extends Node {\n\n\tconstructor( value, nodeType = null ) {\n\n\t\tsuper( nodeType );\n\n\t\tthis.isInputNode = true;\n\n\t\tthis.value = value;\n\t\tthis.precision = null;\n\n\t}\n\n\tgetNodeType( /*builder*/ ) {\n\n\t\tif ( this.nodeType === null ) {\n\n\t\t\treturn getValueType( this.value );\n\n\t\t}\n\n\t\treturn this.nodeType;\n\n\t}\n\n\tgetInputType( builder ) {\n\n\t\treturn this.getNodeType( builder );\n\n\t}\n\n\tsetPrecision( precision ) {\n\n\t\tthis.precision = precision;\n\n\t\treturn this;\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.value = this.value;\n\n\t\tif ( this.value && this.value.toArray ) data.value = this.value.toArray();\n\n\t\tdata.valueType = getValueType( this.value );\n\t\tdata.nodeType = this.nodeType;\n\n\t\tif ( data.valueType === 'ArrayBuffer' ) data.value = arrayBufferToBase64( data.value );\n\n\t\tdata.precision = this.precision;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.nodeType = data.nodeType;\n\t\tthis.value = Array.isArray( data.value ) ? getValueFromType( data.valueType, ...data.value ) : data.value;\n\n\t\tthis.precision = data.precision || null;\n\n\t\tif ( this.value && this.value.fromArray ) this.value = this.value.fromArray( data.value );\n\n\t}\n\n\tgenerate( /*builder, output*/ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n}\n\nexport default InputNode;\n\naddNodeClass( 'InputNode', InputNode );\n","import InputNode from './InputNode.js';\nimport { addNodeClass } from './Node.js';\n\nclass ConstNode extends InputNode {\n\n\tconstructor( value, nodeType = null ) {\n\n\t\tsuper( value, nodeType );\n\n\t\tthis.isConstNode = true;\n\n\t}\n\n\tgenerateConst( builder ) {\n\n\t\treturn builder.generateConst( this.getNodeType( builder ), this.value );\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst type = this.getNodeType( builder );\n\n\t\treturn builder.format( this.generateConst( builder ), type, output );\n\n\t}\n\n}\n\nexport default ConstNode;\n\naddNodeClass( 'ConstNode', ConstNode );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport ArrayElementNode from '../utils/ArrayElementNode.js';\nimport ConvertNode from '../utils/ConvertNode.js';\nimport JoinNode from '../utils/JoinNode.js';\nimport SplitNode from '../utils/SplitNode.js';\nimport SetNode from '../utils/SetNode.js';\nimport ConstNode from '../core/ConstNode.js';\nimport { getValueFromType, getValueType } from '../core/NodeUtils.js';\n\n//\n\nlet currentStack = null;\n\nconst NodeElements = new Map(); // @TODO: Currently only a few nodes are added, probably also add others\n\nexport function addNodeElement( name, nodeElement ) {\n\n\tif ( NodeElements.has( name ) ) {\n\n\t\tconsole.warn( `Redefinition of node element ${ name }` );\n\t\treturn;\n\n\t}\n\n\tif ( typeof nodeElement !== 'function' ) throw new Error( `Node element ${ name } is not a function` );\n\n\tNodeElements.set( name, nodeElement );\n\n}\n\nconst parseSwizzle = ( props ) => props.replace( /r|s/g, 'x' ).replace( /g|t/g, 'y' ).replace( /b|p/g, 'z' ).replace( /a|q/g, 'w' );\n\nconst shaderNodeHandler = {\n\n\tsetup( NodeClosure, params ) {\n\n\t\tconst inputs = params.shift();\n\n\t\treturn NodeClosure( nodeObjects( inputs ), ...params );\n\n\t},\n\n\tget( node, prop, nodeObj ) {\n\n\t\tif ( typeof prop === 'string' && node[ prop ] === undefined ) {\n\n\t\t\tif ( node.isStackNode !== true && prop === 'assign' ) {\n\n\t\t\t\treturn ( ...params ) => {\n\n\t\t\t\t\tcurrentStack.assign( nodeObj, ...params );\n\n\t\t\t\t\treturn nodeObj;\n\n\t\t\t\t};\n\n\t\t\t} else if ( NodeElements.has( prop ) ) {\n\n\t\t\t\tconst nodeElement = NodeElements.get( prop );\n\n\t\t\t\treturn node.isStackNode ? ( ...params ) => nodeObj.add( nodeElement( ...params ) ) : ( ...params ) => nodeElement( nodeObj, ...params );\n\n\t\t\t} else if ( prop === 'self' ) {\n\n\t\t\t\treturn node;\n\n\t\t\t} else if ( prop.endsWith( 'Assign' ) && NodeElements.has( prop.slice( 0, prop.length - 'Assign'.length ) ) ) {\n\n\t\t\t\tconst nodeElement = NodeElements.get( prop.slice( 0, prop.length - 'Assign'.length ) );\n\n\t\t\t\treturn node.isStackNode ? ( ...params ) => nodeObj.assign( params[ 0 ], nodeElement( ...params ) ) : ( ...params ) => nodeObj.assign( nodeElement( nodeObj, ...params ) );\n\n\t\t\t} else if ( /^[xyzwrgbastpq]{1,4}$/.test( prop ) === true ) {\n\n\t\t\t\t// accessing properties ( swizzle )\n\n\t\t\t\tprop = parseSwizzle( prop );\n\n\t\t\t\treturn nodeObject( new SplitNode( nodeObj, prop ) );\n\n\t\t\t} else if ( /^set[XYZWRGBASTPQ]{1,4}$/.test( prop ) === true ) {\n\n\t\t\t\t// set properties ( swizzle )\n\n\t\t\t\tprop = parseSwizzle( prop.slice( 3 ).toLowerCase() );\n\n\t\t\t\t// sort to xyzw sequence\n\n\t\t\t\tprop = prop.split( '' ).sort().join( '' );\n\n\t\t\t\treturn ( value ) => nodeObject( new SetNode( node, prop, value ) );\n\n\t\t\t} else if ( prop === 'width' || prop === 'height' || prop === 'depth' ) {\n\n\t\t\t\t// accessing property\n\n\t\t\t\tif ( prop === 'width' ) prop = 'x';\n\t\t\t\telse if ( prop === 'height' ) prop = 'y';\n\t\t\t\telse if ( prop === 'depth' ) prop = 'z';\n\n\t\t\t\treturn nodeObject( new SplitNode( node, prop ) );\n\n\t\t\t} else if ( /^\\d+$/.test( prop ) === true ) {\n\n\t\t\t\t// accessing array\n\n\t\t\t\treturn nodeObject( new ArrayElementNode( nodeObj, new ConstNode( Number( prop ), 'uint' ) ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Reflect.get( node, prop, nodeObj );\n\n\t},\n\n\tset( node, prop, value, nodeObj ) {\n\n\t\tif ( typeof prop === 'string' && node[ prop ] === undefined ) {\n\n\t\t\t// setting properties\n\n\t\t\tif ( /^[xyzwrgbastpq]{1,4}$/.test( prop ) === true || prop === 'width' || prop === 'height' || prop === 'depth' || /^\\d+$/.test( prop ) === true ) {\n\n\t\t\t\tnodeObj[ prop ].assign( value );\n\n\t\t\t\treturn true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Reflect.set( node, prop, value, nodeObj );\n\n\t}\n\n};\n\nconst nodeObjectsCacheMap = new WeakMap();\nconst nodeBuilderFunctionsCacheMap = new WeakMap();\n\nconst ShaderNodeObject = function ( obj, altType = null ) {\n\n\tconst type = getValueType( obj );\n\n\tif ( type === 'node' ) {\n\n\t\tlet nodeObject = nodeObjectsCacheMap.get( obj );\n\n\t\tif ( nodeObject === undefined ) {\n\n\t\t\tnodeObject = new Proxy( obj, shaderNodeHandler );\n\n\t\t\tnodeObjectsCacheMap.set( obj, nodeObject );\n\t\t\tnodeObjectsCacheMap.set( nodeObject, nodeObject );\n\n\t\t}\n\n\t\treturn nodeObject;\n\n\t} else if ( ( altType === null && ( type === 'float' || type === 'boolean' ) ) || ( type && type !== 'shader' && type !== 'string' ) ) {\n\n\t\treturn nodeObject( getConstNode( obj, altType ) );\n\n\t} else if ( type === 'shader' ) {\n\n\t\treturn tslFn( obj );\n\n\t}\n\n\treturn obj;\n\n};\n\nconst ShaderNodeObjects = function ( objects, altType = null ) {\n\n\tfor ( const name in objects ) {\n\n\t\tobjects[ name ] = nodeObject( objects[ name ], altType );\n\n\t}\n\n\treturn objects;\n\n};\n\nconst ShaderNodeArray = function ( array, altType = null ) {\n\n\tconst len = array.length;\n\n\tfor ( let i = 0; i < len; i ++ ) {\n\n\t\tarray[ i ] = nodeObject( array[ i ], altType );\n\n\t}\n\n\treturn array;\n\n};\n\nconst ShaderNodeProxy = function ( NodeClass, scope = null, factor = null, settings = null ) {\n\n\tconst assignNode = ( node ) => nodeObject( settings !== null ? Object.assign( node, settings ) : node );\n\n\tif ( scope === null ) {\n\n\t\treturn ( ...params ) => {\n\n\t\t\treturn assignNode( new NodeClass( ...nodeArray( params ) ) );\n\n\t\t};\n\n\t} else if ( factor !== null ) {\n\n\t\tfactor = nodeObject( factor );\n\n\t\treturn ( ...params ) => {\n\n\t\t\treturn assignNode( new NodeClass( scope, ...nodeArray( params ), factor ) );\n\n\t\t};\n\n\t} else {\n\n\t\treturn ( ...params ) => {\n\n\t\t\treturn assignNode( new NodeClass( scope, ...nodeArray( params ) ) );\n\n\t\t};\n\n\t}\n\n};\n\nconst ShaderNodeImmutable = function ( NodeClass, ...params ) {\n\n\treturn nodeObject( new NodeClass( ...nodeArray( params ) ) );\n\n};\n\nclass ShaderCallNodeInternal extends Node {\n\n\tconstructor( shaderNode, inputNodes ) {\n\n\t\tsuper();\n\n\t\tthis.shaderNode = shaderNode;\n\t\tthis.inputNodes = inputNodes;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tconst properties = builder.getNodeProperties( this );\n\n\t\tif ( properties.outputNode === null ) {\n\n\t\t\tproperties.outputNode = this.setupOutput( builder );\n\n\t\t}\n\n\t\treturn properties.outputNode.getNodeType( builder );\n\n\t}\n\n\tcall( builder ) {\n\n\t\tconst { shaderNode, inputNodes } = this;\n\n\t\tif ( shaderNode.layout ) {\n\n\t\t\tlet functionNodesCacheMap = nodeBuilderFunctionsCacheMap.get( builder.constructor );\n\n\t\t\tif ( functionNodesCacheMap === undefined ) {\n\n\t\t\t\tfunctionNodesCacheMap = new WeakMap();\n\n\t\t\t\tnodeBuilderFunctionsCacheMap.set( builder.constructor, functionNodesCacheMap );\n\n\t\t\t}\n\n\t\t\tlet functionNode = functionNodesCacheMap.get( shaderNode );\n\n\t\t\tif ( functionNode === undefined ) {\n\n\t\t\t\tfunctionNode = nodeObject( builder.buildFunctionNode( shaderNode ) );\n\n\t\t\t\tfunctionNodesCacheMap.set( shaderNode, functionNode );\n\n\t\t\t}\n\n\t\t\tif ( builder.currentFunctionNode !== null ) {\n\n\t\t\t\tbuilder.currentFunctionNode.includes.push( functionNode );\n\n\t\t\t}\n\n\t\t\treturn nodeObject( functionNode.call( inputNodes ) );\n\n\t\t}\n\n\t\tconst jsFunc = shaderNode.jsFunc;\n\t\tconst outputNode = inputNodes !== null ? jsFunc( inputNodes, builder.stack, builder ) : jsFunc( builder.stack, builder );\n\n\t\treturn nodeObject( outputNode );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst { outputNode } = builder.getNodeProperties( this );\n\n\t\treturn outputNode || this.setupOutput( builder );\n\n\t}\n\n\tsetupOutput( builder ) {\n\n\t\tbuilder.addStack();\n\n\t\tbuilder.stack.outputNode = this.call( builder );\n\n\t\treturn builder.removeStack();\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst { outputNode } = builder.getNodeProperties( this );\n\n\t\tif ( outputNode === null ) {\n\n\t\t\t// TSL: It's recommended to use `tslFn` in setup() pass.\n\n\t\t\treturn this.call( builder ).build( builder, output );\n\n\t\t}\n\n\t\treturn super.generate( builder, output );\n\n\t}\n\n}\n\nclass ShaderNodeInternal extends Node {\n\n\tconstructor( jsFunc ) {\n\n\t\tsuper();\n\n\t\tthis.jsFunc = jsFunc;\n\t\tthis.layout = null;\n\n\t\tthis.global = true;\n\n\t}\n\n\tget isArrayInput() {\n\n\t\treturn /^\\((\\s+)?\\[/.test( this.jsFunc.toString() );\n\n\t}\n\n\tsetLayout( layout ) {\n\n\t\tthis.layout = layout;\n\n\t\treturn this;\n\n\t}\n\n\tcall( inputs = null ) {\n\n\t\tnodeObjects( inputs );\n\n\t\treturn nodeObject( new ShaderCallNodeInternal( this, inputs ) );\n\n\t}\n\n\tsetup() {\n\n\t\treturn this.call();\n\n\t}\n\n}\n\nconst bools = [ false, true ];\nconst uints = [ 0, 1, 2, 3 ];\nconst ints = [ - 1, - 2 ];\nconst floats = [ 0.5, 1.5, 1 / 3, 1e-6, 1e6, Math.PI, Math.PI * 2, 1 / Math.PI, 2 / Math.PI, 1 / ( Math.PI * 2 ), Math.PI / 2 ];\n\nconst boolsCacheMap = new Map();\nfor ( const bool of bools ) boolsCacheMap.set( bool, new ConstNode( bool ) );\n\nconst uintsCacheMap = new Map();\nfor ( const uint of uints ) uintsCacheMap.set( uint, new ConstNode( uint, 'uint' ) );\n\nconst intsCacheMap = new Map( [ ...uintsCacheMap ].map( el => new ConstNode( el.value, 'int' ) ) );\nfor ( const int of ints ) intsCacheMap.set( int, new ConstNode( int, 'int' ) );\n\nconst floatsCacheMap = new Map( [ ...intsCacheMap ].map( el => new ConstNode( el.value ) ) );\nfor ( const float of floats ) floatsCacheMap.set( float, new ConstNode( float ) );\nfor ( const float of floats ) floatsCacheMap.set( - float, new ConstNode( - float ) );\n\nconst cacheMaps = { bool: boolsCacheMap, uint: uintsCacheMap, ints: intsCacheMap, float: floatsCacheMap };\n\nconst constNodesCacheMap = new Map( [ ...boolsCacheMap, ...floatsCacheMap ] );\n\nconst getConstNode = ( value, type ) => {\n\n\tif ( constNodesCacheMap.has( value ) ) {\n\n\t\treturn constNodesCacheMap.get( value );\n\n\t} else if ( value.isNode === true ) {\n\n\t\treturn value;\n\n\t} else {\n\n\t\treturn new ConstNode( value, type );\n\n\t}\n\n};\n\nconst safeGetNodeType = ( node ) => {\n\n\ttry {\n\n\t\treturn node.getNodeType();\n\n\t} catch ( _ ) {\n\n\t\treturn undefined;\n\n\t}\n\n};\n\nconst ConvertType = function ( type, cacheMap = null ) {\n\n\treturn ( ...params ) => {\n\n\t\tif ( params.length === 0 || ( ! [ 'bool', 'float', 'int', 'uint' ].includes( type ) && params.every( param => typeof param !== 'object' ) ) ) {\n\n\t\t\tparams = [ getValueFromType( type, ...params ) ];\n\n\t\t}\n\n\t\tif ( params.length === 1 && cacheMap !== null && cacheMap.has( params[ 0 ] ) ) {\n\n\t\t\treturn nodeObject( cacheMap.get( params[ 0 ] ) );\n\n\t\t}\n\n\t\tif ( params.length === 1 ) {\n\n\t\t\tconst node = getConstNode( params[ 0 ], type );\n\t\t\tif ( safeGetNodeType( node ) === type ) return nodeObject( node );\n\t\t\treturn nodeObject( new ConvertNode( node, type ) );\n\n\t\t}\n\n\t\tconst nodes = params.map( param => getConstNode( param ) );\n\t\treturn nodeObject( new JoinNode( nodes, type ) );\n\n\t};\n\n};\n\n// exports\n\nexport const defined = ( value ) => value && value.value;\n\n// utils\n\nexport const getConstNodeType = ( value ) => ( value !== undefined && value !== null ) ? ( value.nodeType || value.convertTo || ( typeof value === 'string' ? value : null ) ) : null;\n\n// shader node base\n\nexport function ShaderNode( jsFunc ) {\n\n\treturn new Proxy( new ShaderNodeInternal( jsFunc ), shaderNodeHandler );\n\n}\n\nexport const nodeObject = ( val, altType = null ) => /* new */ ShaderNodeObject( val, altType );\nexport const nodeObjects = ( val, altType = null ) => new ShaderNodeObjects( val, altType );\nexport const nodeArray = ( val, altType = null ) => new ShaderNodeArray( val, altType );\nexport const nodeProxy = ( ...params ) => new ShaderNodeProxy( ...params );\nexport const nodeImmutable = ( ...params ) => new ShaderNodeImmutable( ...params );\n\nexport const tslFn = ( jsFunc ) => {\n\n\tconst shaderNode = new ShaderNode( jsFunc );\n\n\tconst fn = ( ...params ) => {\n\n\t\tlet inputs;\n\n\t\tnodeObjects( params );\n\n\t\tif ( params[ 0 ] && params[ 0 ].isNode ) {\n\n\t\t\tinputs = [ ...params ];\n\n\t\t} else {\n\n\t\t\tinputs = params[ 0 ];\n\n\t\t}\n\n\t\treturn shaderNode.call( inputs );\n\n\t};\n\n\tfn.shaderNode = shaderNode;\n\tfn.setLayout = ( layout ) => {\n\n\t\tshaderNode.setLayout( layout );\n\n\t\treturn fn;\n\n\t};\n\n\treturn fn;\n\n};\n\naddNodeClass( 'ShaderNode', ShaderNode );\n\n//\n\naddNodeElement( 'toGlobal', ( node ) => {\n\n\tnode.global = true;\n\n\treturn node;\n\n} );\n\n//\n\nexport const setCurrentStack = ( stack ) => {\n\n\tif ( currentStack === stack ) {\n\n\t\t//throw new Error( 'Stack already defined.' );\n\n\t}\n\n\tcurrentStack = stack;\n\n};\n\nexport const getCurrentStack = () => currentStack;\n\nexport const If = ( ...params ) => currentStack.if( ...params );\n\nexport function append( node ) {\n\n\tif ( currentStack ) currentStack.add( node );\n\n\treturn node;\n\n}\n\naddNodeElement( 'append', append );\n\n// types\n// @TODO: Maybe export from ConstNode.js?\n\nexport const color = new ConvertType( 'color' );\n\nexport const float = new ConvertType( 'float', cacheMaps.float );\nexport const int = new ConvertType( 'int', cacheMaps.ints );\nexport const uint = new ConvertType( 'uint', cacheMaps.uint );\nexport const bool = new ConvertType( 'bool', cacheMaps.bool );\n\nexport const vec2 = new ConvertType( 'vec2' );\nexport const ivec2 = new ConvertType( 'ivec2' );\nexport const uvec2 = new ConvertType( 'uvec2' );\nexport const bvec2 = new ConvertType( 'bvec2' );\n\nexport const vec3 = new ConvertType( 'vec3' );\nexport const ivec3 = new ConvertType( 'ivec3' );\nexport const uvec3 = new ConvertType( 'uvec3' );\nexport const bvec3 = new ConvertType( 'bvec3' );\n\nexport const vec4 = new ConvertType( 'vec4' );\nexport const ivec4 = new ConvertType( 'ivec4' );\nexport const uvec4 = new ConvertType( 'uvec4' );\nexport const bvec4 = new ConvertType( 'bvec4' );\n\nexport const mat2 = new ConvertType( 'mat2' );\nexport const imat2 = new ConvertType( 'imat2' );\nexport const umat2 = new ConvertType( 'umat2' );\nexport const bmat2 = new ConvertType( 'bmat2' );\n\nexport const mat3 = new ConvertType( 'mat3' );\nexport const imat3 = new ConvertType( 'imat3' );\nexport const umat3 = new ConvertType( 'umat3' );\nexport const bmat3 = new ConvertType( 'bmat3' );\n\nexport const mat4 = new ConvertType( 'mat4' );\nexport const imat4 = new ConvertType( 'imat4' );\nexport const umat4 = new ConvertType( 'umat4' );\nexport const bmat4 = new ConvertType( 'bmat4' );\n\nexport const string = ( value = '' ) => nodeObject( new ConstNode( value, 'string' ) );\nexport const arrayBuffer = ( value ) => nodeObject( new ConstNode( value, 'ArrayBuffer' ) );\n\naddNodeElement( 'toColor', color );\naddNodeElement( 'toFloat', float );\naddNodeElement( 'toInt', int );\naddNodeElement( 'toUint', uint );\naddNodeElement( 'toBool', bool );\naddNodeElement( 'toVec2', vec2 );\naddNodeElement( 'toIvec2', ivec2 );\naddNodeElement( 'toUvec2', uvec2 );\naddNodeElement( 'toBvec2', bvec2 );\naddNodeElement( 'toVec3', vec3 );\naddNodeElement( 'toIvec3', ivec3 );\naddNodeElement( 'toUvec3', uvec3 );\naddNodeElement( 'toBvec3', bvec3 );\naddNodeElement( 'toVec4', vec4 );\naddNodeElement( 'toIvec4', ivec4 );\naddNodeElement( 'toUvec4', uvec4 );\naddNodeElement( 'toBvec4', bvec4 );\naddNodeElement( 'toMat2', mat2 );\naddNodeElement( 'toImat2', imat2 );\naddNodeElement( 'toUmat2', umat2 );\naddNodeElement( 'toBmat2', bmat2 );\naddNodeElement( 'toMat3', mat3 );\naddNodeElement( 'toImat3', imat3 );\naddNodeElement( 'toUmat3', umat3 );\naddNodeElement( 'toBmat3', bmat3 );\naddNodeElement( 'toMat4', mat4 );\naddNodeElement( 'toImat4', imat4 );\naddNodeElement( 'toUmat4', umat4 );\naddNodeElement( 'toBmat4', bmat4 );\n\n// basic nodes\n// HACK - we cannot export them from the corresponding files because of the cyclic dependency\nexport const element = nodeProxy( ArrayElementNode );\nexport const convert = ( node, types ) => nodeObject( new ConvertNode( nodeObject( node ), types ) );\nexport const split = ( node, channels ) => nodeObject( new SplitNode( nodeObject( node ), channels ) );\n\naddNodeElement( 'element', element );\naddNodeElement( 'convert', convert );\n","import { addNodeClass } from '../core/Node.js';\nimport TempNode from '../core/TempNode.js';\nimport { addNodeElement, nodeProxy } from '../shadernode/ShaderNode.js';\nimport { vectorComponents } from '../core/constants.js';\n\nclass AssignNode extends TempNode {\n\n\tconstructor( targetNode, sourceNode ) {\n\n\t\tsuper();\n\n\t\tthis.targetNode = targetNode;\n\t\tthis.sourceNode = sourceNode;\n\n\t}\n\n\thasDependencies() {\n\n\t\treturn false;\n\n\t}\n\n\tgetNodeType( builder, output ) {\n\n\t\treturn output !== 'void' ? this.targetNode.getNodeType( builder ) : 'void';\n\n\t}\n\n\tneedsSplitAssign( builder ) {\n\n\t\tconst { targetNode } = this;\n\n\t\tif ( builder.isAvailable( 'swizzleAssign' ) === false && targetNode.isSplitNode && targetNode.components.length > 1 ) {\n\n\t\t\tconst targetLength = builder.getTypeLength( targetNode.node.getNodeType( builder ) );\n\t\t\tconst assignDiferentVector = vectorComponents.join( '' ).slice( 0, targetLength ) !== targetNode.components;\n\n\t\t\treturn assignDiferentVector;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst { targetNode, sourceNode } = this;\n\n\t\tconst needsSplitAssign = this.needsSplitAssign( builder );\n\n\t\tconst targetType = targetNode.getNodeType( builder );\n\n\t\tconst target = targetNode.context( { assign: true } ).build( builder );\n\t\tconst source = sourceNode.build( builder, targetType );\n\n\t\tconst sourceType = sourceNode.getNodeType( builder );\n\n\t\tconst nodeData = builder.getDataFromNode( this );\n\n\t\t//\n\n\t\tlet snippet;\n\n\t\tif ( nodeData.initialized === true ) {\n\n\t\t\tif ( output !== 'void' ) {\n\n\t\t\t\tsnippet = target;\n\n\t\t\t}\n\n\t\t} else if ( needsSplitAssign ) {\n\n\t\t\tconst sourceVar = builder.getVarFromNode( this, null, targetType );\n\t\t\tconst sourceProperty = builder.getPropertyName( sourceVar );\n\n\t\t\tbuilder.addLineFlowCode( `${ sourceProperty } = ${ source }` );\n\n\t\t\tconst targetRoot = targetNode.node.context( { assign: true } ).build( builder );\n\n\t\t\tfor ( let i = 0; i < targetNode.components.length; i ++ ) {\n\n\t\t\t\tconst component = targetNode.components[ i ];\n\n\t\t\t\tbuilder.addLineFlowCode( `${ targetRoot }.${ component } = ${ sourceProperty }[ ${ i } ]` );\n\n\t\t\t}\n\n\t\t\tif ( output !== 'void' ) {\n\n\t\t\t\tsnippet = target;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tsnippet = `${ target } = ${ source }`;\n\n\t\t\tif ( output === 'void' || sourceType === 'void' ) {\n\n\t\t\t\tbuilder.addLineFlowCode( snippet );\n\n\t\t\t\tif ( output !== 'void' ) {\n\n\t\t\t\t\tsnippet = target;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tnodeData.initialized = true;\n\n\t\treturn builder.format( snippet, targetType, output );\n\n\t}\n\n}\n\nexport default AssignNode;\n\nexport const assign = nodeProxy( AssignNode );\n\naddNodeClass( 'AssignNode', AssignNode );\n\naddNodeElement( 'assign', assign );\n","import Node, { addNodeClass } from './Node.js';\nimport { NodeShaderStage } from './constants.js';\nimport { addNodeElement, nodeProxy } from '../shadernode/ShaderNode.js';\n\nclass VaryingNode extends Node {\n\n\tconstructor( node, name = null ) {\n\n\t\tsuper();\n\n\t\tthis.node = node;\n\t\tthis.name = name;\n\n\t\tthis.isVaryingNode = true;\n\n\t}\n\n\tisGlobal() {\n\n\t\treturn true;\n\n\t}\n\n\tgetHash( builder ) {\n\n\t\treturn this.name || super.getHash( builder );\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\t// VaryingNode is auto type\n\n\t\treturn this.node.getNodeType( builder );\n\n\t}\n\n\tsetupVarying( builder ) {\n\n\t\tconst properties = builder.getNodeProperties( this );\n\n\t\tlet varying = properties.varying;\n\n\t\tif ( varying === undefined ) {\n\n\t\t\tconst name = this.name;\n\t\t\tconst type = this.getNodeType( builder );\n\n\t\t\tproperties.varying = varying = builder.getVaryingFromNode( this, name, type );\n\t\t\tproperties.node = this.node;\n\n\t\t}\n\n\t\t// this property can be used to check if the varying can be optimized for a variable\n\t\tvarying.needsInterpolation || ( varying.needsInterpolation = ( builder.shaderStage === 'fragment' ) );\n\n\t\treturn varying;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tthis.setupVarying( builder );\n\n\t}\n\n\tanalyze( builder ) {\n\n\t\tthis.setupVarying( builder );\n\n\t\treturn this.node.analyze( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst properties = builder.getNodeProperties( this );\n\t\tconst varying = this.setupVarying( builder );\n\n\t\tif ( properties.propertyName === undefined ) {\n\n\t\t\tconst type = this.getNodeType( builder );\n\t\t\tconst propertyName = builder.getPropertyName( varying, NodeShaderStage.VERTEX );\n\n\t\t\t// force node run in vertex stage\n\t\t\tbuilder.flowNodeFromShaderStage( NodeShaderStage.VERTEX, this.node, type, propertyName );\n\n\t\t\tproperties.propertyName = propertyName;\n\n\t\t}\n\n\t\treturn builder.getPropertyName( varying );\n\n\t}\n\n}\n\nexport default VaryingNode;\n\nexport const varying = nodeProxy( VaryingNode );\n\naddNodeElement( 'varying', varying );\n\naddNodeClass( 'VaryingNode', VaryingNode );\n","import Node, { addNodeClass } from './Node.js';\nimport { varying } from './VaryingNode.js';\nimport { nodeObject } from '../shadernode/ShaderNode.js';\n\nclass AttributeNode extends Node {\n\n\tconstructor( attributeName, nodeType = null, defaultNode = null ) {\n\n\t\tsuper( nodeType );\n\n\t\tthis.defaultNode = defaultNode;\n\n\t\tthis.global = true;\n\n\t\tthis._attributeName = attributeName;\n\n\t}\n\n\tgetHash( builder ) {\n\n\t\treturn this.getAttributeName( builder );\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tlet nodeType = super.getNodeType( builder );\n\n\t\tif ( nodeType === null ) {\n\n\t\t\tconst attributeName = this.getAttributeName( builder );\n\n\t\t\tif ( builder.hasGeometryAttribute( attributeName ) ) {\n\n\t\t\t\tconst attribute = builder.geometry.getAttribute( attributeName );\n\n\t\t\t\tnodeType = builder.getTypeFromAttribute( attribute );\n\n\t\t\t} else {\n\n\t\t\t\tnodeType = 'float';\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn nodeType;\n\n\t}\n\n\tsetAttributeName( attributeName ) {\n\n\t\tthis._attributeName = attributeName;\n\n\t\treturn this;\n\n\t}\n\n\tgetAttributeName( /*builder*/ ) {\n\n\t\treturn this._attributeName;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst attributeName = this.getAttributeName( builder );\n\t\tconst nodeType = this.getNodeType( builder );\n\t\tconst geometryAttribute = builder.hasGeometryAttribute( attributeName );\n\n\t\tif ( geometryAttribute === true ) {\n\n\t\t\tconst attribute = builder.geometry.getAttribute( attributeName );\n\t\t\tconst attributeType = builder.getTypeFromAttribute( attribute );\n\n\t\t\tconst nodeAttribute = builder.getAttribute( attributeName, attributeType );\n\n\t\t\tif ( builder.shaderStage === 'vertex' ) {\n\n\t\t\t\treturn builder.format( nodeAttribute.name, attributeType, nodeType );\n\n\t\t\t} else {\n\n\t\t\t\tconst nodeVarying = varying( this );\n\n\t\t\t\treturn nodeVarying.build( builder, nodeType );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.warn( `AttributeNode: Vertex attribute \"${ attributeName }\" not found on geometry.` );\n\n\t\t\tconst { defaultNode } = this;\n\n\t\t\tif ( defaultNode !== null ) {\n\n\t\t\t\treturn defaultNode.build( builder, nodeType );\n\n\t\t\t} else {\n\n\t\t\t\treturn builder.generateConst( nodeType );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nexport default AttributeNode;\n\nexport const attribute = ( name, nodeType, defaultNode ) => nodeObject( new AttributeNode( name, nodeType, nodeObject( defaultNode ) ) );\n\naddNodeClass( 'AttributeNode', AttributeNode );\n","import Node, { addNodeClass } from './Node.js';\nimport { addNodeElement, nodeProxy } from '../shadernode/ShaderNode.js';\n\nclass BypassNode extends Node {\n\n\tconstructor( returnNode, callNode ) {\n\n\t\tsuper();\n\n\t\tthis.isBypassNode = true;\n\n\t\tthis.outputNode = returnNode;\n\t\tthis.callNode = callNode;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.outputNode.getNodeType( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst snippet = this.callNode.build( builder, 'void' );\n\n\t\tif ( snippet !== '' ) {\n\n\t\t\tbuilder.addLineFlowCode( snippet );\n\n\t\t}\n\n\t\treturn this.outputNode.build( builder );\n\n\t}\n\n}\n\nexport default BypassNode;\n\nexport const bypass = nodeProxy( BypassNode );\n\naddNodeElement( 'bypass', bypass );\n\naddNodeClass( 'BypassNode', BypassNode );\n","import Node, { addNodeClass } from './Node.js';\nimport { addNodeElement, nodeObject } from '../shadernode/ShaderNode.js';\n\nclass CacheNode extends Node {\n\n\tconstructor( node, parent = true ) {\n\n\t\tsuper();\n\n\t\tthis.node = node;\n\t\tthis.parent = parent;\n\n\t\tthis.isCacheNode = true;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.node.getNodeType( builder );\n\n\t}\n\n\tbuild( builder, ...params ) {\n\n\t\tconst previousCache = builder.getCache();\n\t\tconst cache = builder.getCacheFromNode( this, parent );\n\n\t\tbuilder.setCache( cache );\n\n\t\tconst data = this.node.build( builder, ...params );\n\n\t\tbuilder.setCache( previousCache );\n\n\t\treturn data;\n\n\t}\n\n}\n\nexport default CacheNode;\n\nexport const cache = ( node, ...params ) => nodeObject( new CacheNode( nodeObject( node ), ...params ) );\n\naddNodeElement( 'cache', cache );\n\naddNodeClass( 'CacheNode', CacheNode );\n","import Node, { addNodeClass } from './Node.js';\nimport { addNodeElement, nodeProxy } from '../shadernode/ShaderNode.js';\n\nclass ContextNode extends Node {\n\n\tconstructor( node, context = {} ) {\n\n\t\tsuper();\n\n\t\tthis.isContextNode = true;\n\n\t\tthis.node = node;\n\t\tthis.context = context;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.node.getNodeType( builder );\n\n\t}\n\n\tanalyze( builder ) {\n\n\t\tthis.node.build( builder );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst previousContext = builder.getContext();\n\n\t\tbuilder.setContext( { ...builder.context, ...this.context } );\n\n\t\tconst node = this.node.build( builder );\n\n\t\tbuilder.setContext( previousContext );\n\n\t\treturn node;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst previousContext = builder.getContext();\n\n\t\tbuilder.setContext( { ...builder.context, ...this.context } );\n\n\t\tconst snippet = this.node.build( builder, output );\n\n\t\tbuilder.setContext( previousContext );\n\n\t\treturn snippet;\n\n\t}\n\n}\n\nexport default ContextNode;\n\nexport const context = nodeProxy( ContextNode );\nexport const label = ( node, name ) => context( node, { label: name } );\n\naddNodeElement( 'context', context );\naddNodeElement( 'label', label );\n\naddNodeClass( 'ContextNode', ContextNode );\n","import Node, { addNodeClass } from './Node.js';\nimport { varying } from './VaryingNode.js';\nimport { nodeImmutable } from '../shadernode/ShaderNode.js';\n\nclass IndexNode extends Node {\n\n\tconstructor( scope ) {\n\n\t\tsuper( 'uint' );\n\n\t\tthis.scope = scope;\n\n\t\tthis.isInstanceIndexNode = true;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst nodeType = this.getNodeType( builder );\n\t\tconst scope = this.scope;\n\n\t\tlet propertyName;\n\n\t\tif ( scope === IndexNode.VERTEX ) {\n\n\t\t\tpropertyName = builder.getVertexIndex();\n\n\t\t} else if ( scope === IndexNode.INSTANCE ) {\n\n\t\t\tpropertyName = builder.getInstanceIndex();\n\n\t\t} else if ( scope === IndexNode.DRAW ) {\n\n\t\t\tpropertyName = builder.getDrawIndex();\n\n\t\t} else {\n\n\t\t\tthrow new Error( 'THREE.IndexNode: Unknown scope: ' + scope );\n\n\t\t}\n\n\t\tlet output;\n\n\t\tif ( builder.shaderStage === 'vertex' || builder.shaderStage === 'compute' ) {\n\n\t\t\toutput = propertyName;\n\n\t\t} else {\n\n\t\t\tconst nodeVarying = varying( this );\n\n\t\t\toutput = nodeVarying.build( builder, nodeType );\n\n\t\t}\n\n\t\treturn output;\n\n\t}\n\n}\n\nIndexNode.VERTEX = 'vertex';\nIndexNode.INSTANCE = 'instance';\nIndexNode.DRAW = 'draw';\n\nexport default IndexNode;\n\nexport const vertexIndex = nodeImmutable( IndexNode, IndexNode.VERTEX );\nexport const instanceIndex = nodeImmutable( IndexNode, IndexNode.INSTANCE );\nexport const drawIndex = nodeImmutable( IndexNode, IndexNode.DRAW );\n\naddNodeClass( 'IndexNode', IndexNode );\n","class LightingModel {\n\n\tstart( /*input, stack, builder*/ ) { }\n\n\tfinish( /*input, stack, builder*/ ) { }\n\n\tdirect( /*input, stack, builder*/ ) { }\n\n\tdirectRectArea( /*input, stack, builder*/ ) {}\n\n\tindirectDiffuse( /*input, stack, builder*/ ) { }\n\n\tindirectSpecular( /*input, stack, builder*/ ) { }\n\n\tambientOcclusion( /*input, stack, builder*/ ) { }\n\n}\n\nexport default LightingModel;\n","import Node, { addNodeClass } from './Node.js';\nimport { addNodeElement, nodeProxy } from '../shadernode/ShaderNode.js';\n\nclass VarNode extends Node {\n\n\tconstructor( node, name = null ) {\n\n\t\tsuper();\n\n\t\tthis.node = node;\n\t\tthis.name = name;\n\n\t\tthis.global = true;\n\n\t\tthis.isVarNode = true;\n\n\t}\n\n\tgetHash( builder ) {\n\n\t\treturn this.name || super.getHash( builder );\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.node.getNodeType( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst { node, name } = this;\n\n\t\tconst nodeVar = builder.getVarFromNode( this, name, builder.getVectorType( this.getNodeType( builder ) ) );\n\n\t\tconst propertyName = builder.getPropertyName( nodeVar );\n\n\t\tconst snippet = node.build( builder, nodeVar.type );\n\n\t\tbuilder.addLineFlowCode( `${propertyName} = ${snippet}` );\n\n\t\treturn propertyName;\n\n\t}\n\n}\n\nexport default VarNode;\n\nexport const temp = nodeProxy( VarNode );\n\naddNodeElement( 'temp', temp ); // @TODO: Will be removed in the future\naddNodeElement( 'toVar', ( ...params ) => temp( ...params ).append() );\n\naddNodeClass( 'VarNode', VarNode );\n","import Node, { addNodeClass } from './Node.js';\nimport { nodeImmutable, nodeObject } from '../shadernode/ShaderNode.js';\n\nclass PropertyNode extends Node {\n\n\tconstructor( nodeType, name = null, varying = false ) {\n\n\t\tsuper( nodeType );\n\n\t\tthis.name = name;\n\t\tthis.varying = varying;\n\n\t\tthis.isPropertyNode = true;\n\n\t}\n\n\tgetHash( builder ) {\n\n\t\treturn this.name || super.getHash( builder );\n\n\t}\n\n\tisGlobal( /*builder*/ ) {\n\n\t\treturn true;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tlet nodeVar;\n\n\t\tif ( this.varying === true ) {\n\n\t\t\tnodeVar = builder.getVaryingFromNode( this, this.name );\n\t\t\tnodeVar.needsInterpolation = true;\n\n\t\t} else {\n\n\t\t\tnodeVar = builder.getVarFromNode( this, this.name );\n\n\t\t}\n\n\t\treturn builder.getPropertyName( nodeVar );\n\n\t}\n\n}\n\nexport default PropertyNode;\n\nexport const property = ( type, name ) => nodeObject( new PropertyNode( type, name ) );\nexport const varyingProperty = ( type, name ) => nodeObject( new PropertyNode( type, name, true ) );\n\nexport const diffuseColor = nodeImmutable( PropertyNode, 'vec4', 'DiffuseColor' );\nexport const roughness = nodeImmutable( PropertyNode, 'float', 'Roughness' );\nexport const metalness = nodeImmutable( PropertyNode, 'float', 'Metalness' );\nexport const clearcoat = nodeImmutable( PropertyNode, 'float', 'Clearcoat' );\nexport const clearcoatRoughness = nodeImmutable( PropertyNode, 'float', 'ClearcoatRoughness' );\nexport const sheen = nodeImmutable( PropertyNode, 'vec3', 'Sheen' );\nexport const sheenRoughness = nodeImmutable( PropertyNode, 'float', 'SheenRoughness' );\nexport const iridescence = nodeImmutable( PropertyNode, 'float', 'Iridescence' );\nexport const iridescenceIOR = nodeImmutable( PropertyNode, 'float', 'IridescenceIOR' );\nexport const iridescenceThickness = nodeImmutable( PropertyNode, 'float', 'IridescenceThickness' );\nexport const alphaT = nodeImmutable( PropertyNode, 'float', 'AlphaT' );\nexport const anisotropy = nodeImmutable( PropertyNode, 'float', 'Anisotropy' );\nexport const anisotropyT = nodeImmutable( PropertyNode, 'vec3', 'AnisotropyT' );\nexport const anisotropyB = nodeImmutable( PropertyNode, 'vec3', 'AnisotropyB' );\nexport const specularColor = nodeImmutable( PropertyNode, 'color', 'SpecularColor' );\nexport const specularF90 = nodeImmutable( PropertyNode, 'float', 'SpecularF90' );\nexport const shininess = nodeImmutable( PropertyNode, 'float', 'Shininess' );\nexport const output = nodeImmutable( PropertyNode, 'vec4', 'Output' );\nexport const dashSize = nodeImmutable( PropertyNode, 'float', 'dashSize' );\nexport const gapSize = nodeImmutable( PropertyNode, 'float', 'gapSize' );\nexport const pointWidth = nodeImmutable( PropertyNode, 'float', 'pointWidth' );\nexport const ior = nodeImmutable( PropertyNode, 'float', 'IOR' );\nexport const transmission = nodeImmutable( PropertyNode, 'float', 'Transmission' );\nexport const thickness = nodeImmutable( PropertyNode, 'float', 'Thickness' );\nexport const attenuationDistance = nodeImmutable( PropertyNode, 'float', 'AttenuationDistance' );\nexport const attenuationColor = nodeImmutable( PropertyNode, 'color', 'AttenuationColor' );\nexport const dispersion = nodeImmutable( PropertyNode, 'float', 'Dispersion' );\n\naddNodeClass( 'PropertyNode', PropertyNode );\n","import { addNodeClass } from './Node.js';\nimport { nodeObject } from '../shadernode/ShaderNode.js';\nimport PropertyNode from './PropertyNode.js';\n\nclass ParameterNode extends PropertyNode {\n\n\tconstructor( nodeType, name = null ) {\n\n\t\tsuper( nodeType, name );\n\n\t\tthis.isParameterNode = true;\n\n\t}\n\n\tgetHash() {\n\n\t\treturn this.uuid;\n\n\t}\n\n\tgenerate() {\n\n\t\treturn this.name;\n\n\t}\n\n}\n\nexport default ParameterNode;\n\nexport const parameter = ( type, name ) => nodeObject( new ParameterNode( type, name ) );\n\naddNodeClass( 'ParameterNode', ParameterNode );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { nodeProxy } from '../shadernode/ShaderNode.js';\n\nclass CodeNode extends Node {\n\n\tconstructor( code = '', includes = [], language = '' ) {\n\n\t\tsuper( 'code' );\n\n\t\tthis.isCodeNode = true;\n\n\t\tthis.code = code;\n\t\tthis.language = language;\n\n\t\tthis.includes = includes;\n\n\t}\n\n\tisGlobal() {\n\n\t\treturn true;\n\n\t}\n\n\tsetIncludes( includes ) {\n\n\t\tthis.includes = includes;\n\n\t\treturn this;\n\n\t}\n\n\tgetIncludes( /*builder*/ ) {\n\n\t\treturn this.includes;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst includes = this.getIncludes( builder );\n\n\t\tfor ( const include of includes ) {\n\n\t\t\tinclude.build( builder );\n\n\t\t}\n\n\t\tconst nodeCode = builder.getCodeFromNode( this, this.getNodeType( builder ) );\n\t\tnodeCode.code = this.code;\n\n\t\treturn nodeCode.code;\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.code = this.code;\n\t\tdata.language = this.language;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.code = data.code;\n\t\tthis.language = data.language;\n\n\t}\n\n}\n\nexport default CodeNode;\n\nexport const code = nodeProxy( CodeNode );\n\nexport const js = ( src, includes ) => code( src, includes, 'js' );\nexport const wgsl = ( src, includes ) => code( src, includes, 'wgsl' );\nexport const glsl = ( src, includes ) => code( src, includes, 'glsl' );\n\naddNodeClass( 'CodeNode', CodeNode );\n","import CodeNode from './CodeNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { nodeObject } from '../shadernode/ShaderNode.js';\n\nclass FunctionNode extends CodeNode {\n\n\tconstructor( code = '', includes = [], language = '' ) {\n\n\t\tsuper( code, includes, language );\n\n\t\tthis.keywords = {};\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.getNodeFunction( builder ).type;\n\n\t}\n\n\tgetInputs( builder ) {\n\n\t\treturn this.getNodeFunction( builder ).inputs;\n\n\t}\n\n\tgetNodeFunction( builder ) {\n\n\t\tconst nodeData = builder.getDataFromNode( this );\n\n\t\tlet nodeFunction = nodeData.nodeFunction;\n\n\t\tif ( nodeFunction === undefined ) {\n\n\t\t\tnodeFunction = builder.parser.parseFunction( this.code );\n\n\t\t\tnodeData.nodeFunction = nodeFunction;\n\n\t\t}\n\n\t\treturn nodeFunction;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tsuper.generate( builder );\n\n\t\tconst nodeFunction = this.getNodeFunction( builder );\n\n\t\tconst name = nodeFunction.name;\n\t\tconst type = nodeFunction.type;\n\n\t\tconst nodeCode = builder.getCodeFromNode( this, type );\n\n\t\tif ( name !== '' ) {\n\n\t\t\t// use a custom property name\n\n\t\t\tnodeCode.name = name;\n\n\t\t}\n\n\t\tconst propertyName = builder.getPropertyName( nodeCode );\n\n\t\tlet code = this.getNodeFunction( builder ).getCode( propertyName );\n\n\t\tconst keywords = this.keywords;\n\t\tconst keywordsProperties = Object.keys( keywords );\n\n\t\tif ( keywordsProperties.length > 0 ) {\n\n\t\t\tfor ( const property of keywordsProperties ) {\n\n\t\t\t\tconst propertyRegExp = new RegExp( `\\\\b${property}\\\\b`, 'g' );\n\t\t\t\tconst nodeProperty = keywords[ property ].build( builder, 'property' );\n\n\t\t\t\tcode = code.replace( propertyRegExp, nodeProperty );\n\n\t\t\t}\n\n\t\t}\n\n\t\tnodeCode.code = code + '\\n';\n\n\t\tif ( output === 'property' ) {\n\n\t\t\treturn propertyName;\n\n\t\t} else {\n\n\t\t\treturn builder.format( `${ propertyName }()`, type, output );\n\n\t\t}\n\n\t}\n\n}\n\nexport default FunctionNode;\n\nconst nativeFn = ( code, includes = [], language = '' ) => {\n\n\tfor ( let i = 0; i < includes.length; i ++ ) {\n\n\t\tconst include = includes[ i ];\n\n\t\t// TSL Function: glslFn, wgslFn\n\n\t\tif ( typeof include === 'function' ) {\n\n\t\t\tincludes[ i ] = include.functionNode;\n\n\t\t}\n\n\t}\n\n\tconst functionNode = nodeObject( new FunctionNode( code, includes, language ) );\n\n\tconst fn = ( ...params ) => functionNode.call( ...params );\n\tfn.functionNode = functionNode;\n\n\treturn fn;\n\n};\n\nexport const glslFn = ( code, includes ) => nativeFn( code, includes, 'glsl' );\nexport const wgslFn = ( code, includes ) => nativeFn( code, includes, 'wgsl' );\n\naddNodeClass( 'FunctionNode', FunctionNode );\n","import Node from './Node.js';\nimport { addNodeClass } from './Node.js';\n\nclass UniformGroupNode extends Node {\n\n\tconstructor( name, shared = false ) {\n\n\t\tsuper( 'string' );\n\n\t\tthis.name = name;\n\t\tthis.version = 0;\n\n\t\tthis.shared = shared;\n\n\t\tthis.isUniformGroup = true;\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n}\n\nexport const uniformGroup = ( name ) => new UniformGroupNode( name );\nexport const sharedUniformGroup = ( name ) => new UniformGroupNode( name, true );\n\nexport const frameGroup = sharedUniformGroup( 'frame' );\nexport const renderGroup = sharedUniformGroup( 'render' );\nexport const objectGroup = uniformGroup( 'object' );\n\nexport default UniformGroupNode;\n\naddNodeClass( 'UniformGroupNode', UniformGroupNode );\n","import InputNode from './InputNode.js';\nimport { objectGroup } from './UniformGroupNode.js';\nimport { addNodeClass } from './Node.js';\nimport { nodeObject, getConstNodeType } from '../shadernode/ShaderNode.js';\n\nclass UniformNode extends InputNode {\n\n\tconstructor( value, nodeType = null ) {\n\n\t\tsuper( value, nodeType );\n\n\t\tthis.isUniformNode = true;\n\n\t\tthis.name = '';\n\t\tthis.groupNode = objectGroup;\n\n\t}\n\n\tlabel( name ) {\n\n\t\tthis.name = name;\n\n\t\treturn this;\n\n\t}\n\n\tsetGroup( group ) {\n\n\t\tthis.groupNode = group;\n\n\t\treturn this;\n\n\t}\n\n\tgetGroup() {\n\n\t\treturn this.groupNode;\n\n\t}\n\n\tgetUniformHash( builder ) {\n\n\t\treturn this.getHash( builder );\n\n\t}\n\n\tonUpdate( callback, updateType ) {\n\n\t\tconst self = this.getSelf();\n\n\t\tcallback = callback.bind( self );\n\n\t\treturn super.onUpdate( ( frame ) => {\n\n\t\t\tconst value = callback( frame, self );\n\n\t\t\tif ( value !== undefined ) {\n\n\t\t\t\tthis.value = value;\n\n\t\t\t}\n\n\t \t}, updateType );\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst type = this.getNodeType( builder );\n\n\t\tconst hash = this.getUniformHash( builder );\n\n\t\tlet sharedNode = builder.getNodeFromHash( hash );\n\n\t\tif ( sharedNode === undefined ) {\n\n\t\t\tbuilder.setHashNode( this, hash );\n\n\t\t\tsharedNode = this;\n\n\t\t}\n\n\t\tconst sharedNodeType = sharedNode.getInputType( builder );\n\n\t\tconst nodeUniform = builder.getUniformFromNode( sharedNode, sharedNodeType, builder.shaderStage, this.name || builder.context.label );\n\t\tconst propertyName = builder.getPropertyName( nodeUniform );\n\n\t\tif ( builder.context.label !== undefined ) delete builder.context.label;\n\n\t\treturn builder.format( propertyName, type, output );\n\n\t}\n\n}\n\nexport default UniformNode;\n\nexport const uniform = ( arg1, arg2 ) => {\n\n\tconst nodeType = getConstNodeType( arg2 || arg1 );\n\n\t// @TODO: get ConstNode from .traverse() in the future\n\tconst value = ( arg1 && arg1.isNode === true ) ? ( arg1.node && arg1.node.value ) || arg1.value : arg1;\n\n\treturn nodeObject( new UniformNode( value, nodeType ) );\n\n};\n\naddNodeClass( 'UniformNode', UniformNode );\n","import { attribute } from '../core/AttributeNode.js';\n\nexport const uv = ( index ) => attribute( 'uv' + ( index > 0 ? index : '' ), 'vec2' );\n","import Node from '../core/Node.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { addNodeElement, nodeProxy } from '../shadernode/ShaderNode.js';\n\nclass TextureSizeNode extends Node {\n\n\tconstructor( textureNode, levelNode = null ) {\n\n\t\tsuper( 'uvec2' );\n\n\t\tthis.isTextureSizeNode = true;\n\n\t\tthis.textureNode = textureNode;\n\t\tthis.levelNode = levelNode;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst textureProperty = this.textureNode.build( builder, 'property' );\n\t\tconst levelNode = this.levelNode.build( builder, 'int' );\n\n\t\treturn builder.format( `${ builder.getMethod( 'textureDimensions' ) }( ${ textureProperty }, ${ levelNode } )`, this.getNodeType( builder ), output );\n\n\t}\n\n}\n\nexport default TextureSizeNode;\n\nexport const textureSize = nodeProxy( TextureSizeNode );\n\naddNodeElement( 'textureSize', textureSize );\n\naddNodeClass( 'TextureSizeNode', TextureSizeNode );\n","import TempNode from '../core/TempNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { addNodeElement, nodeProxy } from '../shadernode/ShaderNode.js';\n\nclass OperatorNode extends TempNode {\n\n\tconstructor( op, aNode, bNode, ...params ) {\n\n\t\tsuper();\n\n\t\tif ( params.length > 0 ) {\n\n\t\t\tlet finalOp = new OperatorNode( op, aNode, bNode );\n\n\t\t\tfor ( let i = 0; i < params.length - 1; i ++ ) {\n\n\t\t\t\tfinalOp = new OperatorNode( op, finalOp, params[ i ] );\n\n\t\t\t}\n\n\t\t\taNode = finalOp;\n\t\t\tbNode = params[ params.length - 1 ];\n\n\t\t}\n\n\t\tthis.op = op;\n\t\tthis.aNode = aNode;\n\t\tthis.bNode = bNode;\n\n\t}\n\n\tgetNodeType( builder, output ) {\n\n\t\tconst op = this.op;\n\n\t\tconst aNode = this.aNode;\n\t\tconst bNode = this.bNode;\n\n\t\tconst typeA = aNode.getNodeType( builder );\n\t\tconst typeB = typeof bNode !== 'undefined' ? bNode.getNodeType( builder ) : null;\n\n\t\tif ( typeA === 'void' || typeB === 'void' ) {\n\n\t\t\treturn 'void';\n\n\t\t} else if ( op === '%' ) {\n\n\t\t\treturn typeA;\n\n\t\t} else if ( op === '~' || op === '&' || op === '|' || op === '^' || op === '>>' || op === '<<' ) {\n\n\t\t\treturn builder.getIntegerType( typeA );\n\n\t\t} else if ( op === '!' || op === '==' || op === '&&' || op === '||' || op === '^^' ) {\n\n\t\t\treturn 'bool';\n\n\t\t} else if ( op === '<' || op === '>' || op === '<=' || op === '>=' ) {\n\n\t\t\tconst typeLength = output ? builder.getTypeLength( output ) : Math.max( builder.getTypeLength( typeA ), builder.getTypeLength( typeB ) );\n\n\t\t\treturn typeLength > 1 ? `bvec${ typeLength }` : 'bool';\n\n\t\t} else {\n\n\t\t\tif ( typeA === 'float' && builder.isMatrix( typeB ) ) {\n\n\t\t\t\treturn typeB;\n\n\t\t\t} else if ( builder.isMatrix( typeA ) && builder.isVector( typeB ) ) {\n\n\t\t\t\t// matrix x vector\n\n\t\t\t\treturn builder.getVectorFromMatrix( typeA );\n\n\t\t\t} else if ( builder.isVector( typeA ) && builder.isMatrix( typeB ) ) {\n\n\t\t\t\t// vector x matrix\n\n\t\t\t\treturn builder.getVectorFromMatrix( typeB );\n\n\t\t\t} else if ( builder.getTypeLength( typeB ) > builder.getTypeLength( typeA ) ) {\n\n\t\t\t\t// anytype x anytype: use the greater length vector\n\n\t\t\t\treturn typeB;\n\n\t\t\t}\n\n\t\t\treturn typeA;\n\n\t\t}\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst op = this.op;\n\n\t\tconst aNode = this.aNode;\n\t\tconst bNode = this.bNode;\n\n\t\tconst type = this.getNodeType( builder, output );\n\n\t\tlet typeA = null;\n\t\tlet typeB = null;\n\n\t\tif ( type !== 'void' ) {\n\n\t\t\ttypeA = aNode.getNodeType( builder );\n\t\t\ttypeB = typeof bNode !== 'undefined' ? bNode.getNodeType( builder ) : null;\n\n\t\t\tif ( op === '<' || op === '>' || op === '<=' || op === '>=' || op === '==' ) {\n\n\t\t\t\tif ( builder.isVector( typeA ) ) {\n\n\t\t\t\t\ttypeB = typeA;\n\n\t\t\t\t} else {\n\n\t\t\t\t\ttypeA = typeB = 'float';\n\n\t\t\t\t}\n\n\t\t\t} else if ( op === '>>' || op === '<<' ) {\n\n\t\t\t\ttypeA = type;\n\t\t\t\ttypeB = builder.changeComponentType( typeB, 'uint' );\n\n\t\t\t} else if ( builder.isMatrix( typeA ) && builder.isVector( typeB ) ) {\n\n\t\t\t\t// matrix x vector\n\n\t\t\t\ttypeB = builder.getVectorFromMatrix( typeA );\n\n\t\t\t} else if ( builder.isVector( typeA ) && builder.isMatrix( typeB ) ) {\n\n\t\t\t\t// vector x matrix\n\n\t\t\t\ttypeA = builder.getVectorFromMatrix( typeB );\n\n\t\t\t} else {\n\n\t\t\t\t// anytype x anytype\n\n\t\t\t\ttypeA = typeB = type;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\ttypeA = typeB = type;\n\n\t\t}\n\n\t\tconst a = aNode.build( builder, typeA );\n\t\tconst b = typeof bNode !== 'undefined' ? bNode.build( builder, typeB ) : null;\n\n\t\tconst outputLength = builder.getTypeLength( output );\n\t\tconst fnOpSnippet = builder.getFunctionOperator( op );\n\n\t\tif ( output !== 'void' ) {\n\n\t\t\tif ( op === '<' && outputLength > 1 ) {\n\n\t\t\t\treturn builder.format( `${ builder.getMethod( 'lessThan' ) }( ${ a }, ${ b } )`, type, output );\n\n\t\t\t} else if ( op === '<=' && outputLength > 1 ) {\n\n\t\t\t\treturn builder.format( `${ builder.getMethod( 'lessThanEqual' ) }( ${ a }, ${ b } )`, type, output );\n\n\t\t\t} else if ( op === '>' && outputLength > 1 ) {\n\n\t\t\t\treturn builder.format( `${ builder.getMethod( 'greaterThan' ) }( ${ a }, ${ b } )`, type, output );\n\n\t\t\t} else if ( op === '>=' && outputLength > 1 ) {\n\n\t\t\t\treturn builder.format( `${ builder.getMethod( 'greaterThanEqual' ) }( ${ a }, ${ b } )`, type, output );\n\n\t\t\t} else if ( op === '!' || op === '~' ) {\n\n\t\t\t\treturn builder.format( `(${op}${a})`, typeA, output );\n\n\t\t\t} else if ( fnOpSnippet ) {\n\n\t\t\t\treturn builder.format( `${ fnOpSnippet }( ${ a }, ${ b } )`, type, output );\n\n\t\t\t} else {\n\n\t\t\t\treturn builder.format( `( ${ a } ${ op } ${ b } )`, type, output );\n\n\t\t\t}\n\n\t\t} else if ( typeA !== 'void' ) {\n\n\t\t\tif ( fnOpSnippet ) {\n\n\t\t\t\treturn builder.format( `${ fnOpSnippet }( ${ a }, ${ b } )`, type, output );\n\n\t\t\t} else {\n\n\t\t\t\treturn builder.format( `${ a } ${ op } ${ b }`, type, output );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.op = this.op;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.op = data.op;\n\n\t}\n\n}\n\nexport default OperatorNode;\n\nexport const add = nodeProxy( OperatorNode, '+' );\nexport const sub = nodeProxy( OperatorNode, '-' );\nexport const mul = nodeProxy( OperatorNode, '*' );\nexport const div = nodeProxy( OperatorNode, '/' );\nexport const remainder = nodeProxy( OperatorNode, '%' );\nexport const equal = nodeProxy( OperatorNode, '==' );\nexport const notEqual = nodeProxy( OperatorNode, '!=' );\nexport const lessThan = nodeProxy( OperatorNode, '<' );\nexport const greaterThan = nodeProxy( OperatorNode, '>' );\nexport const lessThanEqual = nodeProxy( OperatorNode, '<=' );\nexport const greaterThanEqual = nodeProxy( OperatorNode, '>=' );\nexport const and = nodeProxy( OperatorNode, '&&' );\nexport const or = nodeProxy( OperatorNode, '||' );\nexport const not = nodeProxy( OperatorNode, '!' );\nexport const xor = nodeProxy( OperatorNode, '^^' );\nexport const bitAnd = nodeProxy( OperatorNode, '&' );\nexport const bitNot = nodeProxy( OperatorNode, '~' );\nexport const bitOr = nodeProxy( OperatorNode, '|' );\nexport const bitXor = nodeProxy( OperatorNode, '^' );\nexport const shiftLeft = nodeProxy( OperatorNode, '<<' );\nexport const shiftRight = nodeProxy( OperatorNode, '>>' );\n\naddNodeElement( 'add', add );\naddNodeElement( 'sub', sub );\naddNodeElement( 'mul', mul );\naddNodeElement( 'div', div );\naddNodeElement( 'remainder', remainder );\naddNodeElement( 'equal', equal );\naddNodeElement( 'notEqual', notEqual );\naddNodeElement( 'lessThan', lessThan );\naddNodeElement( 'greaterThan', greaterThan );\naddNodeElement( 'lessThanEqual', lessThanEqual );\naddNodeElement( 'greaterThanEqual', greaterThanEqual );\naddNodeElement( 'and', and );\naddNodeElement( 'or', or );\naddNodeElement( 'not', not );\naddNodeElement( 'xor', xor );\naddNodeElement( 'bitAnd', bitAnd );\naddNodeElement( 'bitNot', bitNot );\naddNodeElement( 'bitOr', bitOr );\naddNodeElement( 'bitXor', bitXor );\naddNodeElement( 'shiftLeft', shiftLeft );\naddNodeElement( 'shiftRight', shiftRight );\n\naddNodeClass( 'OperatorNode', OperatorNode );\n","import TempNode from '../core/TempNode.js';\nimport { sub, mul, div } from './OperatorNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { addNodeElement, nodeObject, nodeProxy, float, vec3, vec4 } from '../shadernode/ShaderNode.js';\n\nclass MathNode extends TempNode {\n\n\tconstructor( method, aNode, bNode = null, cNode = null ) {\n\n\t\tsuper();\n\n\t\tthis.method = method;\n\n\t\tthis.aNode = aNode;\n\t\tthis.bNode = bNode;\n\t\tthis.cNode = cNode;\n\n\t}\n\n\tgetInputType( builder ) {\n\n\t\tconst aType = this.aNode.getNodeType( builder );\n\t\tconst bType = this.bNode ? this.bNode.getNodeType( builder ) : null;\n\t\tconst cType = this.cNode ? this.cNode.getNodeType( builder ) : null;\n\n\t\tconst aLen = builder.isMatrix( aType ) ? 0 : builder.getTypeLength( aType );\n\t\tconst bLen = builder.isMatrix( bType ) ? 0 : builder.getTypeLength( bType );\n\t\tconst cLen = builder.isMatrix( cType ) ? 0 : builder.getTypeLength( cType );\n\n\t\tif ( aLen > bLen && aLen > cLen ) {\n\n\t\t\treturn aType;\n\n\t\t} else if ( bLen > cLen ) {\n\n\t\t\treturn bType;\n\n\t\t} else if ( cLen > aLen ) {\n\n\t\t\treturn cType;\n\n\t\t}\n\n\t\treturn aType;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tconst method = this.method;\n\n\t\tif ( method === MathNode.LENGTH || method === MathNode.DISTANCE || method === MathNode.DOT ) {\n\n\t\t\treturn 'float';\n\n\t\t} else if ( method === MathNode.CROSS ) {\n\n\t\t\treturn 'vec3';\n\n\t\t} else if ( method === MathNode.ALL ) {\n\n\t\t\treturn 'bool';\n\n\t\t} else if ( method === MathNode.EQUALS ) {\n\n\t\t\treturn builder.changeComponentType( this.aNode.getNodeType( builder ), 'bool' );\n\n\t\t} else if ( method === MathNode.MOD ) {\n\n\t\t\treturn this.aNode.getNodeType( builder );\n\n\t\t} else {\n\n\t\t\treturn this.getInputType( builder );\n\n\t\t}\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst method = this.method;\n\n\t\tconst type = this.getNodeType( builder );\n\t\tconst inputType = this.getInputType( builder );\n\n\t\tconst a = this.aNode;\n\t\tconst b = this.bNode;\n\t\tconst c = this.cNode;\n\n\t\tconst isWebGL = builder.renderer.isWebGLRenderer === true;\n\n\t\tif ( method === MathNode.TRANSFORM_DIRECTION ) {\n\n\t\t\t// dir can be either a direction vector or a normal vector\n\t\t\t// upper-left 3x3 of matrix is assumed to be orthogonal\n\n\t\t\tlet tA = a;\n\t\t\tlet tB = b;\n\n\t\t\tif ( builder.isMatrix( tA.getNodeType( builder ) ) ) {\n\n\t\t\t\ttB = vec4( vec3( tB ), 0.0 );\n\n\t\t\t} else {\n\n\t\t\t\ttA = vec4( vec3( tA ), 0.0 );\n\n\t\t\t}\n\n\t\t\tconst mulNode = mul( tA, tB ).xyz;\n\n\t\t\treturn normalize( mulNode ).build( builder, output );\n\n\t\t} else if ( method === MathNode.NEGATE ) {\n\n\t\t\treturn builder.format( '( - ' + a.build( builder, inputType ) + ' )', type, output );\n\n\t\t} else if ( method === MathNode.ONE_MINUS ) {\n\n\t\t\treturn sub( 1.0, a ).build( builder, output );\n\n\t\t} else if ( method === MathNode.RECIPROCAL ) {\n\n\t\t\treturn div( 1.0, a ).build( builder, output );\n\n\t\t} else if ( method === MathNode.DIFFERENCE ) {\n\n\t\t\treturn abs( sub( a, b ) ).build( builder, output );\n\n\t\t} else {\n\n\t\t\tconst params = [];\n\n\t\t\tif ( method === MathNode.CROSS || method === MathNode.MOD ) {\n\n\t\t\t\tparams.push(\n\t\t\t\t\ta.build( builder, type ),\n\t\t\t\t\tb.build( builder, type )\n\t\t\t\t);\n\n\t\t\t} else if ( method === MathNode.STEP ) {\n\n\t\t\t\tparams.push(\n\t\t\t\t\ta.build( builder, builder.getTypeLength( a.getNodeType( builder ) ) === 1 ? 'float' : inputType ),\n\t\t\t\t\tb.build( builder, inputType )\n\t\t\t\t);\n\n\t\t\t} else if ( ( isWebGL && ( method === MathNode.MIN || method === MathNode.MAX ) ) || method === MathNode.MOD ) {\n\n\t\t\t\tparams.push(\n\t\t\t\t\ta.build( builder, inputType ),\n\t\t\t\t\tb.build( builder, builder.getTypeLength( b.getNodeType( builder ) ) === 1 ? 'float' : inputType )\n\t\t\t\t);\n\n\t\t\t} else if ( method === MathNode.REFRACT ) {\n\n\t\t\t\tparams.push(\n\t\t\t\t\ta.build( builder, inputType ),\n\t\t\t\t\tb.build( builder, inputType ),\n\t\t\t\t\tc.build( builder, 'float' )\n\t\t\t\t);\n\n\t\t\t} else if ( method === MathNode.MIX ) {\n\n\t\t\t\tparams.push(\n\t\t\t\t\ta.build( builder, inputType ),\n\t\t\t\t\tb.build( builder, inputType ),\n\t\t\t\t\tc.build( builder, builder.getTypeLength( c.getNodeType( builder ) ) === 1 ? 'float' : inputType )\n\t\t\t\t);\n\n\t\t\t} else {\n\n\t\t\t\tparams.push( a.build( builder, inputType ) );\n\t\t\t\tif ( b !== null ) params.push( b.build( builder, inputType ) );\n\t\t\t\tif ( c !== null ) params.push( c.build( builder, inputType ) );\n\n\t\t\t}\n\n\t\t\treturn builder.format( `${ builder.getMethod( method, type ) }( ${params.join( ', ' )} )`, type, output );\n\n\t\t}\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.method = this.method;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.method = data.method;\n\n\t}\n\n}\n\n// 1 input\n\nMathNode.ALL = 'all';\nMathNode.ANY = 'any';\nMathNode.EQUALS = 'equals';\n\nMathNode.RADIANS = 'radians';\nMathNode.DEGREES = 'degrees';\nMathNode.EXP = 'exp';\nMathNode.EXP2 = 'exp2';\nMathNode.LOG = 'log';\nMathNode.LOG2 = 'log2';\nMathNode.SQRT = 'sqrt';\nMathNode.INVERSE_SQRT = 'inversesqrt';\nMathNode.FLOOR = 'floor';\nMathNode.CEIL = 'ceil';\nMathNode.NORMALIZE = 'normalize';\nMathNode.FRACT = 'fract';\nMathNode.SIN = 'sin';\nMathNode.COS = 'cos';\nMathNode.TAN = 'tan';\nMathNode.ASIN = 'asin';\nMathNode.ACOS = 'acos';\nMathNode.ATAN = 'atan';\nMathNode.ABS = 'abs';\nMathNode.SIGN = 'sign';\nMathNode.LENGTH = 'length';\nMathNode.NEGATE = 'negate';\nMathNode.ONE_MINUS = 'oneMinus';\nMathNode.DFDX = 'dFdx';\nMathNode.DFDY = 'dFdy';\nMathNode.ROUND = 'round';\nMathNode.RECIPROCAL = 'reciprocal';\nMathNode.TRUNC = 'trunc';\nMathNode.FWIDTH = 'fwidth';\nMathNode.BITCAST = 'bitcast';\nMathNode.TRANSPOSE = 'transpose';\n\n// 2 inputs\n\nMathNode.ATAN2 = 'atan2';\nMathNode.MIN = 'min';\nMathNode.MAX = 'max';\nMathNode.MOD = 'mod';\nMathNode.STEP = 'step';\nMathNode.REFLECT = 'reflect';\nMathNode.DISTANCE = 'distance';\nMathNode.DIFFERENCE = 'difference';\nMathNode.DOT = 'dot';\nMathNode.CROSS = 'cross';\nMathNode.POW = 'pow';\nMathNode.TRANSFORM_DIRECTION = 'transformDirection';\n\n// 3 inputs\n\nMathNode.MIX = 'mix';\nMathNode.CLAMP = 'clamp';\nMathNode.REFRACT = 'refract';\nMathNode.SMOOTHSTEP = 'smoothstep';\nMathNode.FACEFORWARD = 'faceforward';\n\nexport default MathNode;\n\nexport const EPSILON = float( 1e-6 );\nexport const INFINITY = float( 1e6 );\nexport const PI = float( Math.PI );\nexport const PI2 = float( Math.PI * 2 );\n\nexport const all = nodeProxy( MathNode, MathNode.ALL );\nexport const any = nodeProxy( MathNode, MathNode.ANY );\nexport const equals = nodeProxy( MathNode, MathNode.EQUALS );\n\nexport const radians = nodeProxy( MathNode, MathNode.RADIANS );\nexport const degrees = nodeProxy( MathNode, MathNode.DEGREES );\nexport const exp = nodeProxy( MathNode, MathNode.EXP );\nexport const exp2 = nodeProxy( MathNode, MathNode.EXP2 );\nexport const log = nodeProxy( MathNode, MathNode.LOG );\nexport const log2 = nodeProxy( MathNode, MathNode.LOG2 );\nexport const sqrt = nodeProxy( MathNode, MathNode.SQRT );\nexport const inverseSqrt = nodeProxy( MathNode, MathNode.INVERSE_SQRT );\nexport const floor = nodeProxy( MathNode, MathNode.FLOOR );\nexport const ceil = nodeProxy( MathNode, MathNode.CEIL );\nexport const normalize = nodeProxy( MathNode, MathNode.NORMALIZE );\nexport const fract = nodeProxy( MathNode, MathNode.FRACT );\nexport const sin = nodeProxy( MathNode, MathNode.SIN );\nexport const cos = nodeProxy( MathNode, MathNode.COS );\nexport const tan = nodeProxy( MathNode, MathNode.TAN );\nexport const asin = nodeProxy( MathNode, MathNode.ASIN );\nexport const acos = nodeProxy( MathNode, MathNode.ACOS );\nexport const atan = nodeProxy( MathNode, MathNode.ATAN );\nexport const abs = nodeProxy( MathNode, MathNode.ABS );\nexport const sign = nodeProxy( MathNode, MathNode.SIGN );\nexport const length = nodeProxy( MathNode, MathNode.LENGTH );\nexport const negate = nodeProxy( MathNode, MathNode.NEGATE );\nexport const oneMinus = nodeProxy( MathNode, MathNode.ONE_MINUS );\nexport const dFdx = nodeProxy( MathNode, MathNode.DFDX );\nexport const dFdy = nodeProxy( MathNode, MathNode.DFDY );\nexport const round = nodeProxy( MathNode, MathNode.ROUND );\nexport const reciprocal = nodeProxy( MathNode, MathNode.RECIPROCAL );\nexport const trunc = nodeProxy( MathNode, MathNode.TRUNC );\nexport const fwidth = nodeProxy( MathNode, MathNode.FWIDTH );\nexport const bitcast = nodeProxy( MathNode, MathNode.BITCAST );\nexport const transpose = nodeProxy( MathNode, MathNode.TRANSPOSE );\n\nexport const atan2 = nodeProxy( MathNode, MathNode.ATAN2 );\nexport const min = nodeProxy( MathNode, MathNode.MIN );\nexport const max = nodeProxy( MathNode, MathNode.MAX );\nexport const mod = nodeProxy( MathNode, MathNode.MOD );\nexport const step = nodeProxy( MathNode, MathNode.STEP );\nexport const reflect = nodeProxy( MathNode, MathNode.REFLECT );\nexport const distance = nodeProxy( MathNode, MathNode.DISTANCE );\nexport const difference = nodeProxy( MathNode, MathNode.DIFFERENCE );\nexport const dot = nodeProxy( MathNode, MathNode.DOT );\nexport const cross = nodeProxy( MathNode, MathNode.CROSS );\nexport const pow = nodeProxy( MathNode, MathNode.POW );\nexport const pow2 = nodeProxy( MathNode, MathNode.POW, 2 );\nexport const pow3 = nodeProxy( MathNode, MathNode.POW, 3 );\nexport const pow4 = nodeProxy( MathNode, MathNode.POW, 4 );\nexport const transformDirection = nodeProxy( MathNode, MathNode.TRANSFORM_DIRECTION );\n\nexport const cbrt = ( a ) => mul( sign( a ), pow( abs( a ), 1.0 / 3.0 ) );\nexport const lengthSq = ( a ) => dot( a, a );\nexport const mix = nodeProxy( MathNode, MathNode.MIX );\nexport const clamp = ( value, low = 0, high = 1 ) => nodeObject( new MathNode( MathNode.CLAMP, nodeObject( value ), nodeObject( low ), nodeObject( high ) ) );\nexport const saturate = ( value ) => clamp( value );\nexport const refract = nodeProxy( MathNode, MathNode.REFRACT );\nexport const smoothstep = nodeProxy( MathNode, MathNode.SMOOTHSTEP );\nexport const faceForward = nodeProxy( MathNode, MathNode.FACEFORWARD );\n\nexport const mixElement = ( t, e1, e2 ) => mix( e1, e2, t );\nexport const smoothstepElement = ( x, low, high ) => smoothstep( low, high, x );\n\naddNodeElement( 'all', all );\naddNodeElement( 'any', any );\naddNodeElement( 'equals', equals );\n\naddNodeElement( 'radians', radians );\naddNodeElement( 'degrees', degrees );\naddNodeElement( 'exp', exp );\naddNodeElement( 'exp2', exp2 );\naddNodeElement( 'log', log );\naddNodeElement( 'log2', log2 );\naddNodeElement( 'sqrt', sqrt );\naddNodeElement( 'inverseSqrt', inverseSqrt );\naddNodeElement( 'floor', floor );\naddNodeElement( 'ceil', ceil );\naddNodeElement( 'normalize', normalize );\naddNodeElement( 'fract', fract );\naddNodeElement( 'sin', sin );\naddNodeElement( 'cos', cos );\naddNodeElement( 'tan', tan );\naddNodeElement( 'asin', asin );\naddNodeElement( 'acos', acos );\naddNodeElement( 'atan', atan );\naddNodeElement( 'abs', abs );\naddNodeElement( 'sign', sign );\naddNodeElement( 'length', length );\naddNodeElement( 'lengthSq', lengthSq );\naddNodeElement( 'negate', negate );\naddNodeElement( 'oneMinus', oneMinus );\naddNodeElement( 'dFdx', dFdx );\naddNodeElement( 'dFdy', dFdy );\naddNodeElement( 'round', round );\naddNodeElement( 'reciprocal', reciprocal );\naddNodeElement( 'trunc', trunc );\naddNodeElement( 'fwidth', fwidth );\naddNodeElement( 'atan2', atan2 );\naddNodeElement( 'min', min );\naddNodeElement( 'max', max );\naddNodeElement( 'mod', mod );\naddNodeElement( 'step', step );\naddNodeElement( 'reflect', reflect );\naddNodeElement( 'distance', distance );\naddNodeElement( 'dot', dot );\naddNodeElement( 'cross', cross );\naddNodeElement( 'pow', pow );\naddNodeElement( 'pow2', pow2 );\naddNodeElement( 'pow3', pow3 );\naddNodeElement( 'pow4', pow4 );\naddNodeElement( 'transformDirection', transformDirection );\naddNodeElement( 'mix', mixElement );\naddNodeElement( 'clamp', clamp );\naddNodeElement( 'refract', refract );\naddNodeElement( 'smoothstep', smoothstepElement );\naddNodeElement( 'faceForward', faceForward );\naddNodeElement( 'difference', difference );\naddNodeElement( 'saturate', saturate );\naddNodeElement( 'cbrt', cbrt );\naddNodeElement( 'transpose', transpose );\n\naddNodeClass( 'MathNode', MathNode );\n","import TempNode from '../core/TempNode.js';\nimport { mix } from '../math/MathNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { addNodeElement, tslFn, nodeObject, nodeProxy, vec4 } from '../shadernode/ShaderNode.js';\n\nimport { LinearSRGBColorSpace, SRGBColorSpace } from 'three';\n\nconst sRGBToLinearShader = tslFn( ( inputs ) => {\n\n\tconst { value } = inputs;\n\tconst { rgb } = value;\n\n\tconst a = rgb.mul( 0.9478672986 ).add( 0.0521327014 ).pow( 2.4 );\n\tconst b = rgb.mul( 0.0773993808 );\n\tconst factor = rgb.lessThanEqual( 0.04045 );\n\n\tconst rgbResult = mix( a, b, factor );\n\n\treturn vec4( rgbResult, value.a );\n\n} );\n\nconst LinearTosRGBShader = tslFn( ( inputs ) => {\n\n\tconst { value } = inputs;\n\tconst { rgb } = value;\n\n\tconst a = rgb.pow( 0.41666 ).mul( 1.055 ).sub( 0.055 );\n\tconst b = rgb.mul( 12.92 );\n\tconst factor = rgb.lessThanEqual( 0.0031308 );\n\n\tconst rgbResult = mix( a, b, factor );\n\n\treturn vec4( rgbResult, value.a );\n\n} );\n\nconst getColorSpaceMethod = ( colorSpace ) => {\n\n\tlet method = null;\n\n\tif ( colorSpace === LinearSRGBColorSpace ) {\n\n\t\tmethod = 'Linear';\n\n\t} else if ( colorSpace === SRGBColorSpace ) {\n\n\t\tmethod = 'sRGB';\n\n\t}\n\n\treturn method;\n\n};\n\nconst getMethod = ( source, target ) => {\n\n\treturn getColorSpaceMethod( source ) + 'To' + getColorSpaceMethod( target );\n\n};\n\nclass ColorSpaceNode extends TempNode {\n\n\tconstructor( method, node ) {\n\n\t\tsuper( 'vec4' );\n\n\t\tthis.method = method;\n\t\tthis.node = node;\n\n\t}\n\n\tsetup() {\n\n\t\tconst { method, node } = this;\n\n\t\tif ( method === ColorSpaceNode.LINEAR_TO_LINEAR )\n\t\t\treturn node;\n\n\t\treturn Methods[ method ]( { value: node } );\n\n\t}\n\n}\n\nColorSpaceNode.LINEAR_TO_LINEAR = 'LinearToLinear';\nColorSpaceNode.LINEAR_TO_sRGB = 'LinearTosRGB';\nColorSpaceNode.sRGB_TO_LINEAR = 'sRGBToLinear';\n\nconst Methods = {\n\t[ ColorSpaceNode.LINEAR_TO_sRGB ]: LinearTosRGBShader,\n\t[ ColorSpaceNode.sRGB_TO_LINEAR ]: sRGBToLinearShader\n};\n\nexport default ColorSpaceNode;\n\nexport const linearToColorSpace = ( node, colorSpace ) => nodeObject( new ColorSpaceNode( getMethod( LinearSRGBColorSpace, colorSpace ), nodeObject( node ) ) );\nexport const colorSpaceToLinear = ( node, colorSpace ) => nodeObject( new ColorSpaceNode( getMethod( colorSpace, LinearSRGBColorSpace ), nodeObject( node ) ) );\n\nexport const linearTosRGB = nodeProxy( ColorSpaceNode, ColorSpaceNode.LINEAR_TO_sRGB );\nexport const sRGBToLinear = nodeProxy( ColorSpaceNode, ColorSpaceNode.sRGB_TO_LINEAR );\n\naddNodeElement( 'linearTosRGB', linearTosRGB );\naddNodeElement( 'sRGBToLinear', sRGBToLinear );\naddNodeElement( 'linearToColorSpace', linearToColorSpace );\naddNodeElement( 'colorSpaceToLinear', colorSpaceToLinear );\n\naddNodeClass( 'ColorSpaceNode', ColorSpaceNode );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { nodeProxy } from '../shadernode/ShaderNode.js';\n\nclass ExpressionNode extends Node {\n\n\tconstructor( snippet = '', nodeType = 'void' ) {\n\n\t\tsuper( nodeType );\n\n\t\tthis.snippet = snippet;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst type = this.getNodeType( builder );\n\t\tconst snippet = this.snippet;\n\n\t\tif ( type === 'void' ) {\n\n\t\t\tbuilder.addLineFlowCode( snippet );\n\n\t\t} else {\n\n\t\t\treturn builder.format( `( ${ snippet } )`, type, output );\n\n\t\t}\n\n\t}\n\n}\n\nexport default ExpressionNode;\n\nexport const expression = nodeProxy( ExpressionNode );\n\naddNodeClass( 'ExpressionNode', ExpressionNode );\n","import UniformNode from '../core/UniformNode.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { nodeProxy } from '../shadernode/ShaderNode.js';\nimport { addNodeClass } from '../core/Node.js';\n\nclass MaxMipLevelNode extends UniformNode {\n\n\tconstructor( textureNode ) {\n\n\t\tsuper( 0 );\n\n\t\tthis.textureNode = textureNode;\n\n\t\tthis.updateType = NodeUpdateType.FRAME;\n\n\t}\n\n\tget texture() {\n\n\t\treturn this.textureNode.value;\n\n\t}\n\n\tupdate() {\n\n\t\tconst texture = this.texture;\n\t\tconst images = texture.images;\n\t\tconst image = ( images && images.length > 0 ) ? ( ( images[ 0 ] && images[ 0 ].image ) || images[ 0 ] ) : texture.image;\n\n\t\tif ( image && image.width !== undefined ) {\n\n\t\t\tconst { width, height } = image;\n\n\t\t\tthis.value = Math.log2( Math.max( width, height ) );\n\n\t\t}\n\n\t}\n\n}\n\nexport default MaxMipLevelNode;\n\nexport const maxMipLevel = nodeProxy( MaxMipLevelNode );\n\naddNodeClass( 'MaxMipLevelNode', MaxMipLevelNode );\n","import UniformNode, { uniform } from '../core/UniformNode.js';\nimport { uv } from './UVNode.js';\nimport { textureSize } from './TextureSizeNode.js';\nimport { colorSpaceToLinear } from '../display/ColorSpaceNode.js';\nimport { expression } from '../code/ExpressionNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { maxMipLevel } from '../utils/MaxMipLevelNode.js';\nimport { addNodeElement, nodeProxy, vec3, nodeObject } from '../shadernode/ShaderNode.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { IntType, UnsignedIntType } from 'three';\n\nclass TextureNode extends UniformNode {\n\n\tconstructor( value, uvNode = null, levelNode = null ) {\n\n\t\tsuper( value );\n\n\t\tthis.isTextureNode = true;\n\n\t\tthis.uvNode = uvNode;\n\t\tthis.levelNode = levelNode;\n\t\tthis.compareNode = null;\n\t\tthis.depthNode = null;\n\t\tthis.gradNode = null;\n\n\t\tthis.sampler = true;\n\t\tthis.updateMatrix = false;\n\t\tthis.updateType = NodeUpdateType.NONE;\n\n\t\tthis.referenceNode = null;\n\n\t\tthis._value = value;\n\n\t\tthis.setUpdateMatrix( uvNode === null );\n\n\t}\n\n\tset value( value ) {\n\n\t\tif ( this.referenceNode ) {\n\n\t\t\tthis.referenceNode.value = value;\n\n\t\t} else {\n\n\t\t\tthis._value = value;\n\n\t\t}\n\n\t}\n\n\tget value() {\n\n\t\treturn this.referenceNode ? this.referenceNode.value : this._value;\n\n\t}\n\n\tgetUniformHash( /*builder*/ ) {\n\n\t\treturn this.value.uuid;\n\n\t}\n\n\tgetNodeType( /*builder*/ ) {\n\n\t\tif ( this.value.isDepthTexture === true ) return 'float';\n\n\t\tif ( this.value.type === UnsignedIntType ) {\n\n\t\t\treturn 'uvec4';\n\n\t\t} else if ( this.value.type === IntType ) {\n\n\t\t\treturn 'ivec4';\n\n\t\t}\n\n\t\treturn 'vec4';\n\n\t}\n\n\tgetInputType( /*builder*/ ) {\n\n\t\treturn 'texture';\n\n\t}\n\n\tgetDefaultUV() {\n\n\t\treturn uv( this.value.channel );\n\n\t}\n\n\tupdateReference( /*state*/ ) {\n\n\t\treturn this.value;\n\n\t}\n\n\tgetTransformedUV( uvNode ) {\n\n\t\tconst texture = this.value;\n\n\t\treturn uniform( texture.matrix ).mul( vec3( uvNode, 1 ) ).xy;\n\n\t}\n\n\tsetUpdateMatrix( value ) {\n\n\t\tthis.updateMatrix = value;\n\t\tthis.updateType = value ? NodeUpdateType.FRAME : NodeUpdateType.NONE;\n\n\t\treturn this;\n\n\t}\n\n\tsetupUV( builder, uvNode ) {\n\n\t\tconst texture = this.value;\n\n\t\tif ( builder.isFlipY() && ( texture.isRenderTargetTexture === true || texture.isFramebufferTexture === true || texture.isDepthTexture === true ) ) {\n\n\t\t\tuvNode = uvNode.setY( uvNode.y.oneMinus() );\n\n\t\t}\n\n\t\treturn uvNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst properties = builder.getNodeProperties( this );\n\n\t\t//\n\n\t\tlet uvNode = this.uvNode;\n\n\t\tif ( ( uvNode === null || builder.context.forceUVContext === true ) && builder.context.getUV ) {\n\n\t\t\tuvNode = builder.context.getUV( this );\n\n\t\t}\n\n\t\tif ( ! uvNode ) uvNode = this.getDefaultUV();\n\n\t\tif ( this.updateMatrix === true ) {\n\n\t\t\tuvNode = this.getTransformedUV( uvNode );\n\n\t\t}\n\n\t\tuvNode = this.setupUV( builder, uvNode );\n\n\t\t//\n\n\t\tlet levelNode = this.levelNode;\n\n\t\tif ( levelNode === null && builder.context.getTextureLevel ) {\n\n\t\t\tlevelNode = builder.context.getTextureLevel( this );\n\n\t\t}\n\n\t\t//\n\n\t\tproperties.uvNode = uvNode;\n\t\tproperties.levelNode = levelNode;\n\t\tproperties.compareNode = this.compareNode;\n\t\tproperties.gradNode = this.gradNode;\n\t\tproperties.depthNode = this.depthNode;\n\n\t}\n\n\tgenerateUV( builder, uvNode ) {\n\n\t\treturn uvNode.build( builder, this.sampler === true ? 'vec2' : 'ivec2' );\n\n\t}\n\n\tgenerateSnippet( builder, textureProperty, uvSnippet, levelSnippet, depthSnippet, compareSnippet, gradSnippet ) {\n\n\t\tconst texture = this.value;\n\n\t\tlet snippet;\n\n\t\tif ( levelSnippet ) {\n\n\t\t\tsnippet = builder.generateTextureLevel( texture, textureProperty, uvSnippet, levelSnippet, depthSnippet );\n\n\t\t} else if ( gradSnippet ) {\n\n\t\t\tsnippet = builder.generateTextureGrad( texture, textureProperty, uvSnippet, gradSnippet, depthSnippet );\n\n\t\t} else if ( compareSnippet ) {\n\n\t\t\tsnippet = builder.generateTextureCompare( texture, textureProperty, uvSnippet, compareSnippet, depthSnippet );\n\n\t\t} else if ( this.sampler === false ) {\n\n\t\t\tsnippet = builder.generateTextureLoad( texture, textureProperty, uvSnippet, depthSnippet );\n\n\t\t} else {\n\n\t\t\tsnippet = builder.generateTexture( texture, textureProperty, uvSnippet, depthSnippet );\n\n\t\t}\n\n\t\treturn snippet;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst properties = builder.getNodeProperties( this );\n\n\t\tconst texture = this.value;\n\n\t\tif ( ! texture || texture.isTexture !== true ) {\n\n\t\t\tthrow new Error( 'TextureNode: Need a three.js texture.' );\n\n\t\t}\n\n\t\tconst textureProperty = super.generate( builder, 'property' );\n\n\t\tif ( output === 'sampler' ) {\n\n\t\t\treturn textureProperty + '_sampler';\n\n\t\t} else if ( builder.isReference( output ) ) {\n\n\t\t\treturn textureProperty;\n\n\t\t} else {\n\n\t\t\tconst nodeData = builder.getDataFromNode( this );\n\n\t\t\tlet propertyName = nodeData.propertyName;\n\n\t\t\tif ( propertyName === undefined ) {\n\n\t\t\t\tconst { uvNode, levelNode, compareNode, depthNode, gradNode } = properties;\n\n\t\t\t\tconst uvSnippet = this.generateUV( builder, uvNode );\n\t\t\t\tconst levelSnippet = levelNode ? levelNode.build( builder, 'float' ) : null;\n\t\t\t\tconst depthSnippet = depthNode ? depthNode.build( builder, 'int' ) : null;\n\t\t\t\tconst compareSnippet = compareNode ? compareNode.build( builder, 'float' ) : null;\n\t\t\t\tconst gradSnippet = gradNode ? [ gradNode[ 0 ].build( builder, 'vec2' ), gradNode[ 1 ].build( builder, 'vec2' ) ] : null;\n\n\t\t\t\tconst nodeVar = builder.getVarFromNode( this );\n\n\t\t\t\tpropertyName = builder.getPropertyName( nodeVar );\n\n\t\t\t\tconst snippet = this.generateSnippet( builder, textureProperty, uvSnippet, levelSnippet, depthSnippet, compareSnippet, gradSnippet );\n\n\t\t\t\tbuilder.addLineFlowCode( `${propertyName} = ${snippet}` );\n\n\t\t\t\tnodeData.snippet = snippet;\n\t\t\t\tnodeData.propertyName = propertyName;\n\n\t\t\t}\n\n\t\t\tlet snippet = propertyName;\n\t\t\tconst nodeType = this.getNodeType( builder );\n\n\t\t\tif ( builder.needsColorSpaceToLinear( texture ) ) {\n\n\t\t\t\tsnippet = colorSpaceToLinear( expression( snippet, nodeType ), texture.colorSpace ).setup( builder ).build( builder, nodeType );\n\n\t\t\t}\n\n\t\t\treturn builder.format( snippet, nodeType, output );\n\n\t\t}\n\n\t}\n\n\tsetSampler( value ) {\n\n\t\tthis.sampler = value;\n\n\t\treturn this;\n\n\t}\n\n\tgetSampler() {\n\n\t\treturn this.sampler;\n\n\t}\n\n\t// @TODO: Move to TSL\n\n\tuv( uvNode ) {\n\n\t\tconst textureNode = this.clone();\n\t\ttextureNode.uvNode = uvNode;\n\t\ttextureNode.referenceNode = this;\n\n\t\treturn nodeObject( textureNode );\n\n\t}\n\n\tblur( levelNode ) {\n\n\t\tconst textureNode = this.clone();\n\t\ttextureNode.levelNode = levelNode.mul( maxMipLevel( textureNode ) );\n\t\ttextureNode.referenceNode = this;\n\n\t\treturn nodeObject( textureNode );\n\n\t}\n\n\tlevel( levelNode ) {\n\n\t\tconst textureNode = this.clone();\n\t\ttextureNode.levelNode = levelNode;\n\t\ttextureNode.referenceNode = this;\n\n\t\treturn textureNode;\n\n\t}\n\n\tsize( levelNode ) {\n\n\t\treturn textureSize( this, levelNode );\n\n\t}\n\n\tcompare( compareNode ) {\n\n\t\tconst textureNode = this.clone();\n\t\ttextureNode.compareNode = nodeObject( compareNode );\n\t\ttextureNode.referenceNode = this;\n\n\t\treturn nodeObject( textureNode );\n\n\t}\n\n\tgrad( gradNodeX, gradNodeY ) {\n\n\t\tconst textureNode = this.clone();\n\t\ttextureNode.gradNode = [ nodeObject( gradNodeX ), nodeObject( gradNodeY ) ];\n\n\t\ttextureNode.referenceNode = this;\n\n\t\treturn nodeObject( textureNode );\n\n\t}\n\n\tdepth( depthNode ) {\n\n\t\tconst textureNode = this.clone();\n\t\ttextureNode.depthNode = nodeObject( depthNode );\n\t\ttextureNode.referenceNode = this;\n\n\t\treturn nodeObject( textureNode );\n\n\t}\n\n\t// --\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.value = this.value.toJSON( data.meta ).uuid;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.value = data.meta.textures[ data.value ];\n\n\t}\n\n\tupdate() {\n\n\t\tconst texture = this.value;\n\n\t\tif ( texture.matrixAutoUpdate === true ) {\n\n\t\t\ttexture.updateMatrix();\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\tconst newNode = new this.constructor( this.value, this.uvNode, this.levelNode );\n\t\tnewNode.sampler = this.sampler;\n\n\t\treturn newNode;\n\n\t}\n\n}\n\nexport default TextureNode;\n\nexport const texture = nodeProxy( TextureNode );\nexport const textureLoad = ( ...params ) => texture( ...params ).setSampler( false );\n\n//export const textureLevel = ( value, uv, level ) => texture( value, uv ).level( level );\n\nexport const sampler = ( aTexture ) => ( aTexture.isNode === true ? aTexture : texture( aTexture ) ).convert( 'sampler' );\n\naddNodeElement( 'texture', texture );\n//addNodeElement( 'textureLevel', textureLevel );\n\naddNodeClass( 'TextureNode', TextureNode );\n","import UniformNode from '../core/UniformNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { nodeObject } from '../shadernode/ShaderNode.js';\n\nclass BufferNode extends UniformNode {\n\n\tconstructor( value, bufferType, bufferCount = 0 ) {\n\n\t\tsuper( value, bufferType );\n\n\t\tthis.isBufferNode = true;\n\n\t\tthis.bufferType = bufferType;\n\t\tthis.bufferCount = bufferCount;\n\n\t}\n\n\tgetElementType( builder ) {\n\n\t\treturn this.getNodeType( builder );\n\n\t}\n\n\tgetInputType( /*builder*/ ) {\n\n\t\treturn 'buffer';\n\n\t}\n\n}\n\nexport default BufferNode;\n\nexport const buffer = ( value, type, count ) => nodeObject( new BufferNode( value, type, count ) );\n\naddNodeClass( 'BufferNode', BufferNode );\n","import { addNodeClass } from '../core/Node.js';\nimport { nodeObject } from '../shadernode/ShaderNode.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { getValueType } from '../core/NodeUtils.js';\nimport ArrayElementNode from '../utils/ArrayElementNode.js';\nimport BufferNode from './BufferNode.js';\n\nclass UniformsElementNode extends ArrayElementNode {\n\n\tconstructor( arrayBuffer, indexNode ) {\n\n\t\tsuper( arrayBuffer, indexNode );\n\n\t\tthis.isArrayBufferElementNode = true;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.node.getElementType( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst snippet = super.generate( builder );\n\t\tconst type = this.getNodeType();\n\n\t\treturn builder.format( snippet, 'vec4', type );\n\n\t}\n\n}\n\nclass UniformsNode extends BufferNode {\n\n\tconstructor( value, elementType = null ) {\n\n\t\tsuper( null, 'vec4' );\n\n\t\tthis.array = value;\n\t\tthis.elementType = elementType;\n\n\t\tthis._elementType = null;\n\t\tthis._elementLength = 0;\n\n\t\tthis.updateType = NodeUpdateType.RENDER;\n\n\t\tthis.isArrayBufferNode = true;\n\n\t}\n\n\tgetElementType() {\n\n\t\treturn this.elementType || this._elementType;\n\n\t}\n\n\tgetElementLength() {\n\n\t\treturn this._elementLength;\n\n\t}\n\n\tupdate( /*frame*/ ) {\n\n\t\tconst { array, value } = this;\n\n\t\tconst elementLength = this.getElementLength();\n\t\tconst elementType = this.getElementType();\n\n\t\tif ( elementLength === 1 ) {\n\n\t\t\tfor ( let i = 0; i < array.length; i ++ ) {\n\n\t\t\t\tconst index = i * 4;\n\n\t\t\t\tvalue[ index ] = array[ i ];\n\n\t\t\t}\n\n\t\t} else if ( elementType === 'color' ) {\n\n\t\t\tfor ( let i = 0; i < array.length; i ++ ) {\n\n\t\t\t\tconst index = i * 4;\n\t\t\t\tconst vector = array[ i ];\n\n\t\t\t\tvalue[ index ] = vector.r;\n\t\t\t\tvalue[ index + 1 ] = vector.g;\n\t\t\t\tvalue[ index + 2 ] = vector.b || 0;\n\t\t\t\t//value[ index + 3 ] = vector.a || 0;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tfor ( let i = 0; i < array.length; i ++ ) {\n\n\t\t\t\tconst index = i * 4;\n\t\t\t\tconst vector = array[ i ];\n\n\t\t\t\tvalue[ index ] = vector.x;\n\t\t\t\tvalue[ index + 1 ] = vector.y;\n\t\t\t\tvalue[ index + 2 ] = vector.z || 0;\n\t\t\t\tvalue[ index + 3 ] = vector.w || 0;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst length = this.array.length;\n\n\t\tthis._elementType = this.elementType === null ? getValueType( this.array[ 0 ] ) : this.elementType;\n\t\tthis._elementLength = builder.getTypeLength( this._elementType );\n\n\t\tlet arrayType = Float32Array;\n\n\t\tif ( this._elementType.charAt( 0 ) === 'i' ) arrayType = Int32Array;\n\t\telse if ( this._elementType.charAt( 0 ) === 'u' ) arrayType = Uint32Array;\n\n\t\tthis.value = new arrayType( length * 4 );\n\t\tthis.bufferCount = length;\n\t\tthis.bufferType = builder.changeComponentType( 'vec4', builder.getComponentType( this._elementType ) );\n\n\t\treturn super.setup( builder );\n\n\t}\n\n\telement( indexNode ) {\n\n\t\treturn nodeObject( new UniformsElementNode( this, nodeObject( indexNode ) ) );\n\n\t}\n\n}\n\nexport default UniformsNode;\n\nexport const uniforms = ( values, nodeType ) => nodeObject( new UniformsNode( values, nodeType ) );\n\naddNodeClass( 'UniformsNode', UniformsNode );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { uniform } from '../core/UniformNode.js';\nimport { texture } from './TextureNode.js';\nimport { buffer } from './BufferNode.js';\nimport { nodeObject } from '../shadernode/ShaderNode.js';\nimport { uniforms } from './UniformsNode.js';\nimport ArrayElementNode from '../utils/ArrayElementNode.js';\n\nclass ReferenceElementNode extends ArrayElementNode {\n\n\tconstructor( referenceNode, indexNode ) {\n\n\t\tsuper( referenceNode, indexNode );\n\n\t\tthis.referenceNode = referenceNode;\n\n\t\tthis.isReferenceElementNode = true;\n\n\t}\n\n\tgetNodeType() {\n\n\t\treturn this.referenceNode.uniformType;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst snippet = super.generate( builder );\n\t\tconst arrayType = this.referenceNode.getNodeType();\n\t\tconst elementType = this.getNodeType();\n\n\t\treturn builder.format( snippet, arrayType, elementType );\n\n\t}\n\n}\n\nclass ReferenceNode extends Node {\n\n\tconstructor( property, uniformType, object = null, count = null ) {\n\n\t\tsuper();\n\n\t\tthis.property = property;\n\t\tthis.uniformType = uniformType;\n\t\tthis.object = object;\n\t\tthis.count = count;\n\n\t\tthis.properties = property.split( '.' );\n\t\tthis.reference = null;\n\t\tthis.node = null;\n\n\t\tthis.updateType = NodeUpdateType.OBJECT;\n\n\t}\n\n\telement( indexNode ) {\n\n\t\treturn nodeObject( new ReferenceElementNode( this, nodeObject( indexNode ) ) );\n\n\t}\n\n\tsetNodeType( uniformType ) {\n\n\t\tlet node = null;\n\n\t\tif ( this.count !== null ) {\n\n\t\t\tnode = buffer( null, uniformType, this.count );\n\n\t\t} else if ( Array.isArray( this.getValueFromReference() ) ) {\n\n\t\t\tnode = uniforms( null, uniformType );\n\n\t\t} else if ( uniformType === 'texture' ) {\n\n\t\t\tnode = texture( null );\n\n\t\t} else {\n\n\t\t\tnode = uniform( null, uniformType );\n\n\t\t}\n\n\t\tthis.node = node;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tif ( this.node === null ) {\n\n\t\t\tthis.updateValue();\n\n\t\t}\n\n\t\treturn this.node.getNodeType( builder );\n\n\t}\n\n\tgetValueFromReference( object = this.reference ) {\n\n\t\tconst { properties } = this;\n\n\t\tlet value = object[ properties[ 0 ] ];\n\n\t\tfor ( let i = 1; i < properties.length; i ++ ) {\n\n\t\t\tvalue = value[ properties[ i ] ];\n\n\t\t}\n\n\t\treturn value;\n\n\t}\n\n\tupdateReference( state ) {\n\n\t\tthis.reference = this.object !== null ? this.object : state.object;\n\n\t\treturn this.reference;\n\n\t}\n\n\tsetup() {\n\n\t\tthis.updateValue();\n\n\t\treturn this.node;\n\n\t}\n\n\tupdate( /*frame*/ ) {\n\n\t\tthis.updateValue();\n\n\t}\n\n\tupdateValue() {\n\n\t\tif ( this.node === null ) this.setNodeType( this.uniformType );\n\n\t\tconst value = this.getValueFromReference();\n\n\t\tif ( Array.isArray( value ) ) {\n\n\t\t\tthis.node.array = value;\n\n\t\t} else {\n\n\t\t\tthis.node.value = value;\n\n\t\t}\n\n\t}\n\n}\n\nexport default ReferenceNode;\n\nexport const reference = ( name, type, object ) => nodeObject( new ReferenceNode( name, type, object ) );\nexport const referenceBuffer = ( name, type, count, object ) => nodeObject( new ReferenceNode( name, type, object, count ) );\n\naddNodeClass( 'ReferenceNode', ReferenceNode );\n","import ReferenceNode from './ReferenceNode.js';\n//import { renderGroup } from '../core/UniformGroupNode.js';\n//import { NodeUpdateType } from '../core/constants.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { nodeObject } from '../shadernode/ShaderNode.js';\n\nclass MaterialReferenceNode extends ReferenceNode {\n\n\tconstructor( property, inputType, material = null ) {\n\n\t\tsuper( property, inputType, material );\n\n\t\tthis.material = material;\n\n\t\t//this.updateType = NodeUpdateType.RENDER;\n\n\t}\n\n\t/*setNodeType( node ) {\n\n\t\tsuper.setNodeType( node );\n\n\t\tthis.node.groupNode = renderGroup;\n\n\t}*/\n\n\tupdateReference( state ) {\n\n\t\tthis.reference = this.material !== null ? this.material : state.material;\n\n\t\treturn this.reference;\n\n\t}\n\n}\n\nexport default MaterialReferenceNode;\n\nexport const materialReference = ( name, type, material ) => nodeObject( new MaterialReferenceNode( name, type, material ) );\n\naddNodeClass( 'MaterialReferenceNode', MaterialReferenceNode );\n","import { uniform } from '../core/UniformNode.js';\nimport { sharedUniformGroup } from '../core/UniformGroupNode.js';\nimport { Vector3 } from 'three';\n\nconst cameraGroup = /*#__PURE__*/ sharedUniformGroup( 'camera' ).onRenderUpdate( () => {\n\n\tcameraGroup.needsUpdate = true;\n\n} );\n\nexport const cameraNear = /*#__PURE__*/ uniform( 'float' ).label( 'cameraNear' ).setGroup( cameraGroup ).onRenderUpdate( ( { camera } ) => camera.near );\nexport const cameraFar = /*#__PURE__*/ uniform( 'float' ).label( 'cameraFar' ).setGroup( cameraGroup ).onRenderUpdate( ( { camera } ) => camera.far );\nexport const cameraLogDepth = /*#__PURE__*/ uniform( 'float' ).label( 'cameraLogDepth' ).setGroup( cameraGroup ).onRenderUpdate( ( { camera } ) => 2.0 / ( Math.log( camera.far + 1.0 ) / Math.LN2 ) );\nexport const cameraProjectionMatrix = /*#__PURE__*/ uniform( 'mat4' ).label( 'cameraProjectionMatrix' ).setGroup( cameraGroup ).onRenderUpdate( ( { camera } ) => camera.projectionMatrix );\nexport const cameraProjectionMatrixInverse = /*#__PURE__*/ uniform( 'mat4' ).label( 'cameraProjectionMatrixInverse' ).setGroup( cameraGroup ).onRenderUpdate( ( { camera } ) => camera.projectionMatrixInverse );\nexport const cameraViewMatrix = /*#__PURE__*/ uniform( 'mat4' ).label( 'cameraViewMatrix' ).setGroup( cameraGroup ).onRenderUpdate( ( { camera } ) => camera.matrixWorldInverse );\nexport const cameraWorldMatrix = /*#__PURE__*/ uniform( 'mat4' ).label( 'cameraWorldMatrix' ).setGroup( cameraGroup ).onRenderUpdate( ( { camera } ) => camera.matrixWorld );\nexport const cameraNormalMatrix = /*#__PURE__*/ uniform( 'mat3' ).label( 'cameraNormalMatrix' ).setGroup( cameraGroup ).onRenderUpdate( ( { camera } ) => camera.normalMatrix );\nexport const cameraPosition = /*#__PURE__*/ uniform( new Vector3() ).label( 'cameraPosition' ).setGroup( cameraGroup ).onRenderUpdate( ( { camera }, self ) => self.value.setFromMatrixPosition( camera.matrixWorld ) );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport UniformNode from '../core/UniformNode.js';\nimport { nodeProxy } from '../shadernode/ShaderNode.js';\n\nimport { Vector3 } from 'three';\n\nclass Object3DNode extends Node {\n\n\tconstructor( scope = Object3DNode.VIEW_MATRIX, object3d = null ) {\n\n\t\tsuper();\n\n\t\tthis.scope = scope;\n\t\tthis.object3d = object3d;\n\n\t\tthis.updateType = NodeUpdateType.OBJECT;\n\n\t\tthis._uniformNode = new UniformNode( null );\n\n\t}\n\n\tgetNodeType() {\n\n\t\tconst scope = this.scope;\n\n\t\tif ( scope === Object3DNode.WORLD_MATRIX || scope === Object3DNode.VIEW_MATRIX ) {\n\n\t\t\treturn 'mat4';\n\n\t\t} else if ( scope === Object3DNode.NORMAL_MATRIX ) {\n\n\t\t\treturn 'mat3';\n\n\t\t} else if ( scope === Object3DNode.POSITION || scope === Object3DNode.VIEW_POSITION || scope === Object3DNode.DIRECTION || scope === Object3DNode.SCALE ) {\n\n\t\t\treturn 'vec3';\n\n\t\t}\n\n\t}\n\n\tupdate( frame ) {\n\n\t\tconst object = this.object3d;\n\t\tconst uniformNode = this._uniformNode;\n\t\tconst scope = this.scope;\n\n\t\tif ( scope === Object3DNode.VIEW_MATRIX ) {\n\n\t\t\tuniformNode.value = object.modelViewMatrix;\n\n\t\t} else if ( scope === Object3DNode.NORMAL_MATRIX ) {\n\n\t\t\tuniformNode.value = object.normalMatrix;\n\n\t\t} else if ( scope === Object3DNode.WORLD_MATRIX ) {\n\n\t\t\tuniformNode.value = object.matrixWorld;\n\n\t\t} else if ( scope === Object3DNode.POSITION ) {\n\n\t\t\tuniformNode.value = uniformNode.value || new Vector3();\n\n\t\t\tuniformNode.value.setFromMatrixPosition( object.matrixWorld );\n\n\t\t} else if ( scope === Object3DNode.SCALE ) {\n\n\t\t\tuniformNode.value = uniformNode.value || new Vector3();\n\n\t\t\tuniformNode.value.setFromMatrixScale( object.matrixWorld );\n\n\t\t} else if ( scope === Object3DNode.DIRECTION ) {\n\n\t\t\tuniformNode.value = uniformNode.value || new Vector3();\n\n\t\t\tobject.getWorldDirection( uniformNode.value );\n\n\t\t} else if ( scope === Object3DNode.VIEW_POSITION ) {\n\n\t\t\tconst camera = frame.camera;\n\n\t\t\tuniformNode.value = uniformNode.value || new Vector3();\n\t\t\tuniformNode.value.setFromMatrixPosition( object.matrixWorld );\n\n\t\t\tuniformNode.value.applyMatrix4( camera.matrixWorldInverse );\n\n\t\t}\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst scope = this.scope;\n\n\t\tif ( scope === Object3DNode.WORLD_MATRIX || scope === Object3DNode.VIEW_MATRIX ) {\n\n\t\t\tthis._uniformNode.nodeType = 'mat4';\n\n\t\t} else if ( scope === Object3DNode.NORMAL_MATRIX ) {\n\n\t\t\tthis._uniformNode.nodeType = 'mat3';\n\n\t\t} else if ( scope === Object3DNode.POSITION || scope === Object3DNode.VIEW_POSITION || scope === Object3DNode.DIRECTION || scope === Object3DNode.SCALE ) {\n\n\t\t\tthis._uniformNode.nodeType = 'vec3';\n\n\t\t}\n\n\t\treturn this._uniformNode.build( builder );\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.scope = this.scope;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.scope = data.scope;\n\n\t}\n\n}\n\nObject3DNode.VIEW_MATRIX = 'viewMatrix';\nObject3DNode.NORMAL_MATRIX = 'normalMatrix';\nObject3DNode.WORLD_MATRIX = 'worldMatrix';\nObject3DNode.POSITION = 'position';\nObject3DNode.SCALE = 'scale';\nObject3DNode.VIEW_POSITION = 'viewPosition';\nObject3DNode.DIRECTION = 'direction';\n\nexport default Object3DNode;\n\nexport const objectDirection = nodeProxy( Object3DNode, Object3DNode.DIRECTION );\nexport const objectViewMatrix = nodeProxy( Object3DNode, Object3DNode.VIEW_MATRIX );\nexport const objectNormalMatrix = nodeProxy( Object3DNode, Object3DNode.NORMAL_MATRIX );\nexport const objectWorldMatrix = nodeProxy( Object3DNode, Object3DNode.WORLD_MATRIX );\nexport const objectPosition = nodeProxy( Object3DNode, Object3DNode.POSITION );\nexport const objectScale = nodeProxy( Object3DNode, Object3DNode.SCALE );\nexport const objectViewPosition = nodeProxy( Object3DNode, Object3DNode.VIEW_POSITION );\n\naddNodeClass( 'Object3DNode', Object3DNode );\n","import Object3DNode from './Object3DNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { nodeImmutable } from '../shadernode/ShaderNode.js';\nimport { uniform } from '../core/UniformNode.js';\nimport { Matrix4 } from 'three';\n\nclass ModelNode extends Object3DNode {\n\n\tconstructor( scope = ModelNode.VIEW_MATRIX ) {\n\n\t\tsuper( scope );\n\n\t}\n\n\tupdate( frame ) {\n\n\t\tthis.object3d = frame.object;\n\n\t\tsuper.update( frame );\n\n\t}\n\n}\n\nexport default ModelNode;\n\nexport const modelDirection = nodeImmutable( ModelNode, ModelNode.DIRECTION );\nexport const modelViewMatrix = nodeImmutable( ModelNode, ModelNode.VIEW_MATRIX ).label( 'modelViewMatrix' ).temp( 'ModelViewMatrix' );\nexport const modelNormalMatrix = nodeImmutable( ModelNode, ModelNode.NORMAL_MATRIX );\nexport const modelWorldMatrix = nodeImmutable( ModelNode, ModelNode.WORLD_MATRIX );\nexport const modelPosition = nodeImmutable( ModelNode, ModelNode.POSITION );\nexport const modelScale = nodeImmutable( ModelNode, ModelNode.SCALE );\nexport const modelViewPosition = nodeImmutable( ModelNode, ModelNode.VIEW_POSITION );\nexport const modelWorldMatrixInverse = uniform( new Matrix4() ).onObjectUpdate( ( { object }, self ) => self.value.copy( object.matrixWorld ).invert() );\n\naddNodeClass( 'ModelNode', ModelNode );\n","import { attribute } from '../core/AttributeNode.js';\nimport { varying } from '../core/VaryingNode.js';\nimport { property } from '../core/PropertyNode.js';\nimport { cameraViewMatrix } from './CameraNode.js';\nimport { modelNormalMatrix } from './ModelNode.js';\nimport { vec3 } from '../shadernode/ShaderNode.js';\n\nexport const normalGeometry = /*#__PURE__*/ attribute( 'normal', 'vec3', vec3( 0, 1, 0 ) );\nexport const normalLocal = /*#__PURE__*/ normalGeometry.toVar( 'normalLocal' );\nexport const normalView = /*#__PURE__*/ varying( modelNormalMatrix.mul( normalLocal ), 'v_normalView' ).normalize().toVar( 'normalView' );\nexport const normalWorld = /*#__PURE__*/ varying( normalView.transformDirection( cameraViewMatrix ), 'v_normalWorld' ).normalize().toVar( 'transformedNormalWorld' );\nexport const transformedNormalView = /*#__PURE__*/ property( 'vec3', 'transformedNormalView' );\nexport const transformedNormalWorld = /*#__PURE__*/ transformedNormalView.transformDirection( cameraViewMatrix ).normalize().toVar( 'transformedNormalWorld' );\nexport const transformedClearcoatNormalView = /*#__PURE__*/ property( 'vec3', 'transformedClearcoatNormalView' );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { reference } from './ReferenceNode.js';\nimport { materialReference } from './MaterialReferenceNode.js';\nimport { normalView } from './NormalNode.js';\nimport { nodeImmutable, float, vec2, mat2 } from '../shadernode/ShaderNode.js';\nimport { uniform } from '../core/UniformNode.js';\nimport { Vector2 } from 'three';\n\nconst _propertyCache = new Map();\n\nclass MaterialNode extends Node {\n\n\tconstructor( scope ) {\n\n\t\tsuper();\n\n\t\tthis.scope = scope;\n\n\t}\n\n\tgetCache( property, type ) {\n\n\t\tlet node = _propertyCache.get( property );\n\n\t\tif ( node === undefined ) {\n\n\t\t\tnode = materialReference( property, type );\n\n\t\t\t_propertyCache.set( property, node );\n\n\t\t}\n\n\t\treturn node;\n\n\t}\n\n\tgetFloat( property ) {\n\n\t\treturn this.getCache( property, 'float' );\n\n\t}\n\n\tgetColor( property ) {\n\n\t\treturn this.getCache( property, 'color' );\n\n\t}\n\n\tgetTexture( property ) {\n\n\t\treturn this.getCache( property === 'map' ? 'map' : property + 'Map', 'texture' );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst material = builder.context.material;\n\t\tconst scope = this.scope;\n\n\t\tlet node = null;\n\n\t\tif ( scope === MaterialNode.COLOR ) {\n\n\t\t\tconst colorNode = this.getColor( scope );\n\n\t\t\tif ( material.map && material.map.isTexture === true ) {\n\n\t\t\t\tnode = colorNode.mul( this.getTexture( 'map' ) );\n\n\t\t\t} else {\n\n\t\t\t\tnode = colorNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.OPACITY ) {\n\n\t\t\tconst opacityNode = this.getFloat( scope );\n\n\t\t\tif ( material.alphaMap && material.alphaMap.isTexture === true ) {\n\n\t\t\t\tnode = opacityNode.mul( this.getTexture( 'alpha' ) );\n\n\t\t\t} else {\n\n\t\t\t\tnode = opacityNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.SPECULAR_STRENGTH ) {\n\n\t\t\tif ( material.specularMap && material.specularMap.isTexture === true ) {\n\n\t\t\t\tnode = this.getTexture( 'specular' ).r;\n\n\t\t\t} else {\n\n\t\t\t\tnode = float( 1 );\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.SPECULAR_INTENSITY ) {\n\n\t\t\tconst specularIntensity = this.getFloat( scope );\n\n\t\t\tif ( material.specularMap ) {\n\n\t\t\t\tnode = specularIntensity.mul( this.getTexture( scope ).a );\n\n\t\t\t} else {\n\n\t\t\t\tnode = specularIntensity;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.SPECULAR_COLOR ) {\n\n\t\t\tconst specularColorNode = this.getColor( scope );\n\n\t\t\tif ( material.specularColorMap && material.specularColorMap.isTexture === true ) {\n\n\t\t\t\tnode = specularColorNode.mul( this.getTexture( scope ).rgb );\n\n\t\t\t} else {\n\n\t\t\t\tnode = specularColorNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.ROUGHNESS ) { // TODO: cleanup similar branches\n\n\t\t\tconst roughnessNode = this.getFloat( scope );\n\n\t\t\tif ( material.roughnessMap && material.roughnessMap.isTexture === true ) {\n\n\t\t\t\tnode = roughnessNode.mul( this.getTexture( scope ).g );\n\n\t\t\t} else {\n\n\t\t\t\tnode = roughnessNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.METALNESS ) {\n\n\t\t\tconst metalnessNode = this.getFloat( scope );\n\n\t\t\tif ( material.metalnessMap && material.metalnessMap.isTexture === true ) {\n\n\t\t\t\tnode = metalnessNode.mul( this.getTexture( scope ).b );\n\n\t\t\t} else {\n\n\t\t\t\tnode = metalnessNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.EMISSIVE ) {\n\n\t\t\tconst emissiveNode = this.getColor( scope );\n\n\t\t\tif ( material.emissiveMap && material.emissiveMap.isTexture === true ) {\n\n\t\t\t\tnode = emissiveNode.mul( this.getTexture( scope ) );\n\n\t\t\t} else {\n\n\t\t\t\tnode = emissiveNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.NORMAL ) {\n\n\t\t\tif ( material.normalMap ) {\n\n\t\t\t\tnode = this.getTexture( 'normal' ).normalMap( this.getCache( 'normalScale', 'vec2' ) );\n\n\t\t\t} else if ( material.bumpMap ) {\n\n\t\t\t\tnode = this.getTexture( 'bump' ).r.bumpMap( this.getFloat( 'bumpScale' ) );\n\n\t\t\t} else {\n\n\t\t\t\tnode = normalView;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.CLEARCOAT ) {\n\n\t\t\tconst clearcoatNode = this.getFloat( scope );\n\n\t\t\tif ( material.clearcoatMap && material.clearcoatMap.isTexture === true ) {\n\n\t\t\t\tnode = clearcoatNode.mul( this.getTexture( scope ).r );\n\n\t\t\t} else {\n\n\t\t\t\tnode = clearcoatNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.CLEARCOAT_ROUGHNESS ) {\n\n\t\t\tconst clearcoatRoughnessNode = this.getFloat( scope );\n\n\t\t\tif ( material.clearcoatRoughnessMap && material.clearcoatRoughnessMap.isTexture === true ) {\n\n\t\t\t\tnode = clearcoatRoughnessNode.mul( this.getTexture( scope ).r );\n\n\t\t\t} else {\n\n\t\t\t\tnode = clearcoatRoughnessNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.CLEARCOAT_NORMAL ) {\n\n\t\t\tif ( material.clearcoatNormalMap ) {\n\n\t\t\t\tnode = this.getTexture( scope ).normalMap( this.getCache( scope + 'Scale', 'vec2' ) );\n\n\t\t\t} else {\n\n\t\t\t\tnode = normalView;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.SHEEN ) {\n\n\t\t\tconst sheenNode = this.getColor( 'sheenColor' ).mul( this.getFloat( 'sheen' ) ); // Move this mul() to CPU\n\n\t\t\tif ( material.sheenColorMap && material.sheenColorMap.isTexture === true ) {\n\n\t\t\t\tnode = sheenNode.mul( this.getTexture( 'sheenColor' ).rgb );\n\n\t\t\t} else {\n\n\t\t\t\tnode = sheenNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.SHEEN_ROUGHNESS ) {\n\n\t\t\tconst sheenRoughnessNode = this.getFloat( scope );\n\n\t\t\tif ( material.sheenRoughnessMap && material.sheenRoughnessMap.isTexture === true ) {\n\n\t\t\t\tnode = sheenRoughnessNode.mul( this.getTexture( scope ).a );\n\n\t\t\t} else {\n\n\t\t\t\tnode = sheenRoughnessNode;\n\n\t\t\t}\n\n\t\t\tnode = node.clamp( 0.07, 1.0 );\n\n\t\t} else if ( scope === MaterialNode.ANISOTROPY ) {\n\n\t\t\tif ( material.anisotropyMap && material.anisotropyMap.isTexture === true ) {\n\n\t\t\t\tconst anisotropyPolar = this.getTexture( scope );\n\t\t\t\tconst anisotropyMat = mat2( materialAnisotropyVector.x, materialAnisotropyVector.y, materialAnisotropyVector.y.negate(), materialAnisotropyVector.x );\n\n\t\t\t\tnode = anisotropyMat.mul( anisotropyPolar.rg.mul( 2.0 ).sub( vec2( 1.0 ) ).normalize().mul( anisotropyPolar.b ) );\n\n\t\t\t} else {\n\n\t\t\t\tnode = materialAnisotropyVector;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.IRIDESCENCE_THICKNESS ) {\n\n\t\t\tconst iridescenceThicknessMaximum = reference( '1', 'float', material.iridescenceThicknessRange );\n\n\t\t\tif ( material.iridescenceThicknessMap ) {\n\n\t\t\t\tconst iridescenceThicknessMinimum = reference( '0', 'float', material.iridescenceThicknessRange );\n\n\t\t\t\tnode = iridescenceThicknessMaximum.sub( iridescenceThicknessMinimum ).mul( this.getTexture( scope ).g ).add( iridescenceThicknessMinimum );\n\n\t\t\t} else {\n\n\t\t\t\tnode = iridescenceThicknessMaximum;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.TRANSMISSION ) {\n\n\t\t\tconst transmissionNode = this.getFloat( scope );\n\n\t\t\tif ( material.transmissionMap ) {\n\n\t\t\t\tnode = transmissionNode.mul( this.getTexture( scope ).r );\n\n\t\t\t} else {\n\n\t\t\t\tnode = transmissionNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.THICKNESS ) {\n\n\t\t\tconst thicknessNode = this.getFloat( scope );\n\n\t\t\tif ( material.thicknessMap ) {\n\n\t\t\t\tnode = thicknessNode.mul( this.getTexture( scope ).g );\n\n\t\t\t} else {\n\n\t\t\t\tnode = thicknessNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.IOR ) {\n\n\t\t\tnode = this.getFloat( scope );\n\n\t\t} else {\n\n\t\t\tconst outputType = this.getNodeType( builder );\n\n\t\t\tnode = this.getCache( scope, outputType );\n\n\t\t}\n\n\t\treturn node;\n\n\t}\n\n}\n\nMaterialNode.ALPHA_TEST = 'alphaTest';\nMaterialNode.COLOR = 'color';\nMaterialNode.OPACITY = 'opacity';\nMaterialNode.SHININESS = 'shininess';\nMaterialNode.SPECULAR = 'specular';\nMaterialNode.SPECULAR_STRENGTH = 'specularStrength';\nMaterialNode.SPECULAR_INTENSITY = 'specularIntensity';\nMaterialNode.SPECULAR_COLOR = 'specularColor';\nMaterialNode.REFLECTIVITY = 'reflectivity';\nMaterialNode.ROUGHNESS = 'roughness';\nMaterialNode.METALNESS = 'metalness';\nMaterialNode.NORMAL = 'normal';\nMaterialNode.CLEARCOAT = 'clearcoat';\nMaterialNode.CLEARCOAT_ROUGHNESS = 'clearcoatRoughness';\nMaterialNode.CLEARCOAT_NORMAL = 'clearcoatNormal';\nMaterialNode.EMISSIVE = 'emissive';\nMaterialNode.ROTATION = 'rotation';\nMaterialNode.SHEEN = 'sheen';\nMaterialNode.SHEEN_ROUGHNESS = 'sheenRoughness';\nMaterialNode.ANISOTROPY = 'anisotropy';\nMaterialNode.IRIDESCENCE = 'iridescence';\nMaterialNode.IRIDESCENCE_IOR = 'iridescenceIOR';\nMaterialNode.IRIDESCENCE_THICKNESS = 'iridescenceThickness';\nMaterialNode.IOR = 'ior';\nMaterialNode.TRANSMISSION = 'transmission';\nMaterialNode.THICKNESS = 'thickness';\nMaterialNode.ATTENUATION_DISTANCE = 'attenuationDistance';\nMaterialNode.ATTENUATION_COLOR = 'attenuationColor';\nMaterialNode.LINE_SCALE = 'scale';\nMaterialNode.LINE_DASH_SIZE = 'dashSize';\nMaterialNode.LINE_GAP_SIZE = 'gapSize';\nMaterialNode.LINE_WIDTH = 'linewidth';\nMaterialNode.LINE_DASH_OFFSET = 'dashOffset';\nMaterialNode.POINT_WIDTH = 'pointWidth';\nMaterialNode.DISPERSION = 'dispersion';\n\nexport default MaterialNode;\n\nexport const materialAlphaTest = nodeImmutable( MaterialNode, MaterialNode.ALPHA_TEST );\nexport const materialColor = nodeImmutable( MaterialNode, MaterialNode.COLOR );\nexport const materialShininess = nodeImmutable( MaterialNode, MaterialNode.SHININESS );\nexport const materialEmissive = nodeImmutable( MaterialNode, MaterialNode.EMISSIVE );\nexport const materialOpacity = nodeImmutable( MaterialNode, MaterialNode.OPACITY );\nexport const materialSpecular = nodeImmutable( MaterialNode, MaterialNode.SPECULAR );\n\nexport const materialSpecularIntensity = nodeImmutable( MaterialNode, MaterialNode.SPECULAR_INTENSITY );\nexport const materialSpecularColor = nodeImmutable( MaterialNode, MaterialNode.SPECULAR_COLOR );\n\nexport const materialSpecularStrength = nodeImmutable( MaterialNode, MaterialNode.SPECULAR_STRENGTH );\nexport const materialReflectivity = nodeImmutable( MaterialNode, MaterialNode.REFLECTIVITY );\nexport const materialRoughness = nodeImmutable( MaterialNode, MaterialNode.ROUGHNESS );\nexport const materialMetalness = nodeImmutable( MaterialNode, MaterialNode.METALNESS );\nexport const materialNormal = nodeImmutable( MaterialNode, MaterialNode.NORMAL );\nexport const materialClearcoat = nodeImmutable( MaterialNode, MaterialNode.CLEARCOAT );\nexport const materialClearcoatRoughness = nodeImmutable( MaterialNode, MaterialNode.CLEARCOAT_ROUGHNESS );\nexport const materialClearcoatNormal = nodeImmutable( MaterialNode, MaterialNode.CLEARCOAT_NORMAL );\nexport const materialRotation = nodeImmutable( MaterialNode, MaterialNode.ROTATION );\nexport const materialSheen = nodeImmutable( MaterialNode, MaterialNode.SHEEN );\nexport const materialSheenRoughness = nodeImmutable( MaterialNode, MaterialNode.SHEEN_ROUGHNESS );\nexport const materialAnisotropy = nodeImmutable( MaterialNode, MaterialNode.ANISOTROPY );\nexport const materialIridescence = nodeImmutable( MaterialNode, MaterialNode.IRIDESCENCE );\nexport const materialIridescenceIOR = nodeImmutable( MaterialNode, MaterialNode.IRIDESCENCE_IOR );\nexport const materialIridescenceThickness = nodeImmutable( MaterialNode, MaterialNode.IRIDESCENCE_THICKNESS );\nexport const materialTransmission = nodeImmutable( MaterialNode, MaterialNode.TRANSMISSION );\nexport const materialThickness = nodeImmutable( MaterialNode, MaterialNode.THICKNESS );\nexport const materialIOR = nodeImmutable( MaterialNode, MaterialNode.IOR );\nexport const materialAttenuationDistance = nodeImmutable( MaterialNode, MaterialNode.ATTENUATION_DISTANCE );\nexport const materialAttenuationColor = nodeImmutable( MaterialNode, MaterialNode.ATTENUATION_COLOR );\nexport const materialLineScale = nodeImmutable( MaterialNode, MaterialNode.LINE_SCALE );\nexport const materialLineDashSize = nodeImmutable( MaterialNode, MaterialNode.LINE_DASH_SIZE );\nexport const materialLineGapSize = nodeImmutable( MaterialNode, MaterialNode.LINE_GAP_SIZE );\nexport const materialLineWidth = nodeImmutable( MaterialNode, MaterialNode.LINE_WIDTH );\nexport const materialLineDashOffset = nodeImmutable( MaterialNode, MaterialNode.LINE_DASH_OFFSET );\nexport const materialPointWidth = nodeImmutable( MaterialNode, MaterialNode.POINT_WIDTH );\nexport const materialDispersion = nodeImmutable( MaterialNode, MaterialNode.DISPERSION );\nexport const materialAnisotropyVector = uniform( new Vector2() ).onReference( function ( frame ) {\n\n\treturn frame.material;\n\n} ).onRenderUpdate( function ( { material } ) {\n\n\tthis.value.set( material.anisotropy * Math.cos( material.anisotropyRotation ), material.anisotropy * Math.sin( material.anisotropyRotation ) );\n\n} );\n\naddNodeClass( 'MaterialNode', MaterialNode );\n","import { attribute } from '../core/AttributeNode.js';\nimport { varying } from '../core/VaryingNode.js';\nimport { modelWorldMatrix, modelViewMatrix } from './ModelNode.js';\n\nexport const positionGeometry = /*#__PURE__*/ attribute( 'position', 'vec3' );\nexport const positionLocal = /*#__PURE__*/ positionGeometry.toVar( 'positionLocal' );\nexport const positionWorld = /*#__PURE__*/ varying( modelWorldMatrix.mul( positionLocal ).xyz, 'v_positionWorld' );\nexport const positionWorldDirection = /*#__PURE__*/ varying( positionLocal.transformDirection( modelWorldMatrix ), 'v_positionWorldDirection' ).normalize().toVar( 'positionWorldDirection' );\nexport const positionView = /*#__PURE__*/ varying( modelViewMatrix.mul( positionLocal ).xyz, 'v_positionView' );\nexport const positionViewDirection = /*#__PURE__*/ varying( positionView.negate(), 'v_positionViewDirection' ).normalize().toVar( 'positionViewDirection' );\n","import { addNodeClass } from '../core/Node.js';\nimport TempNode from '../core/TempNode.js';\nimport { cameraProjectionMatrix } from './CameraNode.js';\nimport { modelViewMatrix } from './ModelNode.js';\nimport { positionLocal } from './PositionNode.js';\nimport { nodeProxy } from '../shadernode/ShaderNode.js';\nimport { varying } from '../core/VaryingNode.js';\n\nclass ModelViewProjectionNode extends TempNode {\n\n\tconstructor( positionNode = null ) {\n\n\t\tsuper( 'vec4' );\n\n\t\tthis.positionNode = positionNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tif ( builder.shaderStage === 'fragment' ) {\n\n\t\t\treturn varying( builder.context.mvp );\n\n\t\t}\n\n\t\tconst position = this.positionNode || positionLocal;\n\n\t\treturn cameraProjectionMatrix.mul( modelViewMatrix ).mul( position );\n\n\t}\n\n}\n\nexport default ModelViewProjectionNode;\n\nexport const modelViewProjection = nodeProxy( ModelViewProjectionNode );\n\naddNodeClass( 'ModelViewProjectionNode', ModelViewProjectionNode );\n","import InputNode from '../core/InputNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { varying } from '../core/VaryingNode.js';\nimport { nodeObject, addNodeElement } from '../shadernode/ShaderNode.js';\nimport { InterleavedBufferAttribute, InterleavedBuffer, StaticDrawUsage, DynamicDrawUsage } from 'three';\n\nclass BufferAttributeNode extends InputNode {\n\n\tconstructor( value, bufferType = null, bufferStride = 0, bufferOffset = 0 ) {\n\n\t\tsuper( value, bufferType );\n\n\t\tthis.isBufferNode = true;\n\n\t\tthis.bufferType = bufferType;\n\t\tthis.bufferStride = bufferStride;\n\t\tthis.bufferOffset = bufferOffset;\n\n\t\tthis.usage = StaticDrawUsage;\n\t\tthis.instanced = false;\n\n\t\tthis.attribute = null;\n\n\t\tthis.global = true;\n\n\t\tif ( value && value.isBufferAttribute === true ) {\n\n\t\t\tthis.attribute = value;\n\t\t\tthis.usage = value.usage;\n\t\t\tthis.instanced = value.isInstancedBufferAttribute;\n\n\t\t}\n\n\t}\n\n\tgetHash( builder ) {\n\n\t\tif ( this.bufferStride === 0 && this.bufferOffset === 0 ) {\n\n\t\t\tlet bufferData = builder.globalCache.getData( this.value );\n\n\t\t\tif ( bufferData === undefined ) {\n\n\t\t\t\tbufferData = {\n\t\t\t\t\tnode: this\n\t\t\t\t};\n\n\t\t\t\tbuilder.globalCache.setData( this.value, bufferData );\n\n\t\t\t}\n\n\t\t\treturn bufferData.node.uuid;\n\n\t\t}\n\n\t\treturn this.uuid;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tif ( this.bufferType === null ) {\n\n\t\t\tthis.bufferType = builder.getTypeFromAttribute( this.attribute );\n\n\t\t}\n\n\t\treturn this.bufferType;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tif ( this.attribute !== null ) return;\n\n\t\tconst type = this.getNodeType( builder );\n\t\tconst array = this.value;\n\t\tconst itemSize = builder.getTypeLength( type );\n\t\tconst stride = this.bufferStride || itemSize;\n\t\tconst offset = this.bufferOffset;\n\n\t\tconst buffer = array.isInterleavedBuffer === true ? array : new InterleavedBuffer( array, stride );\n\t\tconst bufferAttribute = new InterleavedBufferAttribute( buffer, itemSize, offset );\n\n\t\tbuffer.setUsage( this.usage );\n\n\t\tthis.attribute = bufferAttribute;\n\t\tthis.attribute.isInstancedBufferAttribute = this.instanced; // @TODO: Add a possible: InstancedInterleavedBufferAttribute\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst nodeType = this.getNodeType( builder );\n\n\t\tconst nodeAttribute = builder.getBufferAttributeFromNode( this, nodeType );\n\t\tconst propertyName = builder.getPropertyName( nodeAttribute );\n\n\t\tlet output = null;\n\n\t\tif ( builder.shaderStage === 'vertex' || builder.shaderStage === 'compute' ) {\n\n\t\t\tthis.name = propertyName;\n\n\t\t\toutput = propertyName;\n\n\t\t} else {\n\n\t\t\tconst nodeVarying = varying( this );\n\n\t\t\toutput = nodeVarying.build( builder, nodeType );\n\n\t\t}\n\n\t\treturn output;\n\n\t}\n\n\tgetInputType( /*builder*/ ) {\n\n\t\treturn 'bufferAttribute';\n\n\t}\n\n\tsetUsage( value ) {\n\n\t\tthis.usage = value;\n\n\t\tif ( this.attribute && this.attribute.isBufferAttribute === true ) {\n\n\t\t\tthis.attribute.usage = value;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetInstanced( value ) {\n\n\t\tthis.instanced = value;\n\n\t\treturn this;\n\n\t}\n\n}\n\nexport default BufferAttributeNode;\n\nexport const bufferAttribute = ( array, type, stride, offset ) => nodeObject( new BufferAttributeNode( array, type, stride, offset ) );\nexport const dynamicBufferAttribute = ( array, type, stride, offset ) => bufferAttribute( array, type, stride, offset ).setUsage( DynamicDrawUsage );\n\nexport const instancedBufferAttribute = ( array, type, stride, offset ) => bufferAttribute( array, type, stride, offset ).setInstanced( true );\nexport const instancedDynamicBufferAttribute = ( array, type, stride, offset ) => dynamicBufferAttribute( array, type, stride, offset ).setInstanced( true );\n\naddNodeElement( 'toAttribute', ( bufferNode ) => bufferAttribute( bufferNode.value ) );\n\naddNodeClass( 'BufferAttributeNode', BufferAttributeNode );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { varyingProperty } from '../core/PropertyNode.js';\nimport { instancedBufferAttribute, instancedDynamicBufferAttribute } from './BufferAttributeNode.js';\nimport { normalLocal } from './NormalNode.js';\nimport { positionLocal } from './PositionNode.js';\nimport { nodeProxy, vec3, mat3, mat4 } from '../shadernode/ShaderNode.js';\nimport { DynamicDrawUsage, InstancedInterleavedBuffer, InstancedBufferAttribute } from 'three';\nimport { NodeUpdateType } from '../core/constants.js';\n\nclass InstanceNode extends Node {\n\n\tconstructor( instanceMesh ) {\n\n\t\tsuper( 'void' );\n\n\t\tthis.instanceMesh = instanceMesh;\n\n\t\tthis.instanceMatrixNode = null;\n\n\t\tthis.instanceColorNode = null;\n\n\t\tthis.updateType = NodeUpdateType.FRAME;\n\n\t\tthis.buffer = null;\n\t\tthis.bufferColor = null;\n\n\t}\n\n\tsetup( /*builder*/ ) {\n\n\t\tlet instanceMatrixNode = this.instanceMatrixNode;\n\n\t\tconst instanceMesh = this.instanceMesh;\n\n\t\tif ( instanceMatrixNode === null ) {\n\n\t\t\tconst instanceAttribute = instanceMesh.instanceMatrix;\n\t\t\tconst buffer = new InstancedInterleavedBuffer( instanceAttribute.array, 16, 1 );\n\n\t\t\tthis.buffer = buffer;\n\t\t\tconst bufferFn = instanceAttribute.usage === DynamicDrawUsage ? instancedDynamicBufferAttribute : instancedBufferAttribute;\n\n\t\t\tconst instanceBuffers = [\n\t\t\t\t// F.Signature -> bufferAttribute( array, type, stride, offset )\n\t\t\t\tbufferFn( buffer, 'vec4', 16, 0 ),\n\t\t\t\tbufferFn( buffer, 'vec4', 16, 4 ),\n\t\t\t\tbufferFn( buffer, 'vec4', 16, 8 ),\n\t\t\t\tbufferFn( buffer, 'vec4', 16, 12 )\n\t\t\t];\n\n\t\t\tinstanceMatrixNode = mat4( ...instanceBuffers );\n\n\t\t\tthis.instanceMatrixNode = instanceMatrixNode;\n\n\t\t}\n\n\t\tconst instanceColorAttribute = instanceMesh.instanceColor;\n\n\t\tif ( instanceColorAttribute && this.instanceColorNode === null ) {\n\n\t\t\tconst buffer = new InstancedBufferAttribute( instanceColorAttribute.array, 3 );\n\t\t\tconst bufferFn = instanceColorAttribute.usage === DynamicDrawUsage ? instancedDynamicBufferAttribute : instancedBufferAttribute;\n\n\t\t\tthis.bufferColor = buffer;\n\t\t\tthis.instanceColorNode = vec3( bufferFn( buffer, 'vec3', 3, 0 ) );\n\n\t\t}\n\n\t\t// POSITION\n\n\t\tconst instancePosition = instanceMatrixNode.mul( positionLocal ).xyz;\n\n\t\t// NORMAL\n\n\t\tconst m = mat3( instanceMatrixNode[ 0 ].xyz, instanceMatrixNode[ 1 ].xyz, instanceMatrixNode[ 2 ].xyz );\n\n\t\tconst transformedNormal = normalLocal.div( vec3( m[ 0 ].dot( m[ 0 ] ), m[ 1 ].dot( m[ 1 ] ), m[ 2 ].dot( m[ 2 ] ) ) );\n\n\t\tconst instanceNormal = m.mul( transformedNormal ).xyz;\n\n\t\t// ASSIGNS\n\n\t\tpositionLocal.assign( instancePosition );\n\t\tnormalLocal.assign( instanceNormal );\n\n\t\t// COLOR\n\n\t\tif ( this.instanceColorNode !== null ) {\n\n\t\t\tvaryingProperty( 'vec3', 'vInstanceColor' ).assign( this.instanceColorNode );\n\n\t\t}\n\n\t}\n\n\tupdate( /*frame*/ ) {\n\n\t\tif ( this.instanceMesh.instanceMatrix.usage !== DynamicDrawUsage && this.instanceMesh.instanceMatrix.version !== this.buffer.version ) {\n\n\t\t\tthis.buffer.version = this.instanceMesh.instanceMatrix.version;\n\n\t\t}\n\n\t\tif ( this.instanceMesh.instanceColor && this.instanceMesh.instanceColor.usage !== DynamicDrawUsage && this.instanceMesh.instanceColor.version !== this.bufferColor.version ) {\n\n\t\t\tthis.bufferColor.version = this.instanceMesh.instanceColor.version;\n\n\t\t}\n\n\t}\n\n}\n\nexport default InstanceNode;\n\nexport const instance = nodeProxy( InstanceNode );\n\naddNodeClass( 'InstanceNode', InstanceNode );\n","import { attribute } from '../core/AttributeNode.js';\nimport { varying } from '../core/VaryingNode.js';\nimport { cameraViewMatrix } from './CameraNode.js';\nimport { modelViewMatrix } from './ModelNode.js';\nimport { tslFn, vec4 } from '../shadernode/ShaderNode.js';\n\nexport const tangentGeometry = /*#__PURE__*/ tslFn( ( stack, builder ) => {\n\n\tif ( builder.geometry.hasAttribute( 'tangent' ) === false ) {\n\n\t\tbuilder.geometry.computeTangents();\n\n\t}\n\n\treturn attribute( 'tangent', 'vec4' );\n\n} )();\n\nexport const tangentLocal = /*#__PURE__*/ tangentGeometry.xyz.toVar( 'tangentLocal' );\nexport const tangentView = /*#__PURE__*/ varying( modelViewMatrix.mul( vec4( tangentLocal, 0 ) ).xyz, 'v_tangentView' ).normalize().toVar( 'tangentView' );\nexport const tangentWorld = /*#__PURE__*/ varying( tangentView.transformDirection( cameraViewMatrix ), 'v_tangentWorld' ).normalize().toVar( 'tangentWorld' );\nexport const transformedTangentView = /*#__PURE__*/ tangentView.toVar( 'transformedTangentView' );\nexport const transformedTangentWorld = /*#__PURE__*/ transformedTangentView.transformDirection( cameraViewMatrix ).normalize().toVar( 'transformedTangentWorld' );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { normalLocal } from './NormalNode.js';\nimport { positionLocal } from './PositionNode.js';\nimport { nodeProxy, vec3, mat3, mat4, int, ivec2, float, tslFn } from '../shadernode/ShaderNode.js';\nimport { textureLoad } from './TextureNode.js';\nimport { textureSize } from './TextureSizeNode.js';\nimport { tangentLocal } from './TangentNode.js';\nimport { instanceIndex, drawIndex } from '../core/IndexNode.js';\n\nclass BatchNode extends Node {\n\n\tconstructor( batchMesh ) {\n\n\t\tsuper( 'void' );\n\n\t\tthis.batchMesh = batchMesh;\n\n\n\t\tthis.instanceColorNode = null;\n\n\t\tthis.batchingIdNode = null;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\t// POSITION\n\n\t\tif ( this.batchingIdNode === null ) {\n\n\t\t\tif ( builder.getDrawIndex() === null ) {\n\n\t\t\t\tthis.batchingIdNode = instanceIndex;\n\n\t\t\t} else {\n\n\t\t\t\tthis.batchingIdNode = drawIndex;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst getIndirectIndex = tslFn( ( [ id ] ) => {\n\n\t\t\tconst size = textureSize( textureLoad( this.batchMesh._indirectTexture ), 0 );\n\t\t\tconst x = int( id ).remainder( int( size ) );\n\t\t\tconst y = int( id ).div( int( size ) );\n\t\t\treturn textureLoad( this.batchMesh._indirectTexture, ivec2( x, y ), null, 'uvec4' ).x;\n\n\t\t} ).setLayout( {\n\t\t\tname: 'getIndirectIndex',\n\t\t\ttype: 'uint',\n\t\t\tinputs: [\n\t\t\t\t{ name: 'id', type: 'int' }\n\t\t\t]\n\t\t} );\n\n\t\tconst matriceTexture = this.batchMesh._matricesTexture;\n\n\t\tconst size = textureSize( textureLoad( matriceTexture ), 0 );\n\t\tconst j = float( getIndirectIndex( int( this.batchingIdNode ) ) ).mul( 4 ).toVar();\n\n\t\tconst x = int( j.mod( size ) );\n\t\tconst y = int( j ).div( int( size ) );\n\t\tconst batchingMatrix = mat4(\n\t\t\ttextureLoad( matriceTexture, ivec2( x, y ) ),\n\t\t\ttextureLoad( matriceTexture, ivec2( x.add( 1 ), y ) ),\n\t\t\ttextureLoad( matriceTexture, ivec2( x.add( 2 ), y ) ),\n\t\t\ttextureLoad( matriceTexture, ivec2( x.add( 3 ), y ) )\n\t\t);\n\n\t\tconst bm = mat3(\n\t\t\tbatchingMatrix[ 0 ].xyz,\n\t\t\tbatchingMatrix[ 1 ].xyz,\n\t\t\tbatchingMatrix[ 2 ].xyz\n\t\t );\n\n\t\tpositionLocal.assign( batchingMatrix.mul( positionLocal ) );\n\n\t\tconst transformedNormal = normalLocal.div( vec3( bm[ 0 ].dot( bm[ 0 ] ), bm[ 1 ].dot( bm[ 1 ] ), bm[ 2 ].dot( bm[ 2 ] ) ) );\n\n\t\tconst batchingNormal = bm.mul( transformedNormal ).xyz;\n\n\t\tnormalLocal.assign( batchingNormal );\n\n\t\tif ( builder.hasGeometryAttribute( 'tangent' ) ) {\n\n\t\t\ttangentLocal.mulAssign( bm );\n\n\t\t}\n\n\t}\n\n}\n\nexport default BatchNode;\n\nexport const batch = nodeProxy( BatchNode );\n\naddNodeClass( 'batch', BatchNode );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { nodeObject } from '../shadernode/ShaderNode.js';\nimport { attribute } from '../core/AttributeNode.js';\nimport { reference, referenceBuffer } from './ReferenceNode.js';\nimport { add } from '../math/OperatorNode.js';\nimport { normalLocal } from './NormalNode.js';\nimport { positionLocal } from './PositionNode.js';\nimport { tangentLocal } from './TangentNode.js';\nimport { uniform } from '../core/UniformNode.js';\nimport { buffer } from './BufferNode.js';\n\nclass SkinningNode extends Node {\n\n\tconstructor( skinnedMesh, useReference = false ) {\n\n\t\tsuper( 'void' );\n\n\t\tthis.skinnedMesh = skinnedMesh;\n\t\tthis.useReference = useReference;\n\n\t\tthis.updateType = NodeUpdateType.OBJECT;\n\n\t\t//\n\n\t\tthis.skinIndexNode = attribute( 'skinIndex', 'uvec4' );\n\t\tthis.skinWeightNode = attribute( 'skinWeight', 'vec4' );\n\n\t\tlet bindMatrixNode, bindMatrixInverseNode, boneMatricesNode;\n\n\t\tif ( useReference ) {\n\n\t\t\tbindMatrixNode = reference( 'bindMatrix', 'mat4' );\n\t\t\tbindMatrixInverseNode = reference( 'bindMatrixInverse', 'mat4' );\n\t\t\tboneMatricesNode = referenceBuffer( 'skeleton.boneMatrices', 'mat4', skinnedMesh.skeleton.bones.length );\n\n\t\t} else {\n\n\t\t\tbindMatrixNode = uniform( skinnedMesh.bindMatrix, 'mat4' );\n\t\t\tbindMatrixInverseNode = uniform( skinnedMesh.bindMatrixInverse, 'mat4' );\n\t\t\tboneMatricesNode = buffer( skinnedMesh.skeleton.boneMatrices, 'mat4', skinnedMesh.skeleton.bones.length );\n\n\t\t}\n\n\t\tthis.bindMatrixNode = bindMatrixNode;\n\t\tthis.bindMatrixInverseNode = bindMatrixInverseNode;\n\t\tthis.boneMatricesNode = boneMatricesNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst { skinIndexNode, skinWeightNode, bindMatrixNode, bindMatrixInverseNode, boneMatricesNode } = this;\n\n\t\tconst boneMatX = boneMatricesNode.element( skinIndexNode.x );\n\t\tconst boneMatY = boneMatricesNode.element( skinIndexNode.y );\n\t\tconst boneMatZ = boneMatricesNode.element( skinIndexNode.z );\n\t\tconst boneMatW = boneMatricesNode.element( skinIndexNode.w );\n\n\t\t// POSITION\n\n\t\tconst skinVertex = bindMatrixNode.mul( positionLocal );\n\n\t\tconst skinned = add(\n\t\t\tboneMatX.mul( skinWeightNode.x ).mul( skinVertex ),\n\t\t\tboneMatY.mul( skinWeightNode.y ).mul( skinVertex ),\n\t\t\tboneMatZ.mul( skinWeightNode.z ).mul( skinVertex ),\n\t\t\tboneMatW.mul( skinWeightNode.w ).mul( skinVertex )\n\t\t);\n\n\t\tconst skinPosition = bindMatrixInverseNode.mul( skinned ).xyz;\n\n\t\t// NORMAL\n\n\t\tlet skinMatrix = add(\n\t\t\tskinWeightNode.x.mul( boneMatX ),\n\t\t\tskinWeightNode.y.mul( boneMatY ),\n\t\t\tskinWeightNode.z.mul( boneMatZ ),\n\t\t\tskinWeightNode.w.mul( boneMatW )\n\t\t);\n\n\t\tskinMatrix = bindMatrixInverseNode.mul( skinMatrix ).mul( bindMatrixNode );\n\n\t\tconst skinNormal = skinMatrix.transformDirection( normalLocal ).xyz;\n\n\t\t// ASSIGNS\n\n\t\tpositionLocal.assign( skinPosition );\n\t\tnormalLocal.assign( skinNormal );\n\n\t\tif ( builder.hasGeometryAttribute( 'tangent' ) ) {\n\n\t\t\ttangentLocal.assign( skinNormal );\n\n\t\t}\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tif ( output !== 'void' ) {\n\n\t\t\treturn positionLocal.build( builder, output );\n\n\t\t}\n\n\t}\n\n\tupdate( frame ) {\n\n\t\tconst object = this.useReference ? frame.object : this.skinnedMesh;\n\n\t\tobject.skeleton.update();\n\n\t}\n\n}\n\nexport default SkinningNode;\n\nexport const skinning = ( skinnedMesh ) => nodeObject( new SkinningNode( skinnedMesh ) );\nexport const skinningReference = ( skinnedMesh ) => nodeObject( new SkinningNode( skinnedMesh, true ) );\n\naddNodeClass( 'SkinningNode', SkinningNode );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { expression } from '../code/ExpressionNode.js';\nimport { bypass } from '../core/BypassNode.js';\nimport { addNodeElement, nodeObject, nodeArray } from '../shadernode/ShaderNode.js';\n\nclass LoopNode extends Node {\n\n\tconstructor( params = [] ) {\n\n\t\tsuper();\n\n\t\tthis.params = params;\n\n\t}\n\n\tgetVarName( index ) {\n\n\t\treturn String.fromCharCode( 'i'.charCodeAt() + index );\n\n\t}\n\n\tgetProperties( builder ) {\n\n\t\tconst properties = builder.getNodeProperties( this );\n\n\t\tif ( properties.stackNode !== undefined ) return properties;\n\n\t\t//\n\n\t\tconst inputs = {};\n\n\t\tfor ( let i = 0, l = this.params.length - 1; i < l; i ++ ) {\n\n\t\t\tconst param = this.params[ i ];\n\n\t\t\tconst name = ( param.isNode !== true && param.name ) || this.getVarName( i );\n\t\t\tconst type = ( param.isNode !== true && param.type ) || 'int';\n\n\t\t\tinputs[ name ] = expression( name, type );\n\n\t\t}\n\n\t\tconst stack = builder.addStack(); // TODO: cache() it\n\n\t\tproperties.returnsNode = this.params[ this.params.length - 1 ]( inputs, stack, builder );\n\t\tproperties.stackNode = stack;\n\n\t\tbuilder.removeStack();\n\n\t\treturn properties;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tconst { returnsNode } = this.getProperties( builder );\n\n\t\treturn returnsNode ? returnsNode.getNodeType( builder ) : 'void';\n\n\t}\n\n\tsetup( builder ) {\n\n\t\t// setup properties\n\n\t\tthis.getProperties( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst properties = this.getProperties( builder );\n\n\t\tconst params = this.params;\n\t\tconst stackNode = properties.stackNode;\n\n\t\tfor ( let i = 0, l = params.length - 1; i < l; i ++ ) {\n\n\t\t\tconst param = params[ i ];\n\n\t\t\tlet start = null, end = null, name = null, type = null, condition = null, update = null;\n\n\t\t\tif ( param.isNode ) {\n\n\t\t\t\ttype = 'int';\n\t\t\t\tname = this.getVarName( i );\n\t\t\t\tstart = '0';\n\t\t\t\tend = param.build( builder, type );\n\t\t\t\tcondition = '<';\n\n\t\t\t} else {\n\n\t\t\t\ttype = param.type || 'int';\n\t\t\t\tname = param.name || this.getVarName( i );\n\t\t\t\tstart = param.start;\n\t\t\t\tend = param.end;\n\t\t\t\tcondition = param.condition;\n\t\t\t\tupdate = param.update;\n\n\t\t\t\tif ( typeof start === 'number' ) start = start.toString();\n\t\t\t\telse if ( start && start.isNode ) start = start.build( builder, type );\n\n\t\t\t\tif ( typeof end === 'number' ) end = end.toString();\n\t\t\t\telse if ( end && end.isNode ) end = end.build( builder, type );\n\n\t\t\t\tif ( start !== undefined && end === undefined ) {\n\n\t\t\t\t\tstart = start + ' - 1';\n\t\t\t\t\tend = '0';\n\t\t\t\t\tcondition = '>=';\n\n\t\t\t\t} else if ( end !== undefined && start === undefined ) {\n\n\t\t\t\t\tstart = '0';\n\t\t\t\t\tcondition = '<';\n\n\t\t\t\t}\n\n\t\t\t\tif ( condition === undefined ) {\n\n\t\t\t\t\tif ( Number( start ) > Number( end ) ) {\n\n\t\t\t\t\t\tcondition = '>=';\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tcondition = '<';\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst internalParam = { start, end, condition };\n\n\t\t\t//\n\n\t\t\tconst startSnippet = internalParam.start;\n\t\t\tconst endSnippet = internalParam.end;\n\n\t\t\tlet declarationSnippet = '';\n\t\t\tlet conditionalSnippet = '';\n\t\t\tlet updateSnippet = '';\n\n\t\t\tif ( ! update ) {\n\n\t\t\t\tif ( type === 'int' || type === 'uint' ) {\n\n\t\t\t\t\tif ( condition.includes( '<' ) ) update = '++';\n\t\t\t\t\telse update = '--';\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( condition.includes( '<' ) ) update = '+= 1.';\n\t\t\t\t\telse update = '-= 1.';\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tdeclarationSnippet += builder.getVar( type, name ) + ' = ' + startSnippet;\n\n\t\t\tconditionalSnippet += name + ' ' + condition + ' ' + endSnippet;\n\t\t\tupdateSnippet += name + ' ' + update;\n\n\t\t\tconst forSnippet = `for ( ${ declarationSnippet }; ${ conditionalSnippet }; ${ updateSnippet } )`;\n\n\t\t\tbuilder.addFlowCode( ( i === 0 ? '\\n' : '' ) + builder.tab + forSnippet + ' {\\n\\n' ).addFlowTab();\n\n\t\t}\n\n\t\tconst stackSnippet = stackNode.build( builder, 'void' );\n\n\t\tconst returnsSnippet = properties.returnsNode ? properties.returnsNode.build( builder ) : '';\n\n\t\tbuilder.removeFlowTab().addFlowCode( '\\n' + builder.tab + stackSnippet );\n\n\t\tfor ( let i = 0, l = this.params.length - 1; i < l; i ++ ) {\n\n\t\t\tbuilder.addFlowCode( ( i === 0 ? '' : builder.tab ) + '}\\n\\n' ).removeFlowTab();\n\n\t\t}\n\n\t\tbuilder.addFlowTab();\n\n\t\treturn returnsSnippet;\n\n\t}\n\n}\n\nexport default LoopNode;\n\nexport const loop = ( ...params ) => nodeObject( new LoopNode( nodeArray( params, 'int' ) ) ).append();\nexport const Continue = () => expression( 'continue' ).append();\nexport const Break = () => expression( 'break' ).append();\n\naddNodeElement( 'loop', ( returns, ...params ) => bypass( returns, loop( ...params ) ) );\n\naddNodeClass( 'LoopNode', LoopNode );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { float, nodeProxy, tslFn } from '../shadernode/ShaderNode.js';\nimport { uniform } from '../core/UniformNode.js';\nimport { reference } from './ReferenceNode.js';\nimport { positionLocal } from './PositionNode.js';\nimport { normalLocal } from './NormalNode.js';\nimport { textureLoad } from './TextureNode.js';\nimport { instanceIndex, vertexIndex } from '../core/IndexNode.js';\nimport { ivec2, int } from '../shadernode/ShaderNode.js';\nimport { DataArrayTexture, Vector2, Vector4, FloatType } from 'three';\nimport { loop } from '../utils/LoopNode.js';\n\nconst morphTextures = new WeakMap();\nconst morphVec4 = new Vector4();\n\nconst getMorph = tslFn( ( { bufferMap, influence, stride, width, depth, offset } ) => {\n\n\tconst texelIndex = int( vertexIndex ).mul( stride ).add( offset );\n\n\tconst y = texelIndex.div( width );\n\tconst x = texelIndex.sub( y.mul( width ) );\n\n\tconst bufferAttrib = textureLoad( bufferMap, ivec2( x, y ) ).depth( depth );\n\n\treturn bufferAttrib.mul( influence );\n\n} );\n\nfunction getEntry( geometry ) {\n\n\tconst hasMorphPosition = geometry.morphAttributes.position !== undefined;\n\tconst hasMorphNormals = geometry.morphAttributes.normal !== undefined;\n\tconst hasMorphColors = geometry.morphAttributes.color !== undefined;\n\n\t// instead of using attributes, the WebGL 2 code path encodes morph targets\n\t// into an array of data textures. Each layer represents a single morph target.\n\n\tconst morphAttribute = geometry.morphAttributes.position || geometry.morphAttributes.normal || geometry.morphAttributes.color;\n\tconst morphTargetsCount = ( morphAttribute !== undefined ) ? morphAttribute.length : 0;\n\n\tlet entry = morphTextures.get( geometry );\n\n\tif ( entry === undefined || entry.count !== morphTargetsCount ) {\n\n\t\tif ( entry !== undefined ) entry.texture.dispose();\n\n\t\tconst morphTargets = geometry.morphAttributes.position || [];\n\t\tconst morphNormals = geometry.morphAttributes.normal || [];\n\t\tconst morphColors = geometry.morphAttributes.color || [];\n\n\t\tlet vertexDataCount = 0;\n\n\t\tif ( hasMorphPosition === true ) vertexDataCount = 1;\n\t\tif ( hasMorphNormals === true ) vertexDataCount = 2;\n\t\tif ( hasMorphColors === true ) vertexDataCount = 3;\n\n\t\tlet width = geometry.attributes.position.count * vertexDataCount;\n\t\tlet height = 1;\n\n\t\tconst maxTextureSize = 4096; // @TODO: Use 'capabilities.maxTextureSize'\n\n\t\tif ( width > maxTextureSize ) {\n\n\t\t\theight = Math.ceil( width / maxTextureSize );\n\t\t\twidth = maxTextureSize;\n\n\t\t}\n\n\t\tconst buffer = new Float32Array( width * height * 4 * morphTargetsCount );\n\n\t\tconst bufferTexture = new DataArrayTexture( buffer, width, height, morphTargetsCount );\n\t\tbufferTexture.type = FloatType;\n\t\tbufferTexture.needsUpdate = true;\n\n\t\t// fill buffer\n\n\t\tconst vertexDataStride = vertexDataCount * 4;\n\n\t\tfor ( let i = 0; i < morphTargetsCount; i ++ ) {\n\n\t\t\tconst morphTarget = morphTargets[ i ];\n\t\t\tconst morphNormal = morphNormals[ i ];\n\t\t\tconst morphColor = morphColors[ i ];\n\n\t\t\tconst offset = width * height * 4 * i;\n\n\t\t\tfor ( let j = 0; j < morphTarget.count; j ++ ) {\n\n\t\t\t\tconst stride = j * vertexDataStride;\n\n\t\t\t\tif ( hasMorphPosition === true ) {\n\n\t\t\t\t\tmorphVec4.fromBufferAttribute( morphTarget, j );\n\n\t\t\t\t\tbuffer[ offset + stride + 0 ] = morphVec4.x;\n\t\t\t\t\tbuffer[ offset + stride + 1 ] = morphVec4.y;\n\t\t\t\t\tbuffer[ offset + stride + 2 ] = morphVec4.z;\n\t\t\t\t\tbuffer[ offset + stride + 3 ] = 0;\n\n\t\t\t\t}\n\n\t\t\t\tif ( hasMorphNormals === true ) {\n\n\t\t\t\t\tmorphVec4.fromBufferAttribute( morphNormal, j );\n\n\t\t\t\t\tbuffer[ offset + stride + 4 ] = morphVec4.x;\n\t\t\t\t\tbuffer[ offset + stride + 5 ] = morphVec4.y;\n\t\t\t\t\tbuffer[ offset + stride + 6 ] = morphVec4.z;\n\t\t\t\t\tbuffer[ offset + stride + 7 ] = 0;\n\n\t\t\t\t}\n\n\t\t\t\tif ( hasMorphColors === true ) {\n\n\t\t\t\t\tmorphVec4.fromBufferAttribute( morphColor, j );\n\n\t\t\t\t\tbuffer[ offset + stride + 8 ] = morphVec4.x;\n\t\t\t\t\tbuffer[ offset + stride + 9 ] = morphVec4.y;\n\t\t\t\t\tbuffer[ offset + stride + 10 ] = morphVec4.z;\n\t\t\t\t\tbuffer[ offset + stride + 11 ] = ( morphColor.itemSize === 4 ) ? morphVec4.w : 1;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tentry = {\n\t\t\tcount: morphTargetsCount,\n\t\t\ttexture: bufferTexture,\n\t\t\tstride: vertexDataCount,\n\t\t\tsize: new Vector2( width, height )\n\t\t};\n\n\t\tmorphTextures.set( geometry, entry );\n\n\t\tfunction disposeTexture() {\n\n\t\t\tbufferTexture.dispose();\n\n\t\t\tmorphTextures.delete( geometry );\n\n\t\t\tgeometry.removeEventListener( 'dispose', disposeTexture );\n\n\t\t}\n\n\t\tgeometry.addEventListener( 'dispose', disposeTexture );\n\n\t}\n\n\treturn entry;\n\n}\n\n\nclass MorphNode extends Node {\n\n\tconstructor( mesh ) {\n\n\t\tsuper( 'void' );\n\n\t\tthis.mesh = mesh;\n\t\tthis.morphBaseInfluence = uniform( 1 );\n\n\t\tthis.updateType = NodeUpdateType.OBJECT;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst { geometry } = builder;\n\n\t\tconst hasMorphPosition = geometry.morphAttributes.position !== undefined;\n\t\tconst hasMorphNormals = geometry.morphAttributes.normal !== undefined;\n\n\t\tconst morphAttribute = geometry.morphAttributes.position || geometry.morphAttributes.normal || geometry.morphAttributes.color;\n\t\tconst morphTargetsCount = ( morphAttribute !== undefined ) ? morphAttribute.length : 0;\n\n\t\t// nodes\n\n\t\tconst { texture: bufferMap, stride, size } = getEntry( geometry );\n\n\t\tif ( hasMorphPosition === true ) positionLocal.mulAssign( this.morphBaseInfluence );\n\t\tif ( hasMorphNormals === true ) normalLocal.mulAssign( this.morphBaseInfluence );\n\n\t\tconst width = int( size.width );\n\n\t\tloop( morphTargetsCount, ( { i } ) => {\n\n\t\t\tconst influence = float( 0 ).toVar();\n\n\t\t\tif ( this.mesh.count > 1 && ( this.mesh.morphTexture !== null && this.mesh.morphTexture !== undefined ) ) {\n\n\t\t\t\tinfluence.assign( textureLoad( this.mesh.morphTexture, ivec2( int( i ).add( 1 ), int( instanceIndex ) ) ).r );\n\n\t\t\t} else {\n\n\t\t\t\tinfluence.assign( reference( 'morphTargetInfluences', 'float' ).element( i ).toVar() );\n\n\t\t\t}\n\n\t\t\tif ( hasMorphPosition === true ) {\n\n\t\t\t\tpositionLocal.addAssign( getMorph( {\n\t\t\t\t\tbufferMap,\n\t\t\t\t\tinfluence,\n\t\t\t\t\tstride,\n\t\t\t\t\twidth,\n\t\t\t\t\tdepth: i,\n\t\t\t\t\toffset: int( 0 )\n\t\t\t\t} ) );\n\n\t\t\t}\n\n\t\t\tif ( hasMorphNormals === true ) {\n\n\t\t\t\tnormalLocal.addAssign( getMorph( {\n\t\t\t\t\tbufferMap,\n\t\t\t\t\tinfluence,\n\t\t\t\t\tstride,\n\t\t\t\t\twidth,\n\t\t\t\t\tdepth: i,\n\t\t\t\t\toffset: int( 1 )\n\t\t\t\t} ) );\n\n\t\t\t}\n\n\t\t} );\n\n\t}\n\n\tupdate() {\n\n\t\tconst morphBaseInfluence = this.morphBaseInfluence;\n\n\t\tif ( this.mesh.geometry.morphTargetsRelative ) {\n\n\t\t\tmorphBaseInfluence.value = 1;\n\n\t\t} else {\n\n\t\t\tmorphBaseInfluence.value = 1 - this.mesh.morphTargetInfluences.reduce( ( a, b ) => a + b, 0 );\n\n\t\t}\n\n\t}\n\n}\n\nexport default MorphNode;\n\nexport const morphReference = nodeProxy( MorphNode );\n\naddNodeClass( 'MorphNode', MorphNode );\n","import { cameraViewMatrix } from './CameraNode.js';\nimport { transformedNormalView } from './NormalNode.js';\nimport { positionViewDirection } from './PositionNode.js';\n\nexport const reflectView = /*#__PURE__*/ positionViewDirection.negate().reflect( transformedNormalView );\nexport const reflectVector = /*#__PURE__*/ reflectView.transformDirection( cameraViewMatrix ).toVar( 'reflectVector' );\n","import TextureNode from './TextureNode.js';\nimport { reflectVector } from './ReflectVectorNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { addNodeElement, nodeProxy, vec3 } from '../shadernode/ShaderNode.js';\nimport { WebGPUCoordinateSystem } from 'three';\n\nclass CubeTextureNode extends TextureNode {\n\n\tconstructor( value, uvNode = null, levelNode = null ) {\n\n\t\tsuper( value, uvNode, levelNode );\n\n\t\tthis.isCubeTextureNode = true;\n\n\t}\n\n\tgetInputType( /*builder*/ ) {\n\n\t\treturn 'cubeTexture';\n\n\t}\n\n\tgetDefaultUV() {\n\n\t\treturn reflectVector;\n\n\t}\n\n\tsetUpdateMatrix( /*updateMatrix*/ ) { } // Ignore .updateMatrix for CubeTextureNode\n\n\tsetupUV( builder, uvNode ) {\n\n\t\tconst texture = this.value;\n\n\t\tif ( builder.renderer.coordinateSystem === WebGPUCoordinateSystem || ! texture.isRenderTargetTexture ) {\n\n\t\t\treturn vec3( uvNode.x.negate(), uvNode.yz );\n\n\t\t} else {\n\n\t\t\treturn uvNode;\n\n\t\t}\n\n\t}\n\n\tgenerateUV( builder, cubeUV ) {\n\n\t\treturn cubeUV.build( builder, 'vec3' );\n\n\t}\n\n}\n\nexport default CubeTextureNode;\n\nexport const cubeTexture = nodeProxy( CubeTextureNode );\n\naddNodeElement( 'cubeTexture', cubeTexture );\n\naddNodeClass( 'CubeTextureNode', CubeTextureNode );\n","import Node, { addNodeClass } from '../core/Node.js';\n\nclass LightingNode extends Node {\n\n\tconstructor() {\n\n\t\tsuper( 'vec3' );\n\n\t}\n\n\tgenerate( /*builder*/ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n}\n\nexport default LightingNode;\n\naddNodeClass( 'LightingNode', LightingNode );\n","import LightingNode from './LightingNode.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { uniform } from '../core/UniformNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { vec3, vec4 } from '../shadernode/ShaderNode.js';\nimport { reference } from '../accessors/ReferenceNode.js';\nimport { texture } from '../accessors/TextureNode.js';\nimport { positionWorld } from '../accessors/PositionNode.js';\nimport { normalWorld } from '../accessors/NormalNode.js';\nimport { WebGPUCoordinateSystem } from 'three';\nimport { mix } from '../math/MathNode.js';\n\nimport { Color, DepthTexture, NearestFilter, LessCompare, NoToneMapping } from 'three';\n\nlet overrideMaterial = null;\n\nclass AnalyticLightNode extends LightingNode {\n\n\tconstructor( light = null ) {\n\n\t\tsuper();\n\n\t\tthis.updateType = NodeUpdateType.FRAME;\n\n\t\tthis.light = light;\n\n\t\tthis.rtt = null;\n\t\tthis.shadowNode = null;\n\t\tthis.shadowMaskNode = null;\n\n\t\tthis.color = new Color();\n\t\tthis._defaultColorNode = uniform( this.color );\n\n\t\tthis.colorNode = this._defaultColorNode;\n\n\t\tthis.isAnalyticLightNode = true;\n\n\t}\n\n\tgetCacheKey() {\n\n\t\treturn super.getCacheKey() + '-' + ( this.light.id + '-' + ( this.light.castShadow ? '1' : '0' ) );\n\n\t}\n\n\tgetHash() {\n\n\t\treturn this.light.uuid;\n\n\t}\n\n\tsetupShadow( builder ) {\n\n\t\tconst { object } = builder;\n\n\t\tif ( object.receiveShadow === false ) return;\n\n\t\tlet shadowNode = this.shadowNode;\n\n\t\tif ( shadowNode === null ) {\n\n\t\t\tif ( overrideMaterial === null ) {\n\n\t\t\t\toverrideMaterial = builder.createNodeMaterial();\n\t\t\t\toverrideMaterial.fragmentNode = vec4( 0, 0, 0, 1 );\n\t\t\t\toverrideMaterial.isShadowNodeMaterial = true; // Use to avoid other overrideMaterial override material.fragmentNode unintentionally when using material.shadowNode\n\n\t\t\t}\n\n\t\t\tconst shadow = this.light.shadow;\n\t\t\tconst rtt = builder.createRenderTarget( shadow.mapSize.width, shadow.mapSize.height );\n\n\t\t\tconst depthTexture = new DepthTexture();\n\t\t\tdepthTexture.minFilter = NearestFilter;\n\t\t\tdepthTexture.magFilter = NearestFilter;\n\t\t\tdepthTexture.image.width = shadow.mapSize.width;\n\t\t\tdepthTexture.image.height = shadow.mapSize.height;\n\t\t\tdepthTexture.compareFunction = LessCompare;\n\n\t\t\trtt.depthTexture = depthTexture;\n\n\t\t\tshadow.camera.updateProjectionMatrix();\n\n\t\t\t//\n\n\t\t\tconst shadowIntensity = reference( 'intensity', 'float', shadow );\n\t\t\tconst bias = reference( 'bias', 'float', shadow );\n\t\t\tconst normalBias = reference( 'normalBias', 'float', shadow );\n\n\t\t\tconst position = object.material.shadowPositionNode || positionWorld;\n\n\t\t\tlet shadowCoord = uniform( shadow.matrix ).mul( position.add( normalWorld.mul( normalBias ) ) );\n\t\t\tshadowCoord = shadowCoord.xyz.div( shadowCoord.w );\n\n\t\t\tconst frustumTest = shadowCoord.x.greaterThanEqual( 0 )\n\t\t\t\t.and( shadowCoord.x.lessThanEqual( 1 ) )\n\t\t\t\t.and( shadowCoord.y.greaterThanEqual( 0 ) )\n\t\t\t\t.and( shadowCoord.y.lessThanEqual( 1 ) )\n\t\t\t\t.and( shadowCoord.z.lessThanEqual( 1 ) );\n\n\t\t\tlet coordZ = shadowCoord.z.add( bias );\n\n\t\t\tif ( builder.renderer.coordinateSystem === WebGPUCoordinateSystem ) {\n\n\t\t\t\tcoordZ = coordZ.mul( 2 ).sub( 1 ); // WebGPU: Convertion [ 0, 1 ] to [ - 1, 1 ]\n\n\t\t\t}\n\n\t\t\tshadowCoord = vec3(\n\t\t\t\tshadowCoord.x,\n\t\t\t\tshadowCoord.y.oneMinus(), // follow webgpu standards\n\t\t\t\tcoordZ\n\t\t\t);\n\n\t\t\tconst textureCompare = ( depthTexture, shadowCoord, compare ) => texture( depthTexture, shadowCoord ).compare( compare );\n\t\t\t//const textureCompare = ( depthTexture, shadowCoord, compare ) => compare.step( texture( depthTexture, shadowCoord ) );\n\n\t\t\t// BasicShadowMap\n\n\t\t\tshadowNode = textureCompare( depthTexture, shadowCoord.xy, shadowCoord.z );\n\n\t\t\t// PCFShadowMap\n\t\t\t/*\n\t\t\tconst mapSize = reference( 'mapSize', 'vec2', shadow );\n\t\t\tconst radius = reference( 'radius', 'float', shadow );\n\n\t\t\tconst texelSize = vec2( 1 ).div( mapSize );\n\t\t\tconst dx0 = texelSize.x.negate().mul( radius );\n\t\t\tconst dy0 = texelSize.y.negate().mul( radius );\n\t\t\tconst dx1 = texelSize.x.mul( radius );\n\t\t\tconst dy1 = texelSize.y.mul( radius );\n\t\t\tconst dx2 = dx0.mul( 2 );\n\t\t\tconst dy2 = dy0.mul( 2 );\n\t\t\tconst dx3 = dx1.mul( 2 );\n\t\t\tconst dy3 = dy1.mul( 2 );\n\n\t\t\tshadowNode = add(\n\t\t\t\ttextureCompare( depthTexture, shadowCoord.xy.add( vec2( dx0, dy0 ) ), shadowCoord.z ),\n\t\t\t\ttextureCompare( depthTexture, shadowCoord.xy.add( vec2( 0, dy0 ) ), shadowCoord.z ),\n\t\t\t\ttextureCompare( depthTexture, shadowCoord.xy.add( vec2( dx1, dy0 ) ), shadowCoord.z ),\n\t\t\t\ttextureCompare( depthTexture, shadowCoord.xy.add( vec2( dx2, dy2 ) ), shadowCoord.z ),\n\t\t\t\ttextureCompare( depthTexture, shadowCoord.xy.add( vec2( 0, dy2 ) ), shadowCoord.z ),\n\t\t\t\ttextureCompare( depthTexture, shadowCoord.xy.add( vec2( dx3, dy2 ) ), shadowCoord.z ),\n\t\t\t\ttextureCompare( depthTexture, shadowCoord.xy.add( vec2( dx0, 0 ) ), shadowCoord.z ),\n\t\t\t\ttextureCompare( depthTexture, shadowCoord.xy.add( vec2( dx2, 0 ) ), shadowCoord.z ),\n\t\t\t\ttextureCompare( depthTexture, shadowCoord.xy, shadowCoord.z ),\n\t\t\t\ttextureCompare( depthTexture, shadowCoord.xy.add( vec2( dx3, 0 ) ), shadowCoord.z ),\n\t\t\t\ttextureCompare( depthTexture, shadowCoord.xy.add( vec2( dx1, 0 ) ), shadowCoord.z ),\n\t\t\t\ttextureCompare( depthTexture, shadowCoord.xy.add( vec2( dx2, dy3 ) ), shadowCoord.z ),\n\t\t\t\ttextureCompare( depthTexture, shadowCoord.xy.add( vec2( 0, dy3 ) ), shadowCoord.z ),\n\t\t\t\ttextureCompare( depthTexture, shadowCoord.xy.add( vec2( dx3, dy3 ) ), shadowCoord.z ),\n\t\t\t\ttextureCompare( depthTexture, shadowCoord.xy.add( vec2( dx0, dy1 ) ), shadowCoord.z ),\n\t\t\t\ttextureCompare( depthTexture, shadowCoord.xy.add( vec2( 0, dy1 ) ), shadowCoord.z ),\n\t\t\t\ttextureCompare( depthTexture, shadowCoord.xy.add( vec2( dx1, dy1 ) ), shadowCoord.z )\n\t\t\t).mul( 1 / 17 );\n\t\t\t */\n\t\t\t//\n\n\t\t\tconst shadowColor = texture( rtt.texture, shadowCoord );\n\t\t\tconst shadowMaskNode = frustumTest.mix( 1, shadowNode.mix( shadowColor.a.mix( 1, shadowColor ), 1 ) );\n\n\t\t\tthis.rtt = rtt;\n\t\t\tthis.colorNode = this.colorNode.mul( mix( 1, shadowMaskNode, shadowIntensity ) );\n\n\t\t\tthis.shadowNode = shadowNode;\n\t\t\tthis.shadowMaskNode = shadowMaskNode;\n\n\t\t\t//\n\n\t\t\tthis.updateBeforeType = NodeUpdateType.RENDER;\n\n\t\t}\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tif ( this.light.castShadow ) this.setupShadow( builder );\n\t\telse if ( this.shadowNode !== null ) this.disposeShadow();\n\n\t}\n\n\tupdateShadow( frame ) {\n\n\t\tconst { rtt, light } = this;\n\t\tconst { renderer, scene, camera } = frame;\n\n\t\tconst currentOverrideMaterial = scene.overrideMaterial;\n\n\t\tscene.overrideMaterial = overrideMaterial;\n\n\t\trtt.setSize( light.shadow.mapSize.width, light.shadow.mapSize.height );\n\n\t\tlight.shadow.updateMatrices( light );\n\t\tlight.shadow.camera.layers.mask = camera.layers.mask;\n\n\t\tconst currentToneMapping = renderer.toneMapping;\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\t\tconst currentRenderObjectFunction = renderer.getRenderObjectFunction();\n\n\t\trenderer.setRenderObjectFunction( ( object, ...params ) => {\n\n\t\t\tif ( object.castShadow === true ) {\n\n\t\t\t\trenderer.renderObject( object, ...params );\n\n\t\t\t}\n\n\t\t} );\n\n\t\trenderer.setRenderTarget( rtt );\n\t\trenderer.toneMapping = NoToneMapping;\n\n\t\trenderer.render( scene, light.shadow.camera );\n\n\t\trenderer.setRenderTarget( currentRenderTarget );\n\t\trenderer.setRenderObjectFunction( currentRenderObjectFunction );\n\n\t\trenderer.toneMapping = currentToneMapping;\n\n\t\tscene.overrideMaterial = currentOverrideMaterial;\n\n\t}\n\n\tdisposeShadow() {\n\n\t\tthis.rtt.dispose();\n\n\t\tthis.shadowNode = null;\n\t\tthis.shadowMaskNode = null;\n\t\tthis.rtt = null;\n\n\t\tthis.colorNode = this._defaultColorNode;\n\n\t}\n\n\tupdateBefore( frame ) {\n\n\t\tconst { light } = this;\n\n\t\tif ( light.castShadow ) this.updateShadow( frame );\n\n\t}\n\n\tupdate( /*frame*/ ) {\n\n\t\tconst { light } = this;\n\n\t\tthis.color.copy( light.color ).multiplyScalar( light.intensity );\n\n\t}\n\n}\n\nexport default AnalyticLightNode;\n\naddNodeClass( 'AnalyticLightNode', AnalyticLightNode );\n","import Node from '../core/Node.js';\nimport AnalyticLightNode from './AnalyticLightNode.js';\nimport { nodeObject, nodeProxy, vec3 } from '../shadernode/ShaderNode.js';\n\nconst LightNodes = new WeakMap();\n\nconst sortLights = ( lights ) => {\n\n\treturn lights.sort( ( a, b ) => a.id - b.id );\n\n};\n\nclass LightsNode extends Node {\n\n\tconstructor( lightNodes = [] ) {\n\n\t\tsuper( 'vec3' );\n\n\t\tthis.totalDiffuseNode = vec3().temp( 'totalDiffuse' );\n\t\tthis.totalSpecularNode = vec3().temp( 'totalSpecular' );\n\n\t\tthis.outgoingLightNode = vec3().temp( 'outgoingLight' );\n\n\t\tthis.lightNodes = lightNodes;\n\n\t\tthis._hash = null;\n\n\t}\n\n\tget hasLight() {\n\n\t\treturn this.lightNodes.length > 0;\n\n\t}\n\n\tgetHash() {\n\n\t\tif ( this._hash === null ) {\n\n\t\t\tconst hash = [];\n\n\t\t\tfor ( const lightNode of this.lightNodes ) {\n\n\t\t\t\thash.push( lightNode.getHash() );\n\n\t\t\t}\n\n\t\t\tthis._hash = 'lights-' + hash.join( ',' );\n\n\t\t}\n\n\t\treturn this._hash;\n\n\t}\n\n\tanalyze( builder ) {\n\n\t\tconst properties = builder.getDataFromNode( this );\n\n\t\tfor ( const node of properties.nodes ) {\n\n\t\t\tnode.build( builder );\n\n\t\t}\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst context = builder.context;\n\t\tconst lightingModel = context.lightingModel;\n\n\t\tlet outgoingLightNode = this.outgoingLightNode;\n\n\t\tif ( lightingModel ) {\n\n\t\t\tconst { lightNodes, totalDiffuseNode, totalSpecularNode } = this;\n\n\t\t\tcontext.outgoingLight = outgoingLightNode;\n\n\t\t\tconst stack = builder.addStack();\n\n\t\t\t//\n\n\t\t\tconst properties = builder.getDataFromNode( this );\n\t\t\tproperties.nodes = stack.nodes;\n\n\t\t\t//\n\n\t\t\tlightingModel.start( context, stack, builder );\n\n\t\t\t// lights\n\n\t\t\tfor ( const lightNode of lightNodes ) {\n\n\t\t\t\tlightNode.build( builder );\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tlightingModel.indirectDiffuse( context, stack, builder );\n\t\t\tlightingModel.indirectSpecular( context, stack, builder );\n\t\t\tlightingModel.ambientOcclusion( context, stack, builder );\n\n\t\t\t//\n\n\t\t\tconst { backdrop, backdropAlpha } = context;\n\t\t\tconst { directDiffuse, directSpecular, indirectDiffuse, indirectSpecular } = context.reflectedLight;\n\n\t\t\tlet totalDiffuse = directDiffuse.add( indirectDiffuse );\n\n\t\t\tif ( backdrop !== null ) {\n\n\t\t\t\tif ( backdropAlpha !== null ) {\n\n\t\t\t\t\ttotalDiffuse = vec3( backdropAlpha.mix( totalDiffuse, backdrop ) );\n\n\t\t\t\t} else {\n\n\t\t\t\t\ttotalDiffuse = vec3( backdrop );\n\n\t\t\t\t}\n\n\t\t\t\tcontext.material.transparent = true;\n\n\t\t\t}\n\n\t\t\ttotalDiffuseNode.assign( totalDiffuse );\n\t\t\ttotalSpecularNode.assign( directSpecular.add( indirectSpecular ) );\n\n\t\t\toutgoingLightNode.assign( totalDiffuseNode.add( totalSpecularNode ) );\n\n\t\t\t//\n\n\t\t\tlightingModel.finish( context, stack, builder );\n\n\t\t\t//\n\n\t\t\toutgoingLightNode = outgoingLightNode.bypass( builder.removeStack() );\n\n\t\t}\n\n\t\treturn outgoingLightNode;\n\n\t}\n\n\t_getLightNodeById( id ) {\n\n\t\tfor ( const lightNode of this.lightNodes ) {\n\n\t\t\tif ( lightNode.isAnalyticLightNode && lightNode.light.id === id ) {\n\n\t\t\t\treturn lightNode;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\tfromLights( lights = [] ) {\n\n\t\tconst lightNodes = [];\n\n\t\tlights = sortLights( lights );\n\n\t\tfor ( const light of lights ) {\n\n\t\t\tlet lightNode = this._getLightNodeById( light.id );\n\n\t\t\tif ( lightNode === null ) {\n\n\t\t\t\tconst lightClass = light.constructor;\n\t\t\t\tconst lightNodeClass = LightNodes.has( lightClass ) ? LightNodes.get( lightClass ) : AnalyticLightNode;\n\n\t\t\t\tlightNode = nodeObject( new lightNodeClass( light ) );\n\n\t\t\t}\n\n\t\t\tlightNodes.push( lightNode );\n\n\t\t}\n\n\t\tthis.lightNodes = lightNodes;\n\t\tthis._hash = null;\n\n\t\treturn this;\n\n\t}\n\n}\n\nexport default LightsNode;\n\nexport const lights = ( lights ) => nodeObject( new LightsNode().fromLights( lights ) );\nexport const lightsNode = nodeProxy( LightsNode );\n\nexport function addLightNode( lightClass, lightNodeClass ) {\n\n\tif ( LightNodes.has( lightClass ) ) {\n\n\t\tconsole.warn( `Redefinition of light node ${ lightNodeClass.type }` );\n\t\treturn;\n\n\t}\n\n\tif ( typeof lightClass !== 'function' ) throw new Error( `Light ${ lightClass.name } is not a class` );\n\tif ( typeof lightNodeClass !== 'function' || ! lightNodeClass.type ) throw new Error( `Light node ${ lightNodeClass.type } is not a class` );\n\n\tLightNodes.set( lightClass, lightNodeClass );\n\n}\n","import LightingNode from './LightingNode.js';\nimport { addNodeClass } from '../core/Node.js';\n\nclass AONode extends LightingNode {\n\n\tconstructor( aoNode = null ) {\n\n\t\tsuper();\n\n\t\tthis.aoNode = aoNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst aoIntensity = 1;\n\t\tconst aoNode = this.aoNode.x.sub( 1.0 ).mul( aoIntensity ).add( 1.0 );\n\n\t\tbuilder.context.ambientOcclusion.mulAssign( aoNode );\n\n\t}\n\n}\n\nexport default AONode;\n\naddNodeClass( 'AONode', AONode );\n","import ContextNode from '../core/ContextNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { addNodeElement, nodeProxy, float, vec3 } from '../shadernode/ShaderNode.js';\n\nclass LightingContextNode extends ContextNode {\n\n\tconstructor( node, lightingModel = null, backdropNode = null, backdropAlphaNode = null ) {\n\n\t\tsuper( node );\n\n\t\tthis.lightingModel = lightingModel;\n\t\tthis.backdropNode = backdropNode;\n\t\tthis.backdropAlphaNode = backdropAlphaNode;\n\n\t\tthis._context = null;\n\n\t}\n\n\tgetContext() {\n\n\t\tconst { backdropNode, backdropAlphaNode } = this;\n\n\t\tconst directDiffuse = vec3().temp( 'directDiffuse' ),\n\t\t\tdirectSpecular = vec3().temp( 'directSpecular' ),\n\t\t\tindirectDiffuse = vec3().temp( 'indirectDiffuse' ),\n\t\t\tindirectSpecular = vec3().temp( 'indirectSpecular' );\n\n\t\tconst reflectedLight = {\n\t\t\tdirectDiffuse,\n\t\t\tdirectSpecular,\n\t\t\tindirectDiffuse,\n\t\t\tindirectSpecular\n\t\t};\n\n\t\tconst context = {\n\t\t\tradiance: vec3().temp( 'radiance' ),\n\t\t\tirradiance: vec3().temp( 'irradiance' ),\n\t\t\tiblIrradiance: vec3().temp( 'iblIrradiance' ),\n\t\t\tambientOcclusion: float( 1 ).temp( 'ambientOcclusion' ),\n\t\t\treflectedLight,\n\t\t\tbackdrop: backdropNode,\n\t\t\tbackdropAlpha: backdropAlphaNode\n\t\t};\n\n\t\treturn context;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tthis.context = this._context || ( this._context = this.getContext() );\n\t\tthis.context.lightingModel = this.lightingModel || builder.context.lightingModel;\n\n\t\treturn super.setup( builder );\n\n\t}\n\n}\n\nexport default LightingContextNode;\n\nexport const lightingContext = nodeProxy( LightingContextNode );\n\naddNodeElement( 'lightingContext', lightingContext );\n\naddNodeClass( 'LightingContextNode', LightingContextNode );\n","import { varying } from '../core/VaryingNode.js';\nimport { cameraViewMatrix } from './CameraNode.js';\nimport { normalGeometry, normalLocal, normalView, normalWorld, transformedNormalView } from './NormalNode.js';\nimport { tangentGeometry, tangentLocal, tangentView, tangentWorld, transformedTangentView } from './TangentNode.js';\n\nconst getBitangent = ( crossNormalTangent ) => crossNormalTangent.mul( tangentGeometry.w ).xyz;\n\nexport const bitangentGeometry = /*#__PURE__*/ varying( getBitangent( normalGeometry.cross( tangentGeometry ) ), 'v_bitangentGeometry' ).normalize().toVar( 'bitangentGeometry' );\nexport const bitangentLocal = /*#__PURE__*/ varying( getBitangent( normalLocal.cross( tangentLocal ) ), 'v_bitangentLocal' ).normalize().toVar( 'bitangentLocal' );\nexport const bitangentView = /*#__PURE__*/ varying( getBitangent( normalView.cross( tangentView ) ), 'v_bitangentView' ).normalize().toVar( 'bitangentView' );\nexport const bitangentWorld = /*#__PURE__*/ varying( getBitangent( normalWorld.cross( tangentWorld ) ), 'v_bitangentWorld' ).normalize().toVar( 'bitangentWorld' );\nexport const transformedBitangentView = /*#__PURE__*/ getBitangent( transformedNormalView.cross( transformedTangentView ) ).normalize().toVar( 'transformedBitangentView' );\nexport const transformedBitangentWorld = /*#__PURE__*/ transformedBitangentView.transformDirection( cameraViewMatrix ).normalize().toVar( 'transformedBitangentWorld' );\n","import { bitangentView } from './BitangentNode.js';\nimport { normalView, transformedNormalView } from './NormalNode.js';\nimport { tangentView } from './TangentNode.js';\nimport { mat3 } from '../shadernode/ShaderNode.js';\nimport { mix } from '../math/MathNode.js';\nimport { anisotropy, anisotropyB, roughness } from '../core/PropertyNode.js';\nimport { positionViewDirection } from './PositionNode.js';\n\nexport const TBNViewMatrix = mat3( tangentView, bitangentView, normalView );\n\nexport const parallaxDirection = positionViewDirection.mul( TBNViewMatrix )/*.normalize()*/;\nexport const parallaxUV = ( uv, scale ) => uv.sub( parallaxDirection.mul( scale ) );\n\nexport const transformedBentNormalView = ( () => {\n\n\t// https://google.github.io/filament/Filament.md.html#lighting/imagebasedlights/anisotropy\n\n\tlet bentNormal = anisotropyB.cross( positionViewDirection );\n\tbentNormal = bentNormal.cross( anisotropyB ).normalize();\n\tbentNormal = mix( bentNormal, transformedNormalView, anisotropy.mul( roughness.oneMinus() ).oneMinus().pow2().pow2() ).normalize();\n\n\treturn bentNormal;\n\n\n} )();\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { property } from '../core/PropertyNode.js';\nimport { addNodeElement, nodeProxy } from '../shadernode/ShaderNode.js';\n\nclass CondNode extends Node {\n\n\tconstructor( condNode, ifNode, elseNode = null ) {\n\n\t\tsuper();\n\n\t\tthis.condNode = condNode;\n\n\t\tthis.ifNode = ifNode;\n\t\tthis.elseNode = elseNode;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tconst ifType = this.ifNode.getNodeType( builder );\n\n\t\tif ( this.elseNode !== null ) {\n\n\t\t\tconst elseType = this.elseNode.getNodeType( builder );\n\n\t\t\tif ( builder.getTypeLength( elseType ) > builder.getTypeLength( ifType ) ) {\n\n\t\t\t\treturn elseType;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn ifType;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst properties = builder.getNodeProperties( this );\n\t\tproperties.condNode = this.condNode.cache();\n\t\tproperties.ifNode = this.ifNode.cache();\n\t\tproperties.elseNode = this.elseNode ? this.elseNode.cache() : null;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst type = this.getNodeType( builder );\n\n\t\tconst nodeData = builder.getDataFromNode( this );\n\n\t\tif ( nodeData.nodeProperty !== undefined ) {\n\n\t\t\treturn nodeData.nodeProperty;\n\n\t\t}\n\n\t\tconst { condNode, ifNode, elseNode } = builder.getNodeProperties( this );\n\n\t\tconst needsOutput = output !== 'void';\n\t\tconst nodeProperty = needsOutput ? property( type ).build( builder ) : '';\n\n\t\tnodeData.nodeProperty = nodeProperty;\n\n\t\tconst nodeSnippet = condNode.build( builder, 'bool' );\n\n\t\tbuilder.addFlowCode( `\\n${ builder.tab }if ( ${ nodeSnippet } ) {\\n\\n` ).addFlowTab();\n\n\t\tlet ifSnippet = ifNode.build( builder, type );\n\n\t\tif ( ifSnippet ) {\n\n\t\t\tif ( needsOutput ) {\n\n\t\t\t\tifSnippet = nodeProperty + ' = ' + ifSnippet + ';';\n\n\t\t\t} else {\n\n\t\t\t\tifSnippet = 'return ' + ifSnippet + ';';\n\n\t\t\t}\n\n\t\t}\n\n\t\tbuilder.removeFlowTab().addFlowCode( builder.tab + '\\t' + ifSnippet + '\\n\\n' + builder.tab + '}' );\n\n\t\tif ( elseNode !== null ) {\n\n\t\t\tbuilder.addFlowCode( ' else {\\n\\n' ).addFlowTab();\n\n\t\t\tlet elseSnippet = elseNode.build( builder, type );\n\n\t\t\tif ( elseSnippet ) {\n\n\t\t\t\tif ( needsOutput ) {\n\n\t\t\t\t\telseSnippet = nodeProperty + ' = ' + elseSnippet + ';';\n\n\t\t\t\t} else {\n\n\t\t\t\t\telseSnippet = 'return ' + elseSnippet + ';';\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tbuilder.removeFlowTab().addFlowCode( builder.tab + '\\t' + elseSnippet + '\\n\\n' + builder.tab + '}\\n\\n' );\n\n\t\t} else {\n\n\t\t\tbuilder.addFlowCode( '\\n\\n' );\n\n\t\t}\n\n\t\treturn builder.format( nodeProperty, type, output );\n\n\t}\n\n}\n\nexport default CondNode;\n\nexport const cond = nodeProxy( CondNode );\n\naddNodeElement( 'cond', cond );\n\naddNodeClass( 'CondNode', CondNode );\n","import { tslFn, int, float, vec2, vec3, vec4, If } from '../shadernode/ShaderNode.js';\nimport { cos, sin, abs, max, exp2, log2, clamp, fract, mix, floor, normalize, cross, all } from '../math/MathNode.js';\nimport { mul } from '../math/OperatorNode.js';\nimport { cond } from '../math/CondNode.js';\nimport { loop, Break } from '../utils/LoopNode.js';\n\n// These defines must match with PMREMGenerator\n\nconst cubeUV_r0 = float( 1.0 );\nconst cubeUV_m0 = float( - 2.0 );\nconst cubeUV_r1 = float( 0.8 );\nconst cubeUV_m1 = float( - 1.0 );\nconst cubeUV_r4 = float( 0.4 );\nconst cubeUV_m4 = float( 2.0 );\nconst cubeUV_r5 = float( 0.305 );\nconst cubeUV_m5 = float( 3.0 );\nconst cubeUV_r6 = float( 0.21 );\nconst cubeUV_m6 = float( 4.0 );\n\nconst cubeUV_minMipLevel = float( 4.0 );\nconst cubeUV_minTileSize = float( 16.0 );\n\n// These shader functions convert between the UV coordinates of a single face of\n// a cubemap, the 0-5 integer index of a cube face, and the direction vector for\n// sampling a textureCube (not generally normalized ).\n\nconst getFace = tslFn( ( [ direction ] ) => {\n\n\tconst absDirection = vec3( abs( direction ) ).toVar();\n\tconst face = float( - 1.0 ).toVar();\n\n\tIf( absDirection.x.greaterThan( absDirection.z ), () => {\n\n\t\tIf( absDirection.x.greaterThan( absDirection.y ), () => {\n\n\t\t\tface.assign( cond( direction.x.greaterThan( 0.0 ), 0.0, 3.0 ) );\n\n\t\t} ).else( () => {\n\n\t\t\tface.assign( cond( direction.y.greaterThan( 0.0 ), 1.0, 4.0 ) );\n\n\t\t} );\n\n\t} ).else( () => {\n\n\t\tIf( absDirection.z.greaterThan( absDirection.y ), () => {\n\n\t\t\tface.assign( cond( direction.z.greaterThan( 0.0 ), 2.0, 5.0 ) );\n\n\t\t} ).else( () => {\n\n\t\t\tface.assign( cond( direction.y.greaterThan( 0.0 ), 1.0, 4.0 ) );\n\n\t\t} );\n\n\t} );\n\n\treturn face;\n\n} ).setLayout( {\n\tname: 'getFace',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'direction', type: 'vec3' }\n\t]\n} );\n\n// RH coordinate system; PMREM face-indexing convention\nconst getUV = tslFn( ( [ direction, face ] ) => {\n\n\tconst uv = vec2().toVar();\n\n\tIf( face.equal( 0.0 ), () => {\n\n\t\tuv.assign( vec2( direction.z, direction.y ).div( abs( direction.x ) ) ); // pos x\n\n\t} ).elseif( face.equal( 1.0 ), () => {\n\n\t\tuv.assign( vec2( direction.x.negate(), direction.z.negate() ).div( abs( direction.y ) ) ); // pos y\n\n\t} ).elseif( face.equal( 2.0 ), () => {\n\n\t\tuv.assign( vec2( direction.x.negate(), direction.y ).div( abs( direction.z ) ) ); // pos z\n\n\t} ).elseif( face.equal( 3.0 ), () => {\n\n\t\tuv.assign( vec2( direction.z.negate(), direction.y ).div( abs( direction.x ) ) ); // neg x\n\n\t} ).elseif( face.equal( 4.0 ), () => {\n\n\t\tuv.assign( vec2( direction.x.negate(), direction.z ).div( abs( direction.y ) ) ); // neg y\n\n\t} ).else( () => {\n\n\t\tuv.assign( vec2( direction.x, direction.y ).div( abs( direction.z ) ) ); // neg z\n\n\t} );\n\n\treturn mul( 0.5, uv.add( 1.0 ) );\n\n} ).setLayout( {\n\tname: 'getUV',\n\ttype: 'vec2',\n\tinputs: [\n\t\t{ name: 'direction', type: 'vec3' },\n\t\t{ name: 'face', type: 'float' }\n\t]\n} );\n\nconst roughnessToMip = tslFn( ( [ roughness ] ) => {\n\n\tconst mip = float( 0.0 ).toVar();\n\n\tIf( roughness.greaterThanEqual( cubeUV_r1 ), () => {\n\n\t\tmip.assign( cubeUV_r0.sub( roughness ).mul( cubeUV_m1.sub( cubeUV_m0 ) ).div( cubeUV_r0.sub( cubeUV_r1 ) ).add( cubeUV_m0 ) );\n\n\t} ).elseif( roughness.greaterThanEqual( cubeUV_r4 ), () => {\n\n\t\tmip.assign( cubeUV_r1.sub( roughness ).mul( cubeUV_m4.sub( cubeUV_m1 ) ).div( cubeUV_r1.sub( cubeUV_r4 ) ).add( cubeUV_m1 ) );\n\n\t} ).elseif( roughness.greaterThanEqual( cubeUV_r5 ), () => {\n\n\t\tmip.assign( cubeUV_r4.sub( roughness ).mul( cubeUV_m5.sub( cubeUV_m4 ) ).div( cubeUV_r4.sub( cubeUV_r5 ) ).add( cubeUV_m4 ) );\n\n\t} ).elseif( roughness.greaterThanEqual( cubeUV_r6 ), () => {\n\n\t\tmip.assign( cubeUV_r5.sub( roughness ).mul( cubeUV_m6.sub( cubeUV_m5 ) ).div( cubeUV_r5.sub( cubeUV_r6 ) ).add( cubeUV_m5 ) );\n\n\t} ).else( () => {\n\n\t\tmip.assign( float( - 2.0 ).mul( log2( mul( 1.16, roughness ) ) ) ); // 1.16 = 1.79^0.25\n\n\t} );\n\n\treturn mip;\n\n} ).setLayout( {\n\tname: 'roughnessToMip',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'roughness', type: 'float' }\n\t]\n} );\n\n// RH coordinate system; PMREM face-indexing convention\nexport const getDirection = tslFn( ( [ uv_immutable, face ] ) => {\n\n\tconst uv = uv_immutable.toVar();\n\tuv.assign( mul( 2.0, uv ).sub( 1.0 ) );\n\tconst direction = vec3( uv, 1.0 ).toVar();\n\n\tIf( face.equal( 0.0 ), () => {\n\n\t\tdirection.assign( direction.zyx ); // ( 1, v, u ) pos x\n\n\t} ).elseif( face.equal( 1.0 ), () => {\n\n\t\tdirection.assign( direction.xzy );\n\t\tdirection.xz.mulAssign( - 1.0 ); // ( -u, 1, -v ) pos y\n\n\t} ).elseif( face.equal( 2.0 ), () => {\n\n\t\tdirection.x.mulAssign( - 1.0 ); // ( -u, v, 1 ) pos z\n\n\t} ).elseif( face.equal( 3.0 ), () => {\n\n\t\tdirection.assign( direction.zyx );\n\t\tdirection.xz.mulAssign( - 1.0 ); // ( -1, v, -u ) neg x\n\n\t} ).elseif( face.equal( 4.0 ), () => {\n\n\t\tdirection.assign( direction.xzy );\n\t\tdirection.xy.mulAssign( - 1.0 ); // ( -u, -1, v ) neg y\n\n\t} ).elseif( face.equal( 5.0 ), () => {\n\n\t\tdirection.z.mulAssign( - 1.0 ); // ( u, v, -1 ) neg zS\n\n\t} );\n\n\treturn direction;\n\n} ).setLayout( {\n\tname: 'getDirection',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'uv', type: 'vec2' },\n\t\t{ name: 'face', type: 'float' }\n\t]\n} );\n\n//\n\nexport const textureCubeUV = tslFn( ( [ envMap, sampleDir_immutable, roughness_immutable, CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP ] ) => {\n\n\tconst roughness = float( roughness_immutable );\n\tconst sampleDir = vec3( sampleDir_immutable );\n\n\tconst mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\tconst mipF = fract( mip );\n\tconst mipInt = floor( mip );\n\tconst color0 = vec3( bilinearCubeUV( envMap, sampleDir, mipInt, CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP ) ).toVar();\n\n\tIf( mipF.notEqual( 0.0 ), () => {\n\n\t\tconst color1 = vec3( bilinearCubeUV( envMap, sampleDir, mipInt.add( 1.0 ), CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP ) ).toVar();\n\n\t\tcolor0.assign( mix( color0, color1, mipF ) );\n\n\t} );\n\n\treturn color0;\n\n} );\n\nconst bilinearCubeUV = tslFn( ( [ envMap, direction_immutable, mipInt_immutable, CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP ] ) => {\n\n\tconst mipInt = float( mipInt_immutable ).toVar();\n\tconst direction = vec3( direction_immutable );\n\tconst face = float( getFace( direction ) ).toVar();\n\tconst filterInt = float( max( cubeUV_minMipLevel.sub( mipInt ), 0.0 ) ).toVar();\n\tmipInt.assign( max( mipInt, cubeUV_minMipLevel ) );\n\tconst faceSize = float( exp2( mipInt ) ).toVar();\n\tconst uv = vec2( getUV( direction, face ).mul( faceSize.sub( 2.0 ) ).add( 1.0 ) ).toVar();\n\n\tIf( face.greaterThan( 2.0 ), () => {\n\n\t\tuv.y.addAssign( faceSize );\n\t\tface.subAssign( 3.0 );\n\n\t} );\n\n\tuv.x.addAssign( face.mul( faceSize ) );\n\tuv.x.addAssign( filterInt.mul( mul( 3.0, cubeUV_minTileSize ) ) );\n\tuv.y.addAssign( mul( 4.0, exp2( CUBEUV_MAX_MIP ).sub( faceSize ) ) );\n\tuv.x.mulAssign( CUBEUV_TEXEL_WIDTH );\n\tuv.y.mulAssign( CUBEUV_TEXEL_HEIGHT );\n\n\treturn envMap.uv( uv ).grad( vec2(), vec2() ); // disable anisotropic filtering\n\n} );\n\nconst getSample = tslFn( ( { envMap, mipInt, outputDirection, theta, axis, CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP } ) => {\n\n\tconst cosTheta = cos( theta );\n\n\t// Rodrigues' axis-angle rotation\n\tconst sampleDirection = outputDirection.mul( cosTheta )\n\t\t.add( axis.cross( outputDirection ).mul( sin( theta ) ) )\n\t\t.add( axis.mul( axis.dot( outputDirection ).mul( cosTheta.oneMinus() ) ) );\n\n\treturn bilinearCubeUV( envMap, sampleDirection, mipInt, CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP );\n\n} );\n\nexport const blur = tslFn( ( { n, latitudinal, poleAxis, outputDirection, weights, samples, dTheta, mipInt, envMap, CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP } ) => {\n\n\tconst axis = vec3( cond( latitudinal, poleAxis, cross( poleAxis, outputDirection ) ) ).toVar();\n\n\tIf( all( axis.equals( vec3( 0.0 ) ) ), () => {\n\n\t\taxis.assign( vec3( outputDirection.z, 0.0, outputDirection.x.negate() ) );\n\n\t} );\n\n\taxis.assign( normalize( axis ) );\n\n\tconst gl_FragColor = vec3().toVar();\n\tgl_FragColor.addAssign( weights.element( int( 0 ) ).mul( getSample( { theta: 0.0, axis, outputDirection, mipInt, envMap, CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP } ) ) );\n\n\tloop( { start: int( 1 ), end: n }, ( { i } ) => {\n\n\t\tIf( i.greaterThanEqual( samples ), () => {\n\n\t\t\tBreak();\n\n\t\t} );\n\n\t\tconst theta = float( dTheta.mul( float( i ) ) ).toVar();\n\t\tgl_FragColor.addAssign( weights.element( i ).mul( getSample( { theta: theta.mul( - 1.0 ), axis, outputDirection, mipInt, envMap, CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP } ) ) );\n\t\tgl_FragColor.addAssign( weights.element( i ).mul( getSample( { theta, axis, outputDirection, mipInt, envMap, CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP } ) ) );\n\n\t} );\n\n\treturn vec4( gl_FragColor, 1 );\n\n} );\n","import TempNode from '../core/TempNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { texture } from '../accessors/TextureNode.js';\nimport { textureCubeUV } from './PMREMUtils.js';\nimport { uniform } from '../core/UniformNode.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { nodeProxy, vec3 } from '../shadernode/ShaderNode.js';\nimport { WebGLCoordinateSystem } from 'three';\n\nlet _generator = null;\n\nconst _cache = new WeakMap();\n\nfunction _generateCubeUVSize( imageHeight ) {\n\n\tconst maxMip = Math.log2( imageHeight ) - 2;\n\n\tconst texelHeight = 1.0 / imageHeight;\n\n\tconst texelWidth = 1.0 / ( 3 * Math.max( Math.pow( 2, maxMip ), 7 * 16 ) );\n\n\treturn { texelWidth, texelHeight, maxMip };\n\n}\n\nfunction _getPMREMFromTexture( texture ) {\n\n\tlet cacheTexture = _cache.get( texture );\n\n\tconst pmremVersion = cacheTexture !== undefined ? cacheTexture.pmremVersion : - 1;\n\n\tif ( pmremVersion !== texture.pmremVersion ) {\n\n\t\tif ( texture.isCubeTexture ) {\n\n\t\t\tif ( texture.source.data.some( ( texture ) => texture === undefined ) ) {\n\n\t\t\t\tthrow new Error( 'PMREMNode: Undefined texture in CubeTexture. Use onLoad callback or async loader' );\n\n\t\t\t}\n\n\t\t\tcacheTexture = _generator.fromCubemap( texture, cacheTexture );\n\n\t\t} else {\n\n\t\t\tif ( texture.image === undefined ) {\n\n\t\t\t\tthrow new Error( 'PMREMNode: Undefined image in Texture. Use onLoad callback or async loader' );\n\n\t\t\t}\n\n\t\t\tcacheTexture = _generator.fromEquirectangular( texture, cacheTexture );\n\n\t\t}\n\n\t\tcacheTexture.pmremVersion = texture.pmremVersion;\n\n\t\t_cache.set( texture, cacheTexture );\n\n\t}\n\n\treturn cacheTexture.texture;\n\n}\n\nclass PMREMNode extends TempNode {\n\n\tconstructor( value, uvNode = null, levelNode = null ) {\n\n\t\tsuper( 'vec3' );\n\n\t\tthis._value = value;\n\t\tthis._pmrem = null;\n\n\t\tthis.uvNode = uvNode;\n\t\tthis.levelNode = levelNode;\n\n\t\tthis._generator = null;\n\t\tthis._texture = texture( null );\n\t\tthis._width = uniform( 0 );\n\t\tthis._height = uniform( 0 );\n\t\tthis._maxMip = uniform( 0 );\n\n\t\tthis.updateBeforeType = NodeUpdateType.RENDER;\n\n\t}\n\n\tset value( value ) {\n\n\t\tthis._value = value;\n\t\tthis._pmrem = null;\n\n\t}\n\n\tget value() {\n\n\t\treturn this._value;\n\n\t}\n\n\tupdateFromTexture( texture ) {\n\n\t\tconst cubeUVSize = _generateCubeUVSize( texture.image.height );\n\n\t\tthis._texture.value = texture;\n\t\tthis._width.value = cubeUVSize.texelWidth;\n\t\tthis._height.value = cubeUVSize.texelHeight;\n\t\tthis._maxMip.value = cubeUVSize.maxMip;\n\n\t}\n\n\tupdateBefore() {\n\n\t\tlet pmrem = this._pmrem;\n\n\t\tconst pmremVersion = pmrem ? pmrem.pmremVersion : - 1;\n\t\tconst texture = this._value;\n\n\t\tif ( pmremVersion !== texture.pmremVersion ) {\n\n\t\t\tif ( texture.isPMREMTexture === true ) {\n\n\t\t\t\tpmrem = texture;\n\n\t\t\t} else {\n\n\t\t\t\tpmrem = _getPMREMFromTexture( texture );\n\n\t\t\t}\n\n\t\t\tthis._pmrem = pmrem;\n\n\t\t\tthis.updateFromTexture( pmrem );\n\n\t\t}\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tif ( _generator === null ) {\n\n\t\t\t_generator = builder.createPMREMGenerator();\n\n\t\t}\n\n\t\t//\n\n\t\tthis.updateBefore( builder );\n\n\t\t//\n\n\t\tlet uvNode = this.uvNode;\n\n\t\tif ( uvNode === null && builder.context.getUV ) {\n\n\t\t\tuvNode = builder.context.getUV( this );\n\n\t\t}\n\n\t\t//\n\n\t\tconst texture = this.value;\n\n\t\tif ( builder.renderer.coordinateSystem === WebGLCoordinateSystem && texture.isPMREMTexture !== true && texture.isRenderTargetTexture === true ) {\n\n\t\t\tuvNode = vec3( uvNode.x.negate(), uvNode.yz );\n\n\t\t}\n\n\t\t//\n\n\t\tlet levelNode = this.levelNode;\n\n\t\tif ( levelNode === null && builder.context.getTextureLevel ) {\n\n\t\t\tlevelNode = builder.context.getTextureLevel( this );\n\n\t\t}\n\n\t\t//\n\n\t\treturn textureCubeUV( this._texture, uvNode, levelNode, this._width, this._height, this._maxMip );\n\n\t}\n\n}\n\nexport const pmremTexture = nodeProxy( PMREMNode );\n\naddNodeClass( 'PMREMNode', PMREMNode );\n\nexport default PMREMNode;\n","import LightingNode from './LightingNode.js';\nimport { cache } from '../core/CacheNode.js';\nimport { context } from '../core/ContextNode.js';\nimport { roughness, clearcoatRoughness } from '../core/PropertyNode.js';\nimport { cameraViewMatrix } from '../accessors/CameraNode.js';\nimport { transformedClearcoatNormalView, transformedNormalView, transformedNormalWorld } from '../accessors/NormalNode.js';\nimport { positionViewDirection } from '../accessors/PositionNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { float } from '../shadernode/ShaderNode.js';\nimport { reference } from '../accessors/ReferenceNode.js';\nimport { transformedBentNormalView } from '../accessors/AccessorsUtils.js';\nimport { pmremTexture } from '../pmrem/PMREMNode.js';\n\nconst envNodeCache = new WeakMap();\n\nclass EnvironmentNode extends LightingNode {\n\n\tconstructor( envNode = null ) {\n\n\t\tsuper();\n\n\t\tthis.envNode = envNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tlet envNode = this.envNode;\n\n\t\tif ( envNode.isTextureNode ) {\n\n\t\t\tlet cacheEnvNode = envNodeCache.get( envNode.value );\n\n\t\t\tif ( cacheEnvNode === undefined ) {\n\n\t\t\t\tcacheEnvNode = pmremTexture( envNode.value );\n\n\t\t\t\tenvNodeCache.set( envNode.value, cacheEnvNode );\n\n\t\t\t}\n\n\t\t\tenvNode\t= cacheEnvNode;\n\n\t\t}\n\n\t\t//\n\n\t\tconst { material } = builder;\n\n\t\tconst envMap = material.envMap;\n\t\tconst intensity = envMap ? reference( 'envMapIntensity', 'float', builder.material ) : reference( 'environmentIntensity', 'float', builder.scene ); // @TODO: Add materialEnvIntensity in MaterialNode\n\n\t\tconst useAnisotropy = material.useAnisotropy === true || material.anisotropy > 0;\n\t\tconst radianceNormalView = useAnisotropy ? transformedBentNormalView : transformedNormalView;\n\n\t\tconst radiance = context( envNode, createRadianceContext( roughness, radianceNormalView ) ).mul( intensity );\n\t\tconst irradiance = context( envNode, createIrradianceContext( transformedNormalWorld ) ).mul( Math.PI ).mul( intensity );\n\n\t\tconst isolateRadiance = cache( radiance );\n\t\tconst isolateIrradiance = cache( irradiance );\n\n\t\t//\n\n\t\tbuilder.context.radiance.addAssign( isolateRadiance );\n\n\t\tbuilder.context.iblIrradiance.addAssign( isolateIrradiance );\n\n\t\t//\n\n\t\tconst clearcoatRadiance = builder.context.lightingModel.clearcoatRadiance;\n\n\t\tif ( clearcoatRadiance ) {\n\n\t\t\tconst clearcoatRadianceContext = context( envNode, createRadianceContext( clearcoatRoughness, transformedClearcoatNormalView ) ).mul( intensity );\n\t\t\tconst isolateClearcoatRadiance = cache( clearcoatRadianceContext );\n\n\t\t\tclearcoatRadiance.addAssign( isolateClearcoatRadiance );\n\n\t\t}\n\n\t}\n\n}\n\nconst createRadianceContext = ( roughnessNode, normalViewNode ) => {\n\n\tlet reflectVec = null;\n\n\treturn {\n\t\tgetUV: () => {\n\n\t\t\tif ( reflectVec === null ) {\n\n\t\t\t\treflectVec = positionViewDirection.negate().reflect( normalViewNode );\n\n\t\t\t\t// Mixing the reflection with the normal is more accurate and keeps rough objects from gathering light from behind their tangent plane.\n\t\t\t\treflectVec = roughnessNode.mul( roughnessNode ).mix( reflectVec, normalViewNode ).normalize();\n\n\t\t\t\treflectVec = reflectVec.transformDirection( cameraViewMatrix );\n\n\t\t\t}\n\n\t\t\treturn reflectVec;\n\n\t\t},\n\t\tgetTextureLevel: () => {\n\n\t\t\treturn roughnessNode;\n\n\t\t}\n\t};\n\n};\n\nconst createIrradianceContext = ( normalWorldNode ) => {\n\n\treturn {\n\t\tgetUV: () => {\n\n\t\t\treturn normalWorldNode;\n\n\t\t},\n\t\tgetTextureLevel: () => {\n\n\t\t\treturn float( 1.0 );\n\n\t\t}\n\t};\n\n};\n\nexport default EnvironmentNode;\n\naddNodeClass( 'EnvironmentNode', EnvironmentNode );\n","import LightingNode from './LightingNode.js';\nimport { addNodeClass } from '../core/Node.js';\n\nclass IrradianceNode extends LightingNode {\n\n\tconstructor( node ) {\n\n\t\tsuper();\n\n\t\tthis.node = node;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tbuilder.context.irradiance.addAssign( this.node );\n\n\t}\n\n}\n\nexport default IrradianceNode;\n\naddNodeClass( 'IrradianceNode', IrradianceNode );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { uniform } from '../core/UniformNode.js';\nimport { nodeImmutable, vec2 } from '../shadernode/ShaderNode.js';\n\nimport { Vector2, Vector4 } from 'three';\n\nlet resolution, viewportResult;\n\nclass ViewportNode extends Node {\n\n\tconstructor( scope ) {\n\n\t\tsuper();\n\n\t\tthis.scope = scope;\n\n\t\tthis.isViewportNode = true;\n\n\t}\n\n\tgetNodeType() {\n\n\t\tif ( this.scope === ViewportNode.VIEWPORT ) return 'vec4';\n\t\telse if ( this.scope === ViewportNode.COORDINATE ) return 'vec3';\n\t\telse return 'vec2';\n\n\t}\n\n\tgetUpdateType() {\n\n\t\tlet updateType = NodeUpdateType.NONE;\n\n\t\tif ( this.scope === ViewportNode.RESOLUTION || this.scope === ViewportNode.VIEWPORT ) {\n\n\t\t\tupdateType = NodeUpdateType.RENDER;\n\n\t\t}\n\n\t\tthis.updateType = updateType;\n\n\t\treturn updateType;\n\n\t}\n\n\tupdate( { renderer } ) {\n\n\t\tif ( this.scope === ViewportNode.VIEWPORT ) {\n\n\t\t\trenderer.getViewport( viewportResult );\n\n\t\t} else {\n\n\t\t\trenderer.getDrawingBufferSize( resolution );\n\n\t\t}\n\n\t}\n\n\tsetup( /*builder*/ ) {\n\n\t\tconst scope = this.scope;\n\n\t\tlet output = null;\n\n\t\tif ( scope === ViewportNode.RESOLUTION ) {\n\n\t\t\toutput = uniform( resolution || ( resolution = new Vector2() ) );\n\n\t\t} else if ( scope === ViewportNode.VIEWPORT ) {\n\n\t\t\toutput = uniform( viewportResult || ( viewportResult = new Vector4() ) );\n\n\t\t} else {\n\n\t\t\toutput = viewportCoordinate.div( viewportResolution );\n\n\t\t\tlet outX = output.x;\n\t\t\tlet outY = output.y;\n\n\t\t\tif ( /bottom/i.test( scope ) ) outY = outY.oneMinus();\n\t\t\tif ( /right/i.test( scope ) ) outX = outX.oneMinus();\n\n\t\t\toutput = vec2( outX, outY );\n\n\t\t}\n\n\t\treturn output;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tif ( this.scope === ViewportNode.COORDINATE ) {\n\n\t\t\tlet coord = builder.getFragCoord();\n\n\t\t\tif ( builder.isFlipY() ) {\n\n\t\t\t\t// follow webgpu standards\n\n\t\t\t\tconst resolution = builder.getNodeProperties( viewportResolution ).outputNode.build( builder );\n\n\t\t\t\tcoord = `${ builder.getType( 'vec3' ) }( ${ coord }.x, ${ resolution }.y - ${ coord }.y, ${ coord }.z )`;\n\n\t\t\t}\n\n\t\t\treturn coord;\n\n\t\t}\n\n\t\treturn super.generate( builder );\n\n\t}\n\n}\n\nViewportNode.COORDINATE = 'coordinate';\nViewportNode.RESOLUTION = 'resolution';\nViewportNode.VIEWPORT = 'viewport';\nViewportNode.TOP_LEFT = 'topLeft';\nViewportNode.BOTTOM_LEFT = 'bottomLeft';\nViewportNode.TOP_RIGHT = 'topRight';\nViewportNode.BOTTOM_RIGHT = 'bottomRight';\n\nexport default ViewportNode;\n\nexport const viewportCoordinate = nodeImmutable( ViewportNode, ViewportNode.COORDINATE );\nexport const viewportResolution = nodeImmutable( ViewportNode, ViewportNode.RESOLUTION );\nexport const viewport = nodeImmutable( ViewportNode, ViewportNode.VIEWPORT );\nexport const viewportTopLeft = nodeImmutable( ViewportNode, ViewportNode.TOP_LEFT );\nexport const viewportBottomLeft = nodeImmutable( ViewportNode, ViewportNode.BOTTOM_LEFT );\nexport const viewportTopRight = nodeImmutable( ViewportNode, ViewportNode.TOP_RIGHT );\nexport const viewportBottomRight = nodeImmutable( ViewportNode, ViewportNode.BOTTOM_RIGHT );\n\naddNodeClass( 'ViewportNode', ViewportNode );\n","import TextureNode from '../accessors/TextureNode.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { addNodeElement, nodeProxy } from '../shadernode/ShaderNode.js';\nimport { viewportTopLeft } from './ViewportNode.js';\nimport { Vector2, FramebufferTexture, LinearMipmapLinearFilter } from 'three';\n\nconst _size = new Vector2();\n\nclass ViewportTextureNode extends TextureNode {\n\n\tconstructor( uvNode = viewportTopLeft, levelNode = null, framebufferTexture = null ) {\n\n\t\tif ( framebufferTexture === null ) {\n\n\t\t\tframebufferTexture = new FramebufferTexture();\n\t\t\tframebufferTexture.minFilter = LinearMipmapLinearFilter;\n\n\t\t}\n\n\t\tsuper( framebufferTexture, uvNode, levelNode );\n\n\t\tthis.generateMipmaps = false;\n\n\t\tthis.isOutputTextureNode = true;\n\n\t\tthis.updateBeforeType = NodeUpdateType.FRAME;\n\n\t}\n\n\tupdateBefore( frame ) {\n\n\t\tconst renderer = frame.renderer;\n\t\trenderer.getDrawingBufferSize( _size );\n\n\t\t//\n\n\t\tconst framebufferTexture = this.value;\n\n\t\tif ( framebufferTexture.image.width !== _size.width || framebufferTexture.image.height !== _size.height ) {\n\n\t\t\tframebufferTexture.image.width = _size.width;\n\t\t\tframebufferTexture.image.height = _size.height;\n\t\t\tframebufferTexture.needsUpdate = true;\n\n\t\t}\n\n\t\t//\n\n\t\tconst currentGenerateMipmaps = framebufferTexture.generateMipmaps;\n\t\tframebufferTexture.generateMipmaps = this.generateMipmaps;\n\n\t\trenderer.copyFramebufferToTexture( framebufferTexture );\n\n\t\tframebufferTexture.generateMipmaps = currentGenerateMipmaps;\n\n\t}\n\n\tclone() {\n\n\t\tconst viewportTextureNode = new this.constructor( this.uvNode, this.levelNode, this.value );\n\t\tviewportTextureNode.generateMipmaps = this.generateMipmaps;\n\n\t\treturn viewportTextureNode;\n\n\t}\n\n}\n\nexport default ViewportTextureNode;\n\nexport const viewportTexture = nodeProxy( ViewportTextureNode );\nexport const viewportMipTexture = nodeProxy( ViewportTextureNode, null, null, { generateMipmaps: true } );\n\naddNodeElement( 'viewportTexture', viewportTexture );\naddNodeElement( 'viewportMipTexture', viewportMipTexture );\n\naddNodeClass( 'ViewportTextureNode', ViewportTextureNode );\n","import ViewportTextureNode from './ViewportTextureNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { addNodeElement, nodeProxy } from '../shadernode/ShaderNode.js';\nimport { viewportTopLeft } from './ViewportNode.js';\nimport { DepthTexture } from 'three';\n\nlet sharedDepthbuffer = null;\n\nclass ViewportDepthTextureNode extends ViewportTextureNode {\n\n\tconstructor( uvNode = viewportTopLeft, levelNode = null ) {\n\n\t\tif ( sharedDepthbuffer === null ) {\n\n\t\t\tsharedDepthbuffer = new DepthTexture();\n\n\t\t}\n\n\t\tsuper( uvNode, levelNode, sharedDepthbuffer );\n\n\t}\n\n}\n\nexport default ViewportDepthTextureNode;\n\nexport const viewportDepthTexture = nodeProxy( ViewportDepthTextureNode );\n\naddNodeElement( 'viewportDepthTexture', viewportDepthTexture );\n\naddNodeClass( 'ViewportDepthTextureNode', ViewportDepthTextureNode );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { nodeImmutable, nodeProxy } from '../shadernode/ShaderNode.js';\nimport { cameraNear, cameraFar } from '../accessors/CameraNode.js';\nimport { positionView } from '../accessors/PositionNode.js';\nimport { viewportDepthTexture } from './ViewportDepthTextureNode.js';\n\nclass ViewportDepthNode extends Node {\n\n\tconstructor( scope, valueNode = null ) {\n\n\t\tsuper( 'float' );\n\n\t\tthis.scope = scope;\n\t\tthis.valueNode = valueNode;\n\n\t\tthis.isViewportDepthNode = true;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst { scope } = this;\n\n\t\tif ( scope === ViewportDepthNode.DEPTH ) {\n\n\t\t\treturn builder.getFragDepth();\n\n\t\t}\n\n\t\treturn super.generate( builder );\n\n\t}\n\n\tsetup( { camera } ) {\n\n\t\tconst { scope } = this;\n\t\tconst texture = this.valueNode;\n\n\t\tlet node = null;\n\n\t\tif ( scope === ViewportDepthNode.DEPTH ) {\n\n\t\t\tif ( texture !== null ) {\n\n \t\t\t\tnode = depthBase().assign( texture );\n\n\t\t\t} else {\n\n\t\t\t\tif ( camera.isPerspectiveCamera ) {\n\n\t\t\t\t\tnode = viewZToPerspectiveDepth( positionView.z, cameraNear, cameraFar );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tnode = viewZToOrthographicDepth( positionView.z, cameraNear, cameraFar );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( scope === ViewportDepthNode.LINEAR_DEPTH ) {\n\n\t\t\tif ( texture !== null ) {\n\n\t\t\t\tif ( camera.isPerspectiveCamera ) {\n\n\t\t\t\t\tconst viewZ = perspectiveDepthToViewZ( texture, cameraNear, cameraFar );\n\n\t\t\t\t\tnode = viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tnode = texture;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tnode = viewZToOrthographicDepth( positionView.z, cameraNear, cameraFar );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn node;\n\n\t}\n\n}\n\n// NOTE: viewZ, the z-coordinate in camera space, is negative for points in front of the camera\n\n// -near maps to 0; -far maps to 1\nexport const viewZToOrthographicDepth = ( viewZ, near, far ) => viewZ.add( near ).div( near.sub( far ) );\n\n// maps orthographic depth in [ 0, 1 ] to viewZ\nexport const orthographicDepthToViewZ = ( depth, near, far ) => near.sub( far ).mul( depth ).sub( near );\n\n// NOTE: https://twitter.com/gonnavis/status/1377183786949959682\n\n// -near maps to 0; -far maps to 1\nexport const viewZToPerspectiveDepth = ( viewZ, near, far ) => near.add( viewZ ).mul( far ).div( far.sub( near ).mul( viewZ ) );\n\n// maps perspective depth in [ 0, 1 ] to viewZ\nexport const perspectiveDepthToViewZ = ( depth, near, far ) => near.mul( far ).div( far.sub( near ).mul( depth ).sub( far ) );\n\nViewportDepthNode.DEPTH = 'depth';\nViewportDepthNode.LINEAR_DEPTH = 'linearDepth';\n\nexport default ViewportDepthNode;\n\nconst depthBase = nodeProxy( ViewportDepthNode, ViewportDepthNode.DEPTH );\n\nexport const depth = nodeImmutable( ViewportDepthNode, ViewportDepthNode.DEPTH );\nexport const linearDepth = nodeProxy( ViewportDepthNode, ViewportDepthNode.LINEAR_DEPTH );\nexport const viewportLinearDepth = linearDepth( viewportDepthTexture() );\n\ndepth.assign = ( value ) => depthBase( value );\n\naddNodeClass( 'ViewportDepthNode', ViewportDepthNode );\n","\nimport Node from '../core/Node.js';\nimport { nodeObject } from '../shadernode/ShaderNode.js';\nimport { positionView } from './PositionNode.js';\nimport { diffuseColor, property } from '../core/PropertyNode.js';\nimport { tslFn } from '../shadernode/ShaderNode.js';\nimport { loop } from '../utils/LoopNode.js';\nimport { smoothstep } from '../math/MathNode.js';\nimport { uniforms } from './UniformsNode.js';\n\nclass ClippingNode extends Node {\n\n\tconstructor( scope = ClippingNode.DEFAULT ) {\n\n\t\tsuper();\n\n\t\tthis.scope = scope;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tsuper.setup( builder );\n\n\t\tconst clippingContext = builder.clippingContext;\n\t\tconst { localClipIntersection, localClippingCount, globalClippingCount } = clippingContext;\n\n\t\tconst numClippingPlanes = globalClippingCount + localClippingCount;\n\t\tconst numUnionClippingPlanes = localClipIntersection ? numClippingPlanes - localClippingCount : numClippingPlanes;\n\n\t\tif ( this.scope === ClippingNode.ALPHA_TO_COVERAGE ) {\n\n\t\t\treturn this.setupAlphaToCoverage( clippingContext.planes, numClippingPlanes, numUnionClippingPlanes );\n\n\t\t} else {\n\n\t\t\treturn this.setupDefault( clippingContext.planes, numClippingPlanes, numUnionClippingPlanes );\n\n\t\t}\n\n\t}\n\n\tsetupAlphaToCoverage( planes, numClippingPlanes, numUnionClippingPlanes ) {\n\n\t\treturn tslFn( () => {\n\n\t\t\tconst clippingPlanes = uniforms( planes );\n\n\t\t\tconst distanceToPlane = property( 'float', 'distanceToPlane' );\n\t\t\tconst distanceGradient = property( 'float', 'distanceToGradient' );\n\n\t\t\tconst clipOpacity = property( 'float', 'clipOpacity' );\n\n\t\t\tclipOpacity.assign( 1 );\n\n\t\t\tlet plane;\n\n\t\t\tloop( numUnionClippingPlanes, ( { i } ) => {\n\n\t\t\t\tplane = clippingPlanes.element( i );\n\n\t\t\t\tdistanceToPlane.assign( positionView.dot( plane.xyz ).negate().add( plane.w ) );\n\t\t\t\tdistanceGradient.assign( distanceToPlane.fwidth().div( 2.0 ) );\n\n\t\t\t\tclipOpacity.mulAssign( smoothstep( distanceGradient.negate(), distanceGradient, distanceToPlane ) );\n\n\t\t\t\tclipOpacity.equal( 0.0 ).discard();\n\n\t\t\t} );\n\n\t\t\tif ( numUnionClippingPlanes < numClippingPlanes ) {\n\n\t\t\t\tconst unionClipOpacity = property( 'float', 'unionclipOpacity' );\n\n\t\t\t\tunionClipOpacity.assign( 1 );\n\n\t\t\t\tloop( { start: numUnionClippingPlanes, end: numClippingPlanes }, ( { i } ) => {\n\n\t\t\t\t\tplane = clippingPlanes.element( i );\n\n\t\t\t\t\tdistanceToPlane.assign( positionView.dot( plane.xyz ).negate().add( plane.w ) );\n\t\t\t\t\tdistanceGradient.assign( distanceToPlane.fwidth().div( 2.0 ) );\n\n\t\t\t\t\tunionClipOpacity.mulAssign( smoothstep( distanceGradient.negate(), distanceGradient, distanceToPlane ).oneMinus() );\n\n\t\t\t\t} );\n\n\t\t\t\tclipOpacity.mulAssign( unionClipOpacity.oneMinus() );\n\n\t\t\t}\n\n\t\t\tdiffuseColor.a.mulAssign( clipOpacity );\n\n\t\t\tdiffuseColor.a.equal( 0.0 ).discard();\n\n\t\t} )();\n\n\t}\n\n\tsetupDefault( planes, numClippingPlanes, numUnionClippingPlanes ) {\n\n\t\treturn tslFn( () => {\n\n\t\t\tconst clippingPlanes = uniforms( planes );\n\n\t\t\tlet plane;\n\n\t\t\tloop( numUnionClippingPlanes, ( { i } ) => {\n\n\t\t\t\tplane = clippingPlanes.element( i );\n\t\t\t\tpositionView.dot( plane.xyz ).greaterThan( plane.w ).discard();\n\n\t\t\t} );\n\n\t\t\tif ( numUnionClippingPlanes < numClippingPlanes ) {\n\n\t\t\t\tconst clipped = property( 'bool', 'clipped' );\n\n\t\t\t\tclipped.assign( true );\n\n\t\t\t\tloop( { start: numUnionClippingPlanes, end: numClippingPlanes }, ( { i } ) => {\n\n\t\t\t\t\tplane = clippingPlanes.element( i );\n\t\t\t\t\tclipped.assign( positionView.dot( plane.xyz ).greaterThan( plane.w ).and( clipped ) );\n\n\t\t\t\t} );\n\n\t\t\t\tclipped.discard();\n\n\t\t\t}\n\n\t\t} )();\n\n\t}\n\n}\n\nClippingNode.ALPHA_TO_COVERAGE = 'alphaToCoverage';\nClippingNode.DEFAULT = 'default';\n\nexport default ClippingNode;\n\nexport const clipping = () => nodeObject( new ClippingNode() );\n\nexport const clippingAlpha = () => nodeObject( new ClippingNode( ClippingNode.ALPHA_TO_COVERAGE ) );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { nodeImmutable, float } from '../shadernode/ShaderNode.js';\nimport { BackSide, WebGLCoordinateSystem } from 'three';\n\nclass FrontFacingNode extends Node {\n\n\tconstructor() {\n\n\t\tsuper( 'bool' );\n\n\t\tthis.isFrontFacingNode = true;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst { renderer, material } = builder;\n\n\t\tif ( renderer.coordinateSystem === WebGLCoordinateSystem ) {\n\n\t\t\tif ( material.side === BackSide ) {\n\n\t\t\t\treturn 'false';\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn builder.getFrontFacing();\n\n\t}\n\n}\n\nexport default FrontFacingNode;\n\nexport const frontFacing = nodeImmutable( FrontFacingNode );\nexport const faceDirection = float( frontFacing ).mul( 2.0 ).sub( 1.0 );\n\naddNodeClass( 'FrontFacingNode', FrontFacingNode );\n","import { Material, NormalBlending } from 'three';\nimport { getNodeChildren, getCacheKey } from '../core/NodeUtils.js';\nimport { attribute } from '../core/AttributeNode.js';\nimport { output, diffuseColor, varyingProperty } from '../core/PropertyNode.js';\nimport { materialAlphaTest, materialColor, materialOpacity, materialEmissive, materialNormal } from '../accessors/MaterialNode.js';\nimport { modelViewProjection } from '../accessors/ModelViewProjectionNode.js';\nimport { transformedNormalView, normalLocal } from '../accessors/NormalNode.js';\nimport { instance } from '../accessors/InstanceNode.js';\nimport { batch } from '../accessors/BatchNode.js';\nimport { materialReference } from '../accessors/MaterialReferenceNode.js';\nimport { positionLocal, positionView } from '../accessors/PositionNode.js';\nimport { skinningReference } from '../accessors/SkinningNode.js';\nimport { morphReference } from '../accessors/MorphNode.js';\nimport { texture } from '../accessors/TextureNode.js';\nimport { cubeTexture } from '../accessors/CubeTextureNode.js';\nimport { lightsNode } from '../lighting/LightsNode.js';\nimport { mix } from '../math/MathNode.js';\nimport { float, vec3, vec4 } from '../shadernode/ShaderNode.js';\nimport AONode from '../lighting/AONode.js';\nimport { lightingContext } from '../lighting/LightingContextNode.js';\nimport EnvironmentNode from '../lighting/EnvironmentNode.js';\nimport IrradianceNode from '../lighting/IrradianceNode.js';\nimport { depth } from '../display/ViewportDepthNode.js';\nimport { cameraLogDepth } from '../accessors/CameraNode.js';\nimport { clipping, clippingAlpha } from '../accessors/ClippingNode.js';\nimport { faceDirection } from '../display/FrontFacingNode.js';\n\nconst NodeMaterials = new Map();\n\nclass NodeMaterial extends Material {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isNodeMaterial = true;\n\n\t\tthis.type = this.constructor.type;\n\n\t\tthis.forceSinglePass = false;\n\n\t\tthis.fog = true;\n\t\tthis.lights = true;\n\t\tthis.normals = true;\n\n\t\tthis.lightsNode = null;\n\t\tthis.envNode = null;\n\t\tthis.aoNode = null;\n\n\t\tthis.colorNode = null;\n\t\tthis.normalNode = null;\n\t\tthis.opacityNode = null;\n\t\tthis.backdropNode = null;\n\t\tthis.backdropAlphaNode = null;\n\t\tthis.alphaTestNode = null;\n\n\t\tthis.positionNode = null;\n\n\t\tthis.depthNode = null;\n\t\tthis.shadowNode = null;\n\t\tthis.shadowPositionNode = null;\n\n\t\tthis.outputNode = null;\n\n\t\tthis.fragmentNode = null;\n\t\tthis.vertexNode = null;\n\n\t}\n\n\tcustomProgramCacheKey() {\n\n\t\treturn this.type + getCacheKey( this );\n\n\t}\n\n\tbuild( builder ) {\n\n\t\tthis.setup( builder );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\t// < VERTEX STAGE >\n\n\t\tbuilder.addStack();\n\n\t\tbuilder.stack.outputNode = this.vertexNode || this.setupPosition( builder );\n\n\t\tbuilder.addFlow( 'vertex', builder.removeStack() );\n\n\t\t// < FRAGMENT STAGE >\n\n\t\tbuilder.addStack();\n\n\t\tlet resultNode;\n\n\t\tconst clippingNode = this.setupClipping( builder );\n\n\t\tif ( this.depthWrite === true ) this.setupDepth( builder );\n\n\t\tif ( this.fragmentNode === null ) {\n\n\t\t\tif ( this.normals === true ) this.setupNormal( builder );\n\n\t\t\tthis.setupDiffuseColor( builder );\n\t\t\tthis.setupVariants( builder );\n\n\t\t\tconst outgoingLightNode = this.setupLighting( builder );\n\n\t\t\tif ( clippingNode !== null ) builder.stack.add( clippingNode );\n\n\t\t\t// force unsigned floats - useful for RenderTargets\n\n\t\t\tconst basicOutput = vec4( outgoingLightNode, diffuseColor.a ).max( 0 );\n\n\t\t\tresultNode = this.setupOutput( builder, basicOutput );\n\n\t\t\t// OUTPUT NODE\n\n\t\t\toutput.assign( resultNode );\n\n\t\t\t//\n\n\t\t\tif ( this.outputNode !== null ) resultNode = this.outputNode;\n\n\t\t} else {\n\n\t\t\tlet fragmentNode = this.fragmentNode;\n\n\t\t\tif ( fragmentNode.isOutputStructNode !== true ) {\n\n\t\t\t\tfragmentNode = vec4( fragmentNode );\n\n\t\t\t}\n\n\t\t\tresultNode = this.setupOutput( builder, fragmentNode );\n\n\t\t}\n\n\t\tbuilder.stack.outputNode = resultNode;\n\n\t\tbuilder.addFlow( 'fragment', builder.removeStack() );\n\n\t}\n\n\tsetupClipping( builder ) {\n\n\t\tif ( builder.clippingContext === null ) return null;\n\n\t\tconst { globalClippingCount, localClippingCount } = builder.clippingContext;\n\n\t\tlet result = null;\n\n\t\tif ( globalClippingCount || localClippingCount ) {\n\n\t\t\tif ( this.alphaToCoverage ) {\n\n\t\t\t\t// to be added to flow when the color/alpha value has been determined\n\t\t\t\tresult = clippingAlpha();\n\n\t\t\t} else {\n\n\t\t\t\tbuilder.stack.add( clipping() );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\tsetupDepth( builder ) {\n\n\t\tconst { renderer } = builder;\n\n\t\t// Depth\n\n\t\tlet depthNode = this.depthNode;\n\n\t\tif ( depthNode === null && renderer.logarithmicDepthBuffer === true ) {\n\n\t\t\tconst fragDepth = modelViewProjection().w.add( 1 );\n\n\t\t\tdepthNode = fragDepth.log2().mul( cameraLogDepth ).mul( 0.5 );\n\n\t\t}\n\n\t\tif ( depthNode !== null ) {\n\n\t\t\tdepth.assign( depthNode ).append();\n\n\t\t}\n\n\t}\n\n\tsetupPosition( builder ) {\n\n\t\tconst { object } = builder;\n\t\tconst geometry = object.geometry;\n\n\t\tbuilder.addStack();\n\n\t\t// Vertex\n\n\t\tif ( geometry.morphAttributes.position || geometry.morphAttributes.normal || geometry.morphAttributes.color ) {\n\n\t\t\tmorphReference( object ).append();\n\n\t\t}\n\n\t\tif ( object.isSkinnedMesh === true ) {\n\n\t\t\tskinningReference( object ).append();\n\n\t\t}\n\n\t\tif ( this.displacementMap ) {\n\n\t\t\tconst displacementMap = materialReference( 'displacementMap', 'texture' );\n\t\t\tconst displacementScale = materialReference( 'displacementScale', 'float' );\n\t\t\tconst displacementBias = materialReference( 'displacementBias', 'float' );\n\n\t\t\tpositionLocal.addAssign( normalLocal.normalize().mul( ( displacementMap.x.mul( displacementScale ).add( displacementBias ) ) ) );\n\n\t\t}\n\n\t\tif ( object.isBatchedMesh ) {\n\n\t\t\tbatch( object ).append();\n\n\t\t}\n\n\t\tif ( ( object.instanceMatrix && object.instanceMatrix.isInstancedBufferAttribute === true ) ) {\n\n\t\t\tinstance( object ).append();\n\n\t\t}\n\n\t\tif ( this.positionNode !== null ) {\n\n\t\t\tpositionLocal.assign( this.positionNode );\n\n\t\t}\n\n\t\tconst mvp = modelViewProjection();\n\n\t\tbuilder.context.vertex = builder.removeStack();\n\t\tbuilder.context.mvp = mvp;\n\n\t\treturn mvp;\n\n\t}\n\n\tsetupDiffuseColor( { object, geometry } ) {\n\n\t\tlet colorNode = this.colorNode ? vec4( this.colorNode ) : materialColor;\n\n\t\t// VERTEX COLORS\n\n\t\tif ( this.vertexColors === true && geometry.hasAttribute( 'color' ) ) {\n\n\t\t\tcolorNode = vec4( colorNode.xyz.mul( attribute( 'color', 'vec3' ) ), colorNode.a );\n\n\t\t}\n\n\t\t// Instanced colors\n\n\t\tif ( object.instanceColor ) {\n\n\t\t\tconst instanceColor = varyingProperty( 'vec3', 'vInstanceColor' );\n\n\t\t\tcolorNode = instanceColor.mul( colorNode );\n\n\t\t}\n\n\t\t// COLOR\n\n\t\tdiffuseColor.assign( colorNode );\n\n\t\t// OPACITY\n\n\t\tconst opacityNode = this.opacityNode ? float( this.opacityNode ) : materialOpacity;\n\t\tdiffuseColor.a.assign( diffuseColor.a.mul( opacityNode ) );\n\n\t\t// ALPHA TEST\n\n\t\tif ( this.alphaTestNode !== null || this.alphaTest > 0 ) {\n\n\t\t\tconst alphaTestNode = this.alphaTestNode !== null ? float( this.alphaTestNode ) : materialAlphaTest;\n\n\t\t\tdiffuseColor.a.lessThanEqual( alphaTestNode ).discard();\n\n\t\t}\n\n\t\tif ( this.transparent === false && this.blending === NormalBlending && this.alphaToCoverage === false ) {\n\n\t\t\tdiffuseColor.a.assign( 1.0 );\n\n\t\t}\n\n\t}\n\n\tsetupVariants( /*builder*/ ) {\n\n\t\t// Interface function.\n\n\t}\n\n\tsetupNormal() {\n\n\t\t// NORMAL VIEW\n\n\t\tif ( this.flatShading === true ) {\n\n\t\t\tconst normalNode = positionView.dFdx().cross( positionView.dFdy() ).normalize();\n\n\t\t\ttransformedNormalView.assign( normalNode.mul( faceDirection ) );\n\n\t\t} else {\n\n\t\t\tconst normalNode = this.normalNode ? vec3( this.normalNode ) : materialNormal;\n\n\t\t\ttransformedNormalView.assign( normalNode.mul( faceDirection ) );\n\n\t\t}\n\n\t}\n\n\tgetEnvNode( builder ) {\n\n\t\tlet node = null;\n\n\t\tif ( this.envNode ) {\n\n\t\t\tnode = this.envNode;\n\n\t\t} else if ( this.envMap ) {\n\n\t\t\tnode = this.envMap.isCubeTexture ? cubeTexture( this.envMap ) : texture( this.envMap );\n\n\t\t} else if ( builder.environmentNode ) {\n\n\t\t\tnode = builder.environmentNode;\n\n\t\t}\n\n\t\treturn node;\n\n\t}\n\n\tsetupLights( builder ) {\n\n\t\tconst envNode = this.getEnvNode( builder );\n\n\t\t//\n\n\t\tconst materialLightsNode = [];\n\n\t\tif ( envNode ) {\n\n\t\t\tmaterialLightsNode.push( new EnvironmentNode( envNode ) );\n\n\t\t}\n\n\t\tif ( builder.material.lightMap ) {\n\n\t\t\tmaterialLightsNode.push( new IrradianceNode( materialReference( 'lightMap', 'texture' ) ) );\n\n\t\t}\n\n\t\tif ( this.aoNode !== null || builder.material.aoMap ) {\n\n\t\t\tconst aoNode = this.aoNode !== null ? this.aoNode : texture( builder.material.aoMap );\n\n\t\t\tmaterialLightsNode.push( new AONode( aoNode ) );\n\n\t\t}\n\n\t\tlet lightsN = this.lightsNode || builder.lightsNode;\n\n\t\tif ( materialLightsNode.length > 0 ) {\n\n\t\t\tlightsN = lightsNode( [ ...lightsN.lightNodes, ...materialLightsNode ] );\n\n\t\t}\n\n\t\treturn lightsN;\n\n\t}\n\n\tsetupLightingModel( /*builder*/ ) {\n\n\t\t// Interface function.\n\n\t}\n\n\tsetupLighting( builder ) {\n\n\t\tconst { material } = builder;\n\t\tconst { backdropNode, backdropAlphaNode, emissiveNode } = this;\n\n\t\t// OUTGOING LIGHT\n\n\t\tconst lights = this.lights === true || this.lightsNode !== null;\n\n\t\tconst lightsNode = lights ? this.setupLights( builder ) : null;\n\n\t\tlet outgoingLightNode = diffuseColor.rgb;\n\n\t\tif ( lightsNode && lightsNode.hasLight !== false ) {\n\n\t\t\tconst lightingModel = this.setupLightingModel( builder );\n\n\t\t\toutgoingLightNode = lightingContext( lightsNode, lightingModel, backdropNode, backdropAlphaNode );\n\n\t\t} else if ( backdropNode !== null ) {\n\n\t\t\toutgoingLightNode = vec3( backdropAlphaNode !== null ? mix( outgoingLightNode, backdropNode, backdropAlphaNode ) : backdropNode );\n\n\t\t}\n\n\t\t// EMISSIVE\n\n\t\tif ( ( emissiveNode && emissiveNode.isNode === true ) || ( material.emissive && material.emissive.isColor === true ) ) {\n\n\t\t\toutgoingLightNode = outgoingLightNode.add( vec3( emissiveNode ? emissiveNode : materialEmissive ) );\n\n\t\t}\n\n\t\treturn outgoingLightNode;\n\n\t}\n\n\tsetupOutput( builder, outputNode ) {\n\n\t\t// FOG\n\n\t\tif ( this.fog === true ) {\n\n\t\t\tconst fogNode = builder.fogNode;\n\n\t\t\tif ( fogNode ) outputNode = vec4( fogNode.mix( outputNode.rgb, fogNode.colorNode ), outputNode.a );\n\n\t\t}\n\n\t\treturn outputNode;\n\n\t}\n\n\tsetDefaultValues( material ) {\n\n\t\t// This approach is to reuse the native refreshUniforms*\n\t\t// and turn available the use of features like transmission and environment in core\n\n\t\tfor ( const property in material ) {\n\n\t\t\tconst value = material[ property ];\n\n\t\t\tif ( this[ property ] === undefined ) {\n\n\t\t\t\tthis[ property ] = value;\n\n\t\t\t\tif ( value && value.clone ) this[ property ] = value.clone();\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst descriptors = Object.getOwnPropertyDescriptors( material.constructor.prototype );\n\n\t\tfor ( const key in descriptors ) {\n\n\t\t\tif ( Object.getOwnPropertyDescriptor( this.constructor.prototype, key ) === undefined &&\n\t\t\t     descriptors[ key ].get !== undefined ) {\n\n\t\t\t\tObject.defineProperty( this.constructor.prototype, key, descriptors[ key ] );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst isRoot = ( meta === undefined || typeof meta === 'string' );\n\n\t\tif ( isRoot ) {\n\n\t\t\tmeta = {\n\t\t\t\ttextures: {},\n\t\t\t\timages: {},\n\t\t\t\tnodes: {}\n\t\t\t};\n\n\t\t}\n\n\t\tconst data = Material.prototype.toJSON.call( this, meta );\n\t\tconst nodeChildren = getNodeChildren( this );\n\n\t\tdata.inputNodes = {};\n\n\t\tfor ( const { property, childNode } of nodeChildren ) {\n\n\t\t\tdata.inputNodes[ property ] = childNode.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\t// TODO: Copied from Object3D.toJSON\n\n\t\tfunction extractFromCache( cache ) {\n\n\t\t\tconst values = [];\n\n\t\t\tfor ( const key in cache ) {\n\n\t\t\t\tconst data = cache[ key ];\n\t\t\t\tdelete data.metadata;\n\t\t\t\tvalues.push( data );\n\n\t\t\t}\n\n\t\t\treturn values;\n\n\t\t}\n\n\t\tif ( isRoot ) {\n\n\t\t\tconst textures = extractFromCache( meta.textures );\n\t\t\tconst images = extractFromCache( meta.images );\n\t\t\tconst nodes = extractFromCache( meta.nodes );\n\n\t\t\tif ( textures.length > 0 ) data.textures = textures;\n\t\t\tif ( images.length > 0 ) data.images = images;\n\t\t\tif ( nodes.length > 0 ) data.nodes = nodes;\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.lightsNode = source.lightsNode;\n\t\tthis.envNode = source.envNode;\n\n\t\tthis.colorNode = source.colorNode;\n\t\tthis.normalNode = source.normalNode;\n\t\tthis.opacityNode = source.opacityNode;\n\t\tthis.backdropNode = source.backdropNode;\n\t\tthis.backdropAlphaNode = source.backdropAlphaNode;\n\t\tthis.alphaTestNode = source.alphaTestNode;\n\n\t\tthis.positionNode = source.positionNode;\n\n\t\tthis.depthNode = source.depthNode;\n\t\tthis.shadowNode = source.shadowNode;\n\t\tthis.shadowPositionNode = source.shadowPositionNode;\n\n\t\tthis.outputNode = source.outputNode;\n\n\t\tthis.fragmentNode = source.fragmentNode;\n\t\tthis.vertexNode = source.vertexNode;\n\n\t\treturn super.copy( source );\n\n\t}\n\n\tstatic fromMaterial( material ) {\n\n\t\tif ( material.isNodeMaterial === true ) { // is already a node material\n\n\t\t\treturn material;\n\n\t\t}\n\n\t\tconst type = material.type.replace( 'Material', 'NodeMaterial' );\n\n\t\tconst nodeMaterial = createNodeMaterialFromType( type );\n\n\t\tif ( nodeMaterial === undefined ) {\n\n\t\t\tthrow new Error( `NodeMaterial: Material \"${ material.type }\" is not compatible.` );\n\n\t\t}\n\n\t\tfor ( const key in material ) {\n\n\t\t\tnodeMaterial[ key ] = material[ key ];\n\n\t\t}\n\n\t\treturn nodeMaterial;\n\n\t}\n\n}\n\nexport default NodeMaterial;\n\nexport function addNodeMaterial( type, nodeMaterial ) {\n\n\tif ( typeof nodeMaterial !== 'function' || ! type ) throw new Error( `Node material ${ type } is not a class` );\n\tif ( NodeMaterials.has( type ) ) {\n\n\t\tconsole.warn( `Redefinition of node material ${ type }` );\n\t\treturn;\n\n\t}\n\n\tNodeMaterials.set( type, nodeMaterial );\n\tnodeMaterial.type = type;\n\n}\n\nexport function createNodeMaterialFromType( type ) {\n\n\tconst Material = NodeMaterials.get( type );\n\n\tif ( Material !== undefined ) {\n\n\t\treturn new Material();\n\n\t}\n\n}\n\naddNodeMaterial( 'NodeMaterial', NodeMaterial );\n","import Node, { addNodeClass } from './Node.js';\nimport { cond } from '../math/CondNode.js';\nimport { ShaderNode, nodeProxy, getCurrentStack, setCurrentStack } from '../shadernode/ShaderNode.js';\n\nclass StackNode extends Node {\n\n\tconstructor( parent = null ) {\n\n\t\tsuper();\n\n\t\tthis.nodes = [];\n\t\tthis.outputNode = null;\n\n\t\tthis.parent = parent;\n\n\t\tthis._currentCond = null;\n\n\t\tthis.isStackNode = true;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.outputNode ? this.outputNode.getNodeType( builder ) : 'void';\n\n\t}\n\n\tadd( node ) {\n\n\t\tthis.nodes.push( node );\n\n\t\treturn this;\n\n\t}\n\n\tif( boolNode, method ) {\n\n\t\tconst methodNode = new ShaderNode( method );\n\t\tthis._currentCond = cond( boolNode, methodNode );\n\n\t\treturn this.add( this._currentCond );\n\n\t}\n\n\telseif( boolNode, method ) {\n\n\t\tconst methodNode = new ShaderNode( method );\n\t\tconst ifNode = cond( boolNode, methodNode );\n\n\t\tthis._currentCond.elseNode = ifNode;\n\t\tthis._currentCond = ifNode;\n\n\t\treturn this;\n\n\t}\n\n\telse( method ) {\n\n\t\tthis._currentCond.elseNode = new ShaderNode( method );\n\n\t\treturn this;\n\n\t}\n\n\tbuild( builder, ...params ) {\n\n\t\tconst previousStack = getCurrentStack();\n\n\t\tsetCurrentStack( this );\n\n\t\tfor ( const node of this.nodes ) {\n\n\t\t\tnode.build( builder, 'void' );\n\n\t\t}\n\n\t\tsetCurrentStack( previousStack );\n\n\t\treturn this.outputNode ? this.outputNode.build( builder, ...params ) : super.build( builder, ...params );\n\n\t}\n\n}\n\nexport default StackNode;\n\nexport const stack = nodeProxy( StackNode );\n\naddNodeClass( 'StackNode', StackNode );\n","import TempNode from '../core/TempNode.js';\nimport { positionWorldDirection } from '../accessors/PositionNode.js';\nimport { nodeProxy, vec2 } from '../shadernode/ShaderNode.js';\nimport { addNodeClass } from '../core/Node.js';\n\nclass EquirectUVNode extends TempNode {\n\n\tconstructor( dirNode = positionWorldDirection ) {\n\n\t\tsuper( 'vec2' );\n\n\t\tthis.dirNode = dirNode;\n\n\t}\n\n\tsetup() {\n\n\t\tconst dir = this.dirNode;\n\n\t\tconst u = dir.z.atan2( dir.x ).mul( 1 / ( Math.PI * 2 ) ).add( 0.5 );\n\t\tconst v = dir.y.clamp( - 1.0, 1.0 ).asin().mul( 1 / Math.PI ).add( 0.5 );\n\n\t\treturn vec2( u, v );\n\n\t}\n\n}\n\nexport default EquirectUVNode;\n\nexport const equirectUV = nodeProxy( EquirectUVNode );\n\naddNodeClass( 'EquirectUVNode', EquirectUVNode );\n","import Node, { addNodeClass } from './Node.js';\n\nclass StructTypeNode extends Node {\n\n\tconstructor( types ) {\n\n\t\tsuper();\n\n\t\tthis.types = types;\n\t\tthis.isStructTypeNode = true;\n\n\t}\n\n\tgetMemberTypes() {\n\n\t\treturn this.types;\n\n\t}\n\n}\n\nexport default StructTypeNode;\n\naddNodeClass( 'StructTypeNode', StructTypeNode );\n","import Node, { addNodeClass } from './Node.js';\nimport StructTypeNode from './StructTypeNode.js';\nimport { nodeProxy } from '../shadernode/ShaderNode.js';\n\nclass OutputStructNode extends Node {\n\n\tconstructor( ...members ) {\n\n\t\tsuper();\n\n\t\tthis.members = members;\n\n\t\tthis.isOutputStructNode = true;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tsuper.setup( builder );\n\n\t\tconst members = this.members;\n\t\tconst types = [];\n\n\t\tfor ( let i = 0; i < members.length; i ++ ) {\n\n\t\t\ttypes.push( members[ i ].getNodeType( builder ) );\n\n\t\t}\n\n\t\tthis.nodeType = builder.getStructTypeFromNode( new StructTypeNode( types ) ).name;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst propertyName = builder.getOutputStructName();\n\t\tconst members = this.members;\n\n\t\tconst structPrefix = propertyName !== '' ? propertyName + '.' : '';\n\n\t\tfor ( let i = 0; i < members.length; i ++ ) {\n\n\t\t\tconst snippet = members[ i ].build( builder, output );\n\n\t\t\tbuilder.addLineFlowCode( `${ structPrefix }m${ i } = ${ snippet }` );\n\n\t\t}\n\n\t\treturn propertyName;\n\n\t}\n\n}\n\nexport default OutputStructNode;\n\nexport const outputStruct = nodeProxy( OutputStructNode );\n\naddNodeClass( 'OutputStructNode', OutputStructNode );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { addNodeElement, nodeProxy } from '../shadernode/ShaderNode.js';\n\nclass HashNode extends Node {\n\n\tconstructor( seedNode ) {\n\n\t\tsuper();\n\n\t\tthis.seedNode = seedNode;\n\n\t}\n\n\tsetup( /*builder*/ ) {\n\n\t\t// Taken from https://www.shadertoy.com/view/XlGcRh, originally from pcg-random.org\n\n\t\tconst state = this.seedNode.toUint().mul( 747796405 ).add( 2891336453 );\n\t\tconst word = state.shiftRight( state.shiftRight( 28 ).add( 4 ) ).bitXor( state ).mul( 277803737 );\n\t\tconst result = word.shiftRight( 22 ).bitXor( word );\n\n\t\treturn result.toFloat().mul( 1 / 2 ** 32 ); // Convert to range [0, 1)\n\n\t}\n\n}\n\nexport default HashNode;\n\nexport const hash = nodeProxy( HashNode );\n\naddNodeElement( 'hash', hash );\n\naddNodeClass( 'HashNode', HashNode );\n","import { sub, mul, div, add } from './OperatorNode.js';\nimport { addNodeElement } from '../shadernode/ShaderNode.js';\nimport { PI, pow, sin } from './MathNode.js';\n\n// remapping functions https://iquilezles.org/articles/functions/\nexport const parabola = ( x, k ) => pow( mul( 4.0, x.mul( sub( 1.0, x ) ) ), k );\nexport const gain = ( x, k ) => x.lessThan( 0.5 ) ? parabola( x.mul( 2.0 ), k ).div( 2.0 ) : sub( 1.0, parabola( mul( sub( 1.0, x ), 2.0 ), k ).div( 2.0 ) );\nexport const pcurve = ( x, a, b ) => pow( div( pow( x, a ), add( pow( x, a ), pow( sub( 1.0, x ), b ) ) ), 1.0 / a );\nexport const sinc = ( x, k ) => sin( PI.mul( k.mul( x ).sub( 1.0 ) ) ).div( PI.mul( k.mul( x ).sub( 1.0 ) ) );\n\n\naddNodeElement( 'parabola', parabola );\naddNodeElement( 'gain', gain );\naddNodeElement( 'pcurve', pcurve );\naddNodeElement( 'sinc', sinc );\n","// https://github.com/cabbibo/glsl-tri-noise-3d\n\nimport { loop } from '../utils/LoopNode.js';\nimport { float, vec3, tslFn } from '../shadernode/ShaderNode.js';\n\nconst tri = tslFn( ( [ x ] ) => {\n\n\treturn x.fract().sub( .5 ).abs();\n\n} );\n\nconst tri3 = tslFn( ( [ p ] ) => {\n\n\treturn vec3( tri( p.z.add( tri( p.y.mul( 1. ) ) ) ), tri( p.z.add( tri( p.x.mul( 1. ) ) ) ), tri( p.y.add( tri( p.x.mul( 1. ) ) ) ) );\n\n} );\n\nconst triNoise3D = tslFn( ( [ p_immutable, spd, time ] ) => {\n\n\tconst p = vec3( p_immutable ).toVar();\n\tconst z = float( 1.4 ).toVar();\n\tconst rz = float( 0.0 ).toVar();\n\tconst bp = vec3( p ).toVar();\n\n\tloop( { start: float( 0.0 ), end: float( 3.0 ), type: 'float', condition: '<=' }, () => {\n\n\t\tconst dg = vec3( tri3( bp.mul( 2.0 ) ) ).toVar();\n\t\tp.addAssign( dg.add( time.mul( float( 0.1 ).mul( spd ) ) ) );\n\t\tbp.mulAssign( 1.8 );\n\t\tz.mulAssign( 1.5 );\n\t\tp.mulAssign( 1.2 );\n\n\t\tconst t = float( tri( p.z.add( tri( p.x.add( tri( p.y ) ) ) ) ) ).toVar();\n\t\trz.addAssign( t.div( z ) );\n\t\tbp.addAssign( 0.14 );\n\n\t} );\n\n\treturn rz;\n\n} );\n\n// layouts\n\ntri.setLayout( {\n\tname: 'tri',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'x', type: 'float' }\n\t]\n} );\n\ntri3.setLayout( {\n\tname: 'tri3',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' }\n\t]\n} );\n\ntriNoise3D.setLayout( {\n\tname: 'triNoise3D',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' },\n\t\t{ name: 'spd', type: 'float' },\n\t\t{ name: 'time', type: 'float' }\n\t]\n} );\n\nexport { tri, tri3, triNoise3D };\n","import CondNode from '../math/CondNode.js';\nimport { expression } from '../code/ExpressionNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { addNodeElement, nodeProxy } from '../shadernode/ShaderNode.js';\n\nlet discardExpression;\n\nclass DiscardNode extends CondNode {\n\n\tconstructor( condNode ) {\n\n\t\tdiscardExpression = discardExpression || expression( 'discard' );\n\n\t\tsuper( condNode, discardExpression );\n\n\t}\n\n}\n\nexport default DiscardNode;\n\nexport const inlineDiscard = nodeProxy( DiscardNode );\nexport const discard = ( condNode ) => inlineDiscard( condNode ).append();\nexport const Return = () => expression( 'return' ).append();\n\naddNodeElement( 'discard', discard ); // @TODO: Check... this cause a little confusing using in chaining\n\naddNodeClass( 'DiscardNode', DiscardNode );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { nodeProxy } from '../shadernode/ShaderNode.js';\n\nclass FunctionOverloadingNode extends Node {\n\n\tconstructor( functionNodes = [], ...parametersNodes ) {\n\n\t\tsuper();\n\n\t\tthis.functionNodes = functionNodes;\n\t\tthis.parametersNodes = parametersNodes;\n\n\t\tthis._candidateFnCall = null;\n\n\t\tthis.global = true;\n\n\t}\n\n\tgetNodeType() {\n\n\t\treturn this.functionNodes[ 0 ].shaderNode.layout.type;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst params = this.parametersNodes;\n\n\t\tlet candidateFnCall = this._candidateFnCall;\n\n\t\tif ( candidateFnCall === null ) {\n\n\t\t\tlet candidateFn = null;\n\t\t\tlet candidateScore = - 1;\n\n\t\t\tfor ( const functionNode of this.functionNodes ) {\n\n\t\t\t\tconst shaderNode = functionNode.shaderNode;\n\t\t\t\tconst layout = shaderNode.layout;\n\n\t\t\t\tif ( layout === null ) {\n\n\t\t\t\t\tthrow new Error( 'FunctionOverloadingNode: FunctionNode must be a layout.' );\n\n\t\t\t\t}\n\n\t\t\t\tconst inputs = layout.inputs;\n\n\t\t\t\tif ( params.length === inputs.length ) {\n\n\t\t\t\t\tlet score = 0;\n\n\t\t\t\t\tfor ( let i = 0; i < params.length; i ++ ) {\n\n\t\t\t\t\t\tconst param = params[ i ];\n\t\t\t\t\t\tconst input = inputs[ i ];\n\n\t\t\t\t\t\tif ( param.getNodeType( builder ) === input.type ) {\n\n\t\t\t\t\t\t\tscore ++;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tscore = 0;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( score > candidateScore ) {\n\n\t\t\t\t\t\tcandidateFn = functionNode;\n\t\t\t\t\t\tcandidateScore = score;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis._candidateFnCall = candidateFnCall = candidateFn( ...params );\n\n\t\t}\n\n\t\treturn candidateFnCall;\n\n\t}\n\n}\n\nexport default FunctionOverloadingNode;\n\nconst overloadingBaseFn = nodeProxy( FunctionOverloadingNode );\n\nexport const overloadingFn = ( functionNodes ) => ( ...params ) => overloadingBaseFn( functionNodes, ...params );\n\naddNodeClass( 'FunctionOverloadingNode', FunctionOverloadingNode );\n","import TempNode from '../core/TempNode.js';\nimport { transformedNormalView } from '../accessors/NormalNode.js';\nimport { positionViewDirection } from '../accessors/PositionNode.js';\nimport { nodeImmutable, vec2, vec3 } from '../shadernode/ShaderNode.js';\nimport { addNodeClass } from '../core/Node.js';\n\nclass MatcapUVNode extends TempNode {\n\n\tconstructor() {\n\n\t\tsuper( 'vec2' );\n\n\t}\n\n\tsetup() {\n\n\t\tconst x = vec3( positionViewDirection.z, 0, positionViewDirection.x.negate() ).normalize();\n\t\tconst y = positionViewDirection.cross( x );\n\n\t\treturn vec2( x.dot( transformedNormalView ), y.dot( transformedNormalView ) ).mul( 0.495 ).add( 0.5 ); // 0.495 to remove artifacts caused by undersized matcap disks\n\n\t}\n\n}\n\nexport default MatcapUVNode;\n\nexport const matcapUV = nodeImmutable( MatcapUVNode );\n\naddNodeClass( 'MatcapUVNode', MatcapUVNode );\n","import UniformNode from '../core/UniformNode.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { nodeObject, nodeImmutable } from '../shadernode/ShaderNode.js';\nimport { addNodeClass } from '../core/Node.js';\n\nclass TimerNode extends UniformNode {\n\n\tconstructor( scope = TimerNode.LOCAL, scale = 1, value = 0 ) {\n\n\t\tsuper( value );\n\n\t\tthis.scope = scope;\n\t\tthis.scale = scale;\n\n\t\tthis.updateType = NodeUpdateType.FRAME;\n\n\t}\n\t/*\n\t@TODO:\n\tgetNodeType( builder ) {\n\n\t\tconst scope = this.scope;\n\n\t\tif ( scope === TimerNode.FRAME ) {\n\n\t\t\treturn 'uint';\n\n\t\t}\n\n\t\treturn 'float';\n\n\t}\n*/\n\tupdate( frame ) {\n\n\t\tconst scope = this.scope;\n\t\tconst scale = this.scale;\n\n\t\tif ( scope === TimerNode.LOCAL ) {\n\n\t\t\tthis.value += frame.deltaTime * scale;\n\n\t\t} else if ( scope === TimerNode.DELTA ) {\n\n\t\t\tthis.value = frame.deltaTime * scale;\n\n\t\t} else if ( scope === TimerNode.FRAME ) {\n\n\t\t\tthis.value = frame.frameId;\n\n\t\t} else {\n\n\t\t\t// global\n\n\t\t\tthis.value = frame.time * scale;\n\n\t\t}\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.scope = this.scope;\n\t\tdata.scale = this.scale;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.scope = data.scope;\n\t\tthis.scale = data.scale;\n\n\t}\n\n}\n\nTimerNode.LOCAL = 'local';\nTimerNode.GLOBAL = 'global';\nTimerNode.DELTA = 'delta';\nTimerNode.FRAME = 'frame';\n\nexport default TimerNode;\n\n// @TODO: add support to use node in timeScale\nexport const timerLocal = ( timeScale, value = 0 ) => nodeObject( new TimerNode( TimerNode.LOCAL, timeScale, value ) );\nexport const timerGlobal = ( timeScale, value = 0 ) => nodeObject( new TimerNode( TimerNode.GLOBAL, timeScale, value ) );\nexport const timerDelta = ( timeScale, value = 0 ) => nodeObject( new TimerNode( TimerNode.DELTA, timeScale, value ) );\nexport const frameId = nodeImmutable( TimerNode, TimerNode.FRAME ).toUint();\n\naddNodeClass( 'TimerNode', TimerNode );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { timerLocal } from './TimerNode.js';\nimport { nodeObject, nodeProxy } from '../shadernode/ShaderNode.js';\n\nclass OscNode extends Node {\n\n\tconstructor( method = OscNode.SINE, timeNode = timerLocal() ) {\n\n\t\tsuper();\n\n\t\tthis.method = method;\n\t\tthis.timeNode = timeNode;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.timeNode.getNodeType( builder );\n\n\t}\n\n\tsetup() {\n\n\t\tconst method = this.method;\n\t\tconst timeNode = nodeObject( this.timeNode );\n\n\t\tlet outputNode = null;\n\n\t\tif ( method === OscNode.SINE ) {\n\n\t\t\toutputNode = timeNode.add( 0.75 ).mul( Math.PI * 2 ).sin().mul( 0.5 ).add( 0.5 );\n\n\t\t} else if ( method === OscNode.SQUARE ) {\n\n\t\t\toutputNode = timeNode.fract().round();\n\n\t\t} else if ( method === OscNode.TRIANGLE ) {\n\n\t\t\toutputNode = timeNode.add( 0.5 ).fract().mul( 2 ).sub( 1 ).abs();\n\n\t\t} else if ( method === OscNode.SAWTOOTH ) {\n\n\t\t\toutputNode = timeNode.fract();\n\n\t\t}\n\n\t\treturn outputNode;\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.method = this.method;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.method = data.method;\n\n\t}\n\n}\n\nOscNode.SINE = 'sine';\nOscNode.SQUARE = 'square';\nOscNode.TRIANGLE = 'triangle';\nOscNode.SAWTOOTH = 'sawtooth';\n\nexport default OscNode;\n\nexport const oscSine = nodeProxy( OscNode, OscNode.SINE );\nexport const oscSquare = nodeProxy( OscNode, OscNode.SQUARE );\nexport const oscTriangle = nodeProxy( OscNode, OscNode.TRIANGLE );\nexport const oscSawtooth = nodeProxy( OscNode, OscNode.SAWTOOTH );\n\naddNodeClass( 'OscNode', OscNode );\n","import TempNode from '../core/TempNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { addNodeElement, nodeProxy } from '../shadernode/ShaderNode.js';\n\nclass PackingNode extends TempNode {\n\n\tconstructor( scope, node ) {\n\n\t\tsuper();\n\n\t\tthis.scope = scope;\n\t\tthis.node = node;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.node.getNodeType( builder );\n\n\t}\n\n\tsetup() {\n\n\t\tconst { scope, node } = this;\n\n\t\tlet result = null;\n\n\t\tif ( scope === PackingNode.DIRECTION_TO_COLOR ) {\n\n\t\t\tresult = node.mul( 0.5 ).add( 0.5 );\n\n\t\t} else if ( scope === PackingNode.COLOR_TO_DIRECTION ) {\n\n\t\t\tresult = node.mul( 2.0 ).sub( 1 );\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\nPackingNode.DIRECTION_TO_COLOR = 'directionToColor';\nPackingNode.COLOR_TO_DIRECTION = 'colorToDirection';\n\nexport default PackingNode;\n\nexport const directionToColor = nodeProxy( PackingNode, PackingNode.DIRECTION_TO_COLOR );\nexport const colorToDirection = nodeProxy( PackingNode, PackingNode.COLOR_TO_DIRECTION );\n\naddNodeElement( 'directionToColor', directionToColor );\naddNodeElement( 'colorToDirection', colorToDirection );\n\naddNodeClass( 'PackingNode', PackingNode );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { float, addNodeElement, nodeProxy } from '../shadernode/ShaderNode.js';\n\nclass RemapNode extends Node {\n\n\tconstructor( node, inLowNode, inHighNode, outLowNode = float( 0 ), outHighNode = float( 1 ) ) {\n\n\t\tsuper();\n\n\t\tthis.node = node;\n\t\tthis.inLowNode = inLowNode;\n\t\tthis.inHighNode = inHighNode;\n\t\tthis.outLowNode = outLowNode;\n\t\tthis.outHighNode = outHighNode;\n\n\t\tthis.doClamp = true;\n\n\t}\n\n\tsetup() {\n\n\t\tconst { node, inLowNode, inHighNode, outLowNode, outHighNode, doClamp } = this;\n\n\t\tlet t = node.sub( inLowNode ).div( inHighNode.sub( inLowNode ) );\n\n\t\tif ( doClamp === true ) t = t.clamp();\n\n\t\treturn t.mul( outHighNode.sub( outLowNode ) ).add( outLowNode );\n\n\t}\n\n}\n\nexport default RemapNode;\n\nexport const remap = nodeProxy( RemapNode, null, null, { doClamp: false } );\nexport const remapClamp = nodeProxy( RemapNode );\n\naddNodeElement( 'remap', remap );\naddNodeElement( 'remapClamp', remapClamp );\n\naddNodeClass( 'RemapNode', RemapNode );\n","import TempNode from '../core/TempNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { addNodeElement, nodeProxy, vec2 } from '../shadernode/ShaderNode.js';\n\nclass RotateUVNode extends TempNode {\n\n\tconstructor( uvNode, rotationNode, centerNode = vec2( 0.5 ) ) {\n\n\t\tsuper( 'vec2' );\n\n\t\tthis.uvNode = uvNode;\n\t\tthis.rotationNode = rotationNode;\n\t\tthis.centerNode = centerNode;\n\n\t}\n\n\tsetup() {\n\n\t\tconst { uvNode, rotationNode, centerNode } = this;\n\n\t\tconst vector = uvNode.sub( centerNode );\n\n\t\treturn vector.rotate( rotationNode ).add( centerNode );\n\n\t}\n\n}\n\nexport default RotateUVNode;\n\nexport const rotateUV = nodeProxy( RotateUVNode );\n\naddNodeElement( 'rotateUV', rotateUV );\n\naddNodeClass( 'RotateUVNode', RotateUVNode );\n","import TempNode from '../core/TempNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport {\n\taddNodeElement,\n\tnodeProxy,\n\tvec4,\n\tmat2,\n\tmat4,\n} from '../shadernode/ShaderNode.js';\nimport { cos, sin } from '../math/MathNode.js';\n\nclass RotateNode extends TempNode {\n\n\tconstructor( positionNode, rotationNode ) {\n\n\t\tsuper();\n\n\t\tthis.positionNode = positionNode;\n\t\tthis.rotationNode = rotationNode;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.positionNode.getNodeType( builder );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst { rotationNode, positionNode } = this;\n\n\t\tconst nodeType = this.getNodeType( builder );\n\n\t\tif ( nodeType === 'vec2' ) {\n\n\t\t\tconst cosAngle = rotationNode.cos();\n\t\t\tconst sinAngle = rotationNode.sin();\n\n\t\t\tconst rotationMatrix = mat2(\n\t\t\t\tcosAngle, sinAngle,\n\t\t\t\tsinAngle.negate(), cosAngle\n\t\t\t);\n\n\t\t\treturn rotationMatrix.mul( positionNode );\n\n\t\t} else {\n\n\t\t\tconst rotation = rotationNode;\n\t\t\tconst rotationXMatrix = mat4( vec4( 1.0, 0.0, 0.0, 0.0 ), vec4( 0.0, cos( rotation.x ), sin( rotation.x ).negate(), 0.0 ), vec4( 0.0, sin( rotation.x ), cos( rotation.x ), 0.0 ), vec4( 0.0, 0.0, 0.0, 1.0 ) );\n\t\t\tconst rotationYMatrix = mat4( vec4( cos( rotation.y ), 0.0, sin( rotation.y ), 0.0 ), vec4( 0.0, 1.0, 0.0, 0.0 ), vec4( sin( rotation.y ).negate(), 0.0, cos( rotation.y ), 0.0 ), vec4( 0.0, 0.0, 0.0, 1.0 ) );\n\t\t\tconst rotationZMatrix = mat4( vec4( cos( rotation.z ), sin( rotation.z ).negate(), 0.0, 0.0 ), vec4( sin( rotation.z ), cos( rotation.z ), 0.0, 0.0 ), vec4( 0.0, 0.0, 1.0, 0.0 ), vec4( 0.0, 0.0, 0.0, 1.0 ) );\n\n\t\t\treturn rotationXMatrix.mul( rotationYMatrix ).mul( rotationZMatrix ).mul( vec4( positionNode, 1.0 ) ).xyz;\n\n\t\t}\n\n\t}\n\n}\n\nexport default RotateNode;\n\nexport const rotate = nodeProxy( RotateNode );\n\naddNodeElement( 'rotate', rotate );\n\naddNodeClass( 'RotateNode', RotateNode );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { uv } from '../accessors/UVNode.js';\nimport { nodeProxy, float, vec2 } from '../shadernode/ShaderNode.js';\n\nclass SpriteSheetUVNode extends Node {\n\n\tconstructor( countNode, uvNode = uv(), frameNode = float( 0 ) ) {\n\n\t\tsuper( 'vec2' );\n\n\t\tthis.countNode = countNode;\n\t\tthis.uvNode = uvNode;\n\t\tthis.frameNode = frameNode;\n\n\t}\n\n\tsetup() {\n\n\t\tconst { frameNode, uvNode, countNode } = this;\n\n\t\tconst { width, height } = countNode;\n\n\t\tconst frameNum = frameNode.mod( width.mul( height ) ).floor();\n\n\t\tconst column = frameNum.mod( width );\n\t\tconst row = height.sub( frameNum.add( 1 ).div( width ).ceil() );\n\n\t\tconst scale = countNode.reciprocal();\n\t\tconst uvFrameOffset = vec2( column, row );\n\n\t\treturn uvNode.add( uvFrameOffset ).mul( scale );\n\n\t}\n\n}\n\nexport default SpriteSheetUVNode;\n\nexport const spritesheetUV = nodeProxy( SpriteSheetUVNode );\n\naddNodeClass( 'SpriteSheetUVNode', SpriteSheetUVNode );\n","import { addNodeClass } from '../core/Node.js';\nimport { nodeProxy, addNodeElement } from '../shadernode/ShaderNode.js';\nimport ArrayElementNode from './ArrayElementNode.js';\n\nclass StorageArrayElementNode extends ArrayElementNode {\n\n\tconstructor( storageBufferNode, indexNode ) {\n\n\t\tsuper( storageBufferNode, indexNode );\n\n\t\tthis.isStorageArrayElementNode = true;\n\n\t}\n\n\tset storageBufferNode( value ) {\n\n\t\tthis.node = value;\n\n\t}\n\n\tget storageBufferNode() {\n\n\t\treturn this.node;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tif ( builder.isAvailable( 'storageBuffer' ) === false ) {\n\n\t\t\tif ( ! this.node.instanceIndex && this.node.bufferObject === true ) {\n\n\t\t\t\tbuilder.setupPBO( this.node );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn super.setup( builder );\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tlet snippet;\n\n\t\tconst isAssignContext = builder.context.assign;\n\n\t\t//\n\n\t\tif ( builder.isAvailable( 'storageBuffer' ) === false ) {\n\n\t\t\tconst { node } = this;\n\n\t\t\tif ( ! node.instanceIndex && this.node.bufferObject === true && isAssignContext !== true ) {\n\n\t\t\t\tsnippet = builder.generatePBO( this );\n\n\t\t\t} else {\n\n\t\t\t\tsnippet = node.build( builder );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tsnippet = super.generate( builder );\n\n\t\t}\n\n\t\tif ( isAssignContext !== true ) {\n\n\t\t\tconst type = this.getNodeType( builder );\n\n\t\t\tsnippet = builder.format( snippet, type, output );\n\n\t\t}\n\n\t\treturn snippet;\n\n\t}\n\n}\n\nexport default StorageArrayElementNode;\n\nexport const storageElement = nodeProxy( StorageArrayElementNode );\n\naddNodeElement( 'storageElement', storageElement );\n\naddNodeClass( 'StorageArrayElementNode', StorageArrayElementNode );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { add } from '../math/OperatorNode.js';\nimport { normalLocal } from '../accessors/NormalNode.js';\nimport { positionLocal } from '../accessors/PositionNode.js';\nimport { texture } from '../accessors/TextureNode.js';\nimport { addNodeElement, nodeProxy, float, vec3 } from '../shadernode/ShaderNode.js';\n\nclass TriplanarTexturesNode extends Node {\n\n\tconstructor( textureXNode, textureYNode = null, textureZNode = null, scaleNode = float( 1 ), positionNode = positionLocal, normalNode = normalLocal ) {\n\n\t\tsuper( 'vec4' );\n\n\t\tthis.textureXNode = textureXNode;\n\t\tthis.textureYNode = textureYNode;\n\t\tthis.textureZNode = textureZNode;\n\n\t\tthis.scaleNode = scaleNode;\n\n\t\tthis.positionNode = positionNode;\n\t\tthis.normalNode = normalNode;\n\n\t}\n\n\tsetup() {\n\n\t\tconst { textureXNode, textureYNode, textureZNode, scaleNode, positionNode, normalNode } = this;\n\n\t\t// Ref: https://github.com/keijiro/StandardTriplanar\n\n\t\t// Blending factor of triplanar mapping\n\t\tlet bf = normalNode.abs().normalize();\n\t\tbf = bf.div( bf.dot( vec3( 1.0 ) ) );\n\n\t\t// Triplanar mapping\n\t\tconst tx = positionNode.yz.mul( scaleNode );\n\t\tconst ty = positionNode.zx.mul( scaleNode );\n\t\tconst tz = positionNode.xy.mul( scaleNode );\n\n\t\t// Base color\n\t\tconst textureX = textureXNode.value;\n\t\tconst textureY = textureYNode !== null ? textureYNode.value : textureX;\n\t\tconst textureZ = textureZNode !== null ? textureZNode.value : textureX;\n\n\t\tconst cx = texture( textureX, tx ).mul( bf.x );\n\t\tconst cy = texture( textureY, ty ).mul( bf.y );\n\t\tconst cz = texture( textureZ, tz ).mul( bf.z );\n\n\t\treturn add( cx, cy, cz );\n\n\t}\n\n}\n\nexport default TriplanarTexturesNode;\n\nexport const triplanarTextures = nodeProxy( TriplanarTexturesNode );\nexport const triplanarTexture = ( ...params ) => triplanarTextures( ...params );\n\naddNodeElement( 'triplanarTexture', triplanarTexture );\n\naddNodeClass( 'TriplanarTexturesNode', TriplanarTexturesNode );\n","import TextureNode from '../accessors/TextureNode.js';\nimport { nodeObject, vec2 } from '../shadernode/ShaderNode.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { viewportTopLeft } from '../display/ViewportNode.js';\nimport { Matrix4, Vector2, Vector3, Vector4, Object3D, Plane, RenderTarget, HalfFloatType, LinearMipMapLinearFilter } from 'three';\n\nconst _reflectorPlane = new Plane();\nconst _normal = new Vector3();\nconst _reflectorWorldPosition = new Vector3();\nconst _cameraWorldPosition = new Vector3();\nconst _rotationMatrix = new Matrix4();\nconst _lookAtPosition = new Vector3( 0, 0, - 1 );\nconst clipPlane = new Vector4();\n\nconst _view = new Vector3();\nconst _target = new Vector3();\nconst _q = new Vector4();\n\nconst _size = new Vector2();\n\nconst _defaultRT = new RenderTarget();\nconst _defaultUV = vec2( viewportTopLeft.x.oneMinus(), viewportTopLeft.y );\n\nlet _inReflector = false;\n\nclass ReflectorNode extends TextureNode {\n\n\tconstructor( parameters = {} ) {\n\n\t\tsuper( _defaultRT.texture, _defaultUV );\n\n\t\tconst {\n\t\t\ttarget = new Object3D(),\n\t\t\tresolution = 1,\n\t\t\tgenerateMipmaps = false,\n\t\t\tbounces = true\n\t\t} = parameters;\n\n\t\t//\n\n\t\tthis.target = target;\n\t\tthis.resolution = resolution;\n\t\tthis.generateMipmaps = generateMipmaps;\n\t\tthis.bounces = bounces;\n\n\t\tthis.updateBeforeType = bounces ? NodeUpdateType.RENDER : NodeUpdateType.FRAME;\n\n\t\tthis.virtualCameras = new WeakMap();\n\t\tthis.renderTargets = new WeakMap();\n\n\n\t}\n\n\t_updateResolution( renderTarget, renderer ) {\n\n\t\tconst resolution = this.resolution;\n\n\t\trenderer.getDrawingBufferSize( _size );\n\n\t\trenderTarget.setSize( Math.round( _size.width * resolution ), Math.round( _size.height * resolution ) );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tthis._updateResolution( _defaultRT, builder.renderer );\n\n\t\treturn super.setup( builder );\n\n\t}\n\n\tgetTextureNode() {\n\n\t\treturn this.textureNode;\n\n\t}\n\n\tgetVirtualCamera( camera ) {\n\n\t\tlet virtualCamera = this.virtualCameras.get( camera );\n\n\t\tif ( virtualCamera === undefined ) {\n\n\t\t\tvirtualCamera = camera.clone();\n\n\t\t\tthis.virtualCameras.set( camera, virtualCamera );\n\n\t\t}\n\n\t\treturn virtualCamera;\n\n\t}\n\n\tgetRenderTarget( camera ) {\n\n\t\tlet renderTarget = this.renderTargets.get( camera );\n\n\t\tif ( renderTarget === undefined ) {\n\n\t\t\trenderTarget = new RenderTarget( 0, 0, { type: HalfFloatType } );\n\n\t\t\tif ( this.generateMipmaps === true ) {\n\n\t\t\t    renderTarget.texture.minFilter = LinearMipMapLinearFilter;\n\t\t\t    renderTarget.texture.generateMipmaps = true;\n\n\t\t\t}\n\n\t\t\tthis.renderTargets.set( camera, renderTarget );\n\n\t\t}\n\n\t\treturn renderTarget;\n\n\t}\n\n\tupdateBefore( frame ) {\n\n\t\tif ( this.bounces === false && _inReflector ) return false;\n\n\t\t_inReflector = true;\n\n\t\tconst { scene, camera, renderer, material } = frame;\n\t\tconst { target } = this;\n\n\t\tconst virtualCamera = this.getVirtualCamera( camera );\n\t\tconst renderTarget = this.getRenderTarget( virtualCamera );\n\n\t\trenderer.getDrawingBufferSize( _size );\n\n\t\tthis._updateResolution( renderTarget, renderer );\n\n\t\t//\n\n\t\t_reflectorWorldPosition.setFromMatrixPosition( target.matrixWorld );\n\t\t_cameraWorldPosition.setFromMatrixPosition( camera.matrixWorld );\n\n\t\t_rotationMatrix.extractRotation( target.matrixWorld );\n\n\t\t_normal.set( 0, 0, 1 );\n\t\t_normal.applyMatrix4( _rotationMatrix );\n\n\t\t_view.subVectors( _reflectorWorldPosition, _cameraWorldPosition );\n\n\t\t// Avoid rendering when reflector is facing away\n\n\t\tif ( _view.dot( _normal ) > 0 ) return;\n\n\t\t_view.reflect( _normal ).negate();\n\t\t_view.add( _reflectorWorldPosition );\n\n\t\t_rotationMatrix.extractRotation( camera.matrixWorld );\n\n\t\t_lookAtPosition.set( 0, 0, - 1 );\n\t\t_lookAtPosition.applyMatrix4( _rotationMatrix );\n\t\t_lookAtPosition.add( _cameraWorldPosition );\n\n\t\t_target.subVectors( _reflectorWorldPosition, _lookAtPosition );\n\t\t_target.reflect( _normal ).negate();\n\t\t_target.add( _reflectorWorldPosition );\n\n\t\t//\n\n\t\tvirtualCamera.coordinateSystem = camera.coordinateSystem;\n\t\tvirtualCamera.position.copy( _view );\n\t\tvirtualCamera.up.set( 0, 1, 0 );\n\t\tvirtualCamera.up.applyMatrix4( _rotationMatrix );\n\t\tvirtualCamera.up.reflect( _normal );\n\t\tvirtualCamera.lookAt( _target );\n\n\t\tvirtualCamera.near = camera.near;\n\t\tvirtualCamera.far = camera.far;\n\n\t\tvirtualCamera.updateMatrixWorld();\n\t\tvirtualCamera.projectionMatrix.copy( camera.projectionMatrix );\n\n\t\t// Now update projection matrix with new clip plane, implementing code from: http://www.terathon.com/code/oblique.html\n\t\t// Paper explaining this technique: http://www.terathon.com/lengyel/Lengyel-Oblique.pdf\n\t\t_reflectorPlane.setFromNormalAndCoplanarPoint( _normal, _reflectorWorldPosition );\n\t\t_reflectorPlane.applyMatrix4( virtualCamera.matrixWorldInverse );\n\n\t\tclipPlane.set( _reflectorPlane.normal.x, _reflectorPlane.normal.y, _reflectorPlane.normal.z, _reflectorPlane.constant );\n\n\t\tconst projectionMatrix = virtualCamera.projectionMatrix;\n\n\t\t_q.x = ( Math.sign( clipPlane.x ) + projectionMatrix.elements[ 8 ] ) / projectionMatrix.elements[ 0 ];\n\t\t_q.y = ( Math.sign( clipPlane.y ) + projectionMatrix.elements[ 9 ] ) / projectionMatrix.elements[ 5 ];\n\t\t_q.z = - 1.0;\n\t\t_q.w = ( 1.0 + projectionMatrix.elements[ 10 ] ) / projectionMatrix.elements[ 14 ];\n\n\t\t// Calculate the scaled plane vector\n\t\tclipPlane.multiplyScalar( 1.0 / clipPlane.dot( _q ) );\n\n\t\tconst clipBias = 0;\n\n\t\t// Replacing the third row of the projection matrix\n\t\tprojectionMatrix.elements[ 2 ] = clipPlane.x;\n\t\tprojectionMatrix.elements[ 6 ] = clipPlane.y;\n\t\tprojectionMatrix.elements[ 10 ] = clipPlane.z - clipBias;\n\t\tprojectionMatrix.elements[ 14 ] = clipPlane.w;\n\n\t\t//\n\n\t\tthis.value = renderTarget.texture;\n\n\t\tmaterial.visible = false;\n\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\n\t\trenderer.setRenderTarget( renderTarget );\n\n\t\trenderer.render( scene, virtualCamera );\n\n\t\trenderer.setRenderTarget( currentRenderTarget );\n\n\t\tmaterial.visible = true;\n\n\t\t_inReflector = false;\n\n\t}\n\n}\n\nexport const reflector = ( parameters ) => nodeObject( new ReflectorNode( parameters ) );\n\nexport default ReflectorNode;\n\n","import { addNodeClass } from '../core/Node.js';\nimport AttributeNode from '../core/AttributeNode.js';\nimport { nodeObject } from '../shadernode/ShaderNode.js';\nimport { Vector4 } from 'three';\n\nclass VertexColorNode extends AttributeNode {\n\n\tconstructor( index = 0 ) {\n\n\t\tsuper( null, 'vec4' );\n\n\t\tthis.isVertexColorNode = true;\n\n\t\tthis.index = index;\n\n\t}\n\n\tgetAttributeName( /*builder*/ ) {\n\n\t\tconst index = this.index;\n\n\t\treturn 'color' + ( index > 0 ? index : '' );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst attributeName = this.getAttributeName( builder );\n\t\tconst geometryAttribute = builder.hasGeometryAttribute( attributeName );\n\n\t\tlet result;\n\n\t\tif ( geometryAttribute === true ) {\n\n\t\t\tresult = super.generate( builder );\n\n\t\t} else {\n\n\t\t\t// Vertex color fallback should be white\n\t\t\tresult = builder.generateConst( this.nodeType, new Vector4( 1, 1, 1, 1 ) );\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.index = this.index;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.index = data.index;\n\n\t}\n\n}\n\nexport default VertexColorNode;\n\nexport const vertexColor = ( ...params ) => nodeObject( new VertexColorNode( ...params ) );\n\naddNodeClass( 'VertexColorNode', VertexColorNode );\n","import ReferenceNode from './ReferenceNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { nodeObject } from '../shadernode/ShaderNode.js';\n\nclass RendererReferenceNode extends ReferenceNode {\n\n\tconstructor( property, inputType, renderer = null ) {\n\n\t\tsuper( property, inputType, renderer );\n\n\t\tthis.renderer = renderer;\n\n\t}\n\n\tupdateReference( state ) {\n\n\t\tthis.reference = this.renderer !== null ? this.renderer : state.renderer;\n\n\t\treturn this.reference;\n\n\t}\n\n}\n\nexport default RendererReferenceNode;\n\nexport const rendererReference = ( name, type, renderer ) => nodeObject( new RendererReferenceNode( name, type, renderer ) );\n\naddNodeClass( 'RendererReferenceNode', RendererReferenceNode );\n","import TempNode from '../core/TempNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { add, mul, div } from '../math/OperatorNode.js';\nimport { floor, ceil, fract, pow } from '../math/MathNode.js';\nimport { nodeProxy, addNodeElement, float, vec2, vec4, int } from '../shadernode/ShaderNode.js';\n\n// Mipped Bicubic Texture Filtering by N8\n// https://www.shadertoy.com/view/Dl2SDW\n\nconst bC = 1.0 / 6.0;\n\nconst w0 = ( a ) => mul( bC, mul( a, mul( a, a.negate().add( 3.0 ) ).sub( 3.0 ) ).add( 1.0 ) );\n\nconst w1 = ( a ) => mul( bC, mul( a, mul( a, mul( 3.0, a ).sub( 6.0 ) ) ).add( 4.0 ) );\n\nconst w2 = ( a ) => mul( bC, mul( a, mul( a, mul( - 3.0, a ).add( 3.0 ) ).add( 3.0 ) ).add( 1.0 ) );\n\nconst w3 = ( a ) => mul( bC, pow( a, 3 ) );\n\nconst g0 = ( a ) => w0( a ).add( w1( a ) );\n\nconst g1 = ( a ) => w2( a ).add( w3( a ) );\n\n// h0 and h1 are the two offset functions\nconst h0 = ( a ) => add( - 1.0, w1( a ).div( w0( a ).add( w1( a ) ) ) );\n\nconst h1 = ( a ) => add( 1.0, w3( a ).div( w2( a ).add( w3( a ) ) ) );\n\nconst bicubic = ( textureNode, texelSize, lod ) => {\n\n\tconst uv = textureNode.uvNode;\n\tconst uvScaled = mul( uv, texelSize.zw ).add( 0.5 );\n\n\tconst iuv = floor( uvScaled );\n\tconst fuv = fract( uvScaled );\n\n\tconst g0x = g0( fuv.x );\n\tconst g1x = g1( fuv.x );\n\tconst h0x = h0( fuv.x );\n\tconst h1x = h1( fuv.x );\n\tconst h0y = h0( fuv.y );\n\tconst h1y = h1( fuv.y );\n\n\tconst p0 = vec2( iuv.x.add( h0x ), iuv.y.add( h0y ) ).sub( 0.5 ).mul( texelSize.xy );\n\tconst p1 = vec2( iuv.x.add( h1x ), iuv.y.add( h0y ) ).sub( 0.5 ).mul( texelSize.xy );\n\tconst p2 = vec2( iuv.x.add( h0x ), iuv.y.add( h1y ) ).sub( 0.5 ).mul( texelSize.xy );\n\tconst p3 = vec2( iuv.x.add( h1x ), iuv.y.add( h1y ) ).sub( 0.5 ).mul( texelSize.xy );\n\n\tconst a = g0( fuv.y ).mul( add( g0x.mul( textureNode.uv( p0 ).level( lod ) ), g1x.mul( textureNode.uv( p1 ).level( lod ) ) ) );\n\tconst b = g1( fuv.y ).mul( add( g0x.mul( textureNode.uv( p2 ).level( lod ) ), g1x.mul( textureNode.uv( p3 ).level( lod ) ) ) );\n\n\treturn a.add( b );\n\n};\n\nconst textureBicubicMethod = ( textureNode, lodNode ) => {\n\n\tconst fLodSize = vec2( textureNode.size( int( lodNode ) ) );\n\tconst cLodSize = vec2( textureNode.size( int( lodNode.add( 1.0 ) ) ) );\n\tconst fLodSizeInv = div( 1.0, fLodSize );\n\tconst cLodSizeInv = div( 1.0, cLodSize );\n\tconst fSample = bicubic( textureNode, vec4( fLodSizeInv, fLodSize ), floor( lodNode ) );\n\tconst cSample = bicubic( textureNode, vec4( cLodSizeInv, cLodSize ), ceil( lodNode ) );\n\n\treturn fract( lodNode ).mix( fSample, cSample );\n\n};\n\nclass TextureBicubicNode extends TempNode {\n\n\tconstructor( textureNode, blurNode = float( 3 ) ) {\n\n\t\tsuper( 'vec4' );\n\n\t\tthis.textureNode = textureNode;\n\t\tthis.blurNode = blurNode;\n\n\t}\n\n\tsetup() {\n\n\t\treturn textureBicubicMethod( this.textureNode, this.blurNode );\n\n\t}\n\n}\n\nexport default TextureBicubicNode;\n\nexport const textureBicubic = nodeProxy( TextureBicubicNode );\n\naddNodeElement( 'bicubic', textureBicubic );\n\naddNodeClass( 'TextureBicubicNode', TextureBicubicNode );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { nodeImmutable } from '../shadernode/ShaderNode.js';\n\nclass PointUVNode extends Node {\n\n\tconstructor() {\n\n\t\tsuper( 'vec2' );\n\n\t\tthis.isPointUVNode = true;\n\n\t}\n\n\tgenerate( /*builder*/ ) {\n\n\t\treturn 'vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y )';\n\n\t}\n\n}\n\nexport default PointUVNode;\n\nexport const pointUV = nodeImmutable( PointUVNode );\n\naddNodeClass( 'PointUVNode', PointUVNode );\n","import Node from '../core/Node.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { nodeImmutable } from '../shadernode/ShaderNode.js';\nimport { reference } from './ReferenceNode.js';\n\nclass SceneNode extends Node {\n\n\tconstructor( scope = SceneNode.BACKGROUND_BLURRINESS, scene = null ) {\n\n\t\tsuper();\n\n\t\tthis.scope = scope;\n\t\tthis.scene = scene;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst scope = this.scope;\n\t\tconst scene = this.scene !== null ? this.scene : builder.scene;\n\n\t\tlet output;\n\n\t\tif ( scope === SceneNode.BACKGROUND_BLURRINESS ) {\n\n\t\t\toutput = reference( 'backgroundBlurriness', 'float', scene );\n\n\t\t} else if ( scope === SceneNode.BACKGROUND_INTENSITY ) {\n\n\t\t\toutput = reference( 'backgroundIntensity', 'float', scene );\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.SceneNode: Unknown scope:', scope );\n\n\t\t}\n\n\t\treturn output;\n\n\t}\n\n}\n\nSceneNode.BACKGROUND_BLURRINESS = 'backgroundBlurriness';\nSceneNode.BACKGROUND_INTENSITY = 'backgroundIntensity';\n\nexport default SceneNode;\n\nexport const backgroundBlurriness = nodeImmutable( SceneNode, SceneNode.BACKGROUND_BLURRINESS );\nexport const backgroundIntensity = nodeImmutable( SceneNode, SceneNode.BACKGROUND_INTENSITY );\n\naddNodeClass( 'SceneNode', SceneNode );\n","export const GPUPrimitiveTopology = {\n\tPointList: 'point-list',\n\tLineList: 'line-list',\n\tLineStrip: 'line-strip',\n\tTriangleList: 'triangle-list',\n\tTriangleStrip: 'triangle-strip',\n};\n\nexport const GPUCompareFunction = {\n\tNever: 'never',\n\tLess: 'less',\n\tEqual: 'equal',\n\tLessEqual: 'less-equal',\n\tGreater: 'greater',\n\tNotEqual: 'not-equal',\n\tGreaterEqual: 'greater-equal',\n\tAlways: 'always'\n};\n\nexport const GPUStoreOp = {\n\tStore: 'store',\n\tDiscard: 'discard'\n};\n\nexport const GPULoadOp = {\n\tLoad: 'load',\n\tClear: 'clear'\n};\n\nexport const GPUFrontFace = {\n\tCCW: 'ccw',\n\tCW: 'cw'\n};\n\nexport const GPUCullMode = {\n\tNone: 'none',\n\tFront: 'front',\n\tBack: 'back'\n};\n\nexport const GPUIndexFormat = {\n\tUint16: 'uint16',\n\tUint32: 'uint32'\n};\n\nexport const GPUVertexFormat = {\n\tUint8x2: 'uint8x2',\n\tUint8x4: 'uint8x4',\n\tSint8x2: 'sint8x2',\n\tSint8x4: 'sint8x4',\n\tUnorm8x2: 'unorm8x2',\n\tUnorm8x4: 'unorm8x4',\n\tSnorm8x2: 'snorm8x2',\n\tSnorm8x4: 'snorm8x4',\n\tUint16x2: 'uint16x2',\n\tUint16x4: 'uint16x4',\n\tSint16x2: 'sint16x2',\n\tSint16x4: 'sint16x4',\n\tUnorm16x2: 'unorm16x2',\n\tUnorm16x4: 'unorm16x4',\n\tSnorm16x2: 'snorm16x2',\n\tSnorm16x4: 'snorm16x4',\n\tFloat16x2: 'float16x2',\n\tFloat16x4: 'float16x4',\n\tFloat32: 'float32',\n\tFloat32x2: 'float32x2',\n\tFloat32x3: 'float32x3',\n\tFloat32x4: 'float32x4',\n\tUint32: 'uint32',\n\tUint32x2: 'uint32x2',\n\tUint32x3: 'uint32x3',\n\tUint32x4: 'uint32x4',\n\tSint32: 'sint32',\n\tSint32x2: 'sint32x2',\n\tSint32x3: 'sint32x3',\n\tSint32x4: 'sint32x4'\n};\n\nexport const GPUTextureFormat = {\n\n\t// 8-bit formats\n\n\tR8Unorm: 'r8unorm',\n\tR8Snorm: 'r8snorm',\n\tR8Uint: 'r8uint',\n\tR8Sint: 'r8sint',\n\n\t// 16-bit formats\n\n\tR16Uint: 'r16uint',\n\tR16Sint: 'r16sint',\n\tR16Float: 'r16float',\n\tRG8Unorm: 'rg8unorm',\n\tRG8Snorm: 'rg8snorm',\n\tRG8Uint: 'rg8uint',\n\tRG8Sint: 'rg8sint',\n\n\t// 32-bit formats\n\n\tR32Uint: 'r32uint',\n\tR32Sint: 'r32sint',\n\tR32Float: 'r32float',\n\tRG16Uint: 'rg16uint',\n\tRG16Sint: 'rg16sint',\n\tRG16Float: 'rg16float',\n\tRGBA8Unorm: 'rgba8unorm',\n\tRGBA8UnormSRGB: 'rgba8unorm-srgb',\n\tRGBA8Snorm: 'rgba8snorm',\n\tRGBA8Uint: 'rgba8uint',\n\tRGBA8Sint: 'rgba8sint',\n\tBGRA8Unorm: 'bgra8unorm',\n\tBGRA8UnormSRGB: 'bgra8unorm-srgb',\n\t// Packed 32-bit formats\n\tRGB9E5UFloat: 'rgb9e5ufloat',\n\tRGB10A2Unorm: 'rgb10a2unorm',\n\tRG11B10uFloat: 'rgb10a2unorm',\n\n\t// 64-bit formats\n\n\tRG32Uint: 'rg32uint',\n\tRG32Sint: 'rg32sint',\n\tRG32Float: 'rg32float',\n\tRGBA16Uint: 'rgba16uint',\n\tRGBA16Sint: 'rgba16sint',\n\tRGBA16Float: 'rgba16float',\n\n\t// 128-bit formats\n\n\tRGBA32Uint: 'rgba32uint',\n\tRGBA32Sint: 'rgba32sint',\n\tRGBA32Float: 'rgba32float',\n\n\t// Depth and stencil formats\n\n\tStencil8: 'stencil8',\n\tDepth16Unorm: 'depth16unorm',\n\tDepth24Plus: 'depth24plus',\n\tDepth24PlusStencil8: 'depth24plus-stencil8',\n\tDepth32Float: 'depth32float',\n\n\t// 'depth32float-stencil8' extension\n\n\tDepth32FloatStencil8: 'depth32float-stencil8',\n\n\t// BC compressed formats usable if 'texture-compression-bc' is both\n\t// supported by the device/user agent and enabled in requestDevice.\n\n\tBC1RGBAUnorm: 'bc1-rgba-unorm',\n\tBC1RGBAUnormSRGB: 'bc1-rgba-unorm-srgb',\n\tBC2RGBAUnorm: 'bc2-rgba-unorm',\n\tBC2RGBAUnormSRGB: 'bc2-rgba-unorm-srgb',\n\tBC3RGBAUnorm: 'bc3-rgba-unorm',\n\tBC3RGBAUnormSRGB: 'bc3-rgba-unorm-srgb',\n\tBC4RUnorm: 'bc4-r-unorm',\n\tBC4RSnorm: 'bc4-r-snorm',\n\tBC5RGUnorm: 'bc5-rg-unorm',\n\tBC5RGSnorm: 'bc5-rg-snorm',\n\tBC6HRGBUFloat: 'bc6h-rgb-ufloat',\n\tBC6HRGBFloat: 'bc6h-rgb-float',\n\tBC7RGBAUnorm: 'bc7-rgba-unorm',\n\tBC7RGBAUnormSRGB: 'bc7-rgba-srgb',\n\n\t// ETC2 compressed formats usable if 'texture-compression-etc2' is both\n\t// supported by the device/user agent and enabled in requestDevice.\n\n\tETC2RGB8Unorm: 'etc2-rgb8unorm',\n\tETC2RGB8UnormSRGB: 'etc2-rgb8unorm-srgb',\n\tETC2RGB8A1Unorm: 'etc2-rgb8a1unorm',\n\tETC2RGB8A1UnormSRGB: 'etc2-rgb8a1unorm-srgb',\n\tETC2RGBA8Unorm: 'etc2-rgba8unorm',\n\tETC2RGBA8UnormSRGB: 'etc2-rgba8unorm-srgb',\n\tEACR11Unorm: 'eac-r11unorm',\n\tEACR11Snorm: 'eac-r11snorm',\n\tEACRG11Unorm: 'eac-rg11unorm',\n\tEACRG11Snorm: 'eac-rg11snorm',\n\n\t// ASTC compressed formats usable if 'texture-compression-astc' is both\n\t// supported by the device/user agent and enabled in requestDevice.\n\n\tASTC4x4Unorm: 'astc-4x4-unorm',\n\tASTC4x4UnormSRGB: 'astc-4x4-unorm-srgb',\n\tASTC5x4Unorm: 'astc-5x4-unorm',\n\tASTC5x4UnormSRGB: 'astc-5x4-unorm-srgb',\n\tASTC5x5Unorm: 'astc-5x5-unorm',\n\tASTC5x5UnormSRGB: 'astc-5x5-unorm-srgb',\n\tASTC6x5Unorm: 'astc-6x5-unorm',\n\tASTC6x5UnormSRGB: 'astc-6x5-unorm-srgb',\n\tASTC6x6Unorm: 'astc-6x6-unorm',\n\tASTC6x6UnormSRGB: 'astc-6x6-unorm-srgb',\n\tASTC8x5Unorm: 'astc-8x5-unorm',\n\tASTC8x5UnormSRGB: 'astc-8x5-unorm-srgb',\n\tASTC8x6Unorm: 'astc-8x6-unorm',\n\tASTC8x6UnormSRGB: 'astc-8x6-unorm-srgb',\n\tASTC8x8Unorm: 'astc-8x8-unorm',\n\tASTC8x8UnormSRGB: 'astc-8x8-unorm-srgb',\n\tASTC10x5Unorm: 'astc-10x5-unorm',\n\tASTC10x5UnormSRGB: 'astc-10x5-unorm-srgb',\n\tASTC10x6Unorm: 'astc-10x6-unorm',\n\tASTC10x6UnormSRGB: 'astc-10x6-unorm-srgb',\n\tASTC10x8Unorm: 'astc-10x8-unorm',\n\tASTC10x8UnormSRGB: 'astc-10x8-unorm-srgb',\n\tASTC10x10Unorm: 'astc-10x10-unorm',\n\tASTC10x10UnormSRGB: 'astc-10x10-unorm-srgb',\n\tASTC12x10Unorm: 'astc-12x10-unorm',\n\tASTC12x10UnormSRGB: 'astc-12x10-unorm-srgb',\n\tASTC12x12Unorm: 'astc-12x12-unorm',\n\tASTC12x12UnormSRGB: 'astc-12x12-unorm-srgb',\n\n};\n\nexport const GPUAddressMode = {\n\tClampToEdge: 'clamp-to-edge',\n\tRepeat: 'repeat',\n\tMirrorRepeat: 'mirror-repeat'\n};\n\nexport const GPUFilterMode = {\n\tLinear: 'linear',\n\tNearest: 'nearest'\n};\n\nexport const GPUBlendFactor = {\n\tZero: 'zero',\n\tOne: 'one',\n\tSrc: 'src',\n\tOneMinusSrc: 'one-minus-src',\n\tSrcAlpha: 'src-alpha',\n\tOneMinusSrcAlpha: 'one-minus-src-alpha',\n\tDst: 'dst',\n\tOneMinusDstColor: 'one-minus-dst',\n\tDstAlpha: 'dst-alpha',\n\tOneMinusDstAlpha: 'one-minus-dst-alpha',\n\tSrcAlphaSaturated: 'src-alpha-saturated',\n\tConstant: 'constant',\n\tOneMinusConstant: 'one-minus-constant'\n};\n\nexport const GPUBlendOperation = {\n\tAdd: 'add',\n\tSubtract: 'subtract',\n\tReverseSubtract: 'reverse-subtract',\n\tMin: 'min',\n\tMax: 'max'\n};\n\nexport const GPUColorWriteFlags = {\n\tNone: 0,\n\tRed: 0x1,\n\tGreen: 0x2,\n\tBlue: 0x4,\n\tAlpha: 0x8,\n\tAll: 0xF\n};\n\nexport const GPUStencilOperation = {\n\tKeep: 'keep',\n\tZero: 'zero',\n\tReplace: 'replace',\n\tInvert: 'invert',\n\tIncrementClamp: 'increment-clamp',\n\tDecrementClamp: 'decrement-clamp',\n\tIncrementWrap: 'increment-wrap',\n\tDecrementWrap: 'decrement-wrap'\n};\n\nexport const GPUBufferBindingType = {\n\tUniform: 'uniform',\n\tStorage: 'storage',\n\tReadOnlyStorage: 'read-only-storage'\n};\n\nexport const GPUStorageTextureAccess = {\n\tWriteOnly: 'write-only',\n\tReadOnly: 'read-only',\n\tReadWrite: 'read-write',\n};\n\nexport const GPUSamplerBindingType = {\n\tFiltering: 'filtering',\n\tNonFiltering: 'non-filtering',\n\tComparison: 'comparison'\n};\n\nexport const GPUTextureSampleType = {\n\tFloat: 'float',\n\tUnfilterableFloat: 'unfilterable-float',\n\tDepth: 'depth',\n\tSInt: 'sint',\n\tUInt: 'uint'\n};\n\nexport const GPUTextureDimension = {\n\tOneD: '1d',\n\tTwoD: '2d',\n\tThreeD: '3d'\n};\n\nexport const GPUTextureViewDimension = {\n\tOneD: '1d',\n\tTwoD: '2d',\n\tTwoDArray: '2d-array',\n\tCube: 'cube',\n\tCubeArray: 'cube-array',\n\tThreeD: '3d'\n};\n\nexport const GPUTextureAspect = {\n\tAll: 'all',\n\tStencilOnly: 'stencil-only',\n\tDepthOnly: 'depth-only'\n};\n\nexport const GPUInputStepMode = {\n\tVertex: 'vertex',\n\tInstance: 'instance'\n};\n\nexport const GPUFeatureName = {\n\tDepthClipControl: 'depth-clip-control',\n\tDepth32FloatStencil8: 'depth32float-stencil8',\n\tTextureCompressionBC: 'texture-compression-bc',\n\tTextureCompressionETC2: 'texture-compression-etc2',\n\tTextureCompressionASTC: 'texture-compression-astc',\n\tTimestampQuery: 'timestamp-query',\n\tIndirectFirstInstance: 'indirect-first-instance',\n\tShaderF16: 'shader-f16',\n\tRG11B10UFloat: 'rg11b10ufloat-renderable',\n\tBGRA8UNormStorage: 'bgra8unorm-storage',\n\tFloat32Filterable: 'float32-filterable'\n};\n","import BufferNode from './BufferNode.js';\nimport { bufferAttribute } from './BufferAttributeNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { nodeObject } from '../shadernode/ShaderNode.js';\nimport { varying } from '../core/VaryingNode.js';\nimport { storageElement } from '../utils/StorageArrayElementNode.js';\nimport { GPUBufferBindingType } from '../../renderers/webgpu/utils/WebGPUConstants.js';\n\nclass StorageBufferNode extends BufferNode {\n\n\tconstructor( value, bufferType, bufferCount = 0 ) {\n\n\t\tsuper( value, bufferType, bufferCount );\n\n\t\tthis.isStorageBufferNode = true;\n\n\t\tthis.access = GPUBufferBindingType.Storage;\n\n\t\tthis.bufferObject = false;\n\t\tthis.bufferCount = bufferCount;\n\n\t\tthis._attribute = null;\n\t\tthis._varying = null;\n\n\t\tthis.global = true;\n\n\t\tif ( value.isStorageBufferAttribute !== true && value.isStorageInstancedBufferAttribute !== true ) {\n\n\t\t\t// TOOD: Improve it, possibly adding a new property to the BufferAttribute to identify it as a storage buffer read-only attribute in Renderer\n\n\t\t\tif ( value.isInstancedBufferAttribute ) value.isStorageInstancedBufferAttribute = true;\n\t\t\telse value.isStorageBufferAttribute = true;\n\n\t\t}\n\n\t}\n\n\tgetHash( builder ) {\n\n\t\tif ( this.bufferCount === 0 ) {\n\n\t\t\tlet bufferData = builder.globalCache.getData( this.value );\n\n\t\t\tif ( bufferData === undefined ) {\n\n\t\t\t\tbufferData = {\n\t\t\t\t\tnode: this\n\t\t\t\t};\n\n\t\t\t\tbuilder.globalCache.setData( this.value, bufferData );\n\n\t\t\t}\n\n\t\t\treturn bufferData.node.uuid;\n\n\t\t}\n\n\t\treturn this.uuid;\n\n\t}\n\n\tgetInputType( /*builder*/ ) {\n\n\t\treturn 'storageBuffer';\n\n\t}\n\n\telement( indexNode ) {\n\n\t\treturn storageElement( this, indexNode );\n\n\t}\n\n\tsetBufferObject( value ) {\n\n\t\tthis.bufferObject = value;\n\n\t\treturn this;\n\n\t}\n\n\tsetAccess( value ) {\n\n\t\tthis.access = value;\n\n\t\treturn this;\n\n\t}\n\n\ttoReadOnly() {\n\n\t\treturn this.setAccess( GPUBufferBindingType.ReadOnlyStorage );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tif ( builder.isAvailable( 'storageBuffer' ) ) {\n\n\t\t\treturn super.generate( builder );\n\n\t\t}\n\n\t\tconst nodeType = this.getNodeType( builder );\n\n\t\tif ( this._attribute === null ) {\n\n\t\t\tthis._attribute = bufferAttribute( this.value );\n\t\t\tthis._varying = varying( this._attribute );\n\n\t\t}\n\n\n\t\tconst output = this._varying.build( builder, nodeType );\n\n\t\tbuilder.registerTransform( output, this._attribute );\n\n\t\treturn output;\n\n\t}\n\n}\n\nexport default StorageBufferNode;\n\n// Read-Write Storage\nexport const storage = ( value, type, count ) => nodeObject( new StorageBufferNode( value, type, count ) );\nexport const storageObject = ( value, type, count ) => nodeObject( new StorageBufferNode( value, type, count ).setBufferObject( true ) );\n\naddNodeClass( 'StorageBufferNode', StorageBufferNode );\n","import { addNodeClass } from '../core/Node.js';\nimport TextureNode from './TextureNode.js';\nimport { nodeProxy } from '../shadernode/ShaderNode.js';\nimport { GPUStorageTextureAccess } from '../../renderers/webgpu/utils/WebGPUConstants.js';\n\nclass StorageTextureNode extends TextureNode {\n\n\tconstructor( value, uvNode, storeNode = null ) {\n\n\t\tsuper( value, uvNode );\n\n\t\tthis.storeNode = storeNode;\n\n\t\tthis.isStorageTextureNode = true;\n\n\t\tthis.access = GPUStorageTextureAccess.WriteOnly;\n\n\t}\n\n\tgetInputType( /*builder*/ ) {\n\n\t\treturn 'storageTexture';\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tsuper.setup( builder );\n\n\t\tconst properties = builder.getNodeProperties( this );\n\t\tproperties.storeNode = this.storeNode;\n\n\t}\n\n\tsetAccess( value ) {\n\n\t\tthis.access = value;\n\t\treturn this;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tlet snippet;\n\n\t\tif ( this.storeNode !== null ) {\n\n\t\t\tsnippet = this.generateStore( builder );\n\n\t\t} else {\n\n\t\t\tsnippet = super.generate( builder, output );\n\n\t\t}\n\n\t\treturn snippet;\n\n\t}\n\n\ttoReadOnly() {\n\n\t\treturn this.setAccess( GPUStorageTextureAccess.ReadOnly );\n\n\t}\n\n\ttoWriteOnly() {\n\n\t\treturn this.setAccess( GPUStorageTextureAccess.WriteOnly );\n\n\t}\n\n\tgenerateStore( builder ) {\n\n\t\tconst properties = builder.getNodeProperties( this );\n\n\t\tconst { uvNode, storeNode } = properties;\n\n\t\tconst textureProperty = super.generate( builder, 'property' );\n\t\tconst uvSnippet = uvNode.build( builder, 'uvec2' );\n\t\tconst storeSnippet = storeNode.build( builder, 'vec4' );\n\n\t\tconst snippet = builder.generateTextureStore( builder, textureProperty, uvSnippet, storeSnippet );\n\n\t\tbuilder.addLineFlowCode( snippet );\n\n\t}\n\n}\n\nexport default StorageTextureNode;\n\nexport const storageTexture = nodeProxy( StorageTextureNode );\n\nexport const textureStore = ( value, uvNode, storeNode ) => {\n\n\tconst node = storageTexture( value, uvNode, storeNode );\n\n\tif ( storeNode !== null ) node.append();\n\n\treturn node;\n\n};\n\naddNodeClass( 'StorageTextureNode', StorageTextureNode );\n","import TextureNode from './TextureNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { nodeProxy, vec3, tslFn, If } from '../shadernode/ShaderNode.js';\n\nconst normal = tslFn( ( { texture, uv } ) => {\n\n\tconst epsilon = 0.0001;\n\n\tconst ret = vec3().temp();\n\n\tIf( uv.x.lessThan( epsilon ), () => {\n\n\t\tret.assign( vec3( 1, 0, 0 ) );\n\n\t} ).elseif( uv.y.lessThan( epsilon ), () => {\n\n\t\tret.assign( vec3( 0, 1, 0 ) );\n\n\t} ).elseif( uv.z.lessThan( epsilon ), () => {\n\n\t\tret.assign( vec3( 0, 0, 1 ) );\n\n\t} ).elseif( uv.x.greaterThan( 1 - epsilon ), () => {\n\n\t\tret.assign( vec3( - 1, 0, 0 ) );\n\n\t} ).elseif( uv.y.greaterThan( 1 - epsilon ), () => {\n\n\t\tret.assign( vec3( 0, - 1, 0 ) );\n\n\t} ).elseif( uv.z.greaterThan( 1 - epsilon ), () => {\n\n\t\tret.assign( vec3( 0, 0, - 1 ) );\n\n\t} ).else( () => {\n\n\t\tconst step = 0.01;\n\n\t\tconst x = texture.uv( uv.add( vec3( - step, 0.0, 0.0 ) ) ).r.sub( texture.uv( uv.add( vec3( step, 0.0, 0.0 ) ) ).r );\n\t\tconst y = texture.uv( uv.add( vec3( 0.0, - step, 0.0 ) ) ).r.sub( texture.uv( uv.add( vec3( 0.0, step, 0.0 ) ) ).r );\n\t\tconst z = texture.uv( uv.add( vec3( 0.0, 0.0, - step ) ) ).r.sub( texture.uv( uv.add( vec3( 0.0, 0.0, step ) ) ).r );\n\n\t\tret.assign( vec3( x, y, z ) );\n\n\t} );\n\n\treturn ret.normalize();\n\n} );\n\n\nclass Texture3DNode extends TextureNode {\n\n\tconstructor( value, uvNode = null, levelNode = null ) {\n\n\t\tsuper( value, uvNode, levelNode );\n\n\t\tthis.isTexture3DNode = true;\n\n\t}\n\n\tgetInputType( /*builder*/ ) {\n\n\t\treturn 'texture3D';\n\n\t}\n\n\tgetDefaultUV() {\n\n\t\treturn vec3( 0.5, 0.5, 0.5 );\n\n\t}\n\n\tsetUpdateMatrix( /*updateMatrix*/ ) { } // Ignore .updateMatrix for 3d TextureNode\n\n\tsetupUV( builder, uvNode ) {\n\n\t\treturn uvNode;\n\n\t}\n\n\tgenerateUV( builder, uvNode ) {\n\n\t\treturn uvNode.build( builder, 'vec3' );\n\n\t}\n\n\tnormal( uvNode ) {\n\n\t\treturn normal( { texture: this, uv: uvNode } );\n\n\t}\n\n}\n\nexport default Texture3DNode;\n\nexport const texture3D = nodeProxy( Texture3DNode );\n\naddNodeClass( 'Texture3DNode', Texture3DNode );\n","import ReferenceNode from './ReferenceNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { nodeObject } from '../shadernode/ShaderNode.js';\n\nclass UserDataNode extends ReferenceNode {\n\n\tconstructor( property, inputType, userData = null ) {\n\n\t\tsuper( property, inputType, userData );\n\n\t\tthis.userData = userData;\n\n\t}\n\n\tupdate( frame ) {\n\n\t\tthis.reference = this.userData !== null ? this.userData : frame.object.userData;\n\n\t\tsuper.update( frame );\n\n\t}\n\n}\n\nexport default UserDataNode;\n\nexport const userData = ( name, inputType, userData ) => nodeObject( new UserDataNode( name, inputType, userData ) );\n\naddNodeClass( 'UserDataNode', UserDataNode );\n","import TempNode from '../core/TempNode.js';\nimport { /*mix, step,*/ EPSILON } from '../math/MathNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { addNodeElement, tslFn, nodeProxy, vec3 } from '../shadernode/ShaderNode.js';\n\nexport const BurnNode = tslFn( ( { base, blend } ) => {\n\n\tconst fn = ( c ) => blend[ c ].lessThan( EPSILON ).cond( blend[ c ], base[ c ].oneMinus().div( blend[ c ] ).oneMinus().max( 0 ) );\n\n\treturn vec3( fn( 'x' ), fn( 'y' ), fn( 'z' ) );\n\n} ).setLayout( {\n\tname: 'burnColor',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'base', type: 'vec3' },\n\t\t{ name: 'blend', type: 'vec3' }\n\t]\n} );\n\nexport const DodgeNode = tslFn( ( { base, blend } ) => {\n\n\tconst fn = ( c ) => blend[ c ].equal( 1.0 ).cond( blend[ c ], base[ c ].div( blend[ c ].oneMinus() ).max( 0 ) );\n\n\treturn vec3( fn( 'x' ), fn( 'y' ), fn( 'z' ) );\n\n} ).setLayout( {\n\tname: 'dodgeColor',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'base', type: 'vec3' },\n\t\t{ name: 'blend', type: 'vec3' }\n\t]\n} );\n\nexport const ScreenNode = tslFn( ( { base, blend } ) => {\n\n\tconst fn = ( c ) => base[ c ].oneMinus().mul( blend[ c ].oneMinus() ).oneMinus();\n\n\treturn vec3( fn( 'x' ), fn( 'y' ), fn( 'z' ) );\n\n} ).setLayout( {\n\tname: 'screenColor',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'base', type: 'vec3' },\n\t\t{ name: 'blend', type: 'vec3' }\n\t]\n} );\n\nexport const OverlayNode = tslFn( ( { base, blend } ) => {\n\n\tconst fn = ( c ) => base[ c ].lessThan( 0.5 ).cond( base[ c ].mul( blend[ c ], 2.0 ), base[ c ].oneMinus().mul( blend[ c ].oneMinus() ).oneMinus() );\n\t//const fn = ( c ) => mix( base[ c ].oneMinus().mul( blend[ c ].oneMinus() ).oneMinus(), base[ c ].mul( blend[ c ], 2.0 ), step( base[ c ], 0.5 ) );\n\n\treturn vec3( fn( 'x' ), fn( 'y' ), fn( 'z' ) );\n\n} ).setLayout( {\n\tname: 'overlayColor',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'base', type: 'vec3' },\n\t\t{ name: 'blend', type: 'vec3' }\n\t]\n} );\n\nclass BlendModeNode extends TempNode {\n\n\tconstructor( blendMode, baseNode, blendNode ) {\n\n\t\tsuper();\n\n\t\tthis.blendMode = blendMode;\n\n\t\tthis.baseNode = baseNode;\n\t\tthis.blendNode = blendNode;\n\n\t}\n\n\tsetup() {\n\n\t\tconst { blendMode, baseNode, blendNode } = this;\n\t\tconst params = { base: baseNode, blend: blendNode };\n\n\t\tlet outputNode = null;\n\n\t\tif ( blendMode === BlendModeNode.BURN ) {\n\n\t\t\toutputNode = BurnNode( params );\n\n\t\t} else if ( blendMode === BlendModeNode.DODGE ) {\n\n\t\t\toutputNode = DodgeNode( params );\n\n\t\t} else if ( blendMode === BlendModeNode.SCREEN ) {\n\n\t\t\toutputNode = ScreenNode( params );\n\n\t\t} else if ( blendMode === BlendModeNode.OVERLAY ) {\n\n\t\t\toutputNode = OverlayNode( params );\n\n\t\t}\n\n\t\treturn outputNode;\n\n\t}\n\n}\n\nBlendModeNode.BURN = 'burn';\nBlendModeNode.DODGE = 'dodge';\nBlendModeNode.SCREEN = 'screen';\nBlendModeNode.OVERLAY = 'overlay';\n\nexport default BlendModeNode;\n\nexport const burn = nodeProxy( BlendModeNode, BlendModeNode.BURN );\nexport const dodge = nodeProxy( BlendModeNode, BlendModeNode.DODGE );\nexport const overlay = nodeProxy( BlendModeNode, BlendModeNode.OVERLAY );\nexport const screen = nodeProxy( BlendModeNode, BlendModeNode.SCREEN );\n\naddNodeElement( 'burn', burn );\naddNodeElement( 'dodge', dodge );\naddNodeElement( 'overlay', overlay );\naddNodeElement( 'screen', screen );\n\naddNodeClass( 'BlendModeNode', BlendModeNode );\n","import TempNode from '../core/TempNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { uv } from '../accessors/UVNode.js';\nimport { normalView } from '../accessors/NormalNode.js';\nimport { positionView } from '../accessors/PositionNode.js';\nimport { faceDirection } from './FrontFacingNode.js';\nimport { addNodeElement, tslFn, nodeProxy, float, vec2 } from '../shadernode/ShaderNode.js';\n\n// Bump Mapping Unparametrized Surfaces on the GPU by Morten S. Mikkelsen\n// https://mmikk.github.io/papers3d/mm_sfgrad_bump.pdf\n\nconst dHdxy_fwd = tslFn( ( { textureNode, bumpScale } ) => {\n\n\t// It's used to preserve the same TextureNode instance\n\tconst sampleTexture = ( callback ) => textureNode.cache().context( { getUV: ( texNode ) => callback( texNode.uvNode || uv() ), forceUVContext: true } );\n\n\tconst Hll = float( sampleTexture( ( uvNode ) => uvNode ) );\n\n\treturn vec2(\n\t\tfloat( sampleTexture( ( uvNode ) => uvNode.add( uvNode.dFdx() ) ) ).sub( Hll ),\n\t\tfloat( sampleTexture( ( uvNode ) => uvNode.add( uvNode.dFdy() ) ) ).sub( Hll )\n\t).mul( bumpScale );\n\n} );\n\n// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\nconst perturbNormalArb = tslFn( ( inputs ) => {\n\n\tconst { surf_pos, surf_norm, dHdxy } = inputs;\n\n\t// normalize is done to ensure that the bump map looks the same regardless of the texture's scale\n\tconst vSigmaX = surf_pos.dFdx().normalize();\n\tconst vSigmaY = surf_pos.dFdy().normalize();\n\tconst vN = surf_norm; // normalized\n\n\tconst R1 = vSigmaY.cross( vN );\n\tconst R2 = vN.cross( vSigmaX );\n\n\tconst fDet = vSigmaX.dot( R1 ).mul( faceDirection );\n\n\tconst vGrad = fDet.sign().mul( dHdxy.x.mul( R1 ).add( dHdxy.y.mul( R2 ) ) );\n\n\treturn fDet.abs().mul( surf_norm ).sub( vGrad ).normalize();\n\n} );\n\nclass BumpMapNode extends TempNode {\n\n\tconstructor( textureNode, scaleNode = null ) {\n\n\t\tsuper( 'vec3' );\n\n\t\tthis.textureNode = textureNode;\n\t\tthis.scaleNode = scaleNode;\n\n\t}\n\n\tsetup() {\n\n\t\tconst bumpScale = this.scaleNode !== null ? this.scaleNode : 1;\n\t\tconst dHdxy = dHdxy_fwd( { textureNode: this.textureNode, bumpScale } );\n\n\t\treturn perturbNormalArb( {\n\t\t\tsurf_pos: positionView,\n\t\t\tsurf_norm: normalView,\n\t\t\tdHdxy\n\t\t} );\n\n\t}\n\n}\n\nexport default BumpMapNode;\n\nexport const bumpMap = nodeProxy( BumpMapNode );\n\naddNodeElement( 'bumpMap', bumpMap );\n\naddNodeClass( 'BumpMapNode', BumpMapNode );\n","import TempNode from '../core/TempNode.js';\nimport { dot, mix } from '../math/MathNode.js';\nimport { add } from '../math/OperatorNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { addNodeElement, tslFn, nodeProxy, float, vec3 } from '../shadernode/ShaderNode.js';\n\nconst saturationNode = tslFn( ( { color, adjustment } ) => {\n\n\treturn adjustment.mix( luminance( color.rgb ), color.rgb );\n\n} );\n\nconst vibranceNode = tslFn( ( { color, adjustment } ) => {\n\n\tconst average = add( color.r, color.g, color.b ).div( 3.0 );\n\n\tconst mx = color.r.max( color.g.max( color.b ) );\n\tconst amt = mx.sub( average ).mul( adjustment ).mul( - 3.0 );\n\n\treturn mix( color.rgb, mx, amt );\n\n} );\n\nconst hueNode = tslFn( ( { color, adjustment } ) => {\n\n\tconst k = vec3( 0.57735, 0.57735, 0.57735 );\n\n\tconst cosAngle = adjustment.cos();\n\n\treturn vec3( color.rgb.mul( cosAngle ).add( k.cross( color.rgb ).mul( adjustment.sin() ).add( k.mul( dot( k, color.rgb ).mul( cosAngle.oneMinus() ) ) ) ) );\n\n} );\n\nclass ColorAdjustmentNode extends TempNode {\n\n\tconstructor( method, colorNode, adjustmentNode = float( 1 ) ) {\n\n\t\tsuper( 'vec3' );\n\n\t\tthis.method = method;\n\n\t\tthis.colorNode = colorNode;\n\t\tthis.adjustmentNode = adjustmentNode;\n\n\t}\n\n\tsetup() {\n\n\t\tconst { method, colorNode, adjustmentNode } = this;\n\n\t\tconst callParams = { color: colorNode, adjustment: adjustmentNode };\n\n\t\tlet outputNode = null;\n\n\t\tif ( method === ColorAdjustmentNode.SATURATION ) {\n\n\t\t\toutputNode = saturationNode( callParams );\n\n\t\t} else if ( method === ColorAdjustmentNode.VIBRANCE ) {\n\n\t\t\toutputNode = vibranceNode( callParams );\n\n\t\t} else if ( method === ColorAdjustmentNode.HUE ) {\n\n\t\t\toutputNode = hueNode( callParams );\n\n\t\t} else {\n\n\t\t\tconsole.error( `${ this.type }: Method \"${ this.method }\" not supported!` );\n\n\t\t}\n\n\t\treturn outputNode;\n\n\t}\n\n}\n\nColorAdjustmentNode.SATURATION = 'saturation';\nColorAdjustmentNode.VIBRANCE = 'vibrance';\nColorAdjustmentNode.HUE = 'hue';\n\nexport default ColorAdjustmentNode;\n\nexport const saturation = nodeProxy( ColorAdjustmentNode, ColorAdjustmentNode.SATURATION );\nexport const vibrance = nodeProxy( ColorAdjustmentNode, ColorAdjustmentNode.VIBRANCE );\nexport const hue = nodeProxy( ColorAdjustmentNode, ColorAdjustmentNode.HUE );\n\nexport const lumaCoeffs = vec3( 0.2125, 0.7154, 0.0721 );\nexport const luminance = ( color, luma = lumaCoeffs ) => dot( color, luma );\n\nexport const threshold = ( color, threshold ) => mix( vec3( 0.0 ), color, luminance( color ).sub( threshold ).max( 0 ) );\n\naddNodeElement( 'saturation', saturation );\naddNodeElement( 'vibrance', vibrance );\naddNodeElement( 'hue', hue );\naddNodeElement( 'threshold', threshold );\n\naddNodeClass( 'ColorAdjustmentNode', ColorAdjustmentNode );\n","import TempNode from '../core/TempNode.js';\nimport { add } from '../math/OperatorNode.js';\n\nimport { modelNormalMatrix } from '../accessors/ModelNode.js';\nimport { normalView } from '../accessors/NormalNode.js';\nimport { positionView } from '../accessors/PositionNode.js';\nimport { TBNViewMatrix } from '../accessors/AccessorsUtils.js';\nimport { uv } from '../accessors/UVNode.js';\nimport { faceDirection } from './FrontFacingNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { addNodeElement, tslFn, nodeProxy, vec3 } from '../shadernode/ShaderNode.js';\n\nimport { TangentSpaceNormalMap, ObjectSpaceNormalMap } from 'three';\n\n// Normal Mapping Without Precomputed Tangents\n// http://www.thetenthplanet.de/archives/1180\n\nconst perturbNormal2Arb = tslFn( ( inputs ) => {\n\n\tconst { eye_pos, surf_norm, mapN, uv } = inputs;\n\n\tconst q0 = eye_pos.dFdx();\n\tconst q1 = eye_pos.dFdy();\n\tconst st0 = uv.dFdx();\n\tconst st1 = uv.dFdy();\n\n\tconst N = surf_norm; // normalized\n\n\tconst q1perp = q1.cross( N );\n\tconst q0perp = N.cross( q0 );\n\n\tconst T = q1perp.mul( st0.x ).add( q0perp.mul( st1.x ) );\n\tconst B = q1perp.mul( st0.y ).add( q0perp.mul( st1.y ) );\n\n\tconst det = T.dot( T ).max( B.dot( B ) );\n\tconst scale = faceDirection.mul( det.inverseSqrt() );\n\n\treturn add( T.mul( mapN.x, scale ), B.mul( mapN.y, scale ), N.mul( mapN.z ) ).normalize();\n\n} );\n\nclass NormalMapNode extends TempNode {\n\n\tconstructor( node, scaleNode = null ) {\n\n\t\tsuper( 'vec3' );\n\n\t\tthis.node = node;\n\t\tthis.scaleNode = scaleNode;\n\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst { normalMapType, scaleNode } = this;\n\n\t\tlet normalMap = this.node.mul( 2.0 ).sub( 1.0 );\n\n\t\tif ( scaleNode !== null ) {\n\n\t\t\tnormalMap = vec3( normalMap.xy.mul( scaleNode ), normalMap.z );\n\n\t\t}\n\n\t\tlet outputNode = null;\n\n\t\tif ( normalMapType === ObjectSpaceNormalMap ) {\n\n\t\t\toutputNode = modelNormalMatrix.mul( normalMap ).normalize();\n\n\t\t} else if ( normalMapType === TangentSpaceNormalMap ) {\n\n\t\t\tconst tangent = builder.hasGeometryAttribute( 'tangent' );\n\n\t\t\tif ( tangent === true ) {\n\n\t\t\t\toutputNode = TBNViewMatrix.mul( normalMap ).normalize();\n\n\t\t\t} else {\n\n\t\t\t\toutputNode = perturbNormal2Arb( {\n\t\t\t\t\teye_pos: positionView,\n\t\t\t\t\tsurf_norm: normalView,\n\t\t\t\t\tmapN: normalMap,\n\t\t\t\t\tuv: uv()\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn outputNode;\n\n\t}\n\n}\n\nexport default NormalMapNode;\n\nexport const normalMap = nodeProxy( NormalMapNode );\n\naddNodeElement( 'normalMap', normalMap );\n\naddNodeClass( 'NormalMapNode', NormalMapNode );\n","import TempNode from '../core/TempNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { addNodeElement, nodeProxy } from '../shadernode/ShaderNode.js';\n\nclass PosterizeNode extends TempNode {\n\n\tconstructor( sourceNode, stepsNode ) {\n\n\t\tsuper();\n\n\t\tthis.sourceNode = sourceNode;\n\t\tthis.stepsNode = stepsNode;\n\n\t}\n\n\tsetup() {\n\n\t\tconst { sourceNode, stepsNode } = this;\n\n\t\treturn sourceNode.mul( stepsNode ).floor().div( stepsNode );\n\n\t}\n\n}\n\nexport default PosterizeNode;\n\nexport const posterize = nodeProxy( PosterizeNode );\n\naddNodeElement( 'posterize', posterize );\n\naddNodeClass( 'PosterizeNode', PosterizeNode );\n","import TempNode from '../core/TempNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { addNodeElement, tslFn, nodeObject, float, mat3, vec3, If } from '../shadernode/ShaderNode.js';\nimport { rendererReference } from '../accessors/RendererReferenceNode.js';\nimport { cond } from '../math/CondNode.js';\nimport { clamp, log2, max, min, pow, mix } from '../math/MathNode.js';\nimport { mul, sub, div } from '../math/OperatorNode.js';\n\nimport { NoToneMapping, LinearToneMapping, ReinhardToneMapping, CineonToneMapping, ACESFilmicToneMapping, AgXToneMapping, NeutralToneMapping } from 'three';\n\n// exposure only\nconst LinearToneMappingNode = tslFn( ( { color, exposure } ) => {\n\n\treturn color.mul( exposure ).clamp();\n\n} );\n\n// source: https://www.cs.utah.edu/docs/techreports/2002/pdf/UUCS-02-001.pdf\nconst ReinhardToneMappingNode = tslFn( ( { color, exposure } ) => {\n\n\tcolor = color.mul( exposure );\n\n\treturn color.div( color.add( 1.0 ) ).clamp();\n\n} );\n\n// source: http://filmicworlds.com/blog/filmic-tonemapping-operators/\nconst OptimizedCineonToneMappingNode = tslFn( ( { color, exposure } ) => {\n\n\t// optimized filmic operator by Jim Hejl and Richard Burgess-Dawson\n\tcolor = color.mul( exposure );\n\tcolor = color.sub( 0.004 ).max( 0.0 );\n\n\tconst a = color.mul( color.mul( 6.2 ).add( 0.5 ) );\n\tconst b = color.mul( color.mul( 6.2 ).add( 1.7 ) ).add( 0.06 );\n\n\treturn a.div( b ).pow( 2.2 );\n\n} );\n\n// source: https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_blit.fs\nconst RRTAndODTFit = tslFn( ( { color } ) => {\n\n\tconst a = color.mul( color.add( 0.0245786 ) ).sub( 0.000090537 );\n\tconst b = color.mul( color.add( 0.4329510 ).mul( 0.983729 ) ).add( 0.238081 );\n\n\treturn a.div( b );\n\n} );\n\n// source: https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_blit.fs\nconst ACESFilmicToneMappingNode = tslFn( ( { color, exposure } ) => {\n\n\t// sRGB => XYZ => D65_2_D60 => AP1 => RRT_SAT\n\tconst ACESInputMat = mat3(\n\t\t0.59719, 0.35458, 0.04823,\n\t\t0.07600, 0.90834, 0.01566,\n\t\t0.02840, 0.13383, 0.83777\n\t);\n\n\t// ODT_SAT => XYZ => D60_2_D65 => sRGB\n\tconst ACESOutputMat = mat3(\n\t\t1.60475, - 0.53108, - 0.07367,\n\t\t- 0.10208, 1.10813, - 0.00605,\n\t\t- 0.00327, - 0.07276, 1.07602\n\t);\n\n\tcolor = color.mul( exposure ).div( 0.6 );\n\n\tcolor = ACESInputMat.mul( color );\n\n\t// Apply RRT and ODT\n\tcolor = RRTAndODTFit( { color } );\n\n\tcolor = ACESOutputMat.mul( color );\n\n\t// Clamp to [0, 1]\n\treturn color.clamp();\n\n} );\n\n\n\nconst LINEAR_REC2020_TO_LINEAR_SRGB = mat3( vec3( 1.6605, - 0.1246, - 0.0182 ), vec3( - 0.5876, 1.1329, - 0.1006 ), vec3( - 0.0728, - 0.0083, 1.1187 ) );\nconst LINEAR_SRGB_TO_LINEAR_REC2020 = mat3( vec3( 0.6274, 0.0691, 0.0164 ), vec3( 0.3293, 0.9195, 0.0880 ), vec3( 0.0433, 0.0113, 0.8956 ) );\n\nconst agxDefaultContrastApprox = tslFn( ( [ x_immutable ] ) => {\n\n\tconst x = vec3( x_immutable ).toVar();\n\tconst x2 = vec3( x.mul( x ) ).toVar();\n\tconst x4 = vec3( x2.mul( x2 ) ).toVar();\n\n\treturn float( 15.5 ).mul( x4.mul( x2 ) ).sub( mul( 40.14, x4.mul( x ) ) ).add( mul( 31.96, x4 ).sub( mul( 6.868, x2.mul( x ) ) ).add( mul( 0.4298, x2 ).add( mul( 0.1191, x ).sub( 0.00232 ) ) ) );\n\n} );\n\nconst AGXToneMappingNode = tslFn( ( { color, exposure } ) => {\n\n\tconst colortone = vec3( color ).toVar();\n\tconst AgXInsetMatrix = mat3( vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ), vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ), vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 ) );\n\tconst AgXOutsetMatrix = mat3( vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ), vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ), vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 ) );\n\tconst AgxMinEv = float( - 12.47393 );\n\tconst AgxMaxEv = float( 4.026069 );\n\tcolortone.mulAssign( exposure );\n\tcolortone.assign( LINEAR_SRGB_TO_LINEAR_REC2020.mul( colortone ) );\n\tcolortone.assign( AgXInsetMatrix.mul( colortone ) );\n\tcolortone.assign( max( colortone, 1e-10 ) );\n\tcolortone.assign( log2( colortone ) );\n\tcolortone.assign( colortone.sub( AgxMinEv ).div( AgxMaxEv.sub( AgxMinEv ) ) );\n\tcolortone.assign( clamp( colortone, 0.0, 1.0 ) );\n\tcolortone.assign( agxDefaultContrastApprox( colortone ) );\n\tcolortone.assign( AgXOutsetMatrix.mul( colortone ) );\n\tcolortone.assign( pow( max( vec3( 0.0 ), colortone ), vec3( 2.2 ) ) );\n\tcolortone.assign( LINEAR_REC2020_TO_LINEAR_SRGB.mul( colortone ) );\n\tcolortone.assign( clamp( colortone, 0.0, 1.0 ) );\n\n\treturn colortone;\n\n} );\n\n// https://modelviewer.dev/examples/tone-mapping\n\nconst NeutralToneMappingNode = tslFn( ( { color, exposure } ) => {\n\n\tconst StartCompression = float( 0.8 - 0.04 );\n\tconst Desaturation = float( 0.15 );\n\n\tcolor = color.mul( exposure );\n\n\tconst x = min( color.r, min( color.g, color.b ) );\n\tconst offset = cond( x.lessThan( 0.08 ), x.sub( mul( 6.25, x.mul( x ) ) ), 0.04 );\n\n\tcolor.subAssign( offset );\n\n\tconst peak = max( color.r, max( color.g, color.b ) );\n\n\tIf( peak.lessThan( StartCompression ), () => {\n\n\t\treturn color;\n\n\t} );\n\n\tconst d = sub( 1, StartCompression );\n\tconst newPeak = sub( 1, d.mul( d ).div( peak.add( d.sub( StartCompression ) ) ) );\n\tcolor.mulAssign( newPeak.div( peak ) );\n\tconst g = sub( 1, div( 1, Desaturation.mul( peak.sub( newPeak ) ).add( 1 ) ) );\n\n\treturn mix( color, vec3( newPeak ), g );\n\n} ).setLayout( {\n\tname: 'NeutralToneMapping',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'color', type: 'vec3' },\n\t\t{ name: 'exposure', type: 'float' }\n\t]\n} );\n\nconst toneMappingLib = {\n\t[ LinearToneMapping ]: LinearToneMappingNode,\n\t[ ReinhardToneMapping ]: ReinhardToneMappingNode,\n\t[ CineonToneMapping ]: OptimizedCineonToneMappingNode,\n\t[ ACESFilmicToneMapping ]: ACESFilmicToneMappingNode,\n\t[ AgXToneMapping ]: AGXToneMappingNode,\n\t[ NeutralToneMapping ]: NeutralToneMappingNode\n};\n\nclass ToneMappingNode extends TempNode {\n\n\tconstructor( toneMapping = NoToneMapping, exposureNode = toneMappingExposure, colorNode = null ) {\n\n\t\tsuper( 'vec3' );\n\n\t\tthis.toneMapping = toneMapping;\n\n\t\tthis.exposureNode = exposureNode;\n\t\tthis.colorNode = colorNode;\n\n\t}\n\n\tgetCacheKey() {\n\n\t\tlet cacheKey = super.getCacheKey();\n\t\tcacheKey = '{toneMapping:' + this.toneMapping + ',nodes:' + cacheKey + '}';\n\n\t\treturn cacheKey;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst colorNode = this.colorNode || builder.context.color;\n\t\tconst toneMapping = this.toneMapping;\n\n\t\tif ( toneMapping === NoToneMapping ) return colorNode;\n\n\t\tconst toneMappingParams = { exposure: this.exposureNode, color: colorNode };\n\t\tconst toneMappingNode = toneMappingLib[ toneMapping ];\n\n\t\tlet outputNode = null;\n\n\t\tif ( toneMappingNode ) {\n\n\t\t\toutputNode = toneMappingNode( toneMappingParams );\n\n\t\t} else {\n\n\t\t\tconsole.error( 'ToneMappingNode: Unsupported Tone Mapping configuration.', toneMapping );\n\n\t\t\toutputNode = colorNode;\n\n\t\t}\n\n\t\treturn outputNode;\n\n\t}\n\n}\n\nexport default ToneMappingNode;\n\nexport const toneMapping = ( mapping, exposure, color ) => nodeObject( new ToneMappingNode( mapping, nodeObject( exposure ), nodeObject( color ) ) );\nexport const toneMappingExposure = rendererReference( 'toneMappingExposure', 'float' );\n\naddNodeElement( 'toneMapping', ( color, mapping, exposure ) => toneMapping( mapping, exposure, color ) );\n\naddNodeClass( 'ToneMappingNode', ToneMappingNode );\n","import ViewportTextureNode from './ViewportTextureNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { addNodeElement, nodeProxy } from '../shadernode/ShaderNode.js';\nimport { viewportTopLeft } from './ViewportNode.js';\nimport { FramebufferTexture } from 'three';\n\nlet _sharedFramebuffer = null;\n\nclass ViewportSharedTextureNode extends ViewportTextureNode {\n\n\tconstructor( uvNode = viewportTopLeft, levelNode = null ) {\n\n\t\tif ( _sharedFramebuffer === null ) {\n\n\t\t\t_sharedFramebuffer = new FramebufferTexture();\n\n\t\t}\n\n\t\tsuper( uvNode, levelNode, _sharedFramebuffer );\n\n\t}\n\n\tupdateReference() {\n\n\t\treturn this;\n\n\t}\n\n}\n\nexport default ViewportSharedTextureNode;\n\nexport const viewportSharedTexture = nodeProxy( ViewportSharedTextureNode );\n\naddNodeElement( 'viewportSharedTexture', viewportSharedTexture );\n\naddNodeClass( 'ViewportSharedTextureNode', ViewportSharedTextureNode );\n","import { addNodeClass } from '../core/Node.js';\nimport TempNode from '../core/TempNode.js';\nimport { default as TextureNode/*, texture*/ } from '../accessors/TextureNode.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { nodeObject } from '../shadernode/ShaderNode.js';\nimport { uniform } from '../core/UniformNode.js';\nimport { viewZToOrthographicDepth, perspectiveDepthToViewZ } from './ViewportDepthNode.js';\nimport { RenderTarget, Vector2, HalfFloatType, DepthTexture, NoToneMapping/*, FloatType*/ } from 'three';\n\nconst _size = new Vector2();\n\nclass PassTextureNode extends TextureNode {\n\n\tconstructor( passNode, texture ) {\n\n\t\tsuper( texture );\n\n\t\tthis.passNode = passNode;\n\n\t\tthis.setUpdateMatrix( false );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tthis.passNode.build( builder );\n\n\t\treturn super.setup( builder );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.passNode, this.value );\n\n\t}\n\n}\n\nclass PassNode extends TempNode {\n\n\tconstructor( scope, scene, camera ) {\n\n\t\tsuper( 'vec4' );\n\n\t\tthis.scope = scope;\n\t\tthis.scene = scene;\n\t\tthis.camera = camera;\n\n\t\tthis._pixelRatio = 1;\n\t\tthis._width = 1;\n\t\tthis._height = 1;\n\n\t\tconst depthTexture = new DepthTexture();\n\t\tdepthTexture.isRenderTargetTexture = true;\n\t\t//depthTexture.type = FloatType;\n\t\tdepthTexture.name = 'PostProcessingDepth';\n\n\t\tconst renderTarget = new RenderTarget( this._width * this._pixelRatio, this._height * this._pixelRatio, { type: HalfFloatType } );\n\t\trenderTarget.texture.name = 'PostProcessing';\n\t\trenderTarget.depthTexture = depthTexture;\n\n\t\tthis.renderTarget = renderTarget;\n\n\t\tthis.updateBeforeType = NodeUpdateType.FRAME;\n\n\t\tthis._textureNode = nodeObject( new PassTextureNode( this, renderTarget.texture ) );\n\t\tthis._depthTextureNode = nodeObject( new PassTextureNode( this, depthTexture ) );\n\n\t\tthis._linearDepthNode = null;\n\t\tthis._viewZNode = null;\n\t\tthis._cameraNear = uniform( 0 );\n\t\tthis._cameraFar = uniform( 0 );\n\n\t\tthis.isPassNode = true;\n\n\t}\n\n\tisGlobal() {\n\n\t\treturn true;\n\n\t}\n\n\tgetTextureNode() {\n\n\t\treturn this._textureNode;\n\n\t}\n\n\tgetTextureDepthNode() {\n\n\t\treturn this._depthTextureNode;\n\n\t}\n\n\tgetViewZNode() {\n\n\t\tif ( this._viewZNode === null ) {\n\n\t\t\tconst cameraNear = this._cameraNear;\n\t\t\tconst cameraFar = this._cameraFar;\n\n\t\t\tthis._viewZNode = perspectiveDepthToViewZ( this._depthTextureNode, cameraNear, cameraFar );\n\n\t\t}\n\n\t\treturn this._viewZNode;\n\n\t}\n\n\tgetLinearDepthNode() {\n\n\t\tif ( this._linearDepthNode === null ) {\n\n\t\t\tconst cameraNear = this._cameraNear;\n\t\t\tconst cameraFar = this._cameraFar;\n\n\t\t\t// TODO: just if ( builder.camera.isPerspectiveCamera )\n\n\t\t\tthis._linearDepthNode = viewZToOrthographicDepth( this.getViewZNode(), cameraNear, cameraFar );\n\n\t\t}\n\n\t\treturn this._linearDepthNode;\n\n\t}\n\n\tsetup() {\n\n\t\treturn this.scope === PassNode.COLOR ? this.getTextureNode() : this.getLinearDepthNode();\n\n\t}\n\n\tupdateBefore( frame ) {\n\n\t\tconst { renderer } = frame;\n\t\tconst { scene, camera } = this;\n\n\t\tthis._pixelRatio = renderer.getPixelRatio();\n\n\t\tconst size = renderer.getSize( _size );\n\n\t\tthis.setSize( size.width, size.height );\n\n\t\tconst currentToneMapping = renderer.toneMapping;\n\t\tconst currentToneMappingNode = renderer.toneMappingNode;\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\n\t\tthis._cameraNear.value = camera.near;\n\t\tthis._cameraFar.value = camera.far;\n\n\t\trenderer.toneMapping = NoToneMapping;\n\t\trenderer.toneMappingNode = null;\n\t\trenderer.setRenderTarget( this.renderTarget );\n\n\t\trenderer.render( scene, camera );\n\n\t\trenderer.toneMapping = currentToneMapping;\n\t\trenderer.toneMappingNode = currentToneMappingNode;\n\t\trenderer.setRenderTarget( currentRenderTarget );\n\n\t}\n\n\tsetSize( width, height ) {\n\n\t\tthis._width = width;\n\t\tthis._height = height;\n\n\t\tconst effectiveWidth = this._width * this._pixelRatio;\n\t\tconst effectiveHeight = this._height * this._pixelRatio;\n\n\t\tthis.renderTarget.setSize( effectiveWidth, effectiveHeight );\n\n\t}\n\n\tsetPixelRatio( pixelRatio ) {\n\n\t\tthis._pixelRatio = pixelRatio;\n\n\t\tthis.setSize( this._width, this._height );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.renderTarget.dispose();\n\n\t}\n\n\n}\n\nPassNode.COLOR = 'color';\nPassNode.DEPTH = 'depth';\n\nexport default PassNode;\n\nexport const pass = ( scene, camera ) => nodeObject( new PassNode( PassNode.COLOR, scene, camera ) );\nexport const texturePass = ( pass, texture ) => nodeObject( new PassTextureNode( pass, texture ) );\nexport const depthPass = ( scene, camera ) => nodeObject( new PassNode( PassNode.DEPTH, scene, camera ) );\n\naddNodeClass( 'PassNode', PassNode );\n","import { BufferGeometry, Float32BufferAttribute, Mesh, OrthographicCamera } from 'three';\n\n// Helper for passes that need to fill the viewport with a single quad.\n\nconst _camera = new OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\n\n// https://github.com/mrdoob/three.js/pull/21358\n\nclass QuadGeometry extends BufferGeometry {\n\n\tconstructor( flipY = false ) {\n\n\t\tsuper();\n\n\t\tconst uv = flipY === false ? [ 0, - 1, 0, 1, 2, 1 ] : [ 0, 2, 0, 0, 2, 0 ];\n\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( [ - 1, 3, 0, - 1, - 1, 0, 3, - 1, 0 ], 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uv, 2 ) );\n\n\t}\n\n}\n\nconst _geometry = new QuadGeometry();\n\nclass QuadMesh extends Mesh {\n\n\tconstructor( material = null ) {\n\n\t\tsuper( _geometry, material );\n\n\t\tthis.camera = _camera;\n\n\t}\n\n\trenderAsync( renderer ) {\n\n\t\treturn renderer.renderAsync( this, _camera );\n\n\t}\n\n\trender( renderer ) {\n\n\t\trenderer.render( this, _camera );\n\n\t}\n\n}\n\nexport default QuadMesh;\n","import TempNode from '../core/TempNode.js';\nimport { nodeObject, addNodeElement, tslFn, float, vec2, vec4 } from '../shadernode/ShaderNode.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { mul } from '../math/OperatorNode.js';\nimport { uv } from '../accessors/UVNode.js';\nimport { texturePass } from './PassNode.js';\nimport { uniform } from '../core/UniformNode.js';\nimport { Vector2, RenderTarget } from 'three';\nimport QuadMesh from '../../objects/QuadMesh.js';\n\n// WebGPU: The use of a single QuadMesh for both gaussian blur passes results in a single RenderObject with a SampledTexture binding that\n// alternates between source textures and triggers creation of new BindGroups and BindGroupLayouts every frame.\n\nconst quadMesh1 = new QuadMesh();\nconst quadMesh2 = new QuadMesh();\n\nclass GaussianBlurNode extends TempNode {\n\n\tconstructor( textureNode, sigma = 2 ) {\n\n\t\tsuper( 'vec4' );\n\n\t\tthis.textureNode = textureNode;\n\t\tthis.sigma = sigma;\n\n\t\tthis.directionNode = vec2( 1 );\n\n\t\tthis._invSize = uniform( new Vector2() );\n\t\tthis._passDirection = uniform( new Vector2() );\n\n\t\tthis._horizontalRT = new RenderTarget();\n\t\tthis._horizontalRT.texture.name = 'GaussianBlurNode.horizontal';\n\t\tthis._verticalRT = new RenderTarget();\n\t\tthis._verticalRT.texture.name = 'GaussianBlurNode.vertical';\n\n\t\tthis._textureNode = texturePass( this, this._verticalRT.texture );\n\n\t\tthis.updateBeforeType = NodeUpdateType.RENDER;\n\n\t\tthis.resolution = new Vector2( 1, 1 );\n\n\t}\n\n\tsetSize( width, height ) {\n\n\t\twidth = Math.max( Math.round( width * this.resolution.x ), 1 );\n\t\theight = Math.max( Math.round( height * this.resolution.y ), 1 );\n\n\t\tthis._invSize.value.set( 1 / width, 1 / height );\n\t\tthis._horizontalRT.setSize( width, height );\n\t\tthis._verticalRT.setSize( width, height );\n\n\t}\n\n\tupdateBefore( frame ) {\n\n\t\tconst { renderer } = frame;\n\n\t\tconst textureNode = this.textureNode;\n\t\tconst map = textureNode.value;\n\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\t\tconst currentTexture = textureNode.value;\n\n\t\tquadMesh1.material = this._material;\n\t\tquadMesh2.material = this._material;\n\n\t\tthis.setSize( map.image.width, map.image.height );\n\n\t\tconst textureType = map.type;\n\n\t\tthis._horizontalRT.texture.type = textureType;\n\t\tthis._verticalRT.texture.type = textureType;\n\n\t\t// horizontal\n\n\t\trenderer.setRenderTarget( this._horizontalRT );\n\n\t\tthis._passDirection.value.set( 1, 0 );\n\n\t\tquadMesh1.render( renderer );\n\n\t\t// vertical\n\n\t\ttextureNode.value = this._horizontalRT.texture;\n\t\trenderer.setRenderTarget( this._verticalRT );\n\n\t\tthis._passDirection.value.set( 0, 1 );\n\n\t\tquadMesh2.render( renderer );\n\n\t\t// restore\n\n\t\trenderer.setRenderTarget( currentRenderTarget );\n\t\ttextureNode.value = currentTexture;\n\n\t}\n\n\tgetTextureNode() {\n\n\t\treturn this._textureNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst textureNode = this.textureNode;\n\n\t\tif ( textureNode.isTextureNode !== true ) {\n\n\t\t\tconsole.error( 'GaussianBlurNode requires a TextureNode.' );\n\n\t\t\treturn vec4();\n\n\t\t}\n\n\t\t//\n\n\t\tconst uvNode = textureNode.uvNode || uv();\n\n\t\tconst sampleTexture = ( uv ) => textureNode.cache().context( { getUV: () => uv, forceUVContext: true } );\n\n\t\tconst blur = tslFn( () => {\n\n\t\t\tconst kernelSize = 3 + ( 2 * this.sigma );\n\t\t\tconst gaussianCoefficients = this._getCoefficients( kernelSize );\n\n\t\t\tconst invSize = this._invSize;\n\t\t\tconst direction = vec2( this.directionNode ).mul( this._passDirection );\n\n\t\t\tconst weightSum = float( gaussianCoefficients[ 0 ] ).toVar();\n\t\t\tconst diffuseSum = vec4( sampleTexture( uvNode ).mul( weightSum ) ).toVar();\n\n\t\t\tfor ( let i = 1; i < kernelSize; i ++ ) {\n\n\t\t\t\tconst x = float( i );\n\t\t\t\tconst w = float( gaussianCoefficients[ i ] );\n\n\t\t\t\tconst uvOffset = vec2( direction.mul( invSize.mul( x ) ) ).toVar();\n\n\t\t\t\tconst sample1 = vec4( sampleTexture( uvNode.add( uvOffset ) ) );\n\t\t\t\tconst sample2 = vec4( sampleTexture( uvNode.sub( uvOffset ) ) );\n\n\t\t\t\tdiffuseSum.addAssign( sample1.add( sample2 ).mul( w ) );\n\t\t\t\tweightSum.addAssign( mul( 2.0, w ) );\n\n\t\t\t}\n\n\t\t\treturn diffuseSum.div( weightSum );\n\n\t\t} );\n\n\t\t//\n\n\t\tconst material = this._material || ( this._material = builder.createNodeMaterial() );\n\t\tmaterial.fragmentNode = blur();\n\n\t\t//\n\n\t\tconst properties = builder.getNodeProperties( this );\n\t\tproperties.textureNode = textureNode;\n\n\t\t//\n\n\t\treturn this._textureNode;\n\n\t}\n\n\t_getCoefficients( kernelRadius ) {\n\n\t\tconst coefficients = [];\n\n\t\tfor ( let i = 0; i < kernelRadius; i ++ ) {\n\n\t\t\tcoefficients.push( 0.39894 * Math.exp( - 0.5 * i * i / ( kernelRadius * kernelRadius ) ) / kernelRadius );\n\n\t\t}\n\n\t\treturn coefficients;\n\n\t}\n\n}\n\nexport const gaussianBlur = ( node, sigma ) => nodeObject( new GaussianBlurNode( nodeObject( node ), sigma ) );\n\naddNodeElement( 'gaussianBlur', gaussianBlur );\n\nexport default GaussianBlurNode;\n\n","import TempNode from '../core/TempNode.js';\nimport { nodeObject, addNodeElement, tslFn, float, vec4 } from '../shadernode/ShaderNode.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { uv } from '../accessors/UVNode.js';\nimport { texture } from '../accessors/TextureNode.js';\nimport { texturePass } from './PassNode.js';\nimport { uniform } from '../core/UniformNode.js';\nimport { RenderTarget } from 'three';\nimport { sign, max } from '../math/MathNode.js';\nimport QuadMesh from '../../objects/QuadMesh.js';\nimport { NoToneMapping, Vector2 } from 'three';\n\nconst _size = new Vector2();\n\nconst quadMeshComp = new QuadMesh();\n\nclass AfterImageNode extends TempNode {\n\n\tconstructor( textureNode, damp = 0.96 ) {\n\n\t\tsuper( textureNode );\n\n\t\tthis.textureNode = textureNode;\n\t\tthis.textureNodeOld = texture();\n\t\tthis.damp = uniform( damp );\n\n\t\tthis._compRT = new RenderTarget();\n\t\tthis._compRT.texture.name = 'AfterImageNode.comp';\n\n\t\tthis._oldRT = new RenderTarget();\n\t\tthis._oldRT.texture.name = 'AfterImageNode.old';\n\n\t\tthis._textureNode = texturePass( this, this._compRT.texture );\n\n\t\tthis.updateBeforeType = NodeUpdateType.RENDER;\n\n\t}\n\n\tgetTextureNode() {\n\n\t\treturn this._textureNode;\n\n\t}\n\n\tsetSize( width, height ) {\n\n\t\tthis._compRT.setSize( width, height );\n\t\tthis._oldRT.setSize( width, height );\n\n\t}\n\n\tupdateBefore( frame ) {\n\n\t\tconst { renderer } = frame;\n\n\t\tconst textureNode = this.textureNode;\n\t\tconst map = textureNode.value;\n\n\t\tconst textureType = map.type;\n\n\t\tthis._compRT.texture.type = textureType;\n\t\tthis._oldRT.texture.type = textureType;\n\n\t\trenderer.getDrawingBufferSize( _size );\n\n\t\tthis.setSize( _size.x, _size.y );\n\n\n\t\tconst currentToneMapping = renderer.toneMapping;\n\t\tconst currentToneMappingNode = renderer.toneMappingNode;\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\t\tconst currentTexture = textureNode.value;\n\n\t\tthis.textureNodeOld.value = this._oldRT.texture;\n\n\t\t// comp\n\t\trenderer.toneMapping = NoToneMapping;\n\t\trenderer.toneMappingNode = null;\n\t\trenderer.setRenderTarget( this._compRT );\n\t\tquadMeshComp.render( renderer );\n\n\t\t// Swap the textures\n\t\tconst temp = this._oldRT;\n\t\tthis._oldRT = this._compRT;\n\t\tthis._compRT = temp;\n\n\n\t\trenderer.toneMapping = currentToneMapping;\n\t\trenderer.toneMappingNode = currentToneMappingNode;\n\t\trenderer.setRenderTarget( currentRenderTarget );\n\t\ttextureNode.value = currentTexture;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst textureNode = this.textureNode;\n\t\tconst textureNodeOld = this.textureNodeOld;\n\n\t\tif ( textureNode.isTextureNode !== true ) {\n\n\t\t\tconsole.error( 'AfterImageNode requires a TextureNode.' );\n\n\t\t\treturn vec4();\n\n\t\t}\n\n\t\t//\n\n\t\tconst uvNode = textureNode.uvNode || uv();\n\n\t\ttextureNodeOld.uvNode = uvNode;\n\n\t\tconst sampleTexture = ( uv ) => textureNode.cache().context( { getUV: () => uv, forceUVContext: true } );\n\n\t\tconst when_gt = tslFn( ( [ x_immutable, y_immutable ] ) => {\n\n\t\t\tconst y = float( y_immutable ).toVar();\n\t\t\tconst x = vec4( x_immutable ).toVar();\n\n\t\t\treturn max( sign( x.sub( y ) ), 0.0 );\n\n\t\t} );\n\n\t\tconst afterImg = tslFn( () => {\n\n\t\t\tconst texelOld = vec4( textureNodeOld );\n\t\t\tconst texelNew = vec4( sampleTexture( uvNode ) );\n\n\t\t\ttexelOld.mulAssign( this.damp.mul( when_gt( texelOld, 0.1 ) ) );\n\t\t\treturn max( texelNew, texelOld );\n\n\t\t} );\n\n\t\t//\n\n\t\tconst materialComposed = this._materialComposed || ( this._materialComposed = builder.createNodeMaterial() );\n\t\tmaterialComposed.fragmentNode = afterImg();\n\n\t\tquadMeshComp.material = materialComposed;\n\n\t\t//\n\n\t\tconst properties = builder.getNodeProperties( this );\n\t\tproperties.textureNode = textureNode;\n\n\t\t//\n\n\t\treturn this._textureNode;\n\n\t}\n\n}\n\nexport const afterImage = ( node, damp ) => nodeObject( new AfterImageNode( nodeObject( node ), damp ) );\n\naddNodeElement( 'afterImage', afterImage );\n\nexport default AfterImageNode;\n\n","import TempNode from '../core/TempNode.js';\nimport { nodeObject, addNodeElement, tslFn, float, vec2, vec3, vec4 } from '../shadernode/ShaderNode.js';\nimport { loop } from '../utils/LoopNode.js';\nimport { uniform } from '../core/UniformNode.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { threshold } from './ColorAdjustmentNode.js';\nimport { uv } from '../accessors/UVNode.js';\nimport { texturePass } from './PassNode.js';\nimport { Vector2, RenderTarget } from 'three';\nimport QuadMesh from '../../objects/QuadMesh.js';\n\nconst quadMesh = new QuadMesh();\n\nclass AnamorphicNode extends TempNode {\n\n\tconstructor( textureNode, tresholdNode, scaleNode, samples ) {\n\n\t\tsuper( 'vec4' );\n\n\t\tthis.textureNode = textureNode;\n\t\tthis.tresholdNode = tresholdNode;\n\t\tthis.scaleNode = scaleNode;\n\t\tthis.colorNode = vec3( 0.1, 0.0, 1.0 );\n\t\tthis.samples = samples;\n\t\tthis.resolution = new Vector2( 1, 1 );\n\n\t\tthis._renderTarget = new RenderTarget();\n\t\tthis._renderTarget.texture.name = 'anamorphic';\n\n\t\tthis._invSize = uniform( new Vector2() );\n\n\t\tthis._textureNode = texturePass( this, this._renderTarget.texture );\n\n\t\tthis.updateBeforeType = NodeUpdateType.RENDER;\n\n\t}\n\n\tgetTextureNode() {\n\n\t\treturn this._textureNode;\n\n\t}\n\n\tsetSize( width, height ) {\n\n\t\tthis._invSize.value.set( 1 / width, 1 / height );\n\n\t\twidth = Math.max( Math.round( width * this.resolution.x ), 1 );\n\t\theight = Math.max( Math.round( height * this.resolution.y ), 1 );\n\n\t\tthis._renderTarget.setSize( width, height );\n\n\t}\n\n\tupdateBefore( frame ) {\n\n\t\tconst { renderer } = frame;\n\n\t\tconst textureNode = this.textureNode;\n\t\tconst map = textureNode.value;\n\n\t\tthis._renderTarget.texture.type = map.type;\n\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\t\tconst currentTexture = textureNode.value;\n\n\t\tquadMesh.material = this._material;\n\n\t\tthis.setSize( map.image.width, map.image.height );\n\n\t\t// render\n\n\t\trenderer.setRenderTarget( this._renderTarget );\n\n\t\tquadMesh.render( renderer );\n\n\t\t// restore\n\n\t\trenderer.setRenderTarget( currentRenderTarget );\n\t\ttextureNode.value = currentTexture;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst textureNode = this.textureNode;\n\n\t\tif ( textureNode.isTextureNode !== true ) {\n\n\t\t\tconsole.error( 'AnamorphNode requires a TextureNode.' );\n\n\t\t\treturn vec4();\n\n\t\t}\n\n\t\t//\n\n\t\tconst uvNode = textureNode.uvNode || uv();\n\n\t\tconst sampleTexture = ( uv ) => textureNode.cache().context( { getUV: () => uv, forceUVContext: true } );\n\n\t\tconst anamorph = tslFn( () => {\n\n\t\t\tconst samples = this.samples;\n\t\t\tconst halfSamples = Math.floor( samples / 2 );\n\n\t\t\tconst total = vec3( 0 ).toVar();\n\n\t\t\tloop( { start: - halfSamples, end: halfSamples }, ( { i } ) => {\n\n\t\t\t\tconst softness = float( i ).abs().div( halfSamples ).oneMinus();\n\n\t\t\t\tconst uv = vec2( uvNode.x.add( this._invSize.x.mul( i ).mul( this.scaleNode ) ), uvNode.y );\n\t\t\t\tconst color = sampleTexture( uv );\n\t\t\t\tconst pass = threshold( color, this.tresholdNode ).mul( softness );\n\n\t\t\t\ttotal.addAssign( pass );\n\n\t\t\t} );\n\n\t\t\treturn total.mul( this.colorNode );\n\n\t\t} );\n\n\t\t//\n\n\t\tconst material = this._material || ( this._material = builder.createNodeMaterial() );\n\t\tmaterial.fragmentNode = anamorph();\n\n\t\t//\n\n\t\tconst properties = builder.getNodeProperties( this );\n\t\tproperties.textureNode = textureNode;\n\n\t\t//\n\n\t\treturn this._textureNode;\n\n\t}\n\n}\n\nexport const anamorphic = ( node, threshold = .9, scale = 3, samples = 32 ) => nodeObject( new AnamorphicNode( nodeObject( node ), nodeObject( threshold ), nodeObject( scale ), samples ) );\n\naddNodeElement( 'anamorphic', anamorphic );\n\nexport default AnamorphicNode;\n\n","import TempNode from '../core/TempNode.js';\nimport { uv } from '../accessors/UVNode.js';\nimport { luminance } from './ColorAdjustmentNode.js';\nimport { addNodeElement, tslFn, nodeObject, vec2, vec3, vec4, mat3 } from '../shadernode/ShaderNode.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { uniform } from '../core/UniformNode.js';\nimport { add } from '../math/OperatorNode.js';\nimport { Vector2 } from 'three';\n\nclass SobelOperatorNode extends TempNode {\n\n\tconstructor( textureNode ) {\n\n\t\tsuper();\n\n\t\tthis.textureNode = textureNode;\n\n\t\tthis.updateBeforeType = NodeUpdateType.RENDER;\n\n\t\tthis._invSize = uniform( new Vector2() );\n\n\t}\n\n\tupdateBefore() {\n\n\t\tconst map = this.textureNode.value;\n\n\t\tthis._invSize.value.set( 1 / map.image.width, 1 / map.image.height );\n\n\t}\n\n\tsetup() {\n\n\t\tconst { textureNode } = this;\n\n\t\tconst uvNode = textureNode.uvNode || uv();\n\n\t\tconst sampleTexture = ( uv ) => this.textureNode.cache().context( { getUV: () => uv, forceUVContext: true } );\n\n\t\tconst sobel = tslFn( () => {\n\n\t\t\t// Sobel Edge Detection (see https://youtu.be/uihBwtPIBxM)\n\n\t\t\tconst texel = this._invSize;\n\n\t\t\t// kernel definition (in glsl matrices are filled in column-major order)\n\n\t\t\tconst Gx = mat3( - 1, - 2, - 1, 0, 0, 0, 1, 2, 1 ); // x direction kernel\n\t\t\tconst Gy = mat3( - 1, 0, 1, - 2, 0, 2, - 1, 0, 1 ); // y direction kernel\n\n\t\t\t// fetch the 3x3 neighbourhood of a fragment\n\n\t\t\t// first column\n\n\t\t\tconst tx0y0 = luminance( sampleTexture( uvNode.add( texel.mul( vec2( - 1, - 1 ) ) ) ).xyz );\n\t\t\tconst tx0y1 = luminance( sampleTexture( uvNode.add( texel.mul( vec2( - 1, 0 ) ) ) ).xyz );\n\t\t\tconst tx0y2 = luminance( sampleTexture( uvNode.add( texel.mul( vec2( - 1, 1 ) ) ) ).xyz );\n\n\t\t\t// second column\n\n\t\t\tconst tx1y0 = luminance( sampleTexture( uvNode.add( texel.mul( vec2( 0, - 1 ) ) ) ).xyz );\n\t\t\tconst tx1y1 = luminance( sampleTexture( uvNode.add( texel.mul( vec2( 0, 0 ) ) ) ).xyz );\n\t\t\tconst tx1y2 = luminance( sampleTexture( uvNode.add( texel.mul( vec2( 0, 1 ) ) ) ).xyz );\n\n\t\t\t// third column\n\n\t\t\tconst tx2y0 = luminance( sampleTexture( uvNode.add( texel.mul( vec2( 1, - 1 ) ) ) ).xyz );\n\t\t\tconst tx2y1 = luminance( sampleTexture( uvNode.add( texel.mul( vec2( 1, 0 ) ) ) ).xyz );\n\t\t\tconst tx2y2 = luminance( sampleTexture( uvNode.add( texel.mul( vec2( 1, 1 ) ) ) ).xyz );\n\n\t\t\t// gradient value in x direction\n\n\t\t\tconst valueGx = add(\n\t\t\t\tGx[ 0 ][ 0 ].mul( tx0y0 ),\n\t\t\t\tGx[ 1 ][ 0 ].mul( tx1y0 ),\n\t\t\t\tGx[ 2 ][ 0 ].mul( tx2y0 ),\n\t\t\t\tGx[ 0 ][ 1 ].mul( tx0y1 ),\n\t\t\t\tGx[ 1 ][ 1 ].mul( tx1y1 ),\n\t\t\t\tGx[ 2 ][ 1 ].mul( tx2y1 ),\n\t\t\t\tGx[ 0 ][ 2 ].mul( tx0y2 ),\n\t\t\t\tGx[ 1 ][ 2 ].mul( tx1y2 ),\n\t\t\t\tGx[ 2 ][ 2 ].mul( tx2y2 )\n\t\t\t);\n\n\n\t\t\t// gradient value in y direction\n\n\t\t\tconst valueGy = add(\n\t\t\t\tGy[ 0 ][ 0 ].mul( tx0y0 ),\n\t\t\t\tGy[ 1 ][ 0 ].mul( tx1y0 ),\n\t\t\t\tGy[ 2 ][ 0 ].mul( tx2y0 ),\n\t\t\t\tGy[ 0 ][ 1 ].mul( tx0y1 ),\n\t\t\t\tGy[ 1 ][ 1 ].mul( tx1y1 ),\n\t\t\t\tGy[ 2 ][ 1 ].mul( tx2y1 ),\n\t\t\t\tGy[ 0 ][ 2 ].mul( tx0y2 ),\n\t\t\t\tGy[ 1 ][ 2 ].mul( tx1y2 ),\n\t\t\t\tGy[ 2 ][ 2 ].mul( tx2y2 )\n\t\t\t);\n\n\t\t\t// magnitute of the total gradient\n\n\t\t\tconst G = valueGx.mul( valueGx ).add( valueGy.mul( valueGy ) ).sqrt();\n\n\t\t\treturn vec4( vec3( G ), 1 );\n\n\t\t} );\n\n\t\tconst outputNode = sobel();\n\n\t\treturn outputNode;\n\n\t}\n\n}\n\nexport const sobel = ( node ) => nodeObject( new SobelOperatorNode( nodeObject( node ) ) );\n\naddNodeElement( 'sobel', sobel );\n\nexport default SobelOperatorNode;\n","import TempNode from '../core/TempNode.js';\nimport { uv } from '../accessors/UVNode.js';\nimport { addNodeElement, tslFn, nodeObject, vec2, vec4 } from '../shadernode/ShaderNode.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { uniform } from '../core/UniformNode.js';\nimport { clamp } from '../math/MathNode.js';\n\nclass DepthOfFieldNode extends TempNode {\n\n\tconstructor( textureNode, viewZNode, focus = 1, aperture = 0.025, maxblur = 1 ) {\n\n\t\tsuper();\n\n\t\tthis.textureNode = textureNode;\n\t\tthis.viewZNode = viewZNode;\n\n\t\tthis.focus = uniform( focus );\n\t\tthis.aperture = uniform( aperture );\n\t\tthis.maxblur = uniform( maxblur );\n\t\tthis._aspect = uniform( 0 );\n\n\t\tthis.updateBeforeType = NodeUpdateType.RENDER;\n\n\t}\n\n\tupdateBefore() {\n\n\t\tconst map = this.textureNode.value;\n\n\t\tthis._aspect.value = map.image.width / map.image.height;\n\n\t}\n\n\tsetup() {\n\n\t\tconst { textureNode } = this;\n\n\t\tconst uvNode = textureNode.uvNode || uv();\n\n\t\tconst sampleTexture = ( uv ) => this.textureNode.uv( uv );\n\n\t\tconst dof = tslFn( () => {\n\n\t\t\tconst aspectcorrect = vec2( 1.0, this._aspect );\n\n\t\t\tconst factor = this.focus.add( this.viewZNode );\n\n\t\t\tconst dofblur = vec2( clamp( factor.mul( this.aperture ), this.maxblur.negate(), this.maxblur ) );\n\n\t\t\tconst dofblur9 = dofblur.mul( 0.9 );\n\t\t\tconst dofblur7 = dofblur.mul( 0.7 );\n\t\t\tconst dofblur4 = dofblur.mul( 0.4 );\n\n\t\t\tlet col = vec4( 0.0 );\n\n\t\t\tcol = col.add( sampleTexture( uvNode ) );\n\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( 0.0, 0.4 ).mul( aspectcorrect ).mul( dofblur ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( 0.15, 0.37 ).mul( aspectcorrect ).mul( dofblur ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( 0.29, 0.29 ).mul( aspectcorrect ).mul( dofblur ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( - 0.37, 0.15 ).mul( aspectcorrect ).mul( dofblur ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( 0.40, 0.0 ).mul( aspectcorrect ).mul( dofblur ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( 0.37, - 0.15 ).mul( aspectcorrect ).mul( dofblur ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( 0.29, - 0.29 ).mul( aspectcorrect ).mul( dofblur ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( - 0.15, - 0.37 ).mul( aspectcorrect ).mul( dofblur ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( 0.0, - 0.4 ).mul( aspectcorrect ).mul( dofblur ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( - 0.15, 0.37 ).mul( aspectcorrect ).mul( dofblur ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( - 0.29, 0.29 ).mul( aspectcorrect ).mul( dofblur ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( 0.37, 0.15 ).mul( aspectcorrect ).mul( dofblur ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( - 0.4, 0.0 ).mul( aspectcorrect ).mul( dofblur ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( - 0.37, - 0.15 ).mul( aspectcorrect ).mul( dofblur ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( - 0.29, - 0.29 ).mul( aspectcorrect ).mul( dofblur ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( 0.15, - 0.37 ).mul( aspectcorrect ).mul( dofblur ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( 0.15, 0.37 ).mul( aspectcorrect ).mul( dofblur9 ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( - 0.37, 0.15 ).mul( aspectcorrect ).mul( dofblur9 ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( 0.37, - 0.15 ).mul( aspectcorrect ).mul( dofblur9 ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( - 0.15, - 0.37 ).mul( aspectcorrect ).mul( dofblur9 ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( - 0.15, 0.37 ).mul( aspectcorrect ).mul( dofblur9 ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( 0.37, 0.15 ).mul( aspectcorrect ).mul( dofblur9 ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( - 0.37, - 0.15 ).mul( aspectcorrect ).mul( dofblur9 ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( 0.15, - 0.37 ).mul( aspectcorrect ).mul( dofblur9 ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( 0.29, 0.29 ).mul( aspectcorrect ).mul( dofblur7 ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( 0.40, 0.0 ).mul( aspectcorrect ).mul( dofblur7 ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( 0.29, - 0.29 ).mul( aspectcorrect ).mul( dofblur7 ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( 0.0, - 0.4 ).mul( aspectcorrect ).mul( dofblur7 ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( - 0.29, 0.29 ).mul( aspectcorrect ).mul( dofblur7 ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( - 0.4, 0.0 ).mul( aspectcorrect ).mul( dofblur7 ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( - 0.29, - 0.29 ).mul( aspectcorrect ).mul( dofblur7 ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( 0.0, 0.4 ).mul( aspectcorrect ).mul( dofblur7 ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( 0.29, 0.29 ).mul( aspectcorrect ).mul( dofblur4 ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( 0.4, 0.0 ).mul( aspectcorrect ).mul( dofblur4 ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( 0.29, - 0.29 ).mul( aspectcorrect ).mul( dofblur4 ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( 0.0, - 0.4 ).mul( aspectcorrect ).mul( dofblur4 ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( - 0.29, 0.29 ).mul( aspectcorrect ).mul( dofblur4 ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( - 0.4, 0.0 ).mul( aspectcorrect ).mul( dofblur4 ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( - 0.29, - 0.29 ).mul( aspectcorrect ).mul( dofblur4 ) ) ) );\n\t\t\tcol = col.add( sampleTexture( uvNode.add( vec2( 0.0, 0.4 ).mul( aspectcorrect ).mul( dofblur4 ) ) ) );\n\n\t\t\tcol = col.div( 41 );\n\t\t\tcol.a = 1;\n\n\t\t\treturn vec4( col );\n\n\n\t\t} );\n\n\t\tconst outputNode = dof();\n\n\t\treturn outputNode;\n\n\t}\n\n}\n\nexport const dof = ( node, viewZNode, focus, apeture, maxblur ) => nodeObject( new DepthOfFieldNode( nodeObject( node ), nodeObject( viewZNode ), focus, apeture, maxblur ) );\n\naddNodeElement( 'dof', dof );\n\nexport default DepthOfFieldNode;\n","import TempNode from '../core/TempNode.js';\nimport { nodeObject, addNodeElement, tslFn, vec2, vec3, vec4 } from '../shadernode/ShaderNode.js';\nimport { uniform } from '../core/UniformNode.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { uv } from '../accessors/UVNode.js';\nimport { texturePass } from './PassNode.js';\nimport { sin, cos } from '../math/MathNode.js';\nimport { add } from '../math/OperatorNode.js';\nimport { Vector2, RenderTarget } from 'three';\nimport QuadMesh from '../../objects/QuadMesh.js';\n\nconst quadMesh = new QuadMesh();\n\nclass DotScreenNode extends TempNode {\n\n\tconstructor( colorNode, center = new Vector2( 0.5, 0.5 ), angle = 1.57, scale = 1 ) {\n\n\t\tsuper( 'vec4' );\n\n\t\tthis.colorNode = colorNode;\n\t\tthis.center = uniform( center );\n\t\tthis.angle = uniform( angle );\n\t\tthis.scale = uniform( scale );\n\n\t\tthis._renderTarget = new RenderTarget();\n\t\tthis._renderTarget.texture.name = 'dotScreen';\n\n\t\tthis._size = uniform( new Vector2() );\n\n\t\tthis._textureNode = texturePass( this, this._renderTarget.texture );\n\n\t\tthis.updateBeforeType = NodeUpdateType.RENDER;\n\n\t}\n\n\tgetTextureNode() {\n\n\t\treturn this._textureNode;\n\n\t}\n\n\tsetSize( width, height ) {\n\n\t\tthis._size.value.set( width, height );\n\t\tthis._renderTarget.setSize( width, height );\n\n\t}\n\n\tupdateBefore( frame ) {\n\n\t\tconst { renderer } = frame;\n\n\t\tconst colorNode = this.colorNode;\n\t\tconst map = colorNode.value;\n\n\t\tthis._renderTarget.texture.type = map.type;\n\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\t\tconst currentTexture = colorNode.value;\n\n\t\tquadMesh.material = this._material;\n\n\t\tthis.setSize( map.image.width, map.image.height );\n\n\t\t// render\n\n\t\trenderer.setRenderTarget( this._renderTarget );\n\n\t\tquadMesh.render( renderer );\n\n\t\t// restore\n\n\t\trenderer.setRenderTarget( currentRenderTarget );\n\t\tcolorNode.value = currentTexture;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst colorNode = this.colorNode;\n\n\t\tconst pattern = tslFn( () => {\n\n\t\t\tconst s = sin( this.angle );\n\t\t\tconst c = cos( this.angle );\n\n\t\t\tconst tex = uv().mul( this._size ).sub( this.center );\n\t\t\tconst point = vec2( c.mul( tex.x ).sub( s.mul( tex.y ) ), s.mul( tex.x ).add( c.mul( tex.y ) ) ).mul( this.scale );\n\n\t\t\treturn sin( point.x ).mul( sin( point.y ) ).mul( 4 );\n\n\t\t} );\n\n\t\tconst dotScreen = tslFn( () => {\n\n\t\t\tconst color = colorNode;\n\n\t\t\tconst average = add( color.r, color.g, color.b ).div( 3 );\n\n\t\t\treturn vec4( vec3( average.mul( 10 ).sub( 5 ).add( pattern() ) ), color.a );\n\n\t\t} );\n\n\t\t//\n\n\t\tconst material = this._material || ( this._material = builder.createNodeMaterial() );\n\t\tmaterial.fragmentNode = dotScreen();\n\n\t\t//\n\n\t\tconst properties = builder.getNodeProperties( this );\n\t\tproperties.textureNode = colorNode;\n\n\t\t//\n\n\t\treturn this._textureNode;\n\n\t}\n\n}\n\nexport const dotScreen = ( node, center, angle, scale ) => nodeObject( new DotScreenNode( nodeObject( node ), center, angle, scale ) );\n\naddNodeElement( 'dotScreen', dotScreen );\n\nexport default DotScreenNode;\n\n","import TempNode from '../core/TempNode.js';\nimport { nodeObject, addNodeElement, tslFn, vec2, vec4 } from '../shadernode/ShaderNode.js';\nimport { uniform } from '../core/UniformNode.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { uv } from '../accessors/UVNode.js';\nimport { sin, cos } from '../math/MathNode.js';\n\nclass RGBShiftNode extends TempNode {\n\n\tconstructor( textureNode, amount = 0.005, angle = 0 ) {\n\n\t\tsuper( 'vec4' );\n\n\t\tthis.textureNode = textureNode;\n\t\tthis.amount = uniform( amount );\n\t\tthis.angle = uniform( angle );\n\n\t\tthis.updateBeforeType = NodeUpdateType.RENDER;\n\n\t}\n\n\tupdateBefore() {\n\n\t}\n\n\tsetup() {\n\n\t\tconst { textureNode } = this;\n\n\t\tconst uvNode = textureNode.uvNode || uv();\n\n\t\tconst sampleTexture = ( uv ) => this.textureNode.uv( uv );\n\n\t\tconst rgbShift = tslFn( () => {\n\n\t\t\tconst offset = vec2( cos( this.angle ), sin( this.angle ) ).mul( this.amount );\n\t\t\tconst cr = sampleTexture( uvNode.add( offset ) );\n\t\t\tconst cga = sampleTexture( uvNode );\n\t\t\tconst cb = sampleTexture( uvNode.sub( offset ) );\n\n\t\t\treturn vec4( cr.r, cga.g, cb.b, cga.a );\n\n\t\t} );\n\n\t\treturn rgbShift();\n\n\t}\n\n}\n\nexport const rgbShift = ( node, amount, angle ) => nodeObject( new RGBShiftNode( nodeObject( node ), amount, angle ) );\n\naddNodeElement( 'rgbShift', rgbShift );\n\nexport default RGBShiftNode;\n\n","import TempNode from '../core/TempNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { addNodeElement, nodeArray, nodeObject, nodeObjects } from '../shadernode/ShaderNode.js';\n\nclass FunctionCallNode extends TempNode {\n\n\tconstructor( functionNode = null, parameters = {} ) {\n\n\t\tsuper();\n\n\t\tthis.functionNode = functionNode;\n\t\tthis.parameters = parameters;\n\n\t}\n\n\tsetParameters( parameters ) {\n\n\t\tthis.parameters = parameters;\n\n\t\treturn this;\n\n\t}\n\n\tgetParameters() {\n\n\t\treturn this.parameters;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.functionNode.getNodeType( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst params = [];\n\n\t\tconst functionNode = this.functionNode;\n\n\t\tconst inputs = functionNode.getInputs( builder );\n\t\tconst parameters = this.parameters;\n\n\t\tif ( Array.isArray( parameters ) ) {\n\n\t\t\tfor ( let i = 0; i < parameters.length; i ++ ) {\n\n\t\t\t\tconst inputNode = inputs[ i ];\n\t\t\t\tconst node = parameters[ i ];\n\n\t\t\t\tparams.push( node.build( builder, inputNode.type ) );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tfor ( const inputNode of inputs ) {\n\n\t\t\t\tconst node = parameters[ inputNode.name ];\n\n\t\t\t\tif ( node !== undefined ) {\n\n\t\t\t\t\tparams.push( node.build( builder, inputNode.type ) );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new Error( `FunctionCallNode: Input '${inputNode.name}' not found in FunctionNode.` );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst functionName = functionNode.build( builder, 'property' );\n\n\t\treturn `${functionName}( ${params.join( ', ' )} )`;\n\n\t}\n\n}\n\nexport default FunctionCallNode;\n\nexport const call = ( func, ...params ) => {\n\n\tparams = params.length > 1 || ( params[ 0 ] && params[ 0 ].isNode === true ) ? nodeArray( params ) : nodeObjects( params[ 0 ] );\n\n\treturn nodeObject( new FunctionCallNode( nodeObject( func ), params ) );\n\n};\n\naddNodeElement( 'call', call );\n\naddNodeClass( 'FunctionCallNode', FunctionCallNode );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { arrayBufferToBase64, base64ToArrayBuffer } from '../core/NodeUtils.js';\nimport { addNodeElement, nodeProxy, float } from '../shadernode/ShaderNode.js';\nimport { EventDispatcher } from 'three';\n\nclass ScriptableValueNode extends Node {\n\n\tconstructor( value = null ) {\n\n\t\tsuper();\n\n\t\tthis._value = value;\n\t\tthis._cache = null;\n\n\t\tthis.inputType = null;\n\t\tthis.outpuType = null;\n\n\t\tthis.events = new EventDispatcher();\n\n\t\tthis.isScriptableValueNode = true;\n\n\t}\n\n\tget isScriptableOutputNode() {\n\n\t\treturn this.outputType !== null;\n\n\t}\n\n\tset value( val ) {\n\n\t\tif ( this._value === val ) return;\n\n\t\tif ( this._cache && this.inputType === 'URL' && this.value.value instanceof ArrayBuffer ) {\n\n\t\t\tURL.revokeObjectURL( this._cache );\n\n\t\t\tthis._cache = null;\n\n\t\t}\n\n\t\tthis._value = val;\n\n\t\tthis.events.dispatchEvent( { type: 'change' } );\n\n\t\tthis.refresh();\n\n\t}\n\n\tget value() {\n\n\t\treturn this._value;\n\n\t}\n\n\trefresh() {\n\n\t\tthis.events.dispatchEvent( { type: 'refresh' } );\n\n\t}\n\n\tgetValue() {\n\n\t\tconst value = this.value;\n\n\t\tif ( value && this._cache === null && this.inputType === 'URL' && value.value instanceof ArrayBuffer ) {\n\n\t\t\tthis._cache = URL.createObjectURL( new Blob( [ value.value ] ) );\n\n\t\t} else if ( value && value.value !== null && value.value !== undefined && (\n\t\t\t( ( this.inputType === 'URL' || this.inputType === 'String' ) && typeof value.value === 'string' ) ||\n\t\t\t( this.inputType === 'Number' && typeof value.value === 'number' ) ||\n\t\t\t( this.inputType === 'Vector2' && value.value.isVector2 ) ||\n\t\t\t( this.inputType === 'Vector3' && value.value.isVector3 ) ||\n\t\t\t( this.inputType === 'Vector4' && value.value.isVector4 ) ||\n\t\t\t( this.inputType === 'Color' && value.value.isColor ) ||\n\t\t\t( this.inputType === 'Matrix3' && value.value.isMatrix3 ) ||\n\t\t\t( this.inputType === 'Matrix4' && value.value.isMatrix4 )\n\t\t) ) {\n\n\t\t\treturn value.value;\n\n\t\t}\n\n\t\treturn this._cache || value;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.value && this.value.isNode ? this.value.getNodeType( builder ) : 'float';\n\n\t}\n\n\tsetup() {\n\n\t\treturn this.value && this.value.isNode ? this.value : float();\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tif ( this.value !== null ) {\n\n\t\t\tif ( this.inputType === 'ArrayBuffer' ) {\n\n\t\t\t\tdata.value = arrayBufferToBase64( this.value );\n\n\t\t\t} else {\n\n\t\t\t\tdata.value = this.value ? this.value.toJSON( data.meta ).uuid : null;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tdata.value = null;\n\n\t\t}\n\n\t\tdata.inputType = this.inputType;\n\t\tdata.outputType = this.outputType;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tlet value = null;\n\n\t\tif ( data.value !== null ) {\n\n\t\t\tif ( data.inputType === 'ArrayBuffer' ) {\n\n\t\t\t\tvalue = base64ToArrayBuffer( data.value );\n\n\t\t\t} else if ( data.inputType === 'Texture' ) {\n\n\t\t\t\tvalue = data.meta.textures[ data.value ];\n\n\t\t\t} else {\n\n\t\t\t\tvalue = data.meta.nodes[ data.value ] || null;\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.value = value;\n\n\t\tthis.inputType = data.inputType;\n\t\tthis.outputType = data.outputType;\n\n\t}\n\n}\n\nexport default ScriptableValueNode;\n\nexport const scriptableValue = nodeProxy( ScriptableValueNode );\n\naddNodeElement( 'scriptableValue', scriptableValue );\n\naddNodeClass( 'ScriptableValueNode', ScriptableValueNode );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { scriptableValue } from './ScriptableValueNode.js';\nimport { addNodeElement, nodeProxy, float } from '../shadernode/ShaderNode.js';\n\nclass Resources extends Map {\n\n\tget( key, callback = null, ...params ) {\n\n\t\tif ( this.has( key ) ) return super.get( key );\n\n\t\tif ( callback !== null ) {\n\n\t\t\tconst value = callback( ...params );\n\t\t\tthis.set( key, value );\n\t\t\treturn value;\n\n\t\t}\n\n\t}\n\n}\n\nclass Parameters {\n\n\tconstructor( scriptableNode ) {\n\n\t\tthis.scriptableNode = scriptableNode;\n\n\t}\n\n\tget parameters() {\n\n\t\treturn this.scriptableNode.parameters;\n\n\t}\n\n\tget layout() {\n\n\t\treturn this.scriptableNode.getLayout();\n\n\t}\n\n\tgetInputLayout( id ) {\n\n\t\treturn this.scriptableNode.getInputLayout( id );\n\n\t}\n\n\tget( name ) {\n\n\t\tconst param = this.parameters[ name ];\n\t\tconst value = param ? param.getValue() : null;\n\n\t\treturn value;\n\n\t}\n\n}\n\nexport const global = new Resources();\n\nclass ScriptableNode extends Node {\n\n\tconstructor( codeNode = null, parameters = {} ) {\n\n\t\tsuper();\n\n\t\tthis.codeNode = codeNode;\n\t\tthis.parameters = parameters;\n\n\t\tthis._local = new Resources();\n\t\tthis._output = scriptableValue();\n\t\tthis._outputs = {};\n\t\tthis._source = this.source;\n\t\tthis._method = null;\n\t\tthis._object = null;\n\t\tthis._value = null;\n\t\tthis._needsOutputUpdate = true;\n\n\t\tthis.onRefresh = this.onRefresh.bind( this );\n\n\t\tthis.isScriptableNode = true;\n\n\t}\n\n\tget source() {\n\n\t\treturn this.codeNode ? this.codeNode.code : '';\n\n\t}\n\n\tsetLocal( name, value ) {\n\n\t\treturn this._local.set( name, value );\n\n\t}\n\n\tgetLocal( name ) {\n\n\t\treturn this._local.get( name );\n\n\t}\n\n\tonRefresh() {\n\n\t\tthis._refresh();\n\n\t}\n\n\tgetInputLayout( id ) {\n\n\t\tfor ( const element of this.getLayout() ) {\n\n\t\t\tif ( element.inputType && ( element.id === id || element.name === id ) ) {\n\n\t\t\t\treturn element;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tgetOutputLayout( id ) {\n\n\t\tfor ( const element of this.getLayout() ) {\n\n\t\t\tif ( element.outputType && ( element.id === id || element.name === id ) ) {\n\n\t\t\t\treturn element;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tsetOutput( name, value ) {\n\n\t\tconst outputs = this._outputs;\n\n\t\tif ( outputs[ name ] === undefined ) {\n\n\t\t\toutputs[ name ] = scriptableValue( value );\n\n\t\t} else {\n\n\t\t\toutputs[ name ].value = value;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetOutput( name ) {\n\n\t\treturn this._outputs[ name ];\n\n\t}\n\n\tgetParameter( name ) {\n\n\t\treturn this.parameters[ name ];\n\n\t}\n\n\tsetParameter( name, value ) {\n\n\t\tconst parameters = this.parameters;\n\n\t\tif ( value && value.isScriptableNode ) {\n\n\t\t\tthis.deleteParameter( name );\n\n\t\t\tparameters[ name ] = value;\n\t\t\tparameters[ name ].getDefaultOutput().events.addEventListener( 'refresh', this.onRefresh );\n\n\t\t} else if ( value && value.isScriptableValueNode ) {\n\n\t\t\tthis.deleteParameter( name );\n\n\t\t\tparameters[ name ] = value;\n\t\t\tparameters[ name ].events.addEventListener( 'refresh', this.onRefresh );\n\n\t\t} else if ( parameters[ name ] === undefined ) {\n\n\t\t\tparameters[ name ] = scriptableValue( value );\n\t\t\tparameters[ name ].events.addEventListener( 'refresh', this.onRefresh );\n\n\t\t} else {\n\n\t\t\tparameters[ name ].value = value;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetValue() {\n\n\t\treturn this.getDefaultOutput().getValue();\n\n\t}\n\n\tdeleteParameter( name ) {\n\n\t\tlet valueNode = this.parameters[ name ];\n\n\t\tif ( valueNode ) {\n\n\t\t\tif ( valueNode.isScriptableNode ) valueNode = valueNode.getDefaultOutput();\n\n\t\t\tvalueNode.events.removeEventListener( 'refresh', this.onRefresh );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclearParameters() {\n\n\t\tfor ( const name of Object.keys( this.parameters ) ) {\n\n\t\t\tthis.deleteParameter( name );\n\n\t\t}\n\n\t\tthis.needsUpdate = true;\n\n\t\treturn this;\n\n\t}\n\n\tcall( name, ...params ) {\n\n\t\tconst object = this.getObject();\n\t\tconst method = object[ name ];\n\n\t\tif ( typeof method === 'function' ) {\n\n\t\t\treturn method( ...params );\n\n\t\t}\n\n\t}\n\n\tasync callAsync( name, ...params ) {\n\n\t\tconst object = this.getObject();\n\t\tconst method = object[ name ];\n\n\t\tif ( typeof method === 'function' ) {\n\n\t\t\treturn method.constructor.name === 'AsyncFunction' ? await method( ...params ) : method( ...params );\n\n\t\t}\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.getDefaultOutputNode().getNodeType( builder );\n\n\t}\n\n\trefresh( output = null ) {\n\n\t\tif ( output !== null ) {\n\n\t\t\tthis.getOutput( output ).refresh();\n\n\t\t} else {\n\n\t\t\tthis._refresh();\n\n\t\t}\n\n\t}\n\n\tgetObject() {\n\n\t\tif ( this.needsUpdate ) this.dispose();\n\t\tif ( this._object !== null ) return this._object;\n\n\t\t//\n\n\t\tconst refresh = () => this.refresh();\n\t\tconst setOutput = ( id, value ) => this.setOutput( id, value );\n\n\t\tconst parameters = new Parameters( this );\n\n\t\tconst THREE = global.get( 'THREE' );\n\t\tconst TSL = global.get( 'TSL' );\n\n\t\tconst method = this.getMethod( this.codeNode );\n\t\tconst params = [ parameters, this._local, global, refresh, setOutput, THREE, TSL ];\n\n\t\tthis._object = method( ...params );\n\n\t\tconst layout = this._object.layout;\n\n\t\tif ( layout ) {\n\n\t\t\tif ( layout.cache === false ) {\n\n\t\t\t\tthis._local.clear();\n\n\t\t\t}\n\n\t\t\t// default output\n\t\t\tthis._output.outputType = layout.outputType || null;\n\n\t\t\tif ( Array.isArray( layout.elements ) ) {\n\n\t\t\t\tfor ( const element of layout.elements ) {\n\n\t\t\t\t\tconst id = element.id || element.name;\n\n\t\t\t\t\tif ( element.inputType ) {\n\n\t\t\t\t\t\tif ( this.getParameter( id ) === undefined ) this.setParameter( id, null );\n\n\t\t\t\t\t\tthis.getParameter( id ).inputType = element.inputType;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( element.outputType ) {\n\n\t\t\t\t\t\tif ( this.getOutput( id ) === undefined ) this.setOutput( id, null );\n\n\t\t\t\t\t\tthis.getOutput( id ).outputType = element.outputType;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this._object;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tfor ( const name in this.parameters ) {\n\n\t\t\tlet valueNode = this.parameters[ name ];\n\n\t\t\tif ( valueNode.isScriptableNode ) valueNode = valueNode.getDefaultOutput();\n\n\t\t\tvalueNode.events.addEventListener( 'refresh', this.onRefresh );\n\n\t\t}\n\n\t}\n\n\tgetLayout() {\n\n\t\treturn this.getObject().layout;\n\n\t}\n\n\tgetDefaultOutputNode() {\n\n\t\tconst output = this.getDefaultOutput().value;\n\n\t\tif ( output && output.isNode ) {\n\n\t\t\treturn output;\n\n\t\t}\n\n\t\treturn float();\n\n\t}\n\n\tgetDefaultOutput()\t{\n\n\t\treturn this._exec()._output;\n\n\t}\n\n\tgetMethod() {\n\n\t\tif ( this.needsUpdate ) this.dispose();\n\t\tif ( this._method !== null ) return this._method;\n\n\t\t//\n\n\t\tconst parametersProps = [ 'parameters', 'local', 'global', 'refresh', 'setOutput', 'THREE', 'TSL' ];\n\t\tconst interfaceProps = [ 'layout', 'init', 'main', 'dispose' ];\n\n\t\tconst properties = interfaceProps.join( ', ' );\n\t\tconst declarations = 'var ' + properties + '; var output = {};\\n';\n\t\tconst returns = '\\nreturn { ...output, ' + properties + ' };';\n\n\t\tconst code = declarations + this.codeNode.code + returns;\n\n\t\t//\n\n\t\tthis._method = new Function( ...parametersProps, code );\n\n\t\treturn this._method;\n\n\t}\n\n\tdispose() {\n\n\t\tif ( this._method === null ) return;\n\n\t\tif ( this._object && typeof this._object.dispose === 'function' ) {\n\n\t\t\tthis._object.dispose();\n\n\t\t}\n\n\t\tthis._method = null;\n\t\tthis._object = null;\n\t\tthis._source = null;\n\t\tthis._value = null;\n\t\tthis._needsOutputUpdate = true;\n\t\tthis._output.value = null;\n\t\tthis._outputs = {};\n\n\t}\n\n\tsetup() {\n\n\t\treturn this.getDefaultOutputNode();\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.dispose();\n\n\t}\n\n\tget needsUpdate() {\n\n\t\treturn this.source !== this._source;\n\n\t}\n\n\t_exec()\t{\n\n\t\tif ( this.codeNode === null ) return this;\n\n\t\tif ( this._needsOutputUpdate === true ) {\n\n\t\t\tthis._value = this.call( 'main' );\n\n\t\t\tthis._needsOutputUpdate = false;\n\n\t\t}\n\n\t\tthis._output.value = this._value;\n\n\t\treturn this;\n\n\t}\n\n\t_refresh() {\n\n\t\tthis.needsUpdate = true;\n\n\t\tthis._exec();\n\n\t\tthis._output.refresh();\n\n\t}\n\n}\n\nexport default ScriptableNode;\n\nexport const scriptable = nodeProxy( ScriptableNode );\n\naddNodeElement( 'scriptable', scriptable );\n\naddNodeClass( 'ScriptableNode', ScriptableNode );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { positionView } from '../accessors/PositionNode.js';\nimport { addNodeElement, nodeProxy } from '../shadernode/ShaderNode.js';\n\nclass FogNode extends Node {\n\n\tconstructor( colorNode, factorNode ) {\n\n\t\tsuper( 'float' );\n\n\t\tthis.isFogNode = true;\n\n\t\tthis.colorNode = colorNode;\n\t\tthis.factorNode = factorNode;\n\n\t}\n\n\tgetViewZNode( builder ) {\n\n\t\tlet viewZ;\n\n\t\tconst getViewZ = builder.context.getViewZ;\n\n\t\tif ( getViewZ !== undefined ) {\n\n\t\t\tviewZ = getViewZ( this );\n\n\t\t}\n\n\t\treturn ( viewZ || positionView.z ).negate();\n\n\t}\n\n\tsetup() {\n\n\t\treturn this.factorNode;\n\n\t}\n\n}\n\nexport default FogNode;\n\nexport const fog = nodeProxy( FogNode );\n\naddNodeElement( 'fog', fog );\n\naddNodeClass( 'FogNode', FogNode );\n","import FogNode from './FogNode.js';\nimport { smoothstep } from '../math/MathNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { addNodeElement, nodeProxy } from '../shadernode/ShaderNode.js';\n\nclass FogRangeNode extends FogNode {\n\n\tconstructor( colorNode, nearNode, farNode ) {\n\n\t\tsuper( colorNode );\n\n\t\tthis.isFogRangeNode = true;\n\n\t\tthis.nearNode = nearNode;\n\t\tthis.farNode = farNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst viewZ = this.getViewZNode( builder );\n\n\t\treturn smoothstep( this.nearNode, this.farNode, viewZ );\n\n\t}\n\n}\n\nexport default FogRangeNode;\n\nexport const rangeFog = nodeProxy( FogRangeNode );\n\naddNodeElement( 'rangeFog', rangeFog );\n\naddNodeClass( 'FogRangeNode', FogRangeNode );\n","import FogNode from './FogNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { addNodeElement, nodeProxy } from '../shadernode/ShaderNode.js';\n\nclass FogExp2Node extends FogNode {\n\n\tconstructor( colorNode, densityNode ) {\n\n\t\tsuper( colorNode );\n\n\t\tthis.isFogExp2Node = true;\n\n\t\tthis.densityNode = densityNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst viewZ = this.getViewZNode( builder );\n\t\tconst density = this.densityNode;\n\n\t\treturn density.mul( density, viewZ, viewZ ).negate().exp().oneMinus();\n\n\t}\n\n}\n\nexport default FogExp2Node;\n\nexport const densityFog = nodeProxy( FogExp2Node );\n\naddNodeElement( 'densityFog', densityFog );\n\naddNodeClass( 'FogExp2Node', FogExp2Node );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { getValueType } from '../core/NodeUtils.js';\nimport { buffer } from '../accessors/BufferNode.js';\nimport { instancedBufferAttribute } from '../accessors/BufferAttributeNode.js';\nimport { instanceIndex } from '../core/IndexNode.js';\nimport { nodeProxy, float } from '../shadernode/ShaderNode.js';\n\nimport { Vector4, MathUtils, InstancedBufferAttribute } from 'three';\n\nlet min = null;\nlet max = null;\n\nclass RangeNode extends Node {\n\n\tconstructor( minNode = float(), maxNode = float() ) {\n\n\t\tsuper();\n\n\t\tthis.minNode = minNode;\n\t\tthis.maxNode = maxNode;\n\n\t}\n\n\tgetVectorLength( builder ) {\n\n\t\tconst minLength = builder.getTypeLength( getValueType( this.minNode.value ) );\n\t\tconst maxLength = builder.getTypeLength( getValueType( this.maxNode.value ) );\n\n\t\treturn minLength > maxLength ? minLength : maxLength;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn builder.object.count > 1 ? builder.getTypeFromLength( this.getVectorLength( builder ) ) : 'float';\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst object = builder.object;\n\n\t\tlet output = null;\n\n\t\tif ( object.count > 1 ) {\n\n\t\t\tconst minValue = this.minNode.value;\n\t\t\tconst maxValue = this.maxNode.value;\n\n\t\t\tconst minLength = builder.getTypeLength( getValueType( minValue ) );\n\t\t\tconst maxLength = builder.getTypeLength( getValueType( maxValue ) );\n\n\t\t\tmin = min || new Vector4();\n\t\t\tmax = max || new Vector4();\n\n\t\t\tmin.setScalar( 0 );\n\t\t\tmax.setScalar( 0 );\n\n\t\t\tif ( minLength === 1 ) min.setScalar( minValue );\n\t\t\telse if ( minValue.isColor ) min.set( minValue.r, minValue.g, minValue.b );\n\t\t\telse min.set( minValue.x, minValue.y, minValue.z || 0, minValue.w || 0 );\n\n\t\t\tif ( maxLength === 1 ) max.setScalar( maxValue );\n\t\t\telse if ( maxValue.isColor ) max.set( maxValue.r, maxValue.g, maxValue.b );\n\t\t\telse max.set( maxValue.x, maxValue.y, maxValue.z || 0, maxValue.w || 0 );\n\n\t\t\tconst stride = 4;\n\n\t\t\tconst length = stride * object.count;\n\t\t\tconst array = new Float32Array( length );\n\n\t\t\tfor ( let i = 0; i < length; i ++ ) {\n\n\t\t\t\tconst index = i % stride;\n\n\t\t\t\tconst minElementValue = min.getComponent( index );\n\t\t\t\tconst maxElementValue = max.getComponent( index );\n\n\t\t\t\tarray[ i ] = MathUtils.lerp( minElementValue, maxElementValue, Math.random() );\n\n\t\t\t}\n\n\t\t\tconst nodeType = this.getNodeType( builder );\n\n\t\t\tif ( object.count <= 4096 ) {\n\n\t\t\t\toutput = buffer( array, 'vec4', object.count ).element( instanceIndex ).convert( nodeType );\n\n\t\t\t} else {\n\n\t\t\t\t// TODO: Improve anonymous buffer attribute creation removing this part\n\t\t\t\tconst bufferAttribute = new InstancedBufferAttribute( array, 4 );\n\t\t\t\tbuilder.geometry.setAttribute( '__range' + this.id, bufferAttribute );\n\n\t\t\t\toutput = instancedBufferAttribute( bufferAttribute ).convert( nodeType );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\toutput = float( 0 );\n\n\t\t}\n\n\t\treturn output;\n\n\t}\n\n}\n\nexport default RangeNode;\n\nexport const range = nodeProxy( RangeNode );\n\naddNodeClass( 'RangeNode', RangeNode );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { addNodeElement, nodeObject } from '../shadernode/ShaderNode.js';\n\nclass ComputeNode extends Node {\n\n\tconstructor( computeNode, count, workgroupSize = [ 64 ] ) {\n\n\t\tsuper( 'void' );\n\n\t\tthis.isComputeNode = true;\n\n\t\tthis.computeNode = computeNode;\n\n\t\tthis.count = count;\n\t\tthis.workgroupSize = workgroupSize;\n\t\tthis.dispatchCount = 0;\n\n\t\tthis.version = 1;\n\t\tthis.updateBeforeType = NodeUpdateType.OBJECT;\n\n\t\tthis.updateDispatchCount();\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n\tupdateDispatchCount() {\n\n\t\tconst { count, workgroupSize } = this;\n\n\t\tlet size = workgroupSize[ 0 ];\n\n\t\tfor ( let i = 1; i < workgroupSize.length; i ++ )\n\t\t\tsize *= workgroupSize[ i ];\n\n\t\tthis.dispatchCount = Math.ceil( count / size );\n\n\t}\n\n\tonInit() { }\n\n\tupdateBefore( { renderer } ) {\n\n\t\trenderer.compute( this );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst { shaderStage } = builder;\n\n\t\tif ( shaderStage === 'compute' ) {\n\n\t\t\tconst snippet = this.computeNode.build( builder, 'void' );\n\n\t\t\tif ( snippet !== '' ) {\n\n\t\t\t\tbuilder.addLineFlowCode( snippet );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nexport default ComputeNode;\n\nexport const compute = ( node, count, workgroupSize ) => nodeObject( new ComputeNode( nodeObject( node ), count, workgroupSize ) );\n\naddNodeElement( 'compute', compute );\n\naddNodeClass( 'ComputeNode', ComputeNode );\n","import Node, { addNodeClass } from '../core/Node.js';\nimport { nodeProxy } from '../shadernode/ShaderNode.js';\nimport { objectPosition } from '../accessors/Object3DNode.js';\nimport { cameraViewMatrix } from '../accessors/CameraNode.js';\n\nclass LightNode extends Node {\n\n\tconstructor( scope = LightNode.TARGET_DIRECTION, light = null ) {\n\n\t\tsuper();\n\n\t\tthis.scope = scope;\n\t\tthis.light = light;\n\n\t}\n\n\tsetup() {\n\n\t\tconst { scope, light } = this;\n\n\t\tlet output = null;\n\n\t\tif ( scope === LightNode.TARGET_DIRECTION ) {\n\n\t\t\toutput = cameraViewMatrix.transformDirection( objectPosition( light ).sub( objectPosition( light.target ) ) );\n\n\t\t}\n\n\t\treturn output;\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.scope = this.scope;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.scope = data.scope;\n\n\t}\n\n}\n\nLightNode.TARGET_DIRECTION = 'targetDirection';\n\nexport default LightNode;\n\nexport const lightTargetDirection = nodeProxy( LightNode, LightNode.TARGET_DIRECTION );\n\naddNodeClass( 'LightNode', LightNode );\n","import { tslFn } from '../shadernode/ShaderNode.js';\n\nexport const getDistanceAttenuation = tslFn( ( inputs ) => {\n\n\tconst { lightDistance, cutoffDistance, decayExponent } = inputs;\n\n\t// based upon Frostbite 3 Moving to Physically-based Rendering\n\t// page 32, equation 26: E[window1]\n\t// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\n\tconst distanceFalloff = lightDistance.pow( decayExponent ).max( 0.01 ).reciprocal();\n\n\treturn cutoffDistance.greaterThan( 0 ).cond(\n\t\tdistanceFalloff.mul( lightDistance.div( cutoffDistance ).pow4().oneMinus().clamp().pow2() ),\n\t\tdistanceFalloff\n\t);\n\n} ); // validated\n","import AnalyticLightNode from './AnalyticLightNode.js';\nimport { addLightNode } from './LightsNode.js';\nimport { getDistanceAttenuation } from './LightUtils.js';\nimport { uniform } from '../core/UniformNode.js';\nimport { objectViewPosition } from '../accessors/Object3DNode.js';\nimport { positionView } from '../accessors/PositionNode.js';\nimport { addNodeClass } from '../core/Node.js';\n\nimport { PointLight } from 'three';\n\nclass PointLightNode extends AnalyticLightNode {\n\n\tconstructor( light = null ) {\n\n\t\tsuper( light );\n\n\t\tthis.cutoffDistanceNode = uniform( 0 );\n\t\tthis.decayExponentNode = uniform( 0 );\n\n\t}\n\n\tupdate( frame ) {\n\n\t\tconst { light } = this;\n\n\t\tsuper.update( frame );\n\n\t\tthis.cutoffDistanceNode.value = light.distance;\n\t\tthis.decayExponentNode.value = light.decay;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst { colorNode, cutoffDistanceNode, decayExponentNode, light } = this;\n\n\t\tconst lightingModel = builder.context.lightingModel;\n\n\t\tconst lVector = objectViewPosition( light ).sub( positionView ); // @TODO: Add it into LightNode\n\n\t\tconst lightDirection = lVector.normalize();\n\t\tconst lightDistance = lVector.length();\n\n\t\tconst lightAttenuation = getDistanceAttenuation( {\n\t\t\tlightDistance,\n\t\t\tcutoffDistance: cutoffDistanceNode,\n\t\t\tdecayExponent: decayExponentNode\n\t\t} );\n\n\t\tconst lightColor = colorNode.mul( lightAttenuation );\n\n\t\tconst reflectedLight = builder.context.reflectedLight;\n\n\t\tlightingModel.direct( {\n\t\t\tlightDirection,\n\t\t\tlightColor,\n\t\t\treflectedLight,\n\t\t\tshadowMask: this.shadowMaskNode\n\t\t}, builder.stack, builder );\n\n\t}\n\n}\n\nexport default PointLightNode;\n\naddNodeClass( 'PointLightNode', PointLightNode );\n\naddLightNode( PointLight, PointLightNode );\n","import AnalyticLightNode from './AnalyticLightNode.js';\nimport { lightTargetDirection } from './LightNode.js';\nimport { addLightNode } from './LightsNode.js';\nimport { addNodeClass } from '../core/Node.js';\n\nimport { DirectionalLight } from 'three';\n\nclass DirectionalLightNode extends AnalyticLightNode {\n\n\tconstructor( light = null ) {\n\n\t\tsuper( light );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tsuper.setup( builder );\n\n\t\tconst lightingModel = builder.context.lightingModel;\n\n\t\tconst lightColor = this.colorNode;\n\t\tconst lightDirection = lightTargetDirection( this.light );\n\t\tconst reflectedLight = builder.context.reflectedLight;\n\n\t\tlightingModel.direct( {\n\t\t\tlightDirection,\n\t\t\tlightColor,\n\t\t\treflectedLight,\n\t\t\tshadowMask: this.shadowMaskNode\n\t\t}, builder.stack, builder );\n\n\t}\n\n}\n\nexport default DirectionalLightNode;\n\naddNodeClass( 'DirectionalLightNode', DirectionalLightNode );\n\naddLightNode( DirectionalLight, DirectionalLightNode );\n","import AnalyticLightNode from './AnalyticLightNode.js';\nimport { addLightNode } from './LightsNode.js';\nimport { texture } from '../accessors/TextureNode.js';\nimport { uniform } from '../core/UniformNode.js';\nimport { objectViewPosition } from '../accessors/Object3DNode.js';\nimport { addNodeClass } from '../core/Node.js';\n\nimport { RectAreaLight, Matrix4, Vector3, UniformsLib } from 'three';\n\nconst _matrix41 = new Matrix4();\nconst _matrix42 = new Matrix4();\nlet ltc_1, ltc_2;\n\nclass RectAreaLightNode extends AnalyticLightNode {\n\n\tconstructor( light = null ) {\n\n\t\tsuper( light );\n\n\t\tthis.halfHeight = uniform( new Vector3() );\n\t\tthis.halfWidth = uniform( new Vector3() );\n\n\t}\n\n\tupdate( frame ) {\n\n\t\tsuper.update( frame );\n\n\t\tconst { light } = this;\n\n\t\tconst viewMatrix = frame.camera.matrixWorldInverse;\n\n\t\t_matrix42.identity();\n\t\t_matrix41.copy( light.matrixWorld );\n\t\t_matrix41.premultiply( viewMatrix );\n\t\t_matrix42.extractRotation( _matrix41 );\n\n\t\tthis.halfWidth.value.set( light.width * 0.5, 0.0, 0.0 );\n\t\tthis.halfHeight.value.set( 0.0, light.height * 0.5, 0.0 );\n\n\t\tthis.halfWidth.value.applyMatrix4( _matrix42 );\n\t\tthis.halfHeight.value.applyMatrix4( _matrix42 );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tsuper.setup( builder );\n\n\t\tif ( ltc_1 === undefined ) {\n\n\t\t\tif ( builder.isAvailable( 'float32Filterable' ) ) {\n\n\t\t\t\tltc_1 = texture( UniformsLib.LTC_FLOAT_1 );\n\t\t\t\tltc_2 = texture( UniformsLib.LTC_FLOAT_2 );\n\n\t\t\t} else {\n\n\t\t\t\tltc_1 = texture( UniformsLib.LTC_HALF_1 );\n\t\t\t\tltc_2 = texture( UniformsLib.LTC_HALF_2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst { colorNode, light } = this;\n\t\tconst lightingModel = builder.context.lightingModel;\n\n\t\tconst lightPosition = objectViewPosition( light );\n\t\tconst reflectedLight = builder.context.reflectedLight;\n\n\t\tlightingModel.directRectArea( {\n\t\t\tlightColor: colorNode,\n\t\t\tlightPosition,\n\t\t\thalfWidth: this.halfWidth,\n\t\t\thalfHeight: this.halfHeight,\n\t\t\treflectedLight,\n\t\t\tltc_1,\n\t\t\tltc_2\n\t\t}, builder.stack, builder );\n\n\t}\n\n}\n\nexport default RectAreaLightNode;\n\naddNodeClass( 'RectAreaLightNode', RectAreaLightNode );\n\naddLightNode( RectAreaLight, RectAreaLightNode );\n","import AnalyticLightNode from './AnalyticLightNode.js';\nimport { lightTargetDirection } from './LightNode.js';\nimport { addLightNode } from './LightsNode.js';\nimport { getDistanceAttenuation } from './LightUtils.js';\nimport { uniform } from '../core/UniformNode.js';\nimport { smoothstep } from '../math/MathNode.js';\nimport { objectViewPosition } from '../accessors/Object3DNode.js';\nimport { positionView } from '../accessors/PositionNode.js';\nimport { addNodeClass } from '../core/Node.js';\n\nimport { SpotLight } from 'three';\n\nclass SpotLightNode extends AnalyticLightNode {\n\n\tconstructor( light = null ) {\n\n\t\tsuper( light );\n\n\t\tthis.coneCosNode = uniform( 0 );\n\t\tthis.penumbraCosNode = uniform( 0 );\n\n\t\tthis.cutoffDistanceNode = uniform( 0 );\n\t\tthis.decayExponentNode = uniform( 0 );\n\n\t}\n\n\tupdate( frame ) {\n\n\t\tsuper.update( frame );\n\n\t\tconst { light } = this;\n\n\t\tthis.coneCosNode.value = Math.cos( light.angle );\n\t\tthis.penumbraCosNode.value = Math.cos( light.angle * ( 1 - light.penumbra ) );\n\n\t\tthis.cutoffDistanceNode.value = light.distance;\n\t\tthis.decayExponentNode.value = light.decay;\n\n\t}\n\n\tgetSpotAttenuation( angleCosine ) {\n\n\t\tconst { coneCosNode, penumbraCosNode } = this;\n\n\t\treturn smoothstep( coneCosNode, penumbraCosNode, angleCosine );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tsuper.setup( builder );\n\n\t\tconst lightingModel = builder.context.lightingModel;\n\n\t\tconst { colorNode, cutoffDistanceNode, decayExponentNode, light } = this;\n\n\t\tconst lVector = objectViewPosition( light ).sub( positionView ); // @TODO: Add it into LightNode\n\n\t\tconst lightDirection = lVector.normalize();\n\t\tconst angleCos = lightDirection.dot( lightTargetDirection( light ) );\n\t\tconst spotAttenuation = this.getSpotAttenuation( angleCos );\n\n\t\tconst lightDistance = lVector.length();\n\n\t\tconst lightAttenuation = getDistanceAttenuation( {\n\t\t\tlightDistance,\n\t\t\tcutoffDistance: cutoffDistanceNode,\n\t\t\tdecayExponent: decayExponentNode\n\t\t} );\n\n\t\tconst lightColor = colorNode.mul( spotAttenuation ).mul( lightAttenuation );\n\n\t\tconst reflectedLight = builder.context.reflectedLight;\n\n\t\tlightingModel.direct( {\n\t\t\tlightDirection,\n\t\t\tlightColor,\n\t\t\treflectedLight,\n\t\t\tshadowMask: this.shadowMaskNode\n\t\t}, builder.stack, builder );\n\n\t}\n\n}\n\nexport default SpotLightNode;\n\naddNodeClass( 'SpotLightNode', SpotLightNode );\n\naddLightNode( SpotLight, SpotLightNode );\n","import { SpotLight } from 'three';\n\nclass IESSpotLight extends SpotLight {\n\n\tconstructor( color, intensity, distance, angle, penumbra, decay ) {\n\n\t\tsuper( color, intensity, distance, angle, penumbra, decay );\n\n\t\tthis.iesMap = null;\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.iesMap = source.iesMap;\n\n\t\treturn this;\n\n\t}\n\n}\n\nexport default IESSpotLight;\n","import SpotLightNode from './SpotLightNode.js';\nimport { addLightNode } from './LightsNode.js';\nimport { texture } from '../accessors/TextureNode.js';\nimport { vec2 } from '../shadernode/ShaderNode.js';\nimport { addNodeClass } from '../core/Node.js';\n\nimport IESSpotLight from '../../lights/IESSpotLight.js';\n\nclass IESSpotLightNode extends SpotLightNode {\n\n\tgetSpotAttenuation( angleCosine ) {\n\n\t\tconst iesMap = this.light.iesMap;\n\n\t\tlet spotAttenuation = null;\n\n\t\tif ( iesMap && iesMap.isTexture === true ) {\n\n\t\t\tconst angle = angleCosine.acos().mul( 1.0 / Math.PI );\n\n\t\t\tspotAttenuation = texture( iesMap, vec2( angle, 0 ), 0 ).r;\n\n\t\t} else {\n\n\t\t\tspotAttenuation = super.getSpotAttenuation( angleCosine );\n\n\t\t}\n\n\t\treturn spotAttenuation;\n\n\t}\n\n}\n\nexport default IESSpotLightNode;\n\naddNodeClass( 'IESSpotLightNode', IESSpotLightNode );\n\naddLightNode( IESSpotLight, IESSpotLightNode );\n","import AnalyticLightNode from './AnalyticLightNode.js';\nimport { addLightNode } from './LightsNode.js';\nimport { addNodeClass } from '../core/Node.js';\n\nimport { AmbientLight } from 'three';\n\nclass AmbientLightNode extends AnalyticLightNode {\n\n\tconstructor( light = null ) {\n\n\t\tsuper( light );\n\n\t}\n\n\tsetup( { context } ) {\n\n\t\tcontext.irradiance.addAssign( this.colorNode );\n\n\t}\n\n}\n\nexport default AmbientLightNode;\n\naddNodeClass( 'AmbientLightNode', AmbientLightNode );\n\naddLightNode( AmbientLight, AmbientLightNode );\n","import AnalyticLightNode from './AnalyticLightNode.js';\nimport { addLightNode } from './LightsNode.js';\nimport { uniform } from '../core/UniformNode.js';\nimport { mix } from '../math/MathNode.js';\nimport { normalView } from '../accessors/NormalNode.js';\nimport { objectPosition } from '../accessors/Object3DNode.js';\nimport { addNodeClass } from '../core/Node.js';\n\nimport { Color, HemisphereLight } from 'three';\n\nclass HemisphereLightNode extends AnalyticLightNode {\n\n\tconstructor( light = null ) {\n\n\t\tsuper( light );\n\n\t\tthis.lightPositionNode = objectPosition( light );\n\t\tthis.lightDirectionNode = this.lightPositionNode.normalize();\n\n\t\tthis.groundColorNode = uniform( new Color() );\n\n\t}\n\n\tupdate( frame ) {\n\n\t\tconst { light } = this;\n\n\t\tsuper.update( frame );\n\n\t\tthis.lightPositionNode.object3d = light;\n\n\t\tthis.groundColorNode.value.copy( light.groundColor ).multiplyScalar( light.intensity );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst { colorNode, groundColorNode, lightDirectionNode } = this;\n\n\t\tconst dotNL = normalView.dot( lightDirectionNode );\n\t\tconst hemiDiffuseWeight = dotNL.mul( 0.5 ).add( 0.5 );\n\n\t\tconst irradiance = mix( groundColorNode, colorNode, hemiDiffuseWeight );\n\n\t\tbuilder.context.irradiance.addAssign( irradiance );\n\n\t}\n\n}\n\nexport default HemisphereLightNode;\n\naddNodeClass( 'HemisphereLightNode', HemisphereLightNode );\n\naddLightNode( HemisphereLight, HemisphereLightNode );\n","import TempNode from '../core/TempNode.js';\nimport { uv } from '../accessors/UVNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { addNodeElement, tslFn, nodeProxy } from '../shadernode/ShaderNode.js';\n\nconst checkerShaderNode = tslFn( ( inputs ) => {\n\n\tconst uv = inputs.uv.mul( 2.0 );\n\n\tconst cx = uv.x.floor();\n\tconst cy = uv.y.floor();\n\tconst result = cx.add( cy ).mod( 2.0 );\n\n\treturn result.sign();\n\n} );\n\nclass CheckerNode extends TempNode {\n\n\tconstructor( uvNode = uv() ) {\n\n\t\tsuper( 'float' );\n\n\t\tthis.uvNode = uvNode;\n\n\t}\n\n\tsetup() {\n\n\t\treturn checkerShaderNode( { uv: this.uvNode } );\n\n\t}\n\n}\n\nexport default CheckerNode;\n\nexport const checker = nodeProxy( CheckerNode );\n\naddNodeElement( 'checker', checker );\n\naddNodeClass( 'CheckerNode', CheckerNode );\n","import NodeMaterial, { addNodeMaterial } from './NodeMaterial.js';\nimport { varying } from '../core/VaryingNode.js';\nimport { property } from '../core/PropertyNode.js';\nimport { attribute } from '../core/AttributeNode.js';\nimport { cameraProjectionMatrix } from '../accessors/CameraNode.js';\nimport { materialColor, materialPointWidth } from '../accessors/MaterialNode.js'; // or should this be a property, instead?\nimport { modelViewMatrix } from '../accessors/ModelNode.js';\nimport { positionGeometry } from '../accessors/PositionNode.js';\nimport { smoothstep } from '../math/MathNode.js';\nimport { tslFn, vec2, vec4 } from '../shadernode/ShaderNode.js';\nimport { uv } from '../accessors/UVNode.js';\nimport { viewport } from '../display/ViewportNode.js';\n\nimport { PointsMaterial } from 'three';\n\nconst defaultValues = new PointsMaterial();\n\nclass InstancedPointsNodeMaterial extends NodeMaterial {\n\n\tconstructor( params = {} ) {\n\n\t\tsuper();\n\n\t\tthis.normals = false;\n\n\t\tthis.lights = false;\n\n\t\tthis.useAlphaToCoverage = true;\n\n\t\tthis.useColor = params.vertexColors;\n\n\t\tthis.pointWidth = 1;\n\n\t\tthis.pointColorNode = null;\n\n\t\tthis.setDefaultValues( defaultValues );\n\n\t\tthis.setupShaders();\n\n\t\tthis.setValues( params );\n\n\t}\n\n\tsetupShaders() {\n\n\t\tconst useAlphaToCoverage = this.alphaToCoverage;\n\t\tconst useColor = this.useColor;\n\n\t\tthis.vertexNode = tslFn( () => {\n\n\t\t\t//vUv = uv;\n\t\t\tvarying( vec2(), 'vUv' ).assign( uv() ); // @TODO: Analyze other way to do this\n\n\t\t\tconst instancePosition = attribute( 'instancePosition' );\n\n\t\t\t// camera space\n\t\t\tconst mvPos = property( 'vec4', 'mvPos' );\n\t\t\tmvPos.assign( modelViewMatrix.mul( vec4( instancePosition, 1.0 ) ) );\n\n\t\t\tconst aspect = viewport.z.div( viewport.w );\n\n\t\t\t// clip space\n\t\t\tconst clipPos = cameraProjectionMatrix.mul( mvPos );\n\n\t\t\t// offset in ndc space\n\t\t\tconst offset = property( 'vec2', 'offset' );\n\t\t\toffset.assign( positionGeometry.xy );\n\t\t\toffset.assign( offset.mul( materialPointWidth ) );\n\t\t\toffset.assign( offset.div( viewport.z ) );\n\t\t\toffset.y.assign( offset.y.mul( aspect ) );\n\n\t\t\t// back to clip space\n\t\t\toffset.assign( offset.mul( clipPos.w ) );\n\n\t\t\t//clipPos.xy += offset;\n\t\t\tclipPos.assign( clipPos.add( vec4( offset, 0, 0 ) ) );\n\n\t\t\treturn clipPos;\n\n\t\t\t//vec4 mvPosition = mvPos; // this was used for somethihng...\n\n\t\t} )();\n\n\t\tthis.fragmentNode = tslFn( () => {\n\n\t\t\tconst vUv = varying( vec2(), 'vUv' );\n\n\t\t\t// force assignment into correct place in flow\n\t\t\tconst alpha = property( 'float', 'alpha' );\n\t\t\talpha.assign( 1 );\n\n\t\t\tconst a = vUv.x;\n\t\t\tconst b = vUv.y;\n\n\t\t\tconst len2 = a.mul( a ).add( b.mul( b ) );\n\n\t\t\tif ( useAlphaToCoverage ) {\n\n\t\t\t\t// force assignment out of following 'if' statement - to avoid uniform control flow errors\n\t\t\t\tconst dlen = property( 'float', 'dlen' );\n\t\t\t\tdlen.assign( len2.fwidth() );\n\n\t\t\t\talpha.assign( smoothstep( dlen.oneMinus(), dlen.add( 1 ), len2 ).oneMinus() );\n\n\t\t\t} else {\n\n\t\t\t\tlen2.greaterThan( 1.0 ).discard();\n\n\t\t\t}\n\n\t\t\tlet pointColorNode;\n\n\t\t\tif ( this.pointColorNode ) {\n\n\t\t\t\tpointColorNode = this.pointColorNode;\n\n\t\t\t} else {\n\n\t\t\t\tif ( useColor ) {\n\n\t\t\t\t\tconst instanceColor = attribute( 'instanceColor' );\n\n\t\t\t\t\tpointColorNode = instanceColor.mul( materialColor );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tpointColorNode = materialColor;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn vec4( pointColorNode, alpha );\n\n\t\t} )();\n\n\t\tthis.needsUpdate = true;\n\n\t}\n\n\tget alphaToCoverage() {\n\n\t\treturn this.useAlphaToCoverage;\n\n\t}\n\n\tset alphaToCoverage( value ) {\n\n\t\tif ( this.useAlphaToCoverage !== value ) {\n\n\t\t\tthis.useAlphaToCoverage = value;\n\t\t\tthis.setupShaders();\n\n\t\t}\n\n\t}\n\n}\n\nexport default InstancedPointsNodeMaterial;\n\naddNodeMaterial( 'InstancedPointsNodeMaterial', InstancedPointsNodeMaterial );\n","import NodeMaterial, { addNodeMaterial } from './NodeMaterial.js';\n\nimport { LineBasicMaterial } from 'three';\n\nconst defaultValues = new LineBasicMaterial();\n\nclass LineBasicNodeMaterial extends NodeMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isLineBasicNodeMaterial = true;\n\n\t\tthis.lights = false;\n\t\tthis.normals = false;\n\n\t\tthis.setDefaultValues( defaultValues );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n}\n\nexport default LineBasicNodeMaterial;\n\naddNodeMaterial( 'LineBasicNodeMaterial', LineBasicNodeMaterial );\n","import NodeMaterial, { addNodeMaterial } from './NodeMaterial.js';\nimport { attribute } from '../core/AttributeNode.js';\nimport { varying } from '../core/VaryingNode.js';\nimport { materialLineDashSize, materialLineGapSize, materialLineScale } from '../accessors/MaterialNode.js';\nimport { dashSize, gapSize } from '../core/PropertyNode.js';\nimport { float } from '../shadernode/ShaderNode.js';\nimport { LineDashedMaterial } from 'three';\n\nconst defaultValues = new LineDashedMaterial();\n\nclass LineDashedNodeMaterial extends NodeMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isLineDashedNodeMaterial = true;\n\n\t\tthis.lights = false;\n\t\tthis.normals = false;\n\n\t\tthis.setDefaultValues( defaultValues );\n\n\t\tthis.offsetNode = null;\n\t\tthis.dashScaleNode = null;\n\t\tthis.dashSizeNode = null;\n\t\tthis.gapSizeNode = null;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupVariants() {\n\n\t\tconst offsetNode = this.offsetNode;\n\t\tconst dashScaleNode = this.dashScaleNode ? float( this.dashScaleNode ) : materialLineScale;\n\t\tconst dashSizeNode = this.dashSizeNode ? float( this.dashSizeNode ) : materialLineDashSize;\n\t\tconst gapSizeNode = this.dashSizeNode ? float( this.dashGapNode ) : materialLineGapSize;\n\n\t\tdashSize.assign( dashSizeNode );\n\t\tgapSize.assign( gapSizeNode );\n\n\t\tconst vLineDistance = varying( attribute( 'lineDistance' ).mul( dashScaleNode ) );\n\t\tconst vLineDistanceOffset = offsetNode ? vLineDistance.add( offsetNode ) : vLineDistance;\n\n\t\tvLineDistanceOffset.mod( dashSize.add( gapSize ) ).greaterThan( dashSize ).discard();\n\n\t}\n\n}\n\nexport default LineDashedNodeMaterial;\n\naddNodeMaterial( 'LineDashedNodeMaterial', LineDashedNodeMaterial );\n","import NodeMaterial, { addNodeMaterial } from './NodeMaterial.js';\nimport { temp } from '../core/VarNode.js';\nimport { varying } from '../core/VaryingNode.js';\nimport { property, varyingProperty } from '../core/PropertyNode.js';\nimport { attribute } from '../core/AttributeNode.js';\nimport { cameraProjectionMatrix } from '../accessors/CameraNode.js';\nimport { materialColor, materialLineScale, materialLineDashSize, materialLineGapSize, materialLineDashOffset, materialLineWidth } from '../accessors/MaterialNode.js';\nimport { modelViewMatrix } from '../accessors/ModelNode.js';\nimport { positionGeometry } from '../accessors/PositionNode.js';\nimport { mix, smoothstep } from '../math/MathNode.js';\nimport { tslFn, float, vec2, vec3, vec4, If } from '../shadernode/ShaderNode.js';\nimport { uv } from '../accessors/UVNode.js';\nimport { viewport } from '../display/ViewportNode.js';\nimport { dashSize, gapSize } from '../core/PropertyNode.js';\n\nimport { LineDashedMaterial } from 'three';\n\nconst defaultValues = new LineDashedMaterial();\n\nclass Line2NodeMaterial extends NodeMaterial {\n\n\tconstructor( params = {} ) {\n\n\t\tsuper();\n\n\t\tthis.normals = false;\n\t\tthis.lights = false;\n\n\t\tthis.setDefaultValues( defaultValues );\n\n\t\tthis.useAlphaToCoverage = true;\n\t\tthis.useColor = params.vertexColors;\n\t\tthis.useDash = params.dashed;\n\t\tthis.useWorldUnits = false;\n\n\t\tthis.dashOffset = 0;\n\t\tthis.lineWidth = 1;\n\n\t\tthis.lineColorNode = null;\n\n\t\tthis.offsetNode = null;\n\t\tthis.dashScaleNode = null;\n\t\tthis.dashSizeNode = null;\n\t\tthis.gapSizeNode = null;\n\n\t\tthis.setValues( params );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tthis.setupShaders();\n\n\t\tsuper.setup( builder );\n\n\t}\n\n\tsetupShaders() {\n\n\t\tconst useAlphaToCoverage = this.alphaToCoverage;\n\t\tconst useColor = this.useColor;\n\t\tconst useDash = this.dashed;\n\t\tconst useWorldUnits = this.worldUnits;\n\n\t\tconst trimSegment = tslFn( ( { start, end } ) => {\n\n\t\t\tconst a = cameraProjectionMatrix.element( 2 ).element( 2 ); // 3nd entry in 3th column\n\t\t\tconst b = cameraProjectionMatrix.element( 3 ).element( 2 ); // 3nd entry in 4th column\n\t\t\tconst nearEstimate = b.mul( - 0.5 ).div( a );\n\n\t\t\tconst alpha = nearEstimate.sub( start.z ).div( end.z.sub( start.z ) );\n\n\t\t\treturn vec4( mix( start.xyz, end.xyz, alpha ), end.w );\n\n\t\t} );\n\n\t\tthis.vertexNode = tslFn( () => {\n\n\t\t\tvaryingProperty( 'vec2', 'vUv' ).assign( uv() );\n\n\t\t\tconst instanceStart = attribute( 'instanceStart' );\n\t\t\tconst instanceEnd = attribute( 'instanceEnd' );\n\n\t\t\t// camera space\n\n\t\t\tconst start = property( 'vec4', 'start' );\n\t\t\tconst end = property( 'vec4', 'end' );\n\n\t\t\tstart.assign( modelViewMatrix.mul( vec4( instanceStart, 1.0 ) ) ); // force assignment into correct place in flow\n\t\t\tend.assign( modelViewMatrix.mul( vec4( instanceEnd, 1.0 ) ) );\n\n\t\t\tif ( useWorldUnits ) {\n\n\t\t\t\tvaryingProperty( 'vec3', 'worldStart' ).assign( start.xyz );\n\t\t\t\tvaryingProperty( 'vec3', 'worldEnd' ).assign( end.xyz );\n\n\t\t\t}\n\n\t\t\tconst aspect = viewport.z.div( viewport.w );\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tconst perspective = cameraProjectionMatrix.element( 2 ).element( 3 ).equal( - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tIf( perspective, () => {\n\n\t\t\t\tIf( start.z.lessThan( 0.0 ).and( end.z.greaterThan( 0.0 ) ), () => {\n\n\t\t\t\t\tend.assign( trimSegment( { start: start, end: end } ) );\n\n\t\t\t\t} ).elseif( end.z.lessThan( 0.0 ).and( start.z.greaterThanEqual( 0.0 ) ), () => {\n\n\t\t\t\t\tstart.assign( trimSegment( { start: end, end: start } ) );\n\n\t\t\t \t} );\n\n\t\t\t} );\n\n\t\t\t// clip space\n\t\t\tconst clipStart = cameraProjectionMatrix.mul( start );\n\t\t\tconst clipEnd = cameraProjectionMatrix.mul( end );\n\n\t\t\t// ndc space\n\t\t\tconst ndcStart = clipStart.xyz.div( clipStart.w );\n\t\t\tconst ndcEnd = clipEnd.xyz.div( clipEnd.w );\n\n\t\t\t// direction\n\t\t\tconst dir = ndcEnd.xy.sub( ndcStart.xy ).temp();\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x.assign( dir.x.mul( aspect ) );\n\t\t\tdir.assign( dir.normalize() );\n\n\t\t\tconst clip = temp( vec4() );\n\n\t\t\tif ( useWorldUnits ) {\n\n\t\t\t\t// get the offset direction as perpendicular to the view vector\n\n\t\t\t\tconst worldDir = end.xyz.sub( start.xyz ).normalize();\n\t\t\t\tconst tmpFwd = mix( start.xyz, end.xyz, 0.5 ).normalize();\n\t\t\t\tconst worldUp = worldDir.cross( tmpFwd ).normalize();\n\t\t\t\tconst worldFwd = worldDir.cross( worldUp );\n\n\t\t\t\tconst worldPos = varyingProperty( 'vec4', 'worldPos' );\n\n\t\t\t\tworldPos.assign( positionGeometry.y.lessThan( 0.5 ).cond( start, end ) );\n\n\t\t\t\t// height offset\n\t\t\t\tconst hw = materialLineWidth.mul( 0.5 );\n\t\t\t\tworldPos.addAssign( vec4( positionGeometry.x.lessThan( 0.0 ).cond( worldUp.mul( hw ), worldUp.mul( hw ).negate() ), 0 ) );\n\n\t\t\t\t// don't extend the line if we're rendering dashes because we\n\t\t\t\t// won't be rendering the endcaps\n\t\t\t\tif ( ! useDash ) {\n\n\t\t\t\t\t// cap extension\n\t\t\t\t\tworldPos.addAssign( vec4( positionGeometry.y.lessThan( 0.5 ).cond( worldDir.mul( hw ).negate(), worldDir.mul( hw ) ), 0 ) );\n\n\t\t\t\t\t// add width to the box\n\t\t\t\t\tworldPos.addAssign( vec4( worldFwd.mul( hw ), 0 ) );\n\n\t\t\t\t\t// endcaps\n\t\t\t\t\tIf( positionGeometry.y.greaterThan( 1.0 ).or( positionGeometry.y.lessThan( 0.0 ) ), () => {\n\n\t\t\t\t\t\tworldPos.subAssign( vec4( worldFwd.mul( 2.0 ).mul( hw ), 0 ) );\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t\t// project the worldpos\n\t\t\t\tclip.assign( cameraProjectionMatrix.mul( worldPos ) );\n\n\t\t\t\t// shift the depth of the projected points so the line\n\t\t\t\t// segments overlap neatly\n\t\t\t\tconst clipPose = temp( vec3() );\n\n\t\t\t\tclipPose.assign( positionGeometry.y.lessThan( 0.5 ).cond( ndcStart, ndcEnd ) );\n\t\t\t\tclip.z.assign( clipPose.z.mul( clip.w ) );\n\n\t\t\t} else {\n\n\t\t\t\tconst offset = property( 'vec2', 'offset' );\n\n\t\t\t\toffset.assign( vec2( dir.y, dir.x.negate() ) );\n\n\t\t\t\t// undo aspect ratio adjustment\n\t\t\t\tdir.x.assign( dir.x.div( aspect ) );\n\t\t\t\toffset.x.assign( offset.x.div( aspect ) );\n\n\t\t\t\t// sign flip\n\t\t\t\toffset.assign( positionGeometry.x.lessThan( 0.0 ).cond( offset.negate(), offset ) );\n\n\t\t\t\t// endcaps\n\t\t\t\tIf( positionGeometry.y.lessThan( 0.0 ), () => {\n\n\t\t\t\t\toffset.assign( offset.sub( dir ) );\n\n\t\t\t\t} ).elseif( positionGeometry.y.greaterThan( 1.0 ), () => {\n\n\t\t\t\t\toffset.assign( offset.add( dir ) );\n\n\t\t\t\t} );\n\n\t\t\t\t// adjust for linewidth\n\t\t\t\toffset.assign( offset.mul( materialLineWidth ) );\n\n\t\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\t\toffset.assign( offset.div( viewport.w ) );\n\n\t\t\t\t// select end\n\t\t\t\tclip.assign( positionGeometry.y.lessThan( 0.5 ).cond( clipStart, clipEnd ) );\n\n\t\t\t\t// back to clip space\n\t\t\t\toffset.assign( offset.mul( clip.w ) );\n\n\t\t\t\tclip.assign( clip.add( vec4( offset, 0, 0 ) ) );\n\n\t\t\t}\n\n\t\t\treturn clip;\n\n\t\t} )();\n\n\t\tconst closestLineToLine = tslFn( ( { p1, p2, p3, p4 } ) => {\n\n\t\t\tconst p13 = p1.sub( p3 );\n\t\t\tconst p43 = p4.sub( p3 );\n\n\t\t\tconst p21 = p2.sub( p1 );\n\n\t\t\tconst d1343 = p13.dot( p43 );\n\t\t\tconst d4321 = p43.dot( p21 );\n\t\t\tconst d1321 = p13.dot( p21 );\n\t\t\tconst d4343 = p43.dot( p43 );\n\t\t\tconst d2121 = p21.dot( p21 );\n\n\t\t\tconst denom = d2121.mul( d4343 ).sub( d4321.mul( d4321 ) );\n\t\t\tconst numer = d1343.mul( d4321 ).sub( d1321.mul( d4343 ) );\n\n\t\t\tconst mua = numer.div( denom ).clamp();\n\t\t\tconst mub = d1343.add( d4321.mul( mua ) ).div( d4343 ).clamp();\n\n\t\t\treturn vec2( mua, mub );\n\n\t\t} );\n\n\t\tthis.fragmentNode = tslFn( () => {\n\n\t\t\tconst vUv = varyingProperty( 'vec2', 'vUv' );\n\n\t\t\tif ( useDash ) {\n\n\t\t\t\tconst offsetNode = this.offsetNode ? float( this.offsetNodeNode ) : materialLineDashOffset;\n\t\t\t\tconst dashScaleNode = this.dashScaleNode ? float( this.dashScaleNode ) : materialLineScale;\n\t\t\t\tconst dashSizeNode = this.dashSizeNode ? float( this.dashSizeNode ) : materialLineDashSize;\n\t\t\t\tconst gapSizeNode = this.dashSizeNode ? float( this.dashGapNode ) : materialLineGapSize;\n\n\t\t\t\tdashSize.assign( dashSizeNode );\n\t\t\t\tgapSize.assign( gapSizeNode );\n\n\t\t\t\tconst instanceDistanceStart = attribute( 'instanceDistanceStart' );\n\t\t\t\tconst instanceDistanceEnd = attribute( 'instanceDistanceEnd' );\n\n\t\t\t\tconst lineDistance = positionGeometry.y.lessThan( 0.5 ).cond( dashScaleNode.mul( instanceDistanceStart ), materialLineScale.mul( instanceDistanceEnd ) );\n\n\t\t\t\tconst vLineDistance = varying( lineDistance.add( materialLineDashOffset ) );\n\t\t\t\tconst vLineDistanceOffset = offsetNode ? vLineDistance.add( offsetNode ) : vLineDistance;\n\n\t\t\t\tvUv.y.lessThan( - 1.0 ).or( vUv.y.greaterThan( 1.0 ) ).discard(); // discard endcaps\n\t\t\t\tvLineDistanceOffset.mod( dashSize.add( gapSize ) ).greaterThan( dashSize ).discard(); // todo - FIX\n\n\t\t\t}\n\n\t\t\t // force assignment into correct place in flow\n\t\t\tconst alpha = property( 'float', 'alpha' );\n\t\t\talpha.assign( 1 );\n\n\t\t\tif ( useWorldUnits ) {\n\n\t\t\t\tconst worldStart = varyingProperty( 'vec3', 'worldStart' );\n\t\t\t\tconst worldEnd = varyingProperty( 'vec3', 'worldEnd' );\n\n\t\t\t\t// Find the closest points on the view ray and the line segment\n\t\t\t\tconst rayEnd = varyingProperty( 'vec4', 'worldPos' ).xyz.normalize().mul( 1e5 );\n\t\t\t\tconst lineDir = worldEnd.sub( worldStart );\n\t\t\t\tconst params = closestLineToLine( { p1: worldStart, p2: worldEnd, p3: vec3( 0.0, 0.0, 0.0 ), p4: rayEnd } );\n\n\t\t\t\tconst p1 = worldStart.add( lineDir.mul( params.x ) );\n\t\t\t\tconst p2 = rayEnd.mul( params.y );\n\t\t\t\tconst delta = p1.sub( p2 );\n\t\t\t\tconst len = delta.length();\n\t\t\t\tconst norm = len.div( materialLineWidth );\n\n\t\t\t\tif ( ! useDash ) {\n\n\t\t\t\t\tif ( useAlphaToCoverage ) {\n\n\t\t\t\t\t\tconst dnorm = norm.fwidth();\n\t\t\t\t\t\talpha.assign( smoothstep( dnorm.negate().add( 0.5 ), dnorm.add( 0.5 ), norm ).oneMinus() );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tnorm.greaterThan( 0.5 ).discard();\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// round endcaps\n\n\t\t\t\tif ( useAlphaToCoverage ) {\n\n\t\t\t\t\tconst a = vUv.x;\n\t\t\t\t\tconst b = vUv.y.greaterThan( 0.0 ).cond( vUv.y.sub( 1.0 ), vUv.y.add( 1.0 ) );\n\n\t\t\t\t\tconst len2 = a.mul( a ).add( b.mul( b ) );\n\n\t\t\t\t\t// force assignment out of following 'if' statement - to avoid uniform control flow errors\n\t\t\t\t\tconst dlen = property( 'float', 'dlen' );\n\t\t\t\t\tdlen.assign( len2.fwidth() );\n\n\t\t\t\t\tIf( vUv.y.abs().greaterThan( 1.0 ), () => {\n\n\t\t\t\t\t\talpha.assign( smoothstep( dlen.oneMinus(), dlen.add( 1 ), len2 ).oneMinus() );\n\n\t\t\t\t\t} );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tIf( vUv.y.abs().greaterThan( 1.0 ), () => {\n\n\t\t\t\t\t\tconst a = vUv.x;\n\t\t\t\t\t\tconst b = vUv.y.greaterThan( 0.0 ).cond( vUv.y.sub( 1.0 ), vUv.y.add( 1.0 ) );\n\t\t\t\t\t\tconst len2 = a.mul( a ).add( b.mul( b ) );\n\n\t\t\t\t\t\tlen2.greaterThan( 1.0 ).discard();\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tlet lineColorNode;\n\n\t\t\tif ( this.lineColorNode ) {\n\n\t\t\t\tlineColorNode = this.lineColorNode;\n\n\t\t\t} else {\n\n\t\t\t\tif ( useColor ) {\n\n\t\t\t\t\tconst instanceColorStart = attribute( 'instanceColorStart' );\n\t\t\t\t\tconst instanceColorEnd = attribute( 'instanceColorEnd' );\n\n\t\t\t\t\tconst instanceColor = positionGeometry.y.lessThan( 0.5 ).cond( instanceColorStart, instanceColorEnd );\n\n\t\t\t\t\tlineColorNode = instanceColor.mul( materialColor );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tlineColorNode = materialColor;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn vec4( lineColorNode, alpha );\n\n\t\t} )();\n\n\t}\n\n\n\tget worldUnits() {\n\n\t\treturn this.useWorldUnits;\n\n\t}\n\n\tset worldUnits( value ) {\n\n\t\tif ( this.useWorldUnits !== value ) {\n\n\t\t\tthis.useWorldUnits = value;\n\t\t\tthis.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n\n\tget dashed() {\n\n\t\treturn this.useDash;\n\n\t}\n\n\tset dashed( value ) {\n\n\t\tif ( this.useDash !== value ) {\n\n\t\t\tthis.useDash = value;\n\t\t\tthis.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n\n\tget alphaToCoverage() {\n\n\t\treturn this.useAlphaToCoverage;\n\n\t}\n\n\tset alphaToCoverage( value ) {\n\n\t\tif ( this.useAlphaToCoverage !== value ) {\n\n\t\t\tthis.useAlphaToCoverage = value;\n\t\t\tthis.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n}\n\nexport default Line2NodeMaterial;\n\naddNodeMaterial( 'Line2NodeMaterial', Line2NodeMaterial );\n","import NodeMaterial, { addNodeMaterial } from './NodeMaterial.js';\nimport { diffuseColor } from '../core/PropertyNode.js';\nimport { directionToColor } from '../utils/PackingNode.js';\nimport { materialOpacity } from '../accessors/MaterialNode.js';\nimport { transformedNormalView } from '../accessors/NormalNode.js';\nimport { float, vec4 } from '../shadernode/ShaderNode.js';\n\nimport { MeshNormalMaterial } from 'three';\n\nconst defaultValues = new MeshNormalMaterial();\n\nclass MeshNormalNodeMaterial extends NodeMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.lights = false;\n\n\t\tthis.isMeshNormalNodeMaterial = true;\n\n\t\tthis.setDefaultValues( defaultValues );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupDiffuseColor() {\n\n\t\tconst opacityNode = this.opacityNode ? float( this.opacityNode ) : materialOpacity;\n\n\t\tdiffuseColor.assign( vec4( directionToColor( transformedNormalView ), opacityNode ) );\n\n\t}\n\n}\n\nexport default MeshNormalNodeMaterial;\n\naddNodeMaterial( 'MeshNormalNodeMaterial', MeshNormalNodeMaterial );\n","import NodeMaterial, { addNodeMaterial } from './NodeMaterial.js';\n\nimport { MeshBasicMaterial } from 'three';\n\nconst defaultValues = new MeshBasicMaterial();\n\nclass MeshBasicNodeMaterial extends NodeMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshBasicNodeMaterial = true;\n\n\t\tthis.lights = false;\n\t\t//this.normals = false; @TODO: normals usage by context\n\n\t\tthis.setDefaultValues( defaultValues );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n}\n\nexport default MeshBasicNodeMaterial;\n\naddNodeMaterial( 'MeshBasicNodeMaterial', MeshBasicNodeMaterial );\n","import { tslFn } from '../../shadernode/ShaderNode.js';\n\nconst F_Schlick = tslFn( ( { f0, f90, dotVH } ) => {\n\n\t// Original approximation by Christophe Schlick '94\n\t// float fresnel = pow( 1.0 - dotVH, 5.0 );\n\n\t// Optimized variant (presented by Epic at SIGGRAPH '13)\n\t// https://cdn2.unrealengine.com/Resources/files/2013SiggraphPresentationsNotes-26915738.pdf\n\tconst fresnel = dotVH.mul( - 5.55473 ).sub( 6.98316 ).mul( dotVH ).exp2();\n\n\treturn f0.mul( fresnel.oneMinus() ).add( f90.mul( fresnel ) );\n\n} ); // validated\n\nexport default F_Schlick;\n","import { tslFn } from '../../shadernode/ShaderNode.js';\n\nconst BRDF_Lambert = tslFn( ( inputs ) => {\n\n\treturn inputs.diffuseColor.mul( 1 / Math.PI ); // punctual light\n\n} ); // validated\n\nexport default BRDF_Lambert;\n","import LightingModel from '../core/LightingModel.js';\nimport F_Schlick from './BSDF/F_Schlick.js';\nimport BRDF_Lambert from './BSDF/BRDF_Lambert.js';\nimport { diffuseColor } from '../core/PropertyNode.js';\nimport { transformedNormalView } from '../accessors/NormalNode.js';\nimport { materialSpecularStrength } from '../accessors/MaterialNode.js';\nimport { shininess, specularColor } from '../core/PropertyNode.js';\nimport { positionViewDirection } from '../accessors/PositionNode.js';\nimport { tslFn, float } from '../shadernode/ShaderNode.js';\n\nconst G_BlinnPhong_Implicit = () => float( 0.25 );\n\nconst D_BlinnPhong = tslFn( ( { dotNH } ) => {\n\n\treturn shininess.mul( float( 0.5 ) ).add( 1.0 ).mul( float( 1 / Math.PI ) ).mul( dotNH.pow( shininess ) );\n\n} );\n\nconst BRDF_BlinnPhong = tslFn( ( { lightDirection } ) => {\n\n\tconst halfDir = lightDirection.add( positionViewDirection ).normalize();\n\n\tconst dotNH = transformedNormalView.dot( halfDir ).clamp();\n\tconst dotVH = positionViewDirection.dot( halfDir ).clamp();\n\n\tconst F = F_Schlick( { f0: specularColor, f90: 1.0, dotVH } );\n\tconst G = G_BlinnPhong_Implicit();\n\tconst D = D_BlinnPhong( { dotNH } );\n\n\treturn F.mul( G ).mul( D );\n\n} );\n\nclass PhongLightingModel extends LightingModel {\n\n\tconstructor( specular = true ) {\n\n\t\tsuper();\n\n\t\tthis.specular = specular;\n\n\t}\n\n\tdirect( { lightDirection, lightColor, reflectedLight } ) {\n\n\t\tconst dotNL = transformedNormalView.dot( lightDirection ).clamp();\n\t\tconst irradiance = dotNL.mul( lightColor );\n\n\t\treflectedLight.directDiffuse.addAssign( irradiance.mul( BRDF_Lambert( { diffuseColor: diffuseColor.rgb } ) ) );\n\n\t\tif ( this.specular === true ) {\n\n\t\t\treflectedLight.directSpecular.addAssign( irradiance.mul( BRDF_BlinnPhong( { lightDirection } ) ).mul( materialSpecularStrength ) );\n\n\t\t}\n\n\t}\n\n\tindirectDiffuse( { irradiance, reflectedLight } ) {\n\n\t\treflectedLight.indirectDiffuse.addAssign( irradiance.mul( BRDF_Lambert( { diffuseColor } ) ) );\n\n\t}\n\n}\n\nexport default PhongLightingModel;\n","import NodeMaterial, { addNodeMaterial } from './NodeMaterial.js';\nimport PhongLightingModel from '../functions/PhongLightingModel.js';\n\nimport { MeshLambertMaterial } from 'three';\n\nconst defaultValues = new MeshLambertMaterial();\n\nclass MeshLambertNodeMaterial extends NodeMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshLambertNodeMaterial = true;\n\n\t\tthis.lights = true;\n\n\t\tthis.setDefaultValues( defaultValues );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupLightingModel( /*builder*/ ) {\n\n\t\treturn new PhongLightingModel( false ); // ( specular ) -> force lambert\n\n\t}\n\n}\n\nexport default MeshLambertNodeMaterial;\n\naddNodeMaterial( 'MeshLambertNodeMaterial', MeshLambertNodeMaterial );\n","import NodeMaterial, { addNodeMaterial } from './NodeMaterial.js';\nimport { shininess, specularColor } from '../core/PropertyNode.js';\nimport { materialShininess, materialSpecular } from '../accessors/MaterialNode.js';\nimport { float } from '../shadernode/ShaderNode.js';\nimport PhongLightingModel from '../functions/PhongLightingModel.js';\n\nimport { MeshPhongMaterial } from 'three';\n\nconst defaultValues = new MeshPhongMaterial();\n\nclass MeshPhongNodeMaterial extends NodeMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshPhongNodeMaterial = true;\n\n\t\tthis.lights = true;\n\n\t\tthis.shininessNode = null;\n\t\tthis.specularNode = null;\n\n\t\tthis.setDefaultValues( defaultValues );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupLightingModel( /*builder*/ ) {\n\n\t\treturn new PhongLightingModel();\n\n\t}\n\n\tsetupVariants() {\n\n\t\t// SHININESS\n\n\t\tconst shininessNode = ( this.shininessNode ? float( this.shininessNode ) : materialShininess ).max( 1e-4 ); // to prevent pow( 0.0, 0.0 )\n\n\t\tshininess.assign( shininessNode );\n\n\t\t// SPECULAR COLOR\n\n\t\tconst specularNode = this.specularNode || materialSpecular;\n\n\t\tspecularColor.assign( specularNode );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.shininessNode = source.shininessNode;\n\t\tthis.specularNode = source.specularNode;\n\n\t\treturn super.copy( source );\n\n\t}\n\n}\n\nexport default MeshPhongNodeMaterial;\n\naddNodeMaterial( 'MeshPhongNodeMaterial', MeshPhongNodeMaterial );\n","import { normalGeometry } from '../../accessors/NormalNode.js';\nimport { tslFn } from '../../shadernode/ShaderNode.js';\n\nconst getGeometryRoughness = tslFn( () => {\n\n\tconst dxy = normalGeometry.dFdx().abs().max( normalGeometry.dFdy().abs() );\n\tconst geometryRoughness = dxy.x.max( dxy.y ).max( dxy.z );\n\n\treturn geometryRoughness;\n\n} );\n\nexport default getGeometryRoughness;\n","import getGeometryRoughness from './getGeometryRoughness.js';\nimport { tslFn } from '../../shadernode/ShaderNode.js';\n\nconst getRoughness = tslFn( ( inputs ) => {\n\n\tconst { roughness } = inputs;\n\n\tconst geometryRoughness = getGeometryRoughness();\n\n\tlet roughnessFactor = roughness.max( 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.\n\troughnessFactor = roughnessFactor.add( geometryRoughness );\n\troughnessFactor = roughnessFactor.min( 1.0 );\n\n\treturn roughnessFactor;\n\n} );\n\nexport default getRoughness;\n","import { div } from '../../math/OperatorNode.js';\nimport { EPSILON } from '../../math/MathNode.js';\nimport { tslFn } from '../../shadernode/ShaderNode.js';\n\n// Moving Frostbite to Physically Based Rendering 3.0 - page 12, listing 2\n// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\nconst V_GGX_SmithCorrelated = tslFn( ( { alpha, dotNL, dotNV } ) => {\n\n\tconst a2 = alpha.pow2();\n\n\tconst gv = dotNL.mul( a2.add( a2.oneMinus().mul( dotNV.pow2() ) ).sqrt() );\n\tconst gl = dotNV.mul( a2.add( a2.oneMinus().mul( dotNL.pow2() ) ).sqrt() );\n\n\treturn div( 0.5, gv.add( gl ).max( EPSILON ) );\n\n} ).setLayout( {\n\tname: 'V_GGX_SmithCorrelated',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'alpha', type: 'float' },\n\t\t{ name: 'dotNL', type: 'float' },\n\t\t{ name: 'dotNV', type: 'float' }\n\t]\n} ); // validated\n\nexport default V_GGX_SmithCorrelated;\n","import { div } from '../../math/OperatorNode.js';\nimport { tslFn, vec3 } from '../../shadernode/ShaderNode.js';\n\n// https://google.github.io/filament/Filament.md.html#materialsystem/anisotropicmodel/anisotropicspecularbrdf\n\nconst V_GGX_SmithCorrelated_Anisotropic = tslFn( ( { alphaT, alphaB, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL } ) => {\n\n\tconst gv = dotNL.mul( vec3( alphaT.mul( dotTV ), alphaB.mul( dotBV ), dotNV ).length() );\n\tconst gl = dotNV.mul( vec3( alphaT.mul( dotTL ), alphaB.mul( dotBL ), dotNL ).length() );\n\tconst v = div( 0.5, gv.add( gl ) );\n\n\treturn v.saturate();\n\n} ).setLayout( {\n\tname: 'V_GGX_SmithCorrelated_Anisotropic',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'alphaT', type: 'float', qualifier: 'in' },\n\t\t{ name: 'alphaB', type: 'float', qualifier: 'in' },\n\t\t{ name: 'dotTV', type: 'float', qualifier: 'in' },\n\t\t{ name: 'dotBV', type: 'float', qualifier: 'in' },\n\t\t{ name: 'dotTL', type: 'float', qualifier: 'in' },\n\t\t{ name: 'dotBL', type: 'float', qualifier: 'in' },\n\t\t{ name: 'dotNV', type: 'float', qualifier: 'in' },\n\t\t{ name: 'dotNL', type: 'float', qualifier: 'in' }\n\t]\n} );\n\nexport default V_GGX_SmithCorrelated_Anisotropic;\n","import { tslFn } from '../../shadernode/ShaderNode.js';\n\n// Microfacet Models for Refraction through Rough Surfaces - equation (33)\n// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html\n// alpha is \"roughness squared\" in Disney’s reparameterization\nconst D_GGX = tslFn( ( { alpha, dotNH } ) => {\n\n\tconst a2 = alpha.pow2();\n\n\tconst denom = dotNH.pow2().mul( a2.oneMinus() ).oneMinus(); // avoid alpha = 0 with dotNH = 1\n\n\treturn a2.div( denom.pow2() ).mul( 1 / Math.PI );\n\n} ).setLayout( {\n\tname: 'D_GGX',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'alpha', type: 'float' },\n\t\t{ name: 'dotNH', type: 'float' }\n\t]\n} ); // validated\n\nexport default D_GGX;\n","import { tslFn, float, vec3 } from '../../shadernode/ShaderNode.js';\n\nconst RECIPROCAL_PI = float( 1 / Math.PI );\n\n// https://google.github.io/filament/Filament.md.html#materialsystem/anisotropicmodel/anisotropicspecularbrdf\n\nconst D_GGX_Anisotropic = tslFn( ( { alphaT, alphaB, dotNH, dotTH, dotBH } ) => {\n\n\tconst a2 = alphaT.mul( alphaB );\n\tconst v = vec3( alphaB.mul( dotTH ), alphaT.mul( dotBH ), a2.mul( dotNH ) );\n\tconst v2 = v.dot( v );\n\tconst w2 = a2.div( v2 );\n\n\treturn RECIPROCAL_PI.mul( a2.mul( w2.pow2() ) );\n\n} ).setLayout( {\n\tname: 'D_GGX_Anisotropic',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'alphaT', type: 'float', qualifier: 'in' },\n\t\t{ name: 'alphaB', type: 'float', qualifier: 'in' },\n\t\t{ name: 'dotNH', type: 'float', qualifier: 'in' },\n\t\t{ name: 'dotTH', type: 'float', qualifier: 'in' },\n\t\t{ name: 'dotBH', type: 'float', qualifier: 'in' }\n\t]\n} );\n\nexport default D_GGX_Anisotropic;\n","import F_Schlick from './F_Schlick.js';\nimport V_GGX_SmithCorrelated from './V_GGX_SmithCorrelated.js';\nimport V_GGX_SmithCorrelated_Anisotropic from './V_GGX_SmithCorrelated_Anisotropic.js';\nimport D_GGX from './D_GGX.js';\nimport D_GGX_Anisotropic from './D_GGX_Anisotropic.js';\nimport { transformedNormalView } from '../../accessors/NormalNode.js';\nimport { positionViewDirection } from '../../accessors/PositionNode.js';\nimport { iridescence, alphaT, anisotropyT, anisotropyB } from '../../core/PropertyNode.js';\nimport { tslFn, defined } from '../../shadernode/ShaderNode.js';\n\n// GGX Distribution, Schlick Fresnel, GGX_SmithCorrelated Visibility\nconst BRDF_GGX = tslFn( ( inputs ) => {\n\n\tconst { lightDirection, f0, f90, roughness, f, USE_IRIDESCENCE, USE_ANISOTROPY } = inputs;\n\n\tconst normalView = inputs.normalView || transformedNormalView;\n\n\tconst alpha = roughness.pow2(); // UE4's roughness\n\n\tconst halfDir = lightDirection.add( positionViewDirection ).normalize();\n\n\tconst dotNL = normalView.dot( lightDirection ).clamp();\n\tconst dotNV = normalView.dot( positionViewDirection ).clamp(); // @ TODO: Move to core dotNV\n\tconst dotNH = normalView.dot( halfDir ).clamp();\n\tconst dotVH = positionViewDirection.dot( halfDir ).clamp();\n\n\tlet F = F_Schlick( { f0, f90, dotVH } );\n\tlet V, D;\n\n\tif ( defined( USE_IRIDESCENCE ) ) {\n\n\t\tF = iridescence.mix( F, f );\n\n\t}\n\n\tif ( defined( USE_ANISOTROPY ) ) {\n\n\t\tconst dotTL = anisotropyT.dot( lightDirection );\n\t\tconst dotTV = anisotropyT.dot( positionViewDirection );\n\t\tconst dotTH = anisotropyT.dot( halfDir );\n\t\tconst dotBL = anisotropyB.dot( lightDirection );\n\t\tconst dotBV = anisotropyB.dot( positionViewDirection );\n\t\tconst dotBH = anisotropyB.dot( halfDir );\n\n\t\tV = V_GGX_SmithCorrelated_Anisotropic( { alphaT, alphaB: alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL } );\n\t\tD = D_GGX_Anisotropic( { alphaT, alphaB: alpha, dotNH, dotTH, dotBH } );\n\n\t} else {\n\n\t\tV = V_GGX_SmithCorrelated( { alpha, dotNL, dotNV } );\n\t\tD = D_GGX( { alpha, dotNH } );\n\n\t}\n\n\treturn F.mul( V ).mul( D );\n\n} ); // validated\n\nexport default BRDF_GGX;\n","import { tslFn, vec2, vec4 } from '../../shadernode/ShaderNode.js';\n\n// Analytical approximation of the DFG LUT, one half of the\n// split-sum approximation used in indirect specular lighting.\n// via 'environmentBRDF' from \"Physically Based Shading on Mobile\"\n// https://www.unrealengine.com/blog/physically-based-shading-on-mobile\nconst DFGApprox = tslFn( ( { roughness, dotNV } ) => {\n\n\tconst c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\n\tconst c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\n\tconst r = roughness.mul( c0 ).add( c1 );\n\n\tconst a004 = r.x.mul( r.x ).min( dotNV.mul( - 9.28 ).exp2() ).mul( r.x ).add( r.y );\n\n\tconst fab = vec2( - 1.04, 1.04 ).mul( a004 ).add( r.zw );\n\n\treturn fab;\n\n} ).setLayout( {\n\tname: 'DFGApprox',\n\ttype: 'vec2',\n\tinputs: [\n\t\t{ name: 'roughness', type: 'float' },\n\t\t{ name: 'dotNV', type: 'vec3' }\n\t]\n} );\n\nexport default DFGApprox;\n","import DFGApprox from './DFGApprox.js';\nimport { tslFn } from '../../shadernode/ShaderNode.js';\n\nconst EnvironmentBRDF = tslFn( ( inputs ) => {\n\n\tconst { dotNV, specularColor, specularF90, roughness } = inputs;\n\n\tconst fab = DFGApprox( { dotNV, roughness } );\n\treturn specularColor.mul( fab.x ).add( specularF90.mul( fab.y ) );\n\n} );\n\nexport default EnvironmentBRDF;\n","import { tslFn, vec3 } from '../../shadernode/ShaderNode.js';\n\nconst Schlick_to_F0 = tslFn( ( { f, f90, dotVH } ) => {\n\n\tconst x = dotVH.oneMinus().saturate();\n\tconst x2 = x.mul( x );\n\tconst x5 = x.mul( x2, x2 ).clamp( 0, .9999 );\n\n\treturn f.sub( vec3( f90 ).mul( x5 ) ).div( x5.oneMinus() );\n\n} ).setLayout( {\n\tname: 'Schlick_to_F0',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'f', type: 'vec3' },\n\t\t{ name: 'f90', type: 'float' },\n\t\t{ name: 'dotVH', type: 'float' }\n\t]\n} );\n\nexport default Schlick_to_F0;\n","import { transformedNormalView } from '../../accessors/NormalNode.js';\nimport { positionViewDirection } from '../../accessors/PositionNode.js';\nimport { sheen, sheenRoughness } from '../../core/PropertyNode.js';\nimport { tslFn, float } from '../../shadernode/ShaderNode.js';\n\n// https://github.com/google/filament/blob/master/shaders/src/brdf.fs\nconst D_Charlie = tslFn( ( { roughness, dotNH } ) => {\n\n\tconst alpha = roughness.pow2();\n\n\t// Estevez and Kulla 2017, \"Production Friendly Microfacet Sheen BRDF\"\n\tconst invAlpha = float( 1.0 ).div( alpha );\n\tconst cos2h = dotNH.pow2();\n\tconst sin2h = cos2h.oneMinus().max( 0.0078125 ); // 2^(-14/2), so sin2h^2 > 0 in fp16\n\n\treturn float( 2.0 ).add( invAlpha ).mul( sin2h.pow( invAlpha.mul( 0.5 ) ) ).div( 2.0 * Math.PI );\n\n} ).setLayout( {\n\tname: 'D_Charlie',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'roughness', type: 'float' },\n\t\t{ name: 'dotNH', type: 'float' }\n\t]\n} );\n\n// https://github.com/google/filament/blob/master/shaders/src/brdf.fs\nconst V_Neubelt = tslFn( ( { dotNV, dotNL } ) => {\n\n\t// Neubelt and Pettineo 2013, \"Crafting a Next-gen Material Pipeline for The Order: 1886\"\n\treturn float( 1.0 ).div( float( 4.0 ).mul( dotNL.add( dotNV ).sub( dotNL.mul( dotNV ) ) ) );\n\n} ).setLayout( {\n\tname: 'V_Neubelt',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'dotNV', type: 'float' },\n\t\t{ name: 'dotNL', type: 'float' }\n\t]\n} );\n\nconst BRDF_Sheen = tslFn( ( { lightDirection } ) => {\n\n\tconst halfDir = lightDirection.add( positionViewDirection ).normalize();\n\n\tconst dotNL = transformedNormalView.dot( lightDirection ).clamp();\n\tconst dotNV = transformedNormalView.dot( positionViewDirection ).clamp();\n\tconst dotNH = transformedNormalView.dot( halfDir ).clamp();\n\n\tconst D = D_Charlie( { roughness: sheenRoughness, dotNH } );\n\tconst V = V_Neubelt( { dotNV, dotNL } );\n\n\treturn sheen.mul( D ).mul( V );\n\n} );\n\nexport default BRDF_Sheen;\n","import { tslFn, If, mat3, vec2, vec3 } from '../../shadernode/ShaderNode.js';\nimport { max } from '../../math/MathNode.js';\n\n// Rect Area Light\n\n// Real-Time Polygonal-Light Shading with Linearly Transformed Cosines\n// by Eric Heitz, Jonathan Dupuy, Stephen Hill and David Neubelt\n// code: https://github.com/selfshadow/ltc_code/\n\nconst LTC_Uv = tslFn( ( { N, V, roughness } ) => {\n\n\tconst LUT_SIZE = 64.0;\n\tconst LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst LUT_BIAS = 0.5 / LUT_SIZE;\n\n\tconst dotNV = N.dot( V ).saturate();\n\n\t// texture parameterized by sqrt( GGX alpha ) and sqrt( 1 - cos( theta ) )\n\tconst uv = vec2( roughness, dotNV.oneMinus().sqrt() );\n\n\tuv.assign( uv.mul( LUT_SCALE ).add( LUT_BIAS ) );\n\n\treturn uv;\n\n} ).setLayout( {\n\tname: 'LTC_Uv',\n\ttype: 'vec2',\n\tinputs: [\n\t\t{ name: 'N', type: 'vec3' },\n\t\t{ name: 'V', type: 'vec3' },\n\t\t{ name: 'roughness', type: 'float' }\n\t]\n} );\n\nconst LTC_ClippedSphereFormFactor = tslFn( ( { f } ) => {\n\n\t// Real-Time Area Lighting: a Journey from Research to Production (p.102)\n\t// An approximation of the form factor of a horizon-clipped rectangle.\n\n\tconst l = f.length();\n\n\treturn max( l.mul( l ).add( f.z ).div( l.add( 1.0 ) ), 0 );\n\n} ).setLayout( {\n\tname: 'LTC_ClippedSphereFormFactor',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'f', type: 'vec3' }\n\t]\n} );\n\nconst LTC_EdgeVectorFormFactor = tslFn( ( { v1, v2 } ) => {\n\n\tconst x = v1.dot( v2 );\n\tconst y = x.abs().toVar();\n\n\t// rational polynomial approximation to theta / sin( theta ) / 2PI\n\tconst a = y.mul( 0.0145206 ).add( 0.4965155 ).mul( y ).add( 0.8543985 ).toVar();\n\tconst b = y.add( 4.1616724 ).mul( y ).add( 3.4175940 ).toVar();\n\tconst v = a.div( b );\n\n\tconst theta_sintheta = x.greaterThan( 0.0 ).cond( v, max( x.mul( x ).oneMinus(), 1e-7 ).inverseSqrt().mul( 0.5 ).sub( v ) );\n\n\treturn v1.cross( v2 ).mul( theta_sintheta );\n\n} ).setLayout( {\n\tname: 'LTC_EdgeVectorFormFactor',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'v1', type: 'vec3' },\n\t\t{ name: 'v2', type: 'vec3' }\n\t]\n} );\n\nconst LTC_Evaluate = tslFn( ( { N, V, P, mInv, p0, p1, p2, p3 } ) => {\n\n\t// bail if point is on back side of plane of light\n\t// assumes ccw winding order of light vertices\n\tconst v1 = p1.sub( p0 ).toVar();\n\tconst v2 = p3.sub( p0 ).toVar();\n\n\tconst lightNormal = v1.cross( v2 );\n\tconst result = vec3().toVar();\n\n\tIf( lightNormal.dot( P.sub( p0 ) ).greaterThanEqual( 0.0 ), () => {\n\n\t\t// construct orthonormal basis around N\n\t\tconst T1 = V.sub( N.mul( V.dot( N ) ) ).normalize();\n\t\tconst T2 = N.cross( T1 ).negate(); // negated from paper; possibly due to a different handedness of world coordinate system\n\n\t\t// compute transform\n\t\tconst mat = mInv.mul( mat3( T1, T2, N ).transpose() ).toVar();\n\n\t\t// transform rect\n\t\t// & project rect onto sphere\n\t\tconst coords0 = mat.mul( p0.sub( P ) ).normalize().toVar();\n\t\tconst coords1 = mat.mul( p1.sub( P ) ).normalize().toVar();\n\t\tconst coords2 = mat.mul( p2.sub( P ) ).normalize().toVar();\n\t\tconst coords3 = mat.mul( p3.sub( P ) ).normalize().toVar();\n\n\t\t// calculate vector form factor\n\t\tconst vectorFormFactor = vec3( 0 ).toVar();\n\t\tvectorFormFactor.addAssign( LTC_EdgeVectorFormFactor( { v1: coords0, v2: coords1 } ) );\n\t\tvectorFormFactor.addAssign( LTC_EdgeVectorFormFactor( { v1: coords1, v2: coords2 } ) );\n\t\tvectorFormFactor.addAssign( LTC_EdgeVectorFormFactor( { v1: coords2, v2: coords3 } ) );\n\t\tvectorFormFactor.addAssign( LTC_EdgeVectorFormFactor( { v1: coords3, v2: coords0 } ) );\n\n\t\t// adjust for horizon clipping\n\t\tresult.assign( vec3( LTC_ClippedSphereFormFactor( { f: vectorFormFactor } ) ) );\n\n\t} );\n\n\treturn result;\n\n} ).setLayout( {\n\tname: 'LTC_Evaluate',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'N', type: 'vec3' },\n\t\t{ name: 'V', type: 'vec3' },\n\t\t{ name: 'P', type: 'vec3' },\n\t\t{ name: 'mInv', type: 'mat3' },\n\t\t{ name: 'p0', type: 'vec3' },\n\t\t{ name: 'p1', type: 'vec3' },\n\t\t{ name: 'p2', type: 'vec3' },\n\t\t{ name: 'p3', type: 'vec3' }\n\t]\n} );\n\n\nexport { LTC_Evaluate, LTC_Uv };\n","import BRDF_Lambert from './BSDF/BRDF_Lambert.js';\nimport BRDF_GGX from './BSDF/BRDF_GGX.js';\nimport DFGApprox from './BSDF/DFGApprox.js';\nimport EnvironmentBRDF from './BSDF/EnvironmentBRDF.js';\nimport F_Schlick from './BSDF/F_Schlick.js';\nimport Schlick_to_F0 from './BSDF/Schlick_to_F0.js';\nimport BRDF_Sheen from './BSDF/BRDF_Sheen.js';\nimport { LTC_Evaluate, LTC_Uv } from './BSDF/LTC.js';\nimport LightingModel from '../core/LightingModel.js';\nimport { diffuseColor, specularColor, specularF90, roughness, clearcoat, clearcoatRoughness, sheen, sheenRoughness, iridescence, iridescenceIOR, iridescenceThickness, ior, thickness, transmission, attenuationDistance, attenuationColor, dispersion } from '../core/PropertyNode.js';\nimport { transformedNormalView, transformedClearcoatNormalView, transformedNormalWorld } from '../accessors/NormalNode.js';\nimport { positionViewDirection, positionView, positionWorld } from '../accessors/PositionNode.js';\nimport { tslFn, float, vec2, vec3, vec4, mat3, If } from '../shadernode/ShaderNode.js';\nimport { cond } from '../math/CondNode.js';\nimport { mix, normalize, refract, length, clamp, log2, log, exp, smoothstep } from '../math/MathNode.js';\nimport { div } from '../math/OperatorNode.js';\nimport { cameraPosition, cameraProjectionMatrix, cameraViewMatrix } from '../accessors/CameraNode.js';\nimport { modelWorldMatrix } from '../accessors/ModelNode.js';\nimport { viewportResolution } from '../display/ViewportNode.js';\nimport { viewportMipTexture } from '../display/ViewportTextureNode.js';\nimport { loop } from '../utils/LoopNode.js';\n\n//\n// Transmission\n//\n\nconst getVolumeTransmissionRay = tslFn( ( [ n, v, thickness, ior, modelMatrix ] ) => {\n\n\t// Direction of refracted light.\n\tconst refractionVector = vec3( refract( v.negate(), normalize( n ), div( 1.0, ior ) ) );\n\n\t// Compute rotation-independant scaling of the model matrix.\n\tconst modelScale = vec3(\n\t\tlength( modelMatrix[ 0 ].xyz ),\n\t\tlength( modelMatrix[ 1 ].xyz ),\n\t\tlength( modelMatrix[ 2 ].xyz )\n\t);\n\n\t// The thickness is specified in local space.\n\treturn normalize( refractionVector ).mul( thickness.mul( modelScale ) );\n\n} ).setLayout( {\n\tname: 'getVolumeTransmissionRay',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'n', type: 'vec3' },\n\t\t{ name: 'v', type: 'vec3' },\n\t\t{ name: 'thickness', type: 'float' },\n\t\t{ name: 'ior', type: 'float' },\n\t\t{ name: 'modelMatrix', type: 'mat4' }\n\t]\n} );\n\nconst applyIorToRoughness = tslFn( ( [ roughness, ior ] ) => {\n\n\t// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and\n\t// an IOR of 1.5 results in the default amount of microfacet refraction.\n\treturn roughness.mul( clamp( ior.mul( 2.0 ).sub( 2.0 ), 0.0, 1.0 ) );\n\n} ).setLayout( {\n\tname: 'applyIorToRoughness',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'roughness', type: 'float' },\n\t\t{ name: 'ior', type: 'float' }\n\t]\n} );\n\nconst singleViewportMipTexture = viewportMipTexture();\n\nconst getTransmissionSample = tslFn( ( [ fragCoord, roughness, ior ] ) => {\n\n\tconst transmissionSample = singleViewportMipTexture.uv( fragCoord );\n\t//const transmissionSample = viewportMipTexture( fragCoord );\n\n\tconst lod = log2( float( viewportResolution.x ) ).mul( applyIorToRoughness( roughness, ior ) );\n\n\treturn transmissionSample.bicubic( lod );\n\n} );\n\nconst volumeAttenuation = tslFn( ( [ transmissionDistance, attenuationColor, attenuationDistance ] ) => {\n\n\tIf( attenuationDistance.notEqual( 0 ), () => {\n\n\t\t// Compute light attenuation using Beer's law.\n\t\tconst attenuationCoefficient = log( attenuationColor ).negate().div( attenuationDistance );\n\t\tconst transmittance = exp( attenuationCoefficient.negate().mul( transmissionDistance ) );\n\n\t\treturn transmittance;\n\n\t} );\n\n\t// Attenuation distance is +∞, i.e. the transmitted color is not attenuated at all.\n\treturn vec3( 1.0 );\n\n} ).setLayout( {\n\tname: 'volumeAttenuation',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'transmissionDistance', type: 'float' },\n\t\t{ name: 'attenuationColor', type: 'vec3' },\n\t\t{ name: 'attenuationDistance', type: 'float' }\n\t]\n} );\n\nconst getIBLVolumeRefraction = tslFn( ( [ n, v, roughness, diffuseColor, specularColor, specularF90, position, modelMatrix, viewMatrix, projMatrix, ior, thickness, attenuationColor, attenuationDistance, dispersion ] ) => {\n\n\tlet transmittedLight, transmittance;\n\n\tif ( dispersion ) {\n\n\t\ttransmittedLight = vec4().toVar();\n\t\ttransmittance = vec3().toVar();\n\n\t\tconst halfSpread = ior.sub( 1.0 ).mul( dispersion.mul( 0.025 ) );\n\t\tconst iors = vec3( ior.sub( halfSpread ), ior, ior.add( halfSpread ) );\n\n\t\tloop( { start: 0, end: 3 }, ( { i } ) => {\n\n\t\t\tconst ior = iors.element( i );\n\n\t\t\tconst transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tconst refractedRayExit = position.add( transmissionRay );\n\n\t\t\t// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.\n\t\t\tconst ndcPos = projMatrix.mul( viewMatrix.mul( vec4( refractedRayExit, 1.0 ) ) );\n\t\t\tconst refractionCoords = vec2( ndcPos.xy.div( ndcPos.w ) ).toVar();\n\t\t\trefractionCoords.addAssign( 1.0 );\n\t\t\trefractionCoords.divAssign( 2.0 );\n\t\t\trefractionCoords.assign( vec2( refractionCoords.x, refractionCoords.y.oneMinus() ) ); // webgpu\n\n\t\t\t// Sample framebuffer to get pixel the refracted ray hits.\n\t\t\tconst transmissionSample = getTransmissionSample( refractionCoords, roughness, ior );\n\n\t\t\ttransmittedLight.element( i ).assign( transmissionSample.element( i ) );\n\t\t\ttransmittedLight.a.addAssign( transmissionSample.a );\n\n\t\t\ttransmittance.element( i ).assign( diffuseColor.element( i ).mul( volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance ).element( i ) ) );\n\n\t\t} );\n\n\t\ttransmittedLight.a.divAssign( 3.0 );\n\n\t} else {\n\n\t\tconst transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tconst refractedRayExit = position.add( transmissionRay );\n\n\t\t// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.\n\t\tconst ndcPos = projMatrix.mul( viewMatrix.mul( vec4( refractedRayExit, 1.0 ) ) );\n\t\tconst refractionCoords = vec2( ndcPos.xy.div( ndcPos.w ) ).toVar();\n\t\trefractionCoords.addAssign( 1.0 );\n\t\trefractionCoords.divAssign( 2.0 );\n\t\trefractionCoords.assign( vec2( refractionCoords.x, refractionCoords.y.oneMinus() ) ); // webgpu\n\n\t\t// Sample framebuffer to get pixel the refracted ray hits.\n\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\ttransmittance = diffuseColor.mul( volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance ) );\n\n\t}\n\n\tconst attenuatedColor = transmittance.rgb.mul( transmittedLight.rgb );\n\tconst dotNV = n.dot( v ).clamp();\n\n\t// Get the specular component.\n\tconst F = vec3( EnvironmentBRDF( { // n, v, specularColor, specularF90, roughness\n\t\tdotNV,\n\t\tspecularColor,\n\t\tspecularF90,\n\t\troughness\n\t} ) );\n\n\t// As less light is transmitted, the opacity should be increased. This simple approximation does a decent job\n\t// of modulating a CSS background, and has no effect when the buffer is opaque, due to a solid object or clear color.\n\tconst transmittanceFactor = transmittance.r.add( transmittance.g, transmittance.b ).div( 3.0 );\n\n\treturn vec4( F.oneMinus().mul( attenuatedColor ), transmittedLight.a.oneMinus().mul( transmittanceFactor ).oneMinus() );\n\n} );\n\n//\n// Iridescence\n//\n\n// XYZ to linear-sRGB color space\nconst XYZ_TO_REC709 = mat3(\n\t3.2404542, - 0.9692660, 0.0556434,\n\t- 1.5371385, 1.8760108, - 0.2040259,\n\t- 0.4985314, 0.0415560, 1.0572252\n);\n\n// Assume air interface for top\n// Note: We don't handle the case fresnel0 == 1\nconst Fresnel0ToIor = ( fresnel0 ) => {\n\n\tconst sqrtF0 = fresnel0.sqrt();\n\treturn vec3( 1.0 ).add( sqrtF0 ).div( vec3( 1.0 ).sub( sqrtF0 ) );\n\n};\n\n// ior is a value between 1.0 and 3.0. 1.0 is air interface\nconst IorToFresnel0 = ( transmittedIor, incidentIor ) => {\n\n\treturn transmittedIor.sub( incidentIor ).div( transmittedIor.add( incidentIor ) ).pow2();\n\n};\n\n// Fresnel equations for dielectric/dielectric interfaces.\n// Ref: https://belcour.github.io/blog/research/2017/05/01/brdf-thin-film.html\n// Evaluation XYZ sensitivity curves in Fourier space\nconst evalSensitivity = ( OPD, shift ) => {\n\n\tconst phase = OPD.mul( 2.0 * Math.PI * 1.0e-9 );\n\tconst val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\tconst pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\tconst VAR = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\n\tconst x = float( 9.7470e-14 * Math.sqrt( 2.0 * Math.PI * 4.5282e+09 ) ).mul( phase.mul( 2.2399e+06 ).add( shift.x ).cos() ).mul( phase.pow2().mul( - 4.5282e+09 ).exp() );\n\n\tlet xyz = val.mul( VAR.mul( 2.0 * Math.PI ).sqrt() ).mul( pos.mul( phase ).add( shift ).cos() ).mul( phase.pow2().negate().mul( VAR ).exp() );\n\txyz = vec3( xyz.x.add( x ), xyz.y, xyz.z ).div( 1.0685e-7 );\n\n\tconst rgb = XYZ_TO_REC709.mul( xyz );\n\n\treturn rgb;\n\n};\n\nconst evalIridescence = tslFn( ( { outsideIOR, eta2, cosTheta1, thinFilmThickness, baseF0 } ) => {\n\n\t// Force iridescenceIOR -> outsideIOR when thinFilmThickness -> 0.0\n\tconst iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t// Evaluate the cosTheta on the base layer (Snell law)\n\tconst sinTheta2Sq = outsideIOR.div( iridescenceIOR ).pow2().mul( float( 1 ).sub( cosTheta1.pow2() ) );\n\n\t// Handle TIR:\n\tconst cosTheta2Sq = float( 1 ).sub( sinTheta2Sq );\n\t/*if ( cosTheta2Sq < 0.0 ) {\n\n\t\t\treturn vec3( 1.0 );\n\n\t}*/\n\n\tconst cosTheta2 = cosTheta2Sq.sqrt();\n\n\t// First interface\n\tconst R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\tconst R12 = F_Schlick( { f0: R0, f90: 1.0, dotVH: cosTheta1 } );\n\t//const R21 = R12;\n\tconst T121 = R12.oneMinus();\n\tconst phi12 = iridescenceIOR.lessThan( outsideIOR ).cond( Math.PI, 0.0 );\n\tconst phi21 = float( Math.PI ).sub( phi12 );\n\n\t// Second interface\n\tconst baseIOR = Fresnel0ToIor( baseF0.clamp( 0.0, 0.9999 ) ); // guard against 1.0\n\tconst R1 = IorToFresnel0( baseIOR, iridescenceIOR.toVec3() );\n\tconst R23 = F_Schlick( { f0: R1, f90: 1.0, dotVH: cosTheta2 } );\n\tconst phi23 = vec3(\n\t\tbaseIOR.x.lessThan( iridescenceIOR ).cond( Math.PI, 0.0 ),\n\t\tbaseIOR.y.lessThan( iridescenceIOR ).cond( Math.PI, 0.0 ),\n\t\tbaseIOR.z.lessThan( iridescenceIOR ).cond( Math.PI, 0.0 )\n\t);\n\n\t// Phase shift\n\tconst OPD = iridescenceIOR.mul( thinFilmThickness, cosTheta2, 2.0 );\n\tconst phi = vec3( phi21 ).add( phi23 );\n\n\t// Compound terms\n\tconst R123 = R12.mul( R23 ).clamp( 1e-5, 0.9999 );\n\tconst r123 = R123.sqrt();\n\tconst Rs = T121.pow2().mul( R23 ).div( vec3( 1.0 ).sub( R123 ) );\n\n\t// Reflectance term for m = 0 (DC term amplitude)\n\tconst C0 = R12.add( Rs );\n\tlet I = C0;\n\n\t// Reflectance term for m > 0 (pairs of diracs)\n\tlet Cm = Rs.sub( T121 );\n\tfor ( let m = 1; m <= 2; ++ m ) {\n\n\t\tCm = Cm.mul( r123 );\n\t\tconst Sm = evalSensitivity( float( m ).mul( OPD ), float( m ).mul( phi ) ).mul( 2.0 );\n\t\tI = I.add( Cm.mul( Sm ) );\n\n\t}\n\n\t// Since out of gamut colors might be produced, negative color values are clamped to 0.\n\treturn I.max( vec3( 0.0 ) );\n\n} ).setLayout( {\n\tname: 'evalIridescence',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'outsideIOR', type: 'float' },\n\t\t{ name: 'eta2', type: 'float' },\n\t\t{ name: 'cosTheta1', type: 'float' },\n\t\t{ name: 'thinFilmThickness', type: 'float' },\n\t\t{ name: 'baseF0', type: 'vec3' }\n\t]\n} );\n\n//\n//\tSheen\n//\n\n// This is a curve-fit approxmation to the \"Charlie sheen\" BRDF integrated over the hemisphere from\n// Estevez and Kulla 2017, \"Production Friendly Microfacet Sheen BRDF\". The analysis can be found\n// in the Sheen section of https://drive.google.com/file/d/1T0D1VSyR4AllqIJTQAraEIzjlb5h4FKH/view?usp=sharing\nconst IBLSheenBRDF = tslFn( ( { normal, viewDir, roughness } ) => {\n\n\tconst dotNV = normal.dot( viewDir ).saturate();\n\n\tconst r2 = roughness.pow2();\n\n\tconst a = cond(\n\t\troughness.lessThan( 0.25 ),\n\t\tfloat( - 339.2 ).mul( r2 ).add( float( 161.4 ).mul( roughness ) ).sub( 25.9 ),\n\t\tfloat( - 8.48 ).mul( r2 ).add( float( 14.3 ).mul( roughness ) ).sub( 9.95 )\n\t);\n\n\tconst b = cond(\n\t\troughness.lessThan( 0.25 ),\n\t\tfloat( 44.0 ).mul( r2 ).sub( float( 23.7 ).mul( roughness ) ).add( 3.26 ),\n\t\tfloat( 1.97 ).mul( r2 ).sub( float( 3.27 ).mul( roughness ) ).add( 0.72 )\n\t);\n\n\tconst DG = cond( roughness.lessThan( 0.25 ), 0.0, float( 0.1 ).mul( roughness ).sub( 0.025 ) ).add( a.mul( dotNV ).add( b ).exp() );\n\n\treturn DG.mul( 1.0 / Math.PI ).saturate();\n\n} );\n\nconst clearcoatF0 = vec3( 0.04 );\nconst clearcoatF90 = float( 1 );\n\n//\n\nclass PhysicalLightingModel extends LightingModel {\n\n\tconstructor( clearcoat = false, sheen = false, iridescence = false, anisotropy = false, transmission = false, dispersion = false ) {\n\n\t\tsuper();\n\n\t\tthis.clearcoat = clearcoat;\n\t\tthis.sheen = sheen;\n\t\tthis.iridescence = iridescence;\n\t\tthis.anisotropy = anisotropy;\n\t\tthis.transmission = transmission;\n\t\tthis.dispersion = dispersion;\n\n\t\tthis.clearcoatRadiance = null;\n\t\tthis.clearcoatSpecularDirect = null;\n\t\tthis.clearcoatSpecularIndirect = null;\n\t\tthis.sheenSpecularDirect = null;\n\t\tthis.sheenSpecularIndirect = null;\n\t\tthis.iridescenceFresnel = null;\n\t\tthis.iridescenceF0 = null;\n\n\t}\n\n\tstart( context ) {\n\n\t\tif ( this.clearcoat === true ) {\n\n\t\t\tthis.clearcoatRadiance = vec3().temp( 'clearcoatRadiance' );\n\t\t\tthis.clearcoatSpecularDirect = vec3().temp( 'clearcoatSpecularDirect' );\n\t\t\tthis.clearcoatSpecularIndirect = vec3().temp( 'clearcoatSpecularIndirect' );\n\n\t\t}\n\n\t\tif ( this.sheen === true ) {\n\n\t\t\tthis.sheenSpecularDirect = vec3().temp( 'sheenSpecularDirect' );\n\t\t\tthis.sheenSpecularIndirect = vec3().temp( 'sheenSpecularIndirect' );\n\n\t\t}\n\n\t\tif ( this.iridescence === true ) {\n\n\t\t\tconst dotNVi = transformedNormalView.dot( positionViewDirection ).clamp();\n\n\t\t\tthis.iridescenceFresnel = evalIridescence( {\n\t\t\t\toutsideIOR: float( 1.0 ),\n\t\t\t\teta2: iridescenceIOR,\n\t\t\t\tcosTheta1: dotNVi,\n\t\t\t\tthinFilmThickness: iridescenceThickness,\n\t\t\t\tbaseF0: specularColor\n\t\t\t} );\n\n\t\t\tthis.iridescenceF0 = Schlick_to_F0( { f: this.iridescenceFresnel, f90: 1.0, dotVH: dotNVi } );\n\n\t\t}\n\n\t\tif ( this.transmission === true ) {\n\n\t\t\tconst position = positionWorld;\n\t\t\tconst v = cameraPosition.sub( positionWorld ).normalize(); // TODO: Create Node for this, same issue in MaterialX\n\t\t\tconst n = transformedNormalWorld;\n\n\t\t\tcontext.backdrop = getIBLVolumeRefraction(\n\t\t\t\tn,\n\t\t\t\tv,\n\t\t\t\troughness,\n\t\t\t\tdiffuseColor,\n\t\t\t\tspecularColor,\n\t\t\t\tspecularF90, // specularF90\n\t\t\t\tposition, // positionWorld\n\t\t\t\tmodelWorldMatrix, // modelMatrix\n\t\t\t\tcameraViewMatrix, // viewMatrix\n\t\t\t\tcameraProjectionMatrix, // projMatrix\n\t\t\t\tior,\n\t\t\t\tthickness,\n\t\t\t\tattenuationColor,\n\t\t\t\tattenuationDistance,\n\t\t\t\tthis.dispersion ? dispersion : null\n\t\t\t);\n\n\t\t\tcontext.backdropAlpha = transmission;\n\n\t\t\tdiffuseColor.a.mulAssign( mix( 1, context.backdrop.a, transmission ) );\n\n\t\t}\n\n\t}\n\n\t// Fdez-Agüera's \"Multiple-Scattering Microfacet Model for Real-Time Image Based Lighting\"\n\t// Approximates multiscattering in order to preserve energy.\n\t// http://www.jcgt.org/published/0008/01/03/\n\n\tcomputeMultiscattering( singleScatter, multiScatter, specularF90 ) {\n\n\t\tconst dotNV = transformedNormalView.dot( positionViewDirection ).clamp(); // @ TODO: Move to core dotNV\n\n\t\tconst fab = DFGApprox( { roughness, dotNV } );\n\n\t\tconst Fr = this.iridescenceF0 ? iridescence.mix( specularColor, this.iridescenceF0 ) : specularColor;\n\n\t\tconst FssEss = Fr.mul( fab.x ).add( specularF90.mul( fab.y ) );\n\n\t\tconst Ess = fab.x.add( fab.y );\n\t\tconst Ems = Ess.oneMinus();\n\n\t\tconst Favg = specularColor.add( specularColor.oneMinus().mul( 0.047619 ) ); // 1/21\n\t\tconst Fms = FssEss.mul( Favg ).div( Ems.mul( Favg ).oneMinus() );\n\n\t\tsingleScatter.addAssign( FssEss );\n\t\tmultiScatter.addAssign( Fms.mul( Ems ) );\n\n\t}\n\n\tdirect( { lightDirection, lightColor, reflectedLight } ) {\n\n\t\tconst dotNL = transformedNormalView.dot( lightDirection ).clamp();\n\t\tconst irradiance = dotNL.mul( lightColor );\n\n\t\tif ( this.sheen === true ) {\n\n\t\t\tthis.sheenSpecularDirect.addAssign( irradiance.mul( BRDF_Sheen( { lightDirection } ) ) );\n\n\t\t}\n\n\t\tif ( this.clearcoat === true ) {\n\n\t\t\tconst dotNLcc = transformedClearcoatNormalView.dot( lightDirection ).clamp();\n\t\t\tconst ccIrradiance = dotNLcc.mul( lightColor );\n\n\t\t\tthis.clearcoatSpecularDirect.addAssign( ccIrradiance.mul( BRDF_GGX( { lightDirection, f0: clearcoatF0, f90: clearcoatF90, roughness: clearcoatRoughness, normalView: transformedClearcoatNormalView } ) ) );\n\n\t\t}\n\n\t\treflectedLight.directDiffuse.addAssign( irradiance.mul( BRDF_Lambert( { diffuseColor: diffuseColor.rgb } ) ) );\n\n\t\treflectedLight.directSpecular.addAssign( irradiance.mul( BRDF_GGX( { lightDirection, f0: specularColor, f90: 1, roughness, iridescence: this.iridescence, f: this.iridescenceFresnel, USE_IRIDESCENCE: this.iridescence, USE_ANISOTROPY: this.anisotropy } ) ) );\n\n\t}\n\n\tdirectRectArea( { lightColor, lightPosition, halfWidth, halfHeight, reflectedLight, ltc_1, ltc_2 } ) {\n\n\t\tconst p0 = lightPosition.add( halfWidth ).sub( halfHeight ); // counterclockwise; light shines in local neg z direction\n\t\tconst p1 = lightPosition.sub( halfWidth ).sub( halfHeight );\n\t\tconst p2 = lightPosition.sub( halfWidth ).add( halfHeight );\n\t\tconst p3 = lightPosition.add( halfWidth ).add( halfHeight );\n\n\t\tconst N = transformedNormalView;\n\t\tconst V = positionViewDirection;\n\t\tconst P = positionView.toVar();\n\n\t\tconst uv = LTC_Uv( { N, V, roughness } );\n\n\t\tconst t1 = ltc_1.uv( uv ).toVar();\n\t\tconst t2 = ltc_2.uv( uv ).toVar();\n\n\t\tconst mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3( 0, 1, 0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t).toVar();\n\n\t\t// LTC Fresnel Approximation by Stephen Hill\n\t\t// http://blog.selfshadow.com/publications/s2016-advances/s2016_ltc_fresnel.pdf\n\t\tconst fresnel = specularColor.mul( t2.x ).add( specularColor.oneMinus().mul( t2.y ) ).toVar();\n\n\t\treflectedLight.directSpecular.addAssign( lightColor.mul( fresnel ).mul( LTC_Evaluate( { N, V, P, mInv, p0, p1, p2, p3 } ) ) );\n\n\t\treflectedLight.directDiffuse.addAssign( lightColor.mul( diffuseColor ).mul( LTC_Evaluate( { N, V, P, mInv: mat3( 1, 0, 0, 0, 1, 0, 0, 0, 1 ), p0, p1, p2, p3 } ) ) );\n\n\t}\n\n\tindirectDiffuse( { irradiance, reflectedLight } ) {\n\n\t\treflectedLight.indirectDiffuse.addAssign( irradiance.mul( BRDF_Lambert( { diffuseColor } ) ) );\n\n\t}\n\n\tindirectSpecular( { radiance, iblIrradiance, reflectedLight } ) {\n\n\t\tif ( this.sheen === true ) {\n\n\t\t\tthis.sheenSpecularIndirect.addAssign( iblIrradiance.mul(\n\t\t\t\tsheen,\n\t\t\t\tIBLSheenBRDF( {\n\t\t\t\t\tnormal: transformedNormalView,\n\t\t\t\t\tviewDir: positionViewDirection,\n\t\t\t\t\troughness: sheenRoughness\n\t\t\t\t} )\n\t\t\t) );\n\n\t\t}\n\n\t\tif ( this.clearcoat === true ) {\n\n\t\t\tconst dotNVcc = transformedClearcoatNormalView.dot( positionViewDirection ).clamp();\n\n\t\t\tconst clearcoatEnv = EnvironmentBRDF( {\n\t\t\t\tdotNV: dotNVcc,\n\t\t\t\tspecularColor: clearcoatF0,\n\t\t\t\tspecularF90: clearcoatF90,\n\t\t\t\troughness: clearcoatRoughness\n\t\t\t} );\n\n\t\t\tthis.clearcoatSpecularIndirect.addAssign( this.clearcoatRadiance.mul( clearcoatEnv ) );\n\n\t\t}\n\n\t\t// Both indirect specular and indirect diffuse light accumulate here\n\n\t\tconst singleScattering = vec3().temp( 'singleScattering' );\n\t\tconst multiScattering = vec3().temp( 'multiScattering' );\n\t\tconst cosineWeightedIrradiance = iblIrradiance.mul( 1 / Math.PI );\n\n\t\tthis.computeMultiscattering( singleScattering, multiScattering, specularF90 );\n\n\t\tconst totalScattering = singleScattering.add( multiScattering );\n\n\t\tconst diffuse = diffuseColor.mul( totalScattering.r.max( totalScattering.g ).max( totalScattering.b ).oneMinus() );\n\n\t\treflectedLight.indirectSpecular.addAssign( radiance.mul( singleScattering ) );\n\t\treflectedLight.indirectSpecular.addAssign( multiScattering.mul( cosineWeightedIrradiance ) );\n\n\t\treflectedLight.indirectDiffuse.addAssign( diffuse.mul( cosineWeightedIrradiance ) );\n\n\t}\n\n\tambientOcclusion( { ambientOcclusion, reflectedLight } ) {\n\n\t\tconst dotNV = transformedNormalView.dot( positionViewDirection ).clamp(); // @ TODO: Move to core dotNV\n\n\t\tconst aoNV = dotNV.add( ambientOcclusion );\n\t\tconst aoExp = roughness.mul( - 16.0 ).oneMinus().negate().exp2();\n\n\t\tconst aoNode = ambientOcclusion.sub( aoNV.pow( aoExp ).oneMinus() ).clamp();\n\n\t\tif ( this.clearcoat === true ) {\n\n\t\t\tthis.clearcoatSpecularIndirect.mulAssign( ambientOcclusion );\n\n\t\t}\n\n\t\tif ( this.sheen === true ) {\n\n\t\t\tthis.sheenSpecularIndirect.mulAssign( ambientOcclusion );\n\n\t\t}\n\n\t\treflectedLight.indirectDiffuse.mulAssign( ambientOcclusion );\n\t\treflectedLight.indirectSpecular.mulAssign( aoNode );\n\n\t}\n\n\tfinish( context ) {\n\n\t\tconst { outgoingLight } = context;\n\n\t\tif ( this.clearcoat === true ) {\n\n\t\t\tconst dotNVcc = transformedClearcoatNormalView.dot( positionViewDirection ).clamp();\n\n\t\t\tconst Fcc = F_Schlick( {\n\t\t\t\tdotVH: dotNVcc,\n\t\t\t\tf0: clearcoatF0,\n\t\t\t\tf90: clearcoatF90\n\t\t\t} );\n\n\t\t\tconst clearcoatLight = outgoingLight.mul( clearcoat.mul( Fcc ).oneMinus() ).add( this.clearcoatSpecularDirect.add( this.clearcoatSpecularIndirect ).mul( clearcoat ) );\n\n\t\t\toutgoingLight.assign( clearcoatLight );\n\n\t\t}\n\n\t\tif ( this.sheen === true ) {\n\n\t\t\tconst sheenEnergyComp = sheen.r.max( sheen.g ).max( sheen.b ).mul( 0.157 ).oneMinus();\n\t\t\tconst sheenLight = outgoingLight.mul( sheenEnergyComp ).add( this.sheenSpecularDirect, this.sheenSpecularIndirect );\n\n\t\t\toutgoingLight.assign( sheenLight );\n\n\t\t}\n\n\t}\n\n}\n\nexport default PhysicalLightingModel;\n","import NodeMaterial, { addNodeMaterial } from './NodeMaterial.js';\nimport { diffuseColor, metalness, roughness, specularColor, specularF90 } from '../core/PropertyNode.js';\nimport { mix } from '../math/MathNode.js';\nimport { materialRoughness, materialMetalness } from '../accessors/MaterialNode.js';\nimport getRoughness from '../functions/material/getRoughness.js';\nimport PhysicalLightingModel from '../functions/PhysicalLightingModel.js';\nimport { float, vec3, vec4 } from '../shadernode/ShaderNode.js';\n\nimport { MeshStandardMaterial } from 'three';\n\nconst defaultValues = new MeshStandardMaterial();\n\nclass MeshStandardNodeMaterial extends NodeMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshStandardNodeMaterial = true;\n\n\t\tthis.emissiveNode = null;\n\n\t\tthis.metalnessNode = null;\n\t\tthis.roughnessNode = null;\n\n\t\tthis.setDefaultValues( defaultValues );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupLightingModel( /*builder*/ ) {\n\n\t\treturn new PhysicalLightingModel();\n\n\t}\n\n\tsetupSpecular() {\n\n\t\tconst specularColorNode = mix( vec3( 0.04 ), diffuseColor.rgb, metalness );\n\n\t\tspecularColor.assign( specularColorNode );\n\t\tspecularF90.assign( 1.0 );\n\n\t}\n\n\tsetupVariants() {\n\n\t\t// METALNESS\n\n\t\tconst metalnessNode = this.metalnessNode ? float( this.metalnessNode ) : materialMetalness;\n\n\t\tmetalness.assign( metalnessNode );\n\n\t\t// ROUGHNESS\n\n\t\tlet roughnessNode = this.roughnessNode ? float( this.roughnessNode ) : materialRoughness;\n\t\troughnessNode = getRoughness( { roughness: roughnessNode } );\n\n\t\troughness.assign( roughnessNode );\n\n\t\t// SPECULAR COLOR\n\n\t\tthis.setupSpecular();\n\n\t\t// DIFFUSE COLOR\n\n\t\tdiffuseColor.assign( vec4( diffuseColor.rgb.mul( metalnessNode.oneMinus() ), diffuseColor.a ) );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.emissiveNode = source.emissiveNode;\n\n\t\tthis.metalnessNode = source.metalnessNode;\n\t\tthis.roughnessNode = source.roughnessNode;\n\n\t\treturn super.copy( source );\n\n\t}\n\n}\n\nexport default MeshStandardNodeMaterial;\n\naddNodeMaterial( 'MeshStandardNodeMaterial', MeshStandardNodeMaterial );\n","import { addNodeMaterial } from './NodeMaterial.js';\nimport { transformedClearcoatNormalView } from '../accessors/NormalNode.js';\nimport { clearcoat, clearcoatRoughness, sheen, sheenRoughness, iridescence, iridescenceIOR, iridescenceThickness, specularColor, specularF90, diffuseColor, metalness, roughness, anisotropy, alphaT, anisotropyT, anisotropyB, ior, transmission, thickness, attenuationDistance, attenuationColor, dispersion } from '../core/PropertyNode.js';\nimport { materialClearcoat, materialClearcoatRoughness, materialClearcoatNormal, materialSheen, materialSheenRoughness, materialIridescence, materialIridescenceIOR, materialIridescenceThickness, materialSpecularIntensity, materialSpecularColor, materialAnisotropy, materialIOR, materialTransmission, materialThickness, materialAttenuationDistance, materialAttenuationColor, materialDispersion } from '../accessors/MaterialNode.js';\nimport { float, vec2, vec3, If } from '../shadernode/ShaderNode.js';\nimport getRoughness from '../functions/material/getRoughness.js';\nimport { TBNViewMatrix } from '../accessors/AccessorsUtils.js';\nimport PhysicalLightingModel from '../functions/PhysicalLightingModel.js';\nimport MeshStandardNodeMaterial from './MeshStandardNodeMaterial.js';\nimport { mix, pow2, min } from '../math/MathNode.js';\nimport { MeshPhysicalMaterial } from 'three';\n\nconst defaultValues = new MeshPhysicalMaterial();\n\nclass MeshPhysicalNodeMaterial extends MeshStandardNodeMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshPhysicalNodeMaterial = true;\n\n\t\tthis.clearcoatNode = null;\n\t\tthis.clearcoatRoughnessNode = null;\n\t\tthis.clearcoatNormalNode = null;\n\n\t\tthis.sheenNode = null;\n\t\tthis.sheenRoughnessNode = null;\n\n\t\tthis.iridescenceNode = null;\n\t\tthis.iridescenceIORNode = null;\n\t\tthis.iridescenceThicknessNode = null;\n\n\t\tthis.specularIntensityNode = null;\n\t\tthis.specularColorNode = null;\n\n\t\tthis.iorNode = null;\n\t\tthis.transmissionNode = null;\n\t\tthis.thicknessNode = null;\n\t\tthis.attenuationDistanceNode = null;\n\t\tthis.attenuationColorNode = null;\n\t\tthis.dispersionNode = null;\n\n\t\tthis.anisotropyNode = null;\n\n\t\tthis.setDefaultValues( defaultValues );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tget useClearcoat() {\n\n\t\treturn this.clearcoat > 0 || this.clearcoatNode !== null;\n\n\t}\n\n\tget useIridescence() {\n\n\t\treturn this.iridescence > 0 || this.iridescenceNode !== null;\n\n\t}\n\n\tget useSheen() {\n\n\t\treturn this.sheen > 0 || this.sheenNode !== null;\n\n\t}\n\n\tget useAnisotropy() {\n\n\t\treturn this.anisotropy > 0 || this.anisotropyNode !== null;\n\n\t}\n\n\tget useTransmission() {\n\n\t\treturn this.transmission > 0 || this.transmissionNode !== null;\n\n\t}\n\n\tget useDispersion() {\n\n\t\treturn this.dispersion > 0 || this.dispersionNode !== null;\n\n\t}\n\n\tsetupSpecular() {\n\n\t\tconst iorNode = this.iorNode ? float( this.iorNode ) : materialIOR;\n\n\t\tior.assign( iorNode );\n\t\tspecularColor.assign( mix( min( pow2( ior.sub( 1.0 ).div( ior.add( 1.0 ) ) ).mul( materialSpecularColor ), vec3( 1.0 ) ).mul( materialSpecularIntensity ), diffuseColor.rgb, metalness ) );\n\t\tspecularF90.assign( mix( materialSpecularIntensity, 1.0, metalness ) );\n\n\t}\n\n\tsetupLightingModel( /*builder*/ ) {\n\n\t\treturn new PhysicalLightingModel( this.useClearcoat, this.useSheen, this.useIridescence, this.useAnisotropy, this.useTransmission, this.useDispersion );\n\n\t}\n\n\tsetupVariants( builder ) {\n\n\t\tsuper.setupVariants( builder );\n\n\t\t// CLEARCOAT\n\n\t\tif ( this.useClearcoat ) {\n\n\t\t\tconst clearcoatNode = this.clearcoatNode ? float( this.clearcoatNode ) : materialClearcoat;\n\t\t\tconst clearcoatRoughnessNode = this.clearcoatRoughnessNode ? float( this.clearcoatRoughnessNode ) : materialClearcoatRoughness;\n\n\t\t\tclearcoat.assign( clearcoatNode );\n\t\t\tclearcoatRoughness.assign( getRoughness( { roughness: clearcoatRoughnessNode } ) );\n\n\t\t}\n\n\t\t// SHEEN\n\n\t\tif ( this.useSheen ) {\n\n\t\t\tconst sheenNode = this.sheenNode ? vec3( this.sheenNode ) : materialSheen;\n\t\t\tconst sheenRoughnessNode = this.sheenRoughnessNode ? float( this.sheenRoughnessNode ) : materialSheenRoughness;\n\n\t\t\tsheen.assign( sheenNode );\n\t\t\tsheenRoughness.assign( sheenRoughnessNode );\n\n\t\t}\n\n\t\t// IRIDESCENCE\n\n\t\tif ( this.useIridescence ) {\n\n\t\t\tconst iridescenceNode = this.iridescenceNode ? float( this.iridescenceNode ) : materialIridescence;\n\t\t\tconst iridescenceIORNode = this.iridescenceIORNode ? float( this.iridescenceIORNode ) : materialIridescenceIOR;\n\t\t\tconst iridescenceThicknessNode = this.iridescenceThicknessNode ? float( this.iridescenceThicknessNode ) : materialIridescenceThickness;\n\n\t\t\tiridescence.assign( iridescenceNode );\n\t\t\tiridescenceIOR.assign( iridescenceIORNode );\n\t\t\tiridescenceThickness.assign( iridescenceThicknessNode );\n\n\t\t}\n\n\t\t// ANISOTROPY\n\n\t\tif ( this.useAnisotropy ) {\n\n\t\t\tconst anisotropyV = ( this.anisotropyNode ? vec2( this.anisotropyNode ) : materialAnisotropy ).toVar();\n\n\t\t\tanisotropy.assign( anisotropyV.length() );\n\n\t\t\tIf( anisotropy.equal( 0.0 ), () => {\n\n\t\t\t\tanisotropyV.assign( vec2( 1.0, 0.0 ) );\n\n\t\t\t} ).else( () => {\n\n\t\t\t\tanisotropyV.divAssign( vec2( anisotropy ) );\n\t\t\t\tanisotropy.assign( anisotropy.saturate() );\n\n\t\t\t} );\n\n\t\t\t// Roughness along the anisotropy bitangent is the material roughness, while the tangent roughness increases with anisotropy.\n\t\t\talphaT.assign( anisotropy.pow2().mix( roughness.pow2(), 1.0 ) );\n\n\t\t\tanisotropyT.assign( TBNViewMatrix[ 0 ].mul( anisotropyV.x ).add( TBNViewMatrix[ 1 ].mul( anisotropyV.y ) ) );\n\t\t\tanisotropyB.assign( TBNViewMatrix[ 1 ].mul( anisotropyV.x ).sub( TBNViewMatrix[ 0 ].mul( anisotropyV.y ) ) );\n\n\t\t}\n\n\t\t// TRANSMISSION\n\n\t\tif ( this.useTransmission ) {\n\n\t\t\tconst transmissionNode = this.transmissionNode ? float( this.transmissionNode ) : materialTransmission;\n\t\t\tconst thicknessNode = this.thicknessNode ? float( this.thicknessNode ) : materialThickness;\n\t\t\tconst attenuationDistanceNode = this.attenuationDistanceNode ? float( this.attenuationDistanceNode ) : materialAttenuationDistance;\n\t\t\tconst attenuationColorNode = this.attenuationColorNode ? vec3( this.attenuationColorNode ) : materialAttenuationColor;\n\n\t\t\ttransmission.assign( transmissionNode );\n\t\t\tthickness.assign( thicknessNode );\n\t\t\tattenuationDistance.assign( attenuationDistanceNode );\n\t\t\tattenuationColor.assign( attenuationColorNode );\n\n\t\t\tif ( this.useDispersion ) {\n\n\t\t\t\tconst dispersionNode = this.dispersionNode ? float( this.dispersionNode ) : materialDispersion;\n\n\t\t\t\tdispersion.assign( dispersionNode );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tsetupNormal( builder ) {\n\n\t\tsuper.setupNormal( builder );\n\n\t\t// CLEARCOAT NORMAL\n\n\t\tconst clearcoatNormalNode = this.clearcoatNormalNode ? vec3( this.clearcoatNormalNode ) : materialClearcoatNormal;\n\n\t\ttransformedClearcoatNormalView.assign( clearcoatNormalNode );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.clearcoatNode = source.clearcoatNode;\n\t\tthis.clearcoatRoughnessNode = source.clearcoatRoughnessNode;\n\t\tthis.clearcoatNormalNode = source.clearcoatNormalNode;\n\n\t\tthis.sheenNode = source.sheenNode;\n\t\tthis.sheenRoughnessNode = source.sheenRoughnessNode;\n\n\t\tthis.iridescenceNode = source.iridescenceNode;\n\t\tthis.iridescenceIORNode = source.iridescenceIORNode;\n\t\tthis.iridescenceThicknessNode = source.iridescenceThicknessNode;\n\n\t\tthis.specularIntensityNode = source.specularIntensityNode;\n\t\tthis.specularColorNode = source.specularColorNode;\n\n\t\tthis.transmissionNode = source.transmissionNode;\n\t\tthis.thicknessNode = source.thicknessNode;\n\t\tthis.attenuationDistanceNode = source.attenuationDistanceNode;\n\t\tthis.attenuationColorNode = source.attenuationColorNode;\n\t\tthis.dispersionNode = source.dispersionNode;\n\n\t\tthis.anisotropyNode = source.anisotropyNode;\n\n\t\treturn super.copy( source );\n\n\t}\n\n}\n\nexport default MeshPhysicalNodeMaterial;\n\naddNodeMaterial( 'MeshPhysicalNodeMaterial', MeshPhysicalNodeMaterial );\n","import { addNodeMaterial } from './NodeMaterial.js';\nimport { transformedNormalView } from '../accessors/NormalNode.js';\nimport { positionViewDirection } from '../accessors/PositionNode.js';\nimport PhysicalLightingModel from '../functions/PhysicalLightingModel.js';\nimport MeshPhysicalNodeMaterial from './MeshPhysicalNodeMaterial.js';\nimport { float, vec3 } from '../shadernode/ShaderNode.js';\n\nclass SSSLightingModel extends PhysicalLightingModel {\n\n\tconstructor( useClearcoat, useSheen, useIridescence, useSSS ) {\n\n\t\tsuper( useClearcoat, useSheen, useIridescence );\n\n\t\tthis.useSSS = useSSS;\n\n\t}\n\n\tdirect( { lightDirection, lightColor, reflectedLight }, stack, builder ) {\n\n\t\tif ( this.useSSS === true ) {\n\n\t\t\tconst material = builder.material;\n\n\t\t\tconst { thicknessColorNode, thicknessDistortionNode, thicknessAmbientNode, thicknessAttenuationNode, thicknessPowerNode, thicknessScaleNode } = material;\n\n\t\t\tconst scatteringHalf = lightDirection.add( transformedNormalView.mul( thicknessDistortionNode ) ).normalize();\n\t\t\tconst scatteringDot = float( positionViewDirection.dot( scatteringHalf.negate() ).saturate().pow( thicknessPowerNode ).mul( thicknessScaleNode ) );\n\t\t\tconst scatteringIllu = vec3( scatteringDot.add( thicknessAmbientNode ).mul( thicknessColorNode ) );\n\n\t\t\treflectedLight.directDiffuse.addAssign( scatteringIllu.mul( thicknessAttenuationNode.mul( lightColor ) ) );\n\n\t\t}\n\n\t\tsuper.direct( { lightDirection, lightColor, reflectedLight }, stack, builder );\n\n\t}\n\n}\n\nclass MeshSSSNodeMaterial extends MeshPhysicalNodeMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper( parameters );\n\n\t\tthis.thicknessColorNode = null;\n\t\tthis.thicknessDistortionNode = float( 0.1 );\n\t\tthis.thicknessAmbientNode = float( 0.0 );\n\t\tthis.thicknessAttenuationNode = float( .1 );\n\t\tthis.thicknessPowerNode = float( 2.0 );\n\t\tthis.thicknessScaleNode = float( 10.0 );\n\n\t}\n\n\tget useSSS() {\n\n\t\treturn this.thicknessColorNode !== null;\n\n\t}\n\n\tsetupLightingModel( /*builder*/ ) {\n\n\t\treturn new SSSLightingModel( this.useClearcoat, this.useSheen, this.useIridescence, this.useSSS );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.thicknessColorNode = source.thicknessColorNode;\n\t\tthis.thicknessDistortionNode = source.thicknessDistortionNode;\n\t\tthis.thicknessAmbientNode = source.thicknessAmbientNode;\n\t\tthis.thicknessAttenuationNode = source.thicknessAttenuationNode;\n\t\tthis.thicknessPowerNode = source.thicknessPowerNode;\n\t\tthis.thicknessScaleNode = source.thicknessScaleNode;\n\n\t\treturn super.copy( source );\n\n\t}\n\n}\n\nexport default MeshSSSNodeMaterial;\n\naddNodeMaterial( 'MeshSSSNodeMaterial', MeshSSSNodeMaterial );\n","import LightingModel from '../core/LightingModel.js';\nimport BRDF_Lambert from './BSDF/BRDF_Lambert.js';\nimport { diffuseColor } from '../core/PropertyNode.js';\nimport { normalGeometry } from '../accessors/NormalNode.js';\nimport { tslFn, float, vec2, vec3 } from '../shadernode/ShaderNode.js';\nimport { mix, smoothstep } from '../math/MathNode.js';\nimport { materialReference } from '../accessors/MaterialReferenceNode.js';\n\nconst getGradientIrradiance = tslFn( ( { normal, lightDirection, builder } ) => {\n\n\t// dotNL will be from -1.0 to 1.0\n\tconst dotNL = normal.dot( lightDirection );\n\tconst coord = vec2( dotNL.mul( 0.5 ).add( 0.5 ), 0.0 );\n\n\tif ( builder.material.gradientMap ) {\n\n\t\tconst gradientMap = materialReference( 'gradientMap', 'texture' ).context( { getUV: () => coord } );\n\n\t\treturn vec3( gradientMap.r );\n\n\t} else {\n\n\t\tconst fw = coord.fwidth().mul( 0.5 );\n\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( float( 0.7 ).sub( fw.x ), float( 0.7 ).add( fw.x ), coord.x ) );\n\n\t}\n\n} );\n\nclass ToonLightingModel extends LightingModel {\n\n\tdirect( { lightDirection, lightColor, reflectedLight }, stack, builder ) {\n\n\t\tconst irradiance = getGradientIrradiance( { normal: normalGeometry, lightDirection, builder } ).mul( lightColor );\n\n\t\treflectedLight.directDiffuse.addAssign( irradiance.mul( BRDF_Lambert( { diffuseColor: diffuseColor.rgb } ) ) );\n\n\t}\n\n\tindirectDiffuse( { irradiance, reflectedLight } ) {\n\n\t\treflectedLight.indirectDiffuse.addAssign( irradiance.mul( BRDF_Lambert( { diffuseColor } ) ) );\n\n\t}\n\n}\n\nexport default ToonLightingModel;\n","import NodeMaterial, { addNodeMaterial } from './NodeMaterial.js';\nimport ToonLightingModel from '../functions/ToonLightingModel.js';\n\nimport { MeshToonMaterial } from 'three';\n\nconst defaultValues = new MeshToonMaterial();\n\nclass MeshToonNodeMaterial extends NodeMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshToonNodeMaterial = true;\n\n\t\tthis.lights = true;\n\n\t\tthis.setDefaultValues( defaultValues );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupLightingModel( /*builder*/ ) {\n\n\t\treturn new ToonLightingModel();\n\n\t}\n\n}\n\nexport default MeshToonNodeMaterial;\n\naddNodeMaterial( 'MeshToonNodeMaterial', MeshToonNodeMaterial );\n","import NodeMaterial, { addNodeMaterial } from './NodeMaterial.js';\nimport { materialReference } from '../accessors/MaterialReferenceNode.js';\nimport { diffuseColor } from '../core/PropertyNode.js';\nimport { vec3 } from '../shadernode/ShaderNode.js';\nimport { MeshMatcapMaterial } from 'three';\nimport { mix } from '../math/MathNode.js';\nimport { matcapUV } from '../utils/MatcapUVNode.js';\n\nconst defaultValues = new MeshMatcapMaterial();\n\nclass MeshMatcapNodeMaterial extends NodeMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.lights = false;\n\n\t\tthis.isMeshMatcapNodeMaterial = true;\n\n\t\tthis.setDefaultValues( defaultValues );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupVariants( builder ) {\n\n\t\tconst uv = matcapUV;\n\n\t\tlet matcapColor;\n\n\t\tif ( builder.material.matcap ) {\n\n\t\t\tmatcapColor = materialReference( 'matcap', 'texture' ).context( { getUV: () => uv } );\n\n\t\t} else {\n\n\t\t\tmatcapColor = vec3( mix( 0.2, 0.8, uv.y ) ); // default if matcap is missing\n\n\t\t}\n\n\t\tdiffuseColor.rgb.mulAssign( matcapColor.rgb );\n\n\t}\n\n}\n\n\nexport default MeshMatcapNodeMaterial;\n\naddNodeMaterial( 'MeshMatcapNodeMaterial', MeshMatcapNodeMaterial );\n","import NodeMaterial, { addNodeMaterial } from './NodeMaterial.js';\n\nimport { PointsMaterial } from 'three';\n\nconst defaultValues = new PointsMaterial();\n\nclass PointsNodeMaterial extends NodeMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isPointsNodeMaterial = true;\n\n\t\tthis.lights = false;\n\t\tthis.normals = false;\n\t\tthis.transparent = true;\n\n\t\tthis.sizeNode = null;\n\n\t\tthis.setDefaultValues( defaultValues );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.sizeNode = source.sizeNode;\n\n\t\treturn super.copy( source );\n\n\t}\n\n}\n\nexport default PointsNodeMaterial;\n\naddNodeMaterial( 'PointsNodeMaterial', PointsNodeMaterial );\n","import NodeMaterial, { addNodeMaterial } from './NodeMaterial.js';\nimport { uniform } from '../core/UniformNode.js';\nimport { cameraProjectionMatrix } from '../accessors/CameraNode.js';\nimport { materialRotation } from '../accessors/MaterialNode.js';\nimport { modelViewMatrix, modelWorldMatrix } from '../accessors/ModelNode.js';\nimport { positionLocal } from '../accessors/PositionNode.js';\nimport { float, vec2, vec3, vec4 } from '../shadernode/ShaderNode.js';\n\nimport { SpriteMaterial } from 'three';\n\nconst defaultValues = new SpriteMaterial();\n\nclass SpriteNodeMaterial extends NodeMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isSpriteNodeMaterial = true;\n\n\t\tthis.lights = false;\n\t\tthis.normals = false;\n\n\t\tthis.positionNode = null;\n\t\tthis.rotationNode = null;\n\t\tthis.scaleNode = null;\n\n\t\tthis.setDefaultValues( defaultValues );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupPosition( { object, context } ) {\n\n\t\t// < VERTEX STAGE >\n\n\t\tconst { positionNode, rotationNode, scaleNode } = this;\n\n\t\tconst vertex = positionLocal;\n\n\t\tlet mvPosition = modelViewMatrix.mul( vec3( positionNode || 0 ) );\n\n\t\tlet scale = vec2( modelWorldMatrix[ 0 ].xyz.length(), modelWorldMatrix[ 1 ].xyz.length() );\n\n\t\tif ( scaleNode !== null ) {\n\n\t\t\tscale = scale.mul( scaleNode );\n\n\t\t}\n\n\t\tlet alignedPosition = vertex.xy;\n\n\t\tif ( object.center && object.center.isVector2 === true ) {\n\n\t\t\talignedPosition = alignedPosition.sub( uniform( object.center ).sub( 0.5 ) );\n\n\t\t}\n\n\t\talignedPosition = alignedPosition.mul( scale );\n\n\t\tconst rotation = float( rotationNode || materialRotation );\n\n\t\tconst rotatedPosition = alignedPosition.rotate( rotation );\n\n\t\tmvPosition = vec4( mvPosition.xy.add( rotatedPosition ), mvPosition.zw );\n\n\t\tconst modelViewProjection = cameraProjectionMatrix.mul( mvPosition );\n\n\t\tcontext.vertex = vertex;\n\n\t\treturn modelViewProjection;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.positionNode = source.positionNode;\n\t\tthis.rotationNode = source.rotationNode;\n\t\tthis.scaleNode = source.scaleNode;\n\n\t\treturn super.copy( source );\n\n\t}\n\n}\n\nexport default SpriteNodeMaterial;\n\naddNodeMaterial( 'SpriteNodeMaterial', SpriteNodeMaterial );\n","import LightingModel from '../core/LightingModel.js';\nimport { diffuseColor } from '../core/PropertyNode.js';\nimport { float } from '../shadernode/ShaderNode.js';\n\nclass ShadowMaskModel extends LightingModel {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.shadowNode = float( 1 ).toVar( 'shadowMask' );\n\n\t}\n\n\tdirect( { shadowMask } ) {\n\n\t\tthis.shadowNode.mulAssign( shadowMask );\n\n\t}\n\n\tfinish( context ) {\n\n\t\tdiffuseColor.a.mulAssign( this.shadowNode.oneMinus() );\n\n\t\tcontext.outgoingLight.rgb.assign( diffuseColor.rgb ); // TODO: Optimize LightsNode to avoid this assignment\n\n\t}\n\n}\n\nexport default ShadowMaskModel;\n","import NodeMaterial, { addNodeMaterial } from './NodeMaterial.js';\nimport ShadowMaskModel from '../functions/ShadowMaskModel.js';\n\nimport { ShadowMaterial } from 'three';\n\nconst defaultValues = new ShadowMaterial();\n\nclass ShadowNodeMaterial extends NodeMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isShadowNodeMaterial = true;\n\n\t\tthis.lights = true;\n\n\t\tthis.setDefaultValues( defaultValues );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupLightingModel( /*builder*/ ) {\n\n\t\treturn new ShadowMaskModel();\n\n\t}\n\n}\n\nexport default ShadowNodeMaterial;\n\naddNodeMaterial( 'ShadowNodeMaterial', ShadowNodeMaterial );\n","import NodeMaterial, { addNodeMaterial } from './NodeMaterial.js';\nimport { varying } from '../core/VaryingNode.js';\nimport { property } from '../core/PropertyNode.js';\nimport { materialReference } from '../accessors/MaterialReferenceNode.js';\nimport { modelWorldMatrixInverse } from '../accessors/ModelNode.js';\nimport { cameraPosition } from '../accessors/CameraNode.js';\nimport { positionGeometry } from '../accessors/PositionNode.js';\nimport { tslFn, vec2, vec3, vec4 } from '../shadernode/ShaderNode.js';\nimport { min, max } from '../math/MathNode.js';\nimport { loop, Break } from '../utils/LoopNode.js';\nimport { texture3D } from '../accessors/Texture3DNode.js';\n\nclass VolumeNodeMaterial extends NodeMaterial {\n\n\tconstructor( params = {} ) {\n\n\t\tsuper();\n\n\t\tthis.normals = false;\n\t\tthis.lights = false;\n\t\tthis.isVolumeNodeMaterial = true;\n\t\tthis.testNode = null;\n\n\t\tthis.setValues( params );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst map = texture3D( this.map, null, 0 );\n\n\t\tconst hitBox = tslFn( ( { orig, dir } ) => {\n\n\t\t\tconst box_min = vec3( - 0.5 );\n\t\t\tconst box_max = vec3( 0.5 );\n\n\t\t\tconst inv_dir = dir.reciprocal();\n\n\t\t\tconst tmin_tmp = box_min.sub( orig ).mul( inv_dir );\n\t\t\tconst tmax_tmp = box_max.sub( orig ).mul( inv_dir );\n\n\t\t\tconst tmin = min( tmin_tmp, tmax_tmp );\n\t\t\tconst tmax = max( tmin_tmp, tmax_tmp );\n\n\t\t\tconst t0 = max( tmin.x, max( tmin.y, tmin.z ) );\n\t\t\tconst t1 = min( tmax.x, min( tmax.y, tmax.z ) );\n\n\t\t\treturn vec2( t0, t1 );\n\n\t\t} );\n\n\t\tthis.fragmentNode = tslFn( () => {\n\n\t\t\tconst vOrigin = varying( vec3( modelWorldMatrixInverse.mul( vec4( cameraPosition, 1.0 ) ) ) );\n\t\t\tconst vDirection = varying( positionGeometry.sub( vOrigin ) );\n\n\t\t\tconst rayDir = vDirection.normalize();\n\t\t\tconst bounds = property( 'vec2', 'bounds' ).assign( hitBox( { orig: vOrigin, dir: rayDir } ) );\n\n\t\t\tbounds.x.greaterThan( bounds.y ).discard();\n\n\t\t\tbounds.assign( vec2( max( bounds.x, 0.0 ), bounds.y ) );\n\n\t\t\tconst p = property( 'vec3', 'p' ).assign( vOrigin.add( bounds.x.mul( rayDir ) ) );\n\t\t\tconst inc = property( 'vec3', 'inc' ).assign( vec3( rayDir.abs().reciprocal() ) );\n\t\t\tconst delta = property( 'float', 'delta' ).assign( min( inc.x, min( inc.y, inc.z ) ) );\n\n\t\t\tdelta.divAssign( materialReference( 'steps', 'float' ) );\n\n\t\t\tconst ac = property( 'vec4', 'ac' ).assign( vec4( materialReference( 'base', 'color' ), 0.0 ) );\n\n\t\t\tloop( { type: 'float', start: bounds.x, end: bounds.y, update: '+= delta' }, () => {\n\n\t\t\t\tconst d = property( 'float', 'd' ).assign( map.uv( p.add( 0.5 ) ).r );\n\n\t\t\t\tif ( this.testNode !== null ) {\n\n\t\t\t\t\tthis.testNode( { map: map, mapValue: d, probe: p, finalColor: ac } ).append();\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// default to show surface of mesh\n\t\t\t\t\tac.a.assign( 1 );\n\t\t\t\t\tBreak();\n\n\t\t\t\t}\n\n\t\t\t\tp.addAssign( rayDir.mul( delta ) );\n\n\t\t\t} );\n\n\t\t\tac.a.equal( 0 ).discard();\n\n\t\t\treturn vec4( ac );\n\n\t\t} )();\n\n\t\tsuper.setup( builder );\n\n\t}\n\n}\n\nexport default VolumeNodeMaterial;\n\naddNodeMaterial( 'VolumeNodeMaterial', VolumeNodeMaterial );\n","import { MaterialLoader } from 'three';\nimport { createNodeMaterialFromType } from '../materials/Materials.js';\n\nconst superFromTypeFunction = MaterialLoader.createMaterialFromType;\n\nMaterialLoader.createMaterialFromType = function ( type ) {\n\n\tconst material = createNodeMaterialFromType( type );\n\n\tif ( material !== undefined ) {\n\n\t\treturn material;\n\n\t}\n\n\treturn superFromTypeFunction.call( this, type );\n\n};\n\nclass NodeMaterialLoader extends MaterialLoader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.nodes = {};\n\n\t}\n\n\tparse( json ) {\n\n\t\tconst material = super.parse( json );\n\n\t\tconst nodes = this.nodes;\n\t\tconst inputNodes = json.inputNodes;\n\n\t\tfor ( const property in inputNodes ) {\n\n\t\t\tconst uuid = inputNodes[ property ];\n\n\t\t\tmaterial[ property ] = nodes[ uuid ];\n\n\t\t}\n\n\t\treturn material;\n\n\t}\n\n\tsetNodes( value ) {\n\n\t\tthis.nodes = value;\n\n\t\treturn this;\n\n\t}\n\n}\n\nexport default NodeMaterialLoader;\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { Box, Grid, Paper, Divider } from '@mui/material';\r\nimport { headerStyle, } from \"../Styles.jsx\";\r\nimport { getAllTaskInstances, getTaskInstance, fetchCrewNames } from \"../DataCom/fireBaseFunctionalActions.js\"\r\nimport { RRule } from 'rrule';\r\nimport { temp } from 'three/examples/jsm/nodes/Nodes.js';\r\nconst daysOfWeek = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\r\nconst colours = [\r\n    { name: 'red', rgb: '#FF0000', darker: '#8B0000' },\r\n    { name: 'blue', rgb: '#0000FF', darker: '#00008B' },\r\n    { name: 'green', rgb: '#00FF00', darker: '#008B00' },\r\n    { name: 'purple', rgb: '#800080', darker: '#4B0082' },\r\n    { name: 'orange', rgb: '#FFA500', darker: '#FF4500' },\r\n    { name: 'yellow', rgb: '#FFFF00', darker: '#ADFF2F' }\r\n];\r\n\r\n\r\n\r\n\r\nconst temptasks = Array.from({ length: 7 }, (_, i) => {\r\n    const dayOfWeek = (i + 7) % 7;\r\n    return Array.from({ length: Math.floor(Math.random() * 10) }, (_, j) => ({\r\n        day: daysOfWeek[dayOfWeek],\r\n        EstimatedTimeToComplete: Math.floor(30 + Math.random() * 120),\r\n        id: `Task ${i * 10 + j + 1}`,\r\n        Color: [colours[Math.floor(Math.random() * colours.length)].rgb],\r\n        // darker: [colours[Math.floor(Math.random() * colours.length)].darker],\r\n    }));\r\n}).flat();\r\n\r\n// console.log(tasks);\r\n\r\n\r\nconst WeekComponent = (props) => {\r\n    const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\r\n    const refs = useRef([]);\r\n    const [tasks, setTasks] = useState(temptasks);\r\n\r\n\r\n    useEffect(() => {\r\n        refs.current = days.map(() => React.createRef());\r\n        getAllTaskInstances().then((data) => {\r\n            // console.log(data);\r\n            Promise.all(\r\n                data.map((taskInstance) =>\r\n                    fetchCrewNames(taskInstance.AssignedCrew).then((AssignedCrewName) => {\r\n                        return { ...taskInstance, AssignedCrewName };\r\n                    })\r\n                )\r\n            ).then((updatedData) => {\r\n                // console.log(updatedData);\r\n                setTasks(updatedData);\r\n            });\r\n\r\n\r\n        });\r\n\r\n    }, []);\r\n\r\n\r\n    const updatePosition = (dayIndex, left, top) => {\r\n        if (refs.current[dayIndex] && refs.current[dayIndex].current) {\r\n            const element = refs.current[dayIndex].current;\r\n            element.style.left = `${left}px`;\r\n            element.style.top = `${top}px`;\r\n        }\r\n    };\r\n\r\n    return (\r\n        <><h1\r\n            style={headerStyle}>Week Window\r\n        </h1>\r\n\r\n\r\n\r\n            <Divider orientation=\"vertical\"\r\n                style={{\r\n                    position: 'absolute',\r\n                    left: '13%',\r\n                }}\r\n                sx={{\r\n                    borderLeftWidth: 2,\r\n                    borderLeftStyle: 'dashed',\r\n                    borderLeftColor: 'black',\r\n                    borderRightWidth: 0,\r\n                    height: '77%'\r\n\r\n                }} />\r\n\r\n            <Box\r\n                style={{\r\n                    position: 'relative',\r\n                    // backgroundColor: '#333033',\r\n                    // display: 'grid',\r\n                    top: '5%',\r\n                    width: '85%',\r\n                    left: '15%',\r\n                }}>\r\n                {daysOfWeek.map((day) => (\r\n\r\n\r\n                    < div key={day}>\r\n\r\n\r\n                        <h2 key={day}\r\n                            style={{\r\n                                position: 'absolute',\r\n                                left: '-15%',\r\n                            }}\r\n                        >\r\n                            {day}\r\n                        </h2>\r\n\r\n\r\n                        <Grid container\r\n\r\n                            rowSpacing={{ xs: 1 }}\r\n                            columnSpacing={{ xs: 1 }}\r\n                            p={2}\r\n                            direction=\"row\"\r\n                            justifyContent=\"flex-start\"\r\n                            alignItems=\"flex-start\"\r\n                        // style={{ backgroundColor: '#FF0000' }}\r\n                        >\r\n                            {updatePosition(daysOfWeek.indexOf(day), 0, 0)}\r\n                            {tasks.filter((task) => task.day === day).map((task) => (\r\n\r\n                                <Grid item xs={task.EstimatedTimeToComplete / 30} key={task.id}  >\r\n\r\n                                    <Paper\r\n                                        sx={{\r\n                                            height: 40, display: 'flex', alignItems: 'center', justifyContent: 'center',\r\n                                            backgroundColor: task.Color,\r\n                                            transition: 'background-color 0.3s',\r\n                                            '&:hover': {\r\n                                                backgroundColor: 'white', // Adjust this value to set the hover color\r\n                                            },\r\n                                        }}\r\n                                        onClick={() => { props.onButtonClick(task); }}\r\n                                    >\r\n\r\n                                        {task.name}\r\n                                    </Paper>\r\n                                </Grid>\r\n\r\n\r\n                            )\r\n                            )}\r\n\r\n                        </Grid>\r\n\r\n                        <Divider sx={{ borderBottomWidth: 2, borderStyle: 'dashed', borderColor: 'black', }} />\r\n\r\n                    </div>\r\n                ))}\r\n            </Box>\r\n            {/* </Box > */}\r\n        </>\r\n    );\r\n};\r\n\r\nexport default WeekComponent;\r\n"],"names":["GridContext","getGridUtilityClass","slot","generateUtilityClass","SPACINGS","DIRECTIONS","WRAPS","GRID_SIZES","gridClasses","generateUtilityClasses","spacing","direction","wrap","size","_excluded","getOffset","val","parse","generateGrid","theme","ownerState","globalStyles","breakpoint","styles","columnsBreakpointValues","resolveBreakpointValues","columnValue","width","more","themeSpacing","fullWidth","_extends","generateDirection","directionValues","handleBreakpoints","propValue","output","extractZeroValueBreakpointKeys","breakpoints","values","nonZeroKey","key","sortedBreakpointKeysByValue","a","b","generateRowGap","container","rowSpacing","rowSpacingValues","zeroValueBreakpointKeys","_zeroValueBreakpointK","generateColumnGap","columnSpacing","columnSpacingValues","_zeroValueBreakpointK2","resolveSpacingStyles","spacingStyles","value","GridRoot","styled","props","item","zeroMinWidth","breakpointsStyles","resolveSpacingClasses","classes","className","useUtilityClasses","spacingClasses","breakpointsClasses","slots","composeClasses","Grid","React.forwardRef","inProps","ref","themeProps","useDefaultProps","useTheme","extendSxProp","columnsProp","columnSpacingProp","component","rowSpacingProp","other","_objectWithoutPropertiesLoose","columnsContext","React.useContext","columns","breakpointsValues","otherFiltered","_jsx","clsx","ALL_WEEKDAYS","Weekday","weekday","n","str","s","isPresent","isNumber","isWeekdayStr","isArray","range","start","end","rang","i","repeat","times","array","toArray","padStart","targetLength","padString","split","sep","num","splits","pymod","r","divmod","empty","obj","notEmpty","includes","arr","datetime","y","m","d","h","MONTH_DAYS","ONE_DAY","MAXYEAR","ORDINAL_BASE","PY_WEEKDAYS","isLeapYear","year","isDate","isValidDate","daysBetween","date1","date2","date1ms","date2ms","differencems","toOrdinal","date","fromOrdinal","ordinal","getMonthDays","month","getWeekday","monthRange","combine","time","clone","dolly","cloneDates","dates","clones","sort","timeToUntilString","utc","untilStringToDate","until","re","bits","dateTZtoISO8601","timeZone","dateStr","dateInTimeZone","localTimeZone","dateInLocalTZ","dateInTargetTZ","tzOffset","IterResult","method","args","tooEarly","tooLate","res","CallbackIterResult","_super","__extends","iterator","_this","ENGLISH","contains","defaultGetText","id","defaultDateFormatter","day","ToText","rrule","gettext","language","dateFormatter","bymonthday","bynmonthday","byweekday","days","sortWeekDays","canConvert","RRule","nth","npos","wday","callback","finalDelim","delim","delimJoin","delimiter","finalDelimiter","list","o","realCallback","arg","Parser","rules","text","best","bestSymbol","rule","name_1","match","name","v","parseText","options","ttr","S","AT","F","ON","wkd","decodeWKD","MDAYs","decodeM","on","the","decodeNTH","at","Frequency","freqIsDailyOrGreater","freq","fromText","common","toText","isFullyConvertible","Time","hour","minute","second","millisecond","DateTime","years","months","yearDiv","monthMod","wkst","hours","filtered","byhour","_a","dayDiv","hourMod","minutes","byminute","hourDiv","minuteMod","seconds","bysecond","minuteDiv","secondMod","daysinmonth","interval","initializeOptions","invalid","keys","_i","keys_1","defaultKeys","__assign","parseOptions","opts","DEFAULT_OPTIONS","bynweekday","buildTimeset","millisecondModulo","timeset","parseString","rfcString","parseLine","x","parseDtstart","line","dtstartWithZone","tzid","dtstart","header","parseRrule","strippedLine","attrs","attr","Days","parseNumber","optionKey","parseWeekday","parseIndividualNumber","parts","wdaypart","DateWithZone","datestr","optionsToString","outValue","buildDtstart","strValues","j","ruleString","argsMatch","left","right","Cache","what","cached","argsKeys","findCacheDiff","cachedObject","iterResult","M365MASK","__spreadArray","M366MASK","M28","M29","M30","M31","MDAY366MASK","MDAY365MASK","NM28","NM29","NM30","NM31","NMDAY366MASK","NMDAY365MASK","M366RANGE","M365RANGE","WDAYMASK","wdaymask","rebuildYear","firstyday","yearlen","nextyearlen","yearordinal","yearweekday","result","baseYearMasks","firstwkst","wyearlen","no1wkst","div","mod","numweeks","k","lnumweeks","lyearweekday","lno1wkst","lyearlen","weekst","rebuildMonth","mrange","ranges","first","last","easter","offset","c","e","f","g","l","yearStart","Iterinfo","_","set","buildPoslist","bysetpos","ii","dayset","poslist","daypos","timepos","pos","tmp","iter","count","emitResult","counterDate","makeTimeset","removeFilteredDays","rezonedDate","rezoneIfNeeded","currentDay","isFiltered","bymonth","byweekno","byeaster","byyearday","dayCounter","noCache","parsedOptions","after","before","inc","dt","iterSet","_rrule","_exrule","_rdate","_exdate","_exdateHash","_accept","evalExdate","zonedDate","parseInput","rrulevals","rdatevals","exrulevals","exdatevals","parsedDtstart","lines","splitIntoLines","_b","breakDownLine","parms","_c","rdateTzid","parseRDate","buildRule","rset_1","RRuleSet","groomRruleOptions","rrulestr","extractName","unfold","validateDateParm","parm","rdateval","createGetterSetter","fieldName","field","field_1","_addRule","_addDate","exrule","rdatesToString","rrs","collection","param","rdates","isUTC","dateString","rdate","NodeShaderStage","NodeUpdateType","vectorComponents","getCacheKey","object","force","cacheKey","property","childNode","getNodeChildren","node","toJSON","child","subProperty","getValueType","typeOf","getValueFromType","type","params","last4","Color","Vector2","Vector3","Vector4","Matrix3","Matrix4","base64ToArrayBuffer","arrayBufferToBase64","arrayBuffer","chars","base64","NodeClasses","_nodeId","Node","EventDispatcher","nodeType","MathUtils","updateType","builder","nodeProperties","hash","index","nodeData","outputNode","refNode","buildStage","properties","stackNodesBeforeSetup","json","nodeChildren","inputNodes","nodes","inputArray","uuid","inputObject","meta","isRoot","data","extractFromCache","cache","textures","images","addNodeClass","nodeClass","TempNode","snippet","nodeVar","propertyName","ArrayElementNode","indexNode","nodeSnippet","indexSnippet","ConvertNode","convertTo","requestType","overloadingType","JoinNode","cur","primitiveType","snippetValues","input","inputSnippet","inputPrimitiveType","stringVectorComponents","SplitNode","components","vectorLength","nodeTypeLength","SetNode","sourceNode","targetNode","sourceType","targetType","targetSnippet","sourceSnippet","length","InputNode","precision","ConstNode","currentStack","NodeElements","addNodeElement","nodeElement","parseSwizzle","shaderNodeHandler","NodeClosure","inputs","nodeObjects","prop","nodeObj","nodeObject","nodeObjectsCacheMap","nodeBuilderFunctionsCacheMap","ShaderNodeObject","altType","getConstNode","tslFn","ShaderNodeObjects","objects","ShaderNodeArray","len","ShaderNodeProxy","NodeClass","scope","factor","settings","assignNode","nodeArray","ShaderNodeImmutable","ShaderCallNodeInternal","shaderNode","functionNodesCacheMap","functionNode","jsFunc","ShaderNodeInternal","layout","bools","uints","ints","floats","boolsCacheMap","bool","uintsCacheMap","uint","intsCacheMap","el","int","floatsCacheMap","float","cacheMaps","constNodesCacheMap","safeGetNodeType","ConvertType","cacheMap","defined","getConstNodeType","ShaderNode","nodeProxy","nodeImmutable","fn","setCurrentStack","stack","getCurrentStack","If","append","color","vec2","ivec2","uvec2","bvec2","vec3","ivec3","uvec3","bvec3","vec4","ivec4","uvec4","bvec4","mat2","imat2","umat2","bmat2","mat3","imat3","umat3","bmat3","mat4","imat4","umat4","bmat4","element","convert","types","AssignNode","needsSplitAssign","target","source","sourceVar","sourceProperty","targetRoot","assign","VaryingNode","varying","AttributeNode","attributeName","defaultNode","attribute","attributeType","nodeAttribute","BypassNode","returnNode","callNode","bypass","CacheNode","parent","previousCache","ContextNode","context","previousContext","label","IndexNode","vertexIndex","instanceIndex","drawIndex","LightingModel","VarNode","temp","PropertyNode","varyingProperty","diffuseColor","roughness","metalness","clearcoat","clearcoatRoughness","sheen","sheenRoughness","iridescence","iridescenceIOR","iridescenceThickness","alphaT","anisotropy","anisotropyT","anisotropyB","specularColor","specularF90","shininess","dashSize","gapSize","ior","transmission","thickness","attenuationDistance","attenuationColor","dispersion","ParameterNode","CodeNode","code","include","nodeCode","FunctionNode","nodeFunction","keywords","keywordsProperties","propertyRegExp","nodeProperty","UniformGroupNode","shared","uniformGroup","sharedUniformGroup","objectGroup","UniformNode","group","self","frame","sharedNode","sharedNodeType","nodeUniform","uniform","arg1","arg2","uv","TextureSizeNode","textureNode","levelNode","textureProperty","textureSize","OperatorNode","op","aNode","bNode","finalOp","typeA","typeB","typeLength","outputLength","fnOpSnippet","add","sub","mul","remainder","equal","notEqual","lessThan","greaterThan","lessThanEqual","greaterThanEqual","and","or","not","xor","bitAnd","bitNot","bitOr","bitXor","shiftLeft","shiftRight","MathNode","cNode","aType","bType","cType","aLen","bLen","cLen","inputType","isWebGL","tA","tB","mulNode","normalize","abs","EPSILON","PI","all","any","equals","radians","degrees","exp","exp2","log","log2","sqrt","inverseSqrt","floor","ceil","fract","sin","cos","tan","asin","acos","atan","sign","negate","oneMinus","dFdx","dFdy","round","reciprocal","trunc","fwidth","transpose","atan2","min","max","step","reflect","distance","difference","dot","cross","pow","pow2","pow3","pow4","transformDirection","cbrt","lengthSq","mix","clamp","low","high","saturate","refract","smoothstep","faceForward","mixElement","t","e1","e2","smoothstepElement","sRGBToLinearShader","rgb","rgbResult","LinearTosRGBShader","getColorSpaceMethod","colorSpace","LinearSRGBColorSpace","SRGBColorSpace","getMethod","ColorSpaceNode","Methods","linearToColorSpace","colorSpaceToLinear","linearTosRGB","sRGBToLinear","ExpressionNode","expression","MaxMipLevelNode","texture","image","height","maxMipLevel","TextureNode","uvNode","UnsignedIntType","IntType","uvSnippet","levelSnippet","depthSnippet","compareSnippet","gradSnippet","compareNode","depthNode","gradNode","gradNodeX","gradNodeY","newNode","textureLoad","BufferNode","bufferType","bufferCount","buffer","UniformsElementNode","UniformsNode","elementType","elementLength","vector","arrayType","uniforms","ReferenceElementNode","referenceNode","ReferenceNode","uniformType","state","reference","referenceBuffer","MaterialReferenceNode","material","materialReference","cameraGroup","cameraNear","camera","cameraFar","cameraLogDepth","cameraProjectionMatrix","cameraViewMatrix","cameraPosition","Object3DNode","object3d","uniformNode","objectPosition","objectViewPosition","ModelNode","modelViewMatrix","modelNormalMatrix","modelWorldMatrix","modelWorldMatrixInverse","normalGeometry","normalLocal","normalView","normalWorld","transformedNormalView","transformedNormalWorld","transformedClearcoatNormalView","_propertyCache","MaterialNode","colorNode","opacityNode","specularIntensity","specularColorNode","roughnessNode","metalnessNode","emissiveNode","clearcoatNode","clearcoatRoughnessNode","sheenNode","sheenRoughnessNode","anisotropyPolar","materialAnisotropyVector","iridescenceThicknessMaximum","iridescenceThicknessMinimum","transmissionNode","thicknessNode","outputType","materialAlphaTest","materialColor","materialShininess","materialEmissive","materialOpacity","materialSpecular","materialSpecularIntensity","materialSpecularColor","materialSpecularStrength","materialRoughness","materialMetalness","materialNormal","materialClearcoat","materialClearcoatRoughness","materialClearcoatNormal","materialRotation","materialSheen","materialSheenRoughness","materialAnisotropy","materialIridescence","materialIridescenceIOR","materialIridescenceThickness","materialTransmission","materialThickness","materialIOR","materialAttenuationDistance","materialAttenuationColor","materialLineScale","materialLineDashSize","materialLineGapSize","materialLineWidth","materialLineDashOffset","materialPointWidth","materialDispersion","positionGeometry","positionLocal","positionWorld","positionWorldDirection","positionView","positionViewDirection","ModelViewProjectionNode","positionNode","position","modelViewProjection","BufferAttributeNode","bufferStride","bufferOffset","StaticDrawUsage","bufferData","itemSize","stride","InterleavedBuffer","bufferAttribute","InterleavedBufferAttribute","dynamicBufferAttribute","DynamicDrawUsage","instancedBufferAttribute","instancedDynamicBufferAttribute","bufferNode","InstanceNode","instanceMesh","instanceMatrixNode","instanceAttribute","InstancedInterleavedBuffer","bufferFn","instanceBuffers","instanceColorAttribute","InstancedBufferAttribute","instancePosition","transformedNormal","instanceNormal","instance","tangentGeometry","tangentLocal","tangentView","BatchNode","batchMesh","getIndirectIndex","matriceTexture","batchingMatrix","bm","batchingNormal","batch","SkinningNode","skinnedMesh","useReference","bindMatrixNode","bindMatrixInverseNode","boneMatricesNode","skinIndexNode","skinWeightNode","boneMatX","boneMatY","boneMatZ","boneMatW","skinVertex","skinned","skinPosition","skinMatrix","skinNormal","skinningReference","LoopNode","returnsNode","stackNode","condition","update","internalParam","startSnippet","endSnippet","declarationSnippet","conditionalSnippet","updateSnippet","forSnippet","stackSnippet","returnsSnippet","loop","Break","returns","morphTextures","morphVec4","getMorph","bufferMap","influence","depth","texelIndex","getEntry","geometry","hasMorphPosition","hasMorphNormals","hasMorphColors","morphAttribute","morphTargetsCount","entry","disposeTexture","bufferTexture","morphTargets","morphNormals","morphColors","vertexDataCount","maxTextureSize","DataArrayTexture","FloatType","vertexDataStride","morphTarget","morphNormal","morphColor","MorphNode","mesh","morphBaseInfluence","morphReference","reflectView","reflectVector","CubeTextureNode","WebGPUCoordinateSystem","cubeUV","cubeTexture","LightingNode","overrideMaterial","AnalyticLightNode","light","shadowNode","shadow","rtt","depthTexture","DepthTexture","NearestFilter","LessCompare","shadowIntensity","bias","normalBias","shadowCoord","frustumTest","coordZ","compare","shadowColor","shadowMaskNode","renderer","scene","currentOverrideMaterial","currentToneMapping","currentRenderTarget","currentRenderObjectFunction","NoToneMapping","LightNodes","sortLights","lights","LightsNode","lightNodes","lightNode","lightingModel","outgoingLightNode","totalDiffuseNode","totalSpecularNode","backdrop","backdropAlpha","directDiffuse","directSpecular","indirectDiffuse","indirectSpecular","totalDiffuse","lightClass","lightNodeClass","lightsNode","addLightNode","AONode","aoNode","LightingContextNode","backdropNode","backdropAlphaNode","reflectedLight","lightingContext","getBitangent","crossNormalTangent","bitangentView","TBNViewMatrix","transformedBentNormalView","bentNormal","CondNode","condNode","ifNode","elseNode","ifType","elseType","needsOutput","ifSnippet","elseSnippet","cond","cubeUV_r0","cubeUV_m0","cubeUV_r1","cubeUV_m1","cubeUV_r4","cubeUV_m4","cubeUV_r5","cubeUV_m5","cubeUV_r6","cubeUV_m6","cubeUV_minMipLevel","cubeUV_minTileSize","getFace","absDirection","face","getUV","roughnessToMip","mip","uv_immutable","textureCubeUV","envMap","sampleDir_immutable","roughness_immutable","CUBEUV_TEXEL_WIDTH","CUBEUV_TEXEL_HEIGHT","CUBEUV_MAX_MIP","sampleDir","mipF","mipInt","color0","bilinearCubeUV","color1","direction_immutable","mipInt_immutable","filterInt","faceSize","getSample","outputDirection","theta","axis","cosTheta","sampleDirection","latitudinal","poleAxis","weights","samples","dTheta","gl_FragColor","_generator","_cache","_generateCubeUVSize","imageHeight","maxMip","texelHeight","_getPMREMFromTexture","cacheTexture","PMREMNode","cubeUVSize","pmrem","pmremVersion","WebGLCoordinateSystem","pmremTexture","envNodeCache","EnvironmentNode","envNode","cacheEnvNode","intensity","radianceNormalView","radiance","createRadianceContext","irradiance","createIrradianceContext","isolateRadiance","isolateIrradiance","clearcoatRadiance","clearcoatRadianceContext","isolateClearcoatRadiance","normalViewNode","reflectVec","normalWorldNode","IrradianceNode","resolution","viewportResult","ViewportNode","viewportCoordinate","viewportResolution","outX","outY","coord","viewport","viewportTopLeft","_size","ViewportTextureNode","framebufferTexture","FramebufferTexture","LinearMipmapLinearFilter","currentGenerateMipmaps","viewportTextureNode","viewportTexture","viewportMipTexture","sharedDepthbuffer","ViewportDepthTextureNode","viewportDepthTexture","ViewportDepthNode","valueNode","depthBase","viewZToPerspectiveDepth","viewZToOrthographicDepth","viewZ","perspectiveDepthToViewZ","near","far","linearDepth","ClippingNode","clippingContext","localClipIntersection","localClippingCount","globalClippingCount","numClippingPlanes","numUnionClippingPlanes","planes","clippingPlanes","distanceToPlane","distanceGradient","clipOpacity","plane","unionClipOpacity","clipped","clipping","clippingAlpha","FrontFacingNode","BackSide","frontFacing","faceDirection","NodeMaterials","NodeMaterial","Material","resultNode","clippingNode","basicOutput","fragmentNode","displacementMap","displacementScale","displacementBias","mvp","alphaTestNode","NormalBlending","normalNode","materialLightsNode","lightsN","fogNode","descriptors","nodeMaterial","createNodeMaterialFromType","addNodeMaterial","StackNode","boolNode","methodNode","previousStack","EquirectUVNode","dirNode","dir","u","StructTypeNode","OutputStructNode","members","structPrefix","HashNode","seedNode","word","parabola","gain","pcurve","sinc","tri","tri3","p","triNoise3D","p_immutable","spd","z","rz","bp","dg","discardExpression","DiscardNode","inlineDiscard","discard","FunctionOverloadingNode","functionNodes","parametersNodes","candidateFnCall","candidateFn","candidateScore","score","MatcapUVNode","matcapUV","TimerNode","scale","timerLocal","timeScale","OscNode","timeNode","PackingNode","directionToColor","colorToDirection","RemapNode","inLowNode","inHighNode","outLowNode","outHighNode","doClamp","remap","remapClamp","RotateUVNode","rotationNode","centerNode","rotateUV","RotateNode","cosAngle","sinAngle","rotation","rotationXMatrix","rotationYMatrix","rotationZMatrix","rotate","SpriteSheetUVNode","countNode","frameNode","frameNum","column","row","uvFrameOffset","StorageArrayElementNode","storageBufferNode","isAssignContext","storageElement","TriplanarTexturesNode","textureXNode","textureYNode","textureZNode","scaleNode","bf","tx","ty","tz","textureX","textureY","textureZ","cx","cy","cz","triplanarTextures","triplanarTexture","Plane","RenderTarget","VertexColorNode","geometryAttribute","RendererReferenceNode","rendererReference","bC","w0","w1","w2","w3","g0","g1","h0","h1","bicubic","texelSize","lod","uvScaled","iuv","fuv","g0x","g1x","h0x","h1x","h0y","h1y","p0","p1","p2","p3","textureBicubicMethod","lodNode","fLodSize","cLodSize","fLodSizeInv","cLodSizeInv","fSample","cSample","TextureBicubicNode","blurNode","textureBicubic","PointUVNode","SceneNode","GPUBufferBindingType","GPUStorageTextureAccess","StorageBufferNode","StorageTextureNode","storeNode","storeSnippet","normal","ret","Texture3DNode","texture3D","UserDataNode","userData","BurnNode","base","blend","DodgeNode","ScreenNode","OverlayNode","BlendModeNode","blendMode","baseNode","blendNode","burn","dodge","overlay","screen","dHdxy_fwd","bumpScale","sampleTexture","texNode","Hll","perturbNormalArb","surf_pos","surf_norm","dHdxy","vSigmaX","vSigmaY","vN","R1","R2","fDet","vGrad","BumpMapNode","bumpMap","saturationNode","adjustment","luminance","vibranceNode","average","mx","amt","hueNode","ColorAdjustmentNode","adjustmentNode","callParams","saturation","vibrance","hue","lumaCoeffs","luma","threshold","perturbNormal2Arb","eye_pos","mapN","q0","q1","st0","st1","N","q1perp","q0perp","T","B","det","NormalMapNode","TangentSpaceNormalMap","normalMapType","normalMap","ObjectSpaceNormalMap","PosterizeNode","stepsNode","posterize","LinearToneMappingNode","exposure","ReinhardToneMappingNode","OptimizedCineonToneMappingNode","RRTAndODTFit","ACESFilmicToneMappingNode","ACESInputMat","ACESOutputMat","LINEAR_REC2020_TO_LINEAR_SRGB","LINEAR_SRGB_TO_LINEAR_REC2020","agxDefaultContrastApprox","x_immutable","x2","x4","AGXToneMappingNode","colortone","AgXInsetMatrix","AgXOutsetMatrix","AgxMinEv","AgxMaxEv","NeutralToneMappingNode","StartCompression","Desaturation","peak","newPeak","toneMappingLib","LinearToneMapping","ReinhardToneMapping","CineonToneMapping","ACESFilmicToneMapping","AgXToneMapping","NeutralToneMapping","ToneMappingNode","toneMapping","exposureNode","toneMappingExposure","toneMappingParams","toneMappingNode","mapping","_sharedFramebuffer","ViewportSharedTextureNode","viewportSharedTexture","PassTextureNode","passNode","PassNode","renderTarget","HalfFloatType","currentToneMappingNode","effectiveWidth","effectiveHeight","pixelRatio","texturePass","pass","_camera","OrthographicCamera","QuadGeometry","BufferGeometry","flipY","Float32BufferAttribute","_geometry","QuadMesh","Mesh","quadMesh1","quadMesh2","GaussianBlurNode","sigma","map","currentTexture","textureType","blur","kernelSize","gaussianCoefficients","invSize","weightSum","diffuseSum","w","uvOffset","sample1","sample2","kernelRadius","coefficients","gaussianBlur","quadMeshComp","AfterImageNode","damp","textureNodeOld","when_gt","y_immutable","afterImg","texelOld","texelNew","materialComposed","afterImage","quadMesh","AnamorphicNode","tresholdNode","anamorph","halfSamples","total","softness","anamorphic","SobelOperatorNode","texel","Gx","Gy","tx0y0","tx0y1","tx0y2","tx1y0","tx1y1","tx1y2","tx2y0","tx2y1","tx2y2","valueGx","valueGy","G","sobel","DepthOfFieldNode","viewZNode","focus","aperture","maxblur","aspectcorrect","dofblur","dofblur9","dofblur7","dofblur4","col","dof","apeture","DotScreenNode","center","angle","pattern","tex","point","dotScreen","RGBShiftNode","amount","cr","cga","cb","rgbShift","FunctionCallNode","parameters","inputNode","call","func","ScriptableValueNode","scriptableValue","Resources","Parameters","scriptableNode","global","ScriptableNode","codeNode","outputs","refresh","setOutput","THREE","TSL","parametersProps","declarations","scriptable","FogNode","factorNode","getViewZ","fog","FogRangeNode","nearNode","farNode","rangeFog","FogExp2Node","densityNode","density","densityFog","RangeNode","minNode","maxNode","minLength","maxLength","minValue","maxValue","minElementValue","maxElementValue","ComputeNode","computeNode","workgroupSize","shaderStage","compute","LightNode","lightTargetDirection","getDistanceAttenuation","lightDistance","cutoffDistance","decayExponent","distanceFalloff","PointLightNode","cutoffDistanceNode","decayExponentNode","lVector","lightDirection","lightAttenuation","lightColor","PointLight","DirectionalLightNode","DirectionalLight","_matrix41","_matrix42","ltc_1","ltc_2","RectAreaLightNode","viewMatrix","UniformsLib","lightPosition","RectAreaLight","SpotLightNode","angleCosine","coneCosNode","penumbraCosNode","angleCos","spotAttenuation","SpotLight","IESSpotLight","penumbra","decay","recursive","IESSpotLightNode","iesMap","AmbientLightNode","AmbientLight","HemisphereLightNode","groundColorNode","lightDirectionNode","hemiDiffuseWeight","HemisphereLight","checkerShaderNode","CheckerNode","checker","defaultValues","PointsMaterial","InstancedPointsNodeMaterial","useAlphaToCoverage","useColor","mvPos","aspect","clipPos","vUv","alpha","len2","dlen","pointColorNode","LineBasicMaterial","LineBasicNodeMaterial","LineDashedMaterial","LineDashedNodeMaterial","offsetNode","dashScaleNode","dashSizeNode","gapSizeNode","vLineDistance","Line2NodeMaterial","useDash","useWorldUnits","trimSegment","instanceStart","instanceEnd","perspective","clipStart","clipEnd","ndcStart","ndcEnd","clip","worldDir","tmpFwd","worldUp","worldFwd","worldPos","hw","clipPose","closestLineToLine","p4","p13","p43","p21","d1343","d4321","d1321","d4343","denom","mua","mub","instanceDistanceStart","instanceDistanceEnd","lineDistance","vLineDistanceOffset","worldStart","worldEnd","rayEnd","lineDir","norm","dnorm","lineColorNode","instanceColorStart","instanceColorEnd","MeshNormalMaterial","MeshNormalNodeMaterial","MeshBasicMaterial","MeshBasicNodeMaterial","F_Schlick","f0","f90","dotVH","fresnel","BRDF_Lambert","G_BlinnPhong_Implicit","D_BlinnPhong","dotNH","BRDF_BlinnPhong","halfDir","D","PhongLightingModel","specular","MeshLambertMaterial","MeshLambertNodeMaterial","MeshPhongMaterial","MeshPhongNodeMaterial","shininessNode","specularNode","getGeometryRoughness","dxy","getRoughness","geometryRoughness","roughnessFactor","V_GGX_SmithCorrelated","dotNL","dotNV","a2","gv","gl","V_GGX_SmithCorrelated_Anisotropic","alphaB","dotTV","dotBV","dotTL","dotBL","D_GGX","RECIPROCAL_PI","D_GGX_Anisotropic","dotTH","dotBH","v2","BRDF_GGX","USE_IRIDESCENCE","USE_ANISOTROPY","V","DFGApprox","c0","c1","a004","EnvironmentBRDF","fab","Schlick_to_F0","x5","D_Charlie","invAlpha","sin2h","V_Neubelt","BRDF_Sheen","LTC_Uv","LUT_BIAS","LTC_ClippedSphereFormFactor","LTC_EdgeVectorFormFactor","v1","theta_sintheta","LTC_Evaluate","P","mInv","lightNormal","T1","T2","mat","coords0","coords1","coords2","coords3","vectorFormFactor","getVolumeTransmissionRay","modelMatrix","refractionVector","modelScale","applyIorToRoughness","singleViewportMipTexture","getTransmissionSample","fragCoord","transmissionSample","volumeAttenuation","transmissionDistance","attenuationCoefficient","getIBLVolumeRefraction","projMatrix","transmittedLight","transmittance","halfSpread","iors","transmissionRay","refractedRayExit","ndcPos","refractionCoords","attenuatedColor","transmittanceFactor","XYZ_TO_REC709","Fresnel0ToIor","fresnel0","sqrtF0","IorToFresnel0","transmittedIor","incidentIor","evalSensitivity","OPD","shift","phase","VAR","xyz","evalIridescence","outsideIOR","eta2","cosTheta1","thinFilmThickness","baseF0","sinTheta2Sq","cosTheta2","R0","R12","T121","phi12","phi21","baseIOR","R23","phi23","phi","R123","r123","Rs","I","Cm","Sm","IBLSheenBRDF","viewDir","r2","clearcoatF0","clearcoatF90","PhysicalLightingModel","dotNVi","singleScatter","multiScatter","FssEss","Ems","Favg","Fms","ccIrradiance","halfWidth","halfHeight","t1","t2","iblIrradiance","dotNVcc","clearcoatEnv","singleScattering","multiScattering","cosineWeightedIrradiance","totalScattering","diffuse","ambientOcclusion","aoNV","aoExp","outgoingLight","Fcc","clearcoatLight","sheenEnergyComp","sheenLight","MeshStandardMaterial","MeshStandardNodeMaterial","MeshPhysicalMaterial","MeshPhysicalNodeMaterial","iorNode","iridescenceNode","iridescenceIORNode","iridescenceThicknessNode","anisotropyV","attenuationDistanceNode","attenuationColorNode","dispersionNode","clearcoatNormalNode","SSSLightingModel","useClearcoat","useSheen","useIridescence","useSSS","thicknessColorNode","thicknessDistortionNode","thicknessAmbientNode","thicknessAttenuationNode","thicknessPowerNode","thicknessScaleNode","scatteringHalf","scatteringDot","scatteringIllu","MeshSSSNodeMaterial","getGradientIrradiance","gradientMap","fw","ToonLightingModel","MeshToonMaterial","MeshToonNodeMaterial","MeshMatcapMaterial","MeshMatcapNodeMaterial","matcapColor","PointsNodeMaterial","SpriteMaterial","SpriteNodeMaterial","vertex","mvPosition","alignedPosition","rotatedPosition","ShadowMaskModel","shadowMask","ShadowMaterial","ShadowNodeMaterial","VolumeNodeMaterial","hitBox","orig","box_min","box_max","inv_dir","tmin_tmp","tmax_tmp","tmin","tmax","t0","vOrigin","rayDir","bounds","delta","ac","superFromTypeFunction","MaterialLoader","daysOfWeek","colours","temptasks","dayOfWeek","WeekComponent","refs","useRef","tasks","setTasks","useState","useEffect","React","getAllTaskInstances","taskInstance","fetchCrewNames","AssignedCrewName","updatedData","updatePosition","dayIndex","top","jsxs","Fragment","jsx","headerStyle","Divider","Box","task","Paper"],"mappings":"+zBAOA,MAAMA,oBAA+C,ECL9C,SAASC,GAAoBC,EAAM,CACxC,OAAOC,GAAqB,UAAWD,CAAI,CAC7C,CACA,MAAME,GAAW,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAE,EAC5CC,GAAa,CAAC,iBAAkB,SAAU,cAAe,KAAK,EAC9DC,GAAQ,CAAC,SAAU,eAAgB,MAAM,EACzCC,GAAa,CAAC,OAAQ,GAAM,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,GAAI,EAAE,EACjEC,GAAcC,GAAuB,UAAW,CAAC,OAAQ,YAAa,OAAQ,eAEpF,GAAGL,GAAS,IAAIM,GAAW,cAAcA,CAAO,EAAE,EAElD,GAAGL,GAAW,IAAIM,GAAa,gBAAgBA,CAAS,EAAE,EAE1D,GAAGL,GAAM,IAAIM,GAAQ,WAAWA,CAAI,EAAE,EAEtC,GAAGL,GAAW,IAAIM,GAAQ,WAAWA,CAAI,EAAE,EAAG,GAAGN,GAAW,IAAIM,GAAQ,WAAWA,CAAI,EAAE,EAAG,GAAGN,GAAW,IAAIM,GAAQ,WAAWA,CAAI,EAAE,EAAG,GAAGN,GAAW,IAAIM,GAAQ,WAAWA,CAAI,EAAE,EAAG,GAAGN,GAAW,IAAIM,GAAQ,WAAWA,CAAI,EAAE,CAAC,CAAC,ECH/NC,GAAY,CAAC,YAAa,UAAW,gBAAiB,YAAa,YAAa,YAAa,OAAQ,aAAc,UAAW,OAAQ,cAAc,EAc1J,SAASC,GAAUC,EAAK,CAChB,MAAAC,EAAQ,WAAWD,CAAG,EAC5B,MAAO,GAAGC,CAAK,GAAG,OAAOD,CAAG,EAAE,QAAQ,OAAOC,CAAK,EAAG,EAAE,GAAK,IAAI,EAClE,CACO,SAASC,GAAa,CAC3B,MAAAC,EACA,WAAAC,CACF,EAAG,CACG,IAAAP,EACJ,OAAOM,EAAM,YAAY,KAAK,OAAO,CAACE,EAAcC,IAAe,CAEjE,IAAIC,EAAS,CAAA,EAIb,GAHIH,EAAWE,CAAU,IACvBT,EAAOO,EAAWE,CAAU,GAE1B,CAACT,EACI,OAAAQ,EAET,GAAIR,IAAS,GAEFU,EAAA,CACP,UAAW,EACX,SAAU,EACV,SAAU,MAAA,UAEHV,IAAS,OACTU,EAAA,CACP,UAAW,OACX,SAAU,EACV,WAAY,EACZ,SAAU,OACV,MAAO,MAAA,MAEJ,CACL,MAAMC,EAA0BC,GAAwB,CACtD,OAAQL,EAAW,QACnB,YAAaD,EAAM,YAAY,MAAA,CAChC,EACKO,EAAc,OAAOF,GAA4B,SAAWA,EAAwBF,CAAU,EAAIE,EACpG,GAA6BE,GAAgB,KACxC,OAAAL,EAGH,MAAAM,EAAQ,GAAG,KAAK,MAAMd,EAAOa,EAAc,GAAI,EAAI,GAAI,IAC7D,IAAIE,EAAO,CAAA,EACX,GAAIR,EAAW,WAAaA,EAAW,MAAQA,EAAW,gBAAkB,EAAG,CAC7E,MAAMS,EAAeV,EAAM,QAAQC,EAAW,aAAa,EAC3D,GAAIS,IAAiB,MAAO,CAC1B,MAAMC,EAAY,QAAQH,CAAK,MAAMZ,GAAUc,CAAY,CAAC,IACrDD,EAAA,CACL,UAAWE,EACX,SAAUA,CAAA,CAEd,CACF,CAIAP,EAASQ,GAAS,CAChB,UAAWJ,EACX,SAAU,EACV,SAAUA,GACTC,CAAI,CACT,CAGA,OAAIT,EAAM,YAAY,OAAOG,CAAU,IAAM,EACpC,OAAA,OAAOD,EAAcE,CAAM,EAElCF,EAAaF,EAAM,YAAY,GAAGG,CAAU,CAAC,EAAIC,EAE5CF,CACT,EAAG,CAAE,CAAA,CACP,CACO,SAASW,GAAkB,CAChC,MAAAb,EACA,WAAAC,CACF,EAAG,CACD,MAAMa,EAAkBR,GAAwB,CAC9C,OAAQL,EAAW,UACnB,YAAaD,EAAM,YAAY,MAAA,CAChC,EACD,OAAOe,GAAkB,CACvB,MAAAf,CAAA,EACCc,EAA8BE,GAAA,CAC/B,MAAMC,EAAS,CACb,cAAeD,CAAA,EAEjB,OAAIA,EAAU,QAAQ,QAAQ,IAAM,IAClCC,EAAO,QAAQ5B,GAAY,IAAI,EAAE,EAAI,CACnC,SAAU,MAAA,GAGP4B,CAAA,CACR,CACH,CAOA,SAASC,GAA+B,CACtC,YAAAC,EACA,OAAAC,CACF,EAAG,CACD,IAAIC,EAAa,GACjB,OAAO,KAAKD,CAAM,EAAE,QAAeE,GAAA,CAC7BD,IAAe,IAGfD,EAAOE,CAAG,IAAM,IACLD,EAAAC,EACf,CACD,EACK,MAAAC,EAA8B,OAAO,KAAKJ,CAAW,EAAE,KAAK,CAACK,EAAGC,IAC7DN,EAAYK,CAAC,EAAIL,EAAYM,CAAC,CACtC,EACD,OAAOF,EAA4B,MAAM,EAAGA,EAA4B,QAAQF,CAAU,CAAC,CAC7F,CACO,SAASK,GAAe,CAC7B,MAAA1B,EACA,WAAAC,CACF,EAAG,CACK,KAAA,CACJ,UAAA0B,EACA,WAAAC,CACE,EAAA3B,EACJ,IAAIG,EAAS,CAAA,EACT,GAAAuB,GAAaC,IAAe,EAAG,CACjC,MAAMC,EAAmBvB,GAAwB,CAC/C,OAAQsB,EACR,YAAa5B,EAAM,YAAY,MAAA,CAChC,EACG,IAAA8B,EACA,OAAOD,GAAqB,WAC9BC,EAA0BZ,GAA+B,CACvD,YAAalB,EAAM,YAAY,OAC/B,OAAQ6B,CAAA,CACT,GAEHzB,EAASW,GAAkB,CACzB,MAAAf,CAAA,EACC6B,EAAkB,CAACb,EAAWb,IAAe,CAC1C,IAAA4B,EACE,MAAArB,EAAeV,EAAM,QAAQgB,CAAS,EAC5C,OAAIN,IAAiB,MACZ,CACL,UAAW,IAAId,GAAUc,CAAY,CAAC,GACtC,CAAC,QAAQrB,GAAY,IAAI,EAAE,EAAG,CAC5B,WAAYO,GAAUc,CAAY,CACpC,CAAA,GAGCqB,EAAwBD,IAA4B,MAAQC,EAAsB,SAAS5B,CAAU,EACjG,GAEF,CACL,UAAW,EACX,CAAC,QAAQd,GAAY,IAAI,EAAE,EAAG,CAC5B,WAAY,CACd,CAAA,CACF,CACD,CACH,CACO,OAAAe,CACT,CACO,SAAS4B,GAAkB,CAChC,MAAAhC,EACA,WAAAC,CACF,EAAG,CACK,KAAA,CACJ,UAAA0B,EACA,cAAAM,CACE,EAAAhC,EACJ,IAAIG,EAAS,CAAA,EACT,GAAAuB,GAAaM,IAAkB,EAAG,CACpC,MAAMC,EAAsB5B,GAAwB,CAClD,OAAQ2B,EACR,YAAajC,EAAM,YAAY,MAAA,CAChC,EACG,IAAA8B,EACA,OAAOI,GAAwB,WACjCJ,EAA0BZ,GAA+B,CACvD,YAAalB,EAAM,YAAY,OAC/B,OAAQkC,CAAA,CACT,GAEH9B,EAASW,GAAkB,CACzB,MAAAf,CAAA,EACCkC,EAAqB,CAAClB,EAAWb,IAAe,CAC7C,IAAAgC,EACE,MAAAzB,EAAeV,EAAM,QAAQgB,CAAS,EAC5C,OAAIN,IAAiB,MACZ,CACL,MAAO,eAAed,GAAUc,CAAY,CAAC,IAC7C,WAAY,IAAId,GAAUc,CAAY,CAAC,GACvC,CAAC,QAAQrB,GAAY,IAAI,EAAE,EAAG,CAC5B,YAAaO,GAAUc,CAAY,CACrC,CAAA,GAGCyB,EAAyBL,IAA4B,MAAQK,EAAuB,SAAShC,CAAU,EACnG,GAEF,CACL,MAAO,OACP,WAAY,EACZ,CAAC,QAAQd,GAAY,IAAI,EAAE,EAAG,CAC5B,YAAa,CACf,CAAA,CACF,CACD,CACH,CACO,OAAAe,CACT,CACO,SAASgC,GAAqB7C,EAAS4B,EAAaf,EAAS,CAAA,EAAI,CAElE,GAAA,CAACb,GAAWA,GAAW,EACzB,MAAO,GAGT,GAAI,OAAOA,GAAY,UAAY,CAAC,OAAO,MAAM,OAAOA,CAAO,CAAC,GAAK,OAAOA,GAAY,SACtF,MAAO,CAACa,EAAO,cAAc,OAAOb,CAAO,CAAC,EAAE,CAAC,EAGjD,MAAM8C,EAAgB,CAAA,EACtB,OAAAlB,EAAY,QAAsBhB,GAAA,CAC1B,MAAAmC,EAAQ/C,EAAQY,CAAU,EAC5B,OAAOmC,CAAK,EAAI,GACJD,EAAA,KAAKjC,EAAO,WAAWD,CAAU,IAAI,OAAOmC,CAAK,CAAC,EAAE,CAAC,CACrE,CACD,EACMD,CACT,CAQA,MAAME,GAAWC,GAAO,MAAO,CAC7B,KAAM,UACN,KAAM,OACN,kBAAmB,CAACC,EAAOrC,IAAW,CAC9B,KAAA,CACJ,WAAAH,CACE,EAAAwC,EACE,CACJ,UAAAd,EACA,UAAAnC,EACA,KAAAkD,EACA,QAAAnD,EACA,KAAAE,EACA,aAAAkD,EACA,YAAAxB,CACE,EAAAlB,EACJ,IAAIoC,EAAgB,CAAA,EAGhBV,IACcU,EAAAD,GAAqB7C,EAAS4B,EAAaf,CAAM,GAEnE,MAAMwC,EAAoB,CAAA,EAC1B,OAAAzB,EAAY,QAAsBhB,GAAA,CAC1B,MAAAmC,EAAQrC,EAAWE,CAAU,EAC/BmC,GACgBM,EAAA,KAAKxC,EAAO,QAAQD,CAAU,IAAI,OAAOmC,CAAK,CAAC,EAAE,CAAC,CACtE,CACD,EACM,CAAClC,EAAO,KAAMuB,GAAavB,EAAO,UAAWsC,GAAQtC,EAAO,KAAMuC,GAAgBvC,EAAO,aAAc,GAAGiC,EAAe7C,IAAc,OAASY,EAAO,gBAAgB,OAAOZ,CAAS,CAAC,EAAE,EAAGC,IAAS,QAAUW,EAAO,WAAW,OAAOX,CAAI,CAAC,EAAE,EAAG,GAAGmD,CAAiB,CAChR,CACF,CAAC,EAAE,CAAC,CACF,WAAA3C,CACF,IAAMW,GAAS,CACb,UAAW,YACb,EAAGX,EAAW,WAAa,CACzB,QAAS,OACT,SAAU,OACV,MAAO,MACT,EAAGA,EAAW,MAAQ,CACpB,OAAQ,CACV,EAAGA,EAAW,cAAgB,CAC5B,SAAU,CACZ,EAAGA,EAAW,OAAS,QAAU,CAC/B,SAAUA,EAAW,IACvB,CAAC,EAAGY,GAAmBa,GAAgBM,GAAmBjC,EAAY,EACtD,SAAA8C,GAAsBtD,EAAS4B,EAAa,CAEtD,GAAA,CAAC5B,GAAWA,GAAW,EACzB,MAAO,GAGT,GAAI,OAAOA,GAAY,UAAY,CAAC,OAAO,MAAM,OAAOA,CAAO,CAAC,GAAK,OAAOA,GAAY,SACtF,MAAO,CAAC,cAAc,OAAOA,CAAO,CAAC,EAAE,EAGzC,MAAMuD,EAAU,CAAA,EAChB,OAAA3B,EAAY,QAAsBhB,GAAA,CAC1B,MAAAmC,EAAQ/C,EAAQY,CAAU,EAC5B,GAAA,OAAOmC,CAAK,EAAI,EAAG,CACrB,MAAMS,EAAY,WAAW5C,CAAU,IAAI,OAAOmC,CAAK,CAAC,GACxDQ,EAAQ,KAAKC,CAAS,CACxB,CAAA,CACD,EACMD,CACT,CACA,MAAME,GAAkC/C,GAAA,CAChC,KAAA,CACJ,QAAA6C,EACA,UAAAnB,EACA,UAAAnC,EACA,KAAAkD,EACA,QAAAnD,EACA,KAAAE,EACA,aAAAkD,EACA,YAAAxB,CACE,EAAAlB,EACJ,IAAIgD,EAAiB,CAAA,EAGjBtB,IACesB,EAAAJ,GAAsBtD,EAAS4B,CAAW,GAE7D,MAAM+B,EAAqB,CAAA,EAC3B/B,EAAY,QAAsBhB,GAAA,CAC1B,MAAAmC,EAAQrC,EAAWE,CAAU,EAC/BmC,GACFY,EAAmB,KAAK,QAAQ/C,CAAU,IAAI,OAAOmC,CAAK,CAAC,EAAE,CAC/D,CACD,EACD,MAAMa,EAAQ,CACZ,KAAM,CAAC,OAAQxB,GAAa,YAAae,GAAQ,OAAQC,GAAgB,eAAgB,GAAGM,EAAgBzD,IAAc,OAAS,gBAAgB,OAAOA,CAAS,CAAC,GAAIC,IAAS,QAAU,WAAW,OAAOA,CAAI,CAAC,GAAI,GAAGyD,CAAkB,CAAA,EAEtO,OAAAE,GAAeD,EAAOrE,GAAqBgE,CAAO,CAC3D,EACMO,GAA0BC,GAAAA,WAAW,SAAcC,EAASC,EAAK,CACrE,MAAMC,EAAaC,GAAgB,CACjC,MAAOH,EACP,KAAM,SAAA,CACP,EACK,CACJ,YAAApC,GACEwC,GAAS,EACPlB,EAAQmB,GAAaH,CAAU,EAC/B,CACF,UAAAV,EACA,QAASc,EACT,cAAeC,EACf,UAAAC,EAAY,MACZ,UAAApC,EAAY,GACZ,UAAAnC,EAAY,MACZ,KAAAkD,EAAO,GACP,WAAYsB,EACZ,QAAAzE,EAAU,EACV,KAAAE,EAAO,OACP,aAAAkD,EAAe,EACb,EAAAF,EACJwB,EAAQC,GAA8BzB,EAAO9C,EAAS,EAClDiC,EAAaoC,GAAkBzE,EAC/B0C,EAAgB6B,GAAqBvE,EACrC4E,EAAiBC,cAAiBvF,EAAW,EAG7CwF,EAAU1C,EAAYkC,GAAe,GAAKM,EAC1CG,EAAoB,CAAA,EACpBC,EAAgB3D,GAAS,CAAC,EAAGqD,CAAK,EAC5B9C,EAAA,KAAK,QAAsBhB,IAAA,CACjC8D,EAAM9D,EAAU,GAAK,OACLmE,EAAAnE,EAAU,EAAI8D,EAAM9D,EAAU,EAChD,OAAOoE,EAAcpE,EAAU,EACjC,CACD,EACD,MAAMF,EAAaW,GAAS,CAAC,EAAG6B,EAAO,CACrC,QAAA4B,EACA,UAAA1C,EACA,UAAAnC,EACA,KAAAkD,EACA,WAAAd,EACA,cAAAK,EACA,KAAAxC,EACA,aAAAkD,EACA,QAAApD,GACC+E,EAAmB,CACpB,YAAanD,EAAY,IAAA,CAC1B,EACK2B,GAAUE,GAAkB/C,CAAU,EACxB,OAAAuE,GAAA,IAAK3F,GAAY,SAAU,CAC7C,MAAOwF,EACP,SAA4BG,GAAAA,IAAAjC,GAAU3B,GAAS,CAC7C,WAAAX,EACA,UAAWwE,GAAK3B,GAAQ,KAAMC,CAAS,EACvC,GAAIgB,EACJ,IAAAP,CACF,EAAGe,CAAa,CAAC,CAAA,CAClB,CACH,CAAC,ECtaM,IAAIG,GAAe,CACtB,KACA,KACA,KACA,KACA,KACA,KACA,IACJ,EACIC,GAAyB,UAAY,CACrC,SAASA,EAAQC,EAASC,EAAG,CACzB,GAAIA,IAAM,EACN,MAAM,IAAI,MAAM,kCAAkC,EACtD,KAAK,QAAUD,EACf,KAAK,EAAIC,CACZ,CACD,OAAAF,EAAQ,QAAU,SAAUG,EAAK,CAC7B,OAAO,IAAIH,EAAQD,GAAa,QAAQI,CAAG,CAAC,CACpD,EAGIH,EAAQ,UAAU,IAAM,SAAUE,EAAG,CACjC,OAAO,KAAK,IAAMA,EAAI,KAAO,IAAIF,EAAQ,KAAK,QAASE,CAAC,CAChE,EAEIF,EAAQ,UAAU,OAAS,SAAUV,EAAO,CACxC,OAAO,KAAK,UAAYA,EAAM,SAAW,KAAK,IAAMA,EAAM,CAClE,EAEIU,EAAQ,UAAU,SAAW,UAAY,CACrC,IAAII,EAAIL,GAAa,KAAK,OAAO,EACjC,OAAI,KAAK,IACLK,GAAK,KAAK,EAAI,EAAI,IAAM,IAAM,OAAO,KAAK,CAAC,EAAIA,GAC5CA,CACf,EACIJ,EAAQ,UAAU,aAAe,UAAY,CACzC,OAAO,KAAK,UAAY,EAAI,EAAI,KAAK,QAAU,CACvD,EACWA,CACX,ICtCWK,GAAY,SAAU1C,EAAO,CACpC,OAAOA,GAAU,IACrB,EACW2C,GAAW,SAAU3C,EAAO,CACnC,OAAO,OAAOA,GAAU,QAC5B,EACW4C,GAAe,SAAU5C,EAAO,CACvC,OAAO,OAAOA,GAAU,UAAYoC,GAAa,SAASpC,CAAK,CACnE,EACW6C,GAAU,MAAM,QAIhBC,GAAQ,SAAUC,EAAOC,EAAK,CACjCA,IAAQ,SAAUA,EAAMD,GACxB,UAAU,SAAW,IACrBC,EAAMD,EACNA,EAAQ,GAGZ,QADIE,EAAO,CAAA,EACFC,EAAIH,EAAOG,EAAIF,EAAKE,IACzBD,EAAK,KAAKC,CAAC,EACf,OAAOD,CACX,EAIWE,EAAS,SAAUnD,EAAOoD,EAAO,CACxC,IAAIF,EAAI,EACJG,EAAQ,CAAA,EACZ,GAAIR,GAAQ7C,CAAK,EACb,KAAOkD,EAAIE,EAAOF,IACdG,EAAMH,CAAC,EAAI,CAAE,EAAC,OAAOlD,CAAK,MAG9B,MAAOkD,EAAIE,EAAOF,IACdG,EAAMH,CAAC,EAAIlD,EAEnB,OAAOqD,CACX,EACWC,GAAU,SAAUlD,EAAM,CACjC,OAAIyC,GAAQzC,CAAI,EACLA,EAEJ,CAACA,CAAI,CAChB,EACO,SAASmD,GAASnD,EAAMoD,EAAcC,EAAW,CAChDA,IAAc,SAAUA,EAAY,KACxC,IAAIjB,EAAM,OAAOpC,CAAI,EAErB,OADAoD,EAAeA,GAAgB,EAC3BhB,EAAI,OAASgB,EACN,OAAOhB,CAAG,GAErBgB,EAAeA,EAAehB,EAAI,OAC9BgB,EAAeC,EAAU,SACzBA,GAAaN,EAAOM,EAAWD,EAAeC,EAAU,MAAM,GAE3DA,EAAU,MAAM,EAAGD,CAAY,EAAI,OAAOhB,CAAG,EACxD,CAIO,IAAIkB,GAAQ,SAAUlB,EAAKmB,EAAKC,EAAK,CACxC,IAAIC,EAASrB,EAAI,MAAMmB,CAAG,EAC1B,OAAOC,EACDC,EAAO,MAAM,EAAGD,CAAG,EAAE,OAAO,CAACC,EAAO,MAAMD,CAAG,EAAE,KAAKD,CAAG,CAAC,CAAC,EACzDE,CACV,EAgBWC,GAAQ,SAAU5E,EAAGC,EAAG,CAC/B,IAAI4E,EAAI7E,EAAIC,EAEZ,OAAO4E,EAAI5E,EAAI,EAAI4E,EAAI5E,EAAI4E,CAC/B,EAIWC,GAAS,SAAU9E,EAAGC,EAAG,CAChC,MAAO,CAAE,IAAK,KAAK,MAAMD,EAAIC,CAAC,EAAG,IAAK2E,GAAM5E,EAAGC,CAAC,CAAC,CACrD,EACW8E,GAAQ,SAAUC,EAAK,CAC9B,MAAO,CAACxB,GAAUwB,CAAG,GAAKA,EAAI,SAAW,CAC7C,EAQWC,GAAW,SAAUD,EAAK,CACjC,MAAO,CAACD,GAAMC,CAAG,CACrB,EAIWE,EAAW,SAAUC,EAAK9G,EAAK,CACtC,OAAO4G,GAASE,CAAG,GAAKA,EAAI,QAAQ9G,CAAG,IAAM,EACjD,ECnHW+G,GAAW,SAAUC,EAAGC,EAAGC,EAAGC,EAAGxB,EAAGT,EAAG,CAC9C,OAAIiC,IAAM,SAAUA,EAAI,GACpBxB,IAAM,SAAUA,EAAI,GACpBT,IAAM,SAAUA,EAAI,GACjB,IAAI,KAAK,KAAK,IAAI8B,EAAGC,EAAI,EAAGC,EAAGC,EAAGxB,EAAGT,CAAC,CAAC,CAClD,EAMWkC,GAAa,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,EAAE,EAI5DC,GAAU,IAAO,GAAK,GAAK,GAI3BC,GAAU,KAMVC,GAAeR,GAAS,KAAM,EAAG,CAAC,EAKlCS,GAAc,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,CAAC,EASlCC,GAAa,SAAUC,EAAM,CACpC,OAAQA,EAAO,IAAM,GAAKA,EAAO,MAAQ,GAAMA,EAAO,MAAQ,CAClE,EACWC,GAAS,SAAUlF,EAAO,CACjC,OAAOA,aAAiB,IAC5B,EACWmF,GAAc,SAAUnF,EAAO,CACtC,OAAOkF,GAAOlF,CAAK,GAAK,CAAC,MAAMA,EAAM,QAAO,CAAE,CAClD,EAUWoF,GAAc,SAAUC,EAAOC,EAAO,CAG7C,IAAIC,EAAUF,EAAM,UAChBG,EAAUF,EAAM,UAEhBG,EAAeF,EAAUC,EAE7B,OAAO,KAAK,MAAMC,EAAeb,EAAO,CAC5C,EAIWc,GAAY,SAAUC,EAAM,CACnC,OAAOP,GAAYO,EAAMb,EAAY,CACzC,EAIWc,GAAc,SAAUC,EAAS,CACxC,OAAO,IAAI,KAAKf,GAAa,QAAO,EAAKe,EAAUjB,EAAO,CAC9D,EACWkB,GAAe,SAAUH,EAAM,CACtC,IAAII,EAAQJ,EAAK,cACjB,OAAOI,IAAU,GAAKf,GAAWW,EAAK,eAAc,CAAE,EAChD,GACAhB,GAAWoB,CAAK,CAC1B,EAIWC,GAAa,SAAUL,EAAM,CACpC,OAAOZ,GAAYY,EAAK,UAAS,CAAE,CACvC,EAIWM,GAAa,SAAUhB,EAAMc,EAAO,CAC3C,IAAIJ,EAAOrB,GAASW,EAAMc,EAAQ,EAAG,CAAC,EACtC,MAAO,CAACC,GAAWL,CAAI,EAAGG,GAAaH,CAAI,CAAC,CAChD,EAIWO,GAAU,SAAUP,EAAMQ,EAAM,CACvC,OAAAA,EAAOA,GAAQR,EACR,IAAI,KAAK,KAAK,IAAIA,EAAK,eAAgB,EAAEA,EAAK,cAAeA,EAAK,WAAU,EAAIQ,EAAK,SAAU,EAAEA,EAAK,aAAcA,EAAK,WAAU,EAAIA,EAAK,gBAAiB,CAAA,CAAC,CACzK,EACWC,GAAQ,SAAUT,EAAM,CAC/B,IAAIU,EAAQ,IAAI,KAAKV,EAAK,QAAS,CAAA,EACnC,OAAOU,CACX,EACWC,GAAa,SAAUC,EAAO,CAErC,QADIC,EAAS,CAAA,EACJtD,EAAI,EAAGA,EAAIqD,EAAM,OAAQrD,IAC9BsD,EAAO,KAAKJ,GAAMG,EAAMrD,CAAC,CAAC,CAAC,EAE/B,OAAOsD,CACX,EAIWC,GAAO,SAAUF,EAAO,CAC/BA,EAAM,KAAK,SAAUrH,EAAGC,EAAG,CACvB,OAAOD,EAAE,QAAO,EAAKC,EAAE,QAAO,CACtC,CAAK,CACL,EACWuH,GAAoB,SAAUP,EAAMQ,EAAK,CAC5CA,IAAQ,SAAUA,EAAM,IAC5B,IAAIhB,EAAO,IAAI,KAAKQ,CAAI,EACxB,MAAO,CACH5C,GAASoC,EAAK,eAAc,EAAG,SAAU,EAAE,EAAG,GAAG,EACjDpC,GAASoC,EAAK,YAAW,EAAK,EAAG,EAAG,GAAG,EACvCpC,GAASoC,EAAK,aAAc,EAAG,GAAG,EAClC,IACApC,GAASoC,EAAK,cAAe,EAAG,GAAG,EACnCpC,GAASoC,EAAK,gBAAiB,EAAG,GAAG,EACrCpC,GAASoC,EAAK,gBAAiB,EAAG,GAAG,EACrCgB,EAAM,IAAM,EACpB,EAAM,KAAK,EAAE,CACb,EACWC,GAAoB,SAAUC,EAAO,CAC5C,IAAIC,EAAK,qDACLC,EAAOD,EAAG,KAAKD,CAAK,EACxB,GAAI,CAACE,EACD,MAAM,IAAI,MAAM,wBAAwB,OAAOF,CAAK,CAAC,EACzD,OAAO,IAAI,KAAK,KAAK,IAAI,SAASE,EAAK,CAAC,EAAG,EAAE,EAAG,SAASA,EAAK,CAAC,EAAG,EAAE,EAAI,EAAG,SAASA,EAAK,CAAC,EAAG,EAAE,EAAG,SAASA,EAAK,CAAC,EAAG,EAAE,GAAK,EAAG,SAASA,EAAK,CAAC,EAAG,EAAE,GAAK,EAAG,SAASA,EAAK,CAAC,EAAG,EAAE,GAAK,CAAC,CAAC,CACzL,EACIC,GAAkB,SAAUrB,EAAMsB,EAAU,CAE5C,IAAIC,EAAUvB,EAAK,eAAe,QAAS,CAAE,SAAUsB,CAAQ,CAAE,EAEjE,OAAOC,EAAQ,QAAQ,IAAK,GAAG,EAAI,GACvC,EACWC,GAAiB,SAAUxB,EAAMsB,EAAU,CAClD,IAAIG,EAAgB,KAAK,eAAgB,EAAC,gBAAe,EAAG,SAExDC,EAAgB,IAAI,KAAKL,GAAgBrB,EAAMyB,CAAa,CAAC,EAC7DE,EAAiB,IAAI,KAAKN,GAAgBrB,EAAMsB,GAAsD,KAAK,CAAC,EAC5GM,EAAWD,EAAe,QAAS,EAAGD,EAAc,QAAO,EAC/D,OAAO,IAAI,KAAK1B,EAAK,QAAS,EAAG4B,CAAQ,CAC7C,EC5JIC,GAA4B,UAAY,CACxC,SAASA,EAAWC,EAAQC,EAAM,CAC9B,KAAK,QAAU,KACf,KAAK,QAAU,KACf,KAAK,QAAU,GACf,KAAK,MAAQ,EACb,KAAK,OAASD,EACd,KAAK,KAAOC,EACRD,IAAW,WACX,KAAK,QAAUC,EAAK,IACdA,EAAK,OACL,IAAI,KAAKA,EAAK,OAAO,QAAS,EAAG,CAAC,EACxC,KAAK,QAAUA,EAAK,IAAMA,EAAK,MAAQ,IAAI,KAAKA,EAAK,MAAM,QAAS,EAAG,CAAC,GAEnED,IAAW,SAChB,KAAK,QAAUC,EAAK,IAAMA,EAAK,GAAK,IAAI,KAAKA,EAAK,GAAG,QAAS,EAAG,CAAC,EAE7DD,IAAW,UAChB,KAAK,QAAUC,EAAK,IAAMA,EAAK,GAAK,IAAI,KAAKA,EAAK,GAAG,QAAS,EAAG,CAAC,EAEzE,CASD,OAAAF,EAAW,UAAU,OAAS,SAAU7B,EAAM,CAC1C,EAAE,KAAK,MACP,IAAIgC,EAAW,KAAK,SAAWhC,EAAO,KAAK,QACvCiC,EAAU,KAAK,SAAWjC,EAAO,KAAK,QAC1C,GAAI,KAAK,SAAW,UAAW,CAC3B,GAAIgC,EACA,MAAO,GACX,GAAIC,EACA,MAAO,EACd,SACQ,KAAK,SAAW,UACrB,GAAIA,EACA,MAAO,WAEN,KAAK,SAAW,QACrB,OAAID,EACO,IACX,KAAK,IAAIhC,CAAI,EACN,IAEX,OAAO,KAAK,IAAIA,CAAI,CAC5B,EAMI6B,EAAW,UAAU,IAAM,SAAU7B,EAAM,CACvC,YAAK,QAAQ,KAAKA,CAAI,EACf,EACf,EAOI6B,EAAW,UAAU,SAAW,UAAY,CACxC,IAAIK,EAAM,KAAK,QACf,OAAQ,KAAK,OAAM,CACf,IAAK,MACL,IAAK,UACD,OAAOA,EACX,IAAK,SACL,IAAK,QACL,QACI,OAAQA,EAAI,OAASA,EAAIA,EAAI,OAAS,CAAC,EAAI,IAClD,CACT,EACIL,EAAW,UAAU,MAAQ,UAAY,CACrC,OAAO,IAAIA,EAAW,KAAK,OAAQ,KAAK,IAAI,CACpD,EACWA,CACX,IC/EIM,GAAoC,SAAUC,EAAQ,CACtDC,GAAUF,EAAoBC,CAAM,EACpC,SAASD,EAAmBL,EAAQC,EAAMO,EAAU,CAChD,IAAIC,EAAQH,EAAO,KAAK,KAAMN,EAAQC,CAAI,GAAK,KAC/C,OAAAQ,EAAM,SAAWD,EACVC,CACV,CACD,OAAAJ,EAAmB,UAAU,IAAM,SAAUnC,EAAM,CAC/C,OAAI,KAAK,SAASA,EAAM,KAAK,QAAQ,MAAM,GACvC,KAAK,QAAQ,KAAKA,CAAI,EACf,IAEJ,EACf,EACWmC,CACX,EAAEN,EAAU,EClBRW,GAAU,CACV,SAAU,CACN,SACA,SACA,UACA,YACA,WACA,SACA,UACH,EACD,WAAY,CACR,UACA,WACA,QACA,QACA,MACA,OACA,OACA,SACA,YACA,UACA,WACA,UACH,EACD,OAAQ,CACJ,KAAM,mBACN,OAAQ,eACR,aAAc,oBACd,MAAO,UACP,SAAU,UACV,aAAc,cACd,UAAW,WACX,UAAW,WACX,YAAa,aACb,WAAY,YACZ,UAAW,WACX,GAAI,YACJ,GAAI,SACJ,IAAK,QACL,MAAO,UACP,OAAQ,WACR,MAAO,UACP,IAAK,kCACL,KAAM,SACN,IAAK,QACL,UAAW,WACX,MAAO,aACP,OAAQ,iBACR,QAAS,qBACT,UAAW,uBACX,SAAU,sBACV,OAAQ,iBACR,SAAU,mBACV,OAAQ,iBACR,QAAS,eACT,SAAU,gBACV,MAAO,aACP,MAAO,aACP,IAAK,QACL,KAAM,UACN,KAAM,UACN,OAAQ,cACR,UAAW,oBACX,QAAS,eACT,SAAU,gBACV,SAAU,gBACV,MAAO,uBACV,CACL,EC9DIC,GAAW,SAAU/D,EAAK9G,EAAK,CAC/B,OAAO8G,EAAI,QAAQ9G,CAAG,IAAM,EAChC,EACI8K,GAAiB,SAAUC,EAAI,CAAE,OAAOA,EAAG,SAAU,GACrDC,GAAuB,SAAUtD,EAAMc,EAAOyC,EAAK,CAAE,MAAO,GAAG,OAAOzC,EAAO,GAAG,EAAE,OAAOyC,EAAK,IAAI,EAAE,OAAOvD,CAAI,GAS/GwD,GAAwB,UAAY,CACpC,SAASA,EAAOC,EAAOC,EAASC,EAAUC,EAAe,CAWrD,GAVIF,IAAY,SAAUA,EAAUN,IAChCO,IAAa,SAAUA,EAAWT,IAClCU,IAAkB,SAAUA,EAAgBN,IAChD,KAAK,KAAO,GACZ,KAAK,SAAWK,GAAYT,GAC5B,KAAK,QAAUQ,EACf,KAAK,cAAgBE,EACrB,KAAK,MAAQH,EACb,KAAK,QAAUA,EAAM,QACrB,KAAK,YAAcA,EAAM,YACrB,KAAK,YAAY,WAAY,CAC7B,IAAII,EAAa,CAAA,EAAG,OAAO,KAAK,QAAQ,UAAU,EAC9CC,EAAc,CAAA,EAAG,OAAO,KAAK,QAAQ,WAAW,EACpDD,EAAW,KAAK,SAAU5J,EAAGC,EAAG,CAAE,OAAOD,EAAIC,CAAE,CAAE,EACjD4J,EAAY,KAAK,SAAU7J,EAAGC,EAAG,CAAE,OAAOA,EAAID,CAAE,CAAE,EAElD,KAAK,WAAa4J,EAAW,OAAOC,CAAW,EAC1C,KAAK,WAAW,SACjB,KAAK,WAAa,KACzB,CACD,GAAIrG,GAAU,KAAK,YAAY,SAAS,EAAG,CACvC,IAAIsG,EAAanG,GAAQ,KAAK,YAAY,SAAS,EAE7C,KAAK,YAAY,UADjB,CAAC,KAAK,YAAY,SAAS,EAE7BoG,EAAO,OAAOD,CAAS,EAC3B,KAAK,UAAY,CACb,SAAUA,EAAU,OAAO,SAAU1G,EAAS,CAC1C,MAAO,CAACA,EAAQ,CACpC,CAAiB,EACD,UAAW0G,EAAU,OAAO,SAAU1G,EAAS,CAC3C,MAAO,EAAQA,EAAQ,CAC3C,CAAiB,EACD,WAAY2G,EAAK,QAAQ,IAAI,IAAM,IAC/BA,EAAK,QAAQ,IAAI,IAAM,IACvBA,EAAK,QAAQ,IAAI,IAAM,IACvBA,EAAK,QAAQ,IAAI,IAAM,IACvBA,EAAK,QAAQ,IAAI,IAAM,IACvBA,EAAK,QAAQ,IAAI,IAAM,IACvBA,EAAK,QAAQ,IAAI,IAAM,GAC3B,WAAYA,EAAK,QAAQ,IAAI,IAAM,IAC/BA,EAAK,QAAQ,IAAI,IAAM,IACvBA,EAAK,QAAQ,IAAI,IAAM,IACvBA,EAAK,QAAQ,IAAI,IAAM,IACvBA,EAAK,QAAQ,IAAI,IAAM,IACvBA,EAAK,QAAQ,IAAI,IAAM,IACvBA,EAAK,QAAQ,IAAI,IAAM,EAC3C,EACY,IAAIC,EAAe,SAAUhK,EAAGC,EAAG,CAC/B,OAAOD,EAAE,QAAUC,EAAE,OACrC,EACY,KAAK,UAAU,SAAS,KAAK+J,CAAY,EACzC,KAAK,UAAU,UAAU,KAAKA,CAAY,EACrC,KAAK,UAAU,SAAS,SACzB,KAAK,UAAU,SAAW,MACzB,KAAK,UAAU,UAAU,SAC1B,KAAK,UAAU,UAAY,KAClC,MAEG,KAAK,UAAY,IAExB,CAOD,OAAAT,EAAO,mBAAqB,SAAUC,EAAO,CACzC,IAAIS,EAAa,GAGjB,GAFI,EAAET,EAAM,QAAQ,QAAQD,EAAO,cAE/BC,EAAM,YAAY,OAASA,EAAM,YAAY,MAC7C,MAAO,GACX,QAAS1J,KAAO0J,EAAM,YAAa,CAC/B,GAAIN,GAAS,CAAC,UAAW,OAAQ,OAAQ,MAAM,EAAGpJ,CAAG,EACjD,MAAO,GACX,GAAI,CAACoJ,GAASK,EAAO,YAAYC,EAAM,QAAQ,IAAI,EAAG1J,CAAG,EACrD,MAAO,EACd,CACD,OAAOmK,CACf,EACIV,EAAO,UAAU,mBAAqB,UAAY,CAC9C,OAAOA,EAAO,mBAAmB,KAAK,KAAK,CACnD,EAQIA,EAAO,UAAU,SAAW,UAAY,CACpC,IAAIE,EAAU,KAAK,QACnB,GAAI,EAAE,KAAK,QAAQ,QAAQF,EAAO,aAC9B,OAAOE,EAAQ,yDAAyD,EAM5E,GAJA,KAAK,KAAO,CAACA,EAAQ,OAAO,CAAC,EAG7B,KAAKS,EAAM,YAAY,KAAK,QAAQ,IAAI,CAAC,IACrC,KAAK,QAAQ,MAAO,CACpB,KAAK,IAAIT,EAAQ,OAAO,CAAC,EACzB,IAAI9B,EAAQ,KAAK,QAAQ,MACzB,KAAK,IAAI,KAAK,cAAcA,EAAM,eAAc,EAAI,KAAK,SAAS,WAAWA,EAAM,YAAa,CAAA,EAAGA,EAAM,WAAY,CAAA,CAAC,CACzH,MACQ,KAAK,QAAQ,OAClB,KAAK,IAAI8B,EAAQ,KAAK,CAAC,EAClB,IAAI,KAAK,QAAQ,MAAM,SAAQ,CAAE,EACjC,IAAI,KAAK,OAAO,KAAK,QAAQ,KAAK,EAAIA,EAAQ,OAAO,EAAIA,EAAQ,MAAM,CAAC,EAEjF,OAAK,KAAK,mBAAoB,GAC1B,KAAK,IAAIA,EAAQ,iBAAiB,CAAC,EAChC,KAAK,KAAK,KAAK,EAAE,CAChC,EACIF,EAAO,UAAU,OAAS,UAAY,CAClC,IAAIE,EAAU,KAAK,QACf,KAAK,QAAQ,WAAa,GAC1B,KAAK,IAAI,KAAK,QAAQ,SAAS,SAAQ,CAAE,EAC7C,KAAK,IAAI,KAAK,OAAO,KAAK,QAAQ,QAAQ,EAAIA,EAAQ,OAAO,EAAIA,EAAQ,MAAM,CAAC,CACxF,EACIF,EAAO,UAAU,SAAW,UAAY,CACpC,IAAIE,EAAU,KAAK,QACf,KAAK,QAAQ,WAAa,GAC1B,KAAK,IAAI,KAAK,QAAQ,SAAS,SAAQ,CAAE,EAC7C,KAAK,IAAI,KAAK,OAAO,KAAK,QAAQ,QAAQ,EACpCA,EAAQ,SAAS,EACjBA,EAAQ,QAAQ,CAAC,CAC/B,EACIF,EAAO,UAAU,MAAQ,UAAY,CACjC,IAAIE,EAAU,KAAK,QACf,KAAK,QAAQ,WAAa,GAC1B,KAAK,IAAI,KAAK,QAAQ,SAAS,SAAQ,CAAE,EACzC,KAAK,WAAa,KAAK,UAAU,WACjC,KAAK,IAAI,KAAK,OAAO,KAAK,QAAQ,QAAQ,EACpCA,EAAQ,UAAU,EAClBA,EAAQ,SAAS,CAAC,EAGxB,KAAK,IAAI,KAAK,OAAO,KAAK,QAAQ,QAAQ,EAAIA,EAAQ,MAAM,EAAIA,EAAQ,KAAK,CAAC,EAE9E,KAAK,YAAY,UACjB,KAAK,IAAIA,EAAQ,IAAI,CAAC,EACtB,KAAK,SAAQ,GAEb,KAAK,WACL,KAAK,YAAW,EAEX,KAAK,UACV,KAAK,WAAU,EAEV,KAAK,YAAY,QACtB,KAAK,QAAO,CAExB,EACIF,EAAO,UAAU,OAAS,UAAY,CAClC,IAAIE,EAAU,KAAK,QACf,KAAK,QAAQ,WAAa,GAC1B,KAAK,IAAI,KAAK,QAAQ,SAAS,SAAU,CAAA,EAAE,IAAI,KAAK,OAAO,KAAK,QAAQ,QAAQ,EAAIA,EAAQ,OAAO,EAAIA,EAAQ,MAAM,CAAC,EAEtH,KAAK,WAAa,KAAK,UAAU,WAC7B,KAAK,QAAQ,WAAa,EAC1B,KAAK,IAAI,KAAK,OAAO,KAAK,QAAQ,QAAQ,EACpCA,EAAQ,UAAU,EAClBA,EAAQ,SAAS,CAAC,EAGxB,KAAK,IAAIA,EAAQ,IAAI,CAAC,EAAE,IAAIA,EAAQ,UAAU,CAAC,EAG9C,KAAK,WAAa,KAAK,UAAU,WACtC,KAAK,IAAI,KAAK,OAAO,KAAK,QAAQ,QAAQ,EAAIA,EAAQ,MAAM,EAAIA,EAAQ,KAAK,CAAC,GAG1E,KAAK,QAAQ,WAAa,GAC1B,KAAK,IAAIA,EAAQ,MAAM,CAAC,EACxB,KAAK,YAAY,UACjB,KAAK,IAAIA,EAAQ,IAAI,CAAC,EACtB,KAAK,SAAQ,GAEb,KAAK,WACL,KAAK,YAAW,EAEX,KAAK,WACV,KAAK,WAAU,EAEf,KAAK,YAAY,QACjB,KAAK,QAAO,EAG5B,EACIF,EAAO,UAAU,QAAU,UAAY,CACnC,IAAIE,EAAU,KAAK,QACf,KAAK,YAAY,SACb,KAAK,QAAQ,WAAa,IAC1B,KAAK,IAAI,KAAK,QAAQ,SAAS,SAAU,CAAA,EAAE,IAAIA,EAAQ,QAAQ,CAAC,EAC5D,KAAK,OAAO,KAAK,QAAQ,QAAQ,GACjC,KAAK,IAAIA,EAAQ,IAAI,CAAC,GAK9B,KAAK,SAAQ,IAGT,KAAK,QAAQ,WAAa,GAC1B,KAAK,IAAI,KAAK,QAAQ,SAAS,SAAQ,CAAE,EAE7C,KAAK,IAAI,KAAK,OAAO,KAAK,QAAQ,QAAQ,EACpCA,EAAQ,QAAQ,EAChBA,EAAQ,OAAO,CAAC,GAEtB,KAAK,WACL,KAAK,YAAW,EAEX,KAAK,WAAa,KAAK,UAAU,WACtC,KAAK,IAAIA,EAAQ,IAAI,CAAC,EAAE,IAAIA,EAAQ,UAAU,CAAC,EAE1C,KAAK,WACV,KAAK,WAAU,CAE3B,EACIF,EAAO,UAAU,OAAS,UAAY,CAClC,IAAIE,EAAU,KAAK,QACf,KAAK,YAAY,SACb,KAAK,QAAQ,WAAa,IAC1B,KAAK,IAAI,KAAK,QAAQ,SAAS,SAAQ,CAAE,EACzC,KAAK,IAAIA,EAAQ,OAAO,CAAC,GAK7B,KAAK,SAAQ,IAGT,KAAK,QAAQ,WAAa,GAC1B,KAAK,IAAI,KAAK,QAAQ,SAAS,SAAQ,CAAE,EAE7C,KAAK,IAAI,KAAK,OAAO,KAAK,QAAQ,QAAQ,EAAIA,EAAQ,OAAO,EAAIA,EAAQ,MAAM,CAAC,GAEhF,KAAK,WACL,KAAK,YAAW,EAEX,KAAK,WACV,KAAK,WAAU,EAEf,KAAK,QAAQ,WACb,KAAK,IAAIA,EAAQ,QAAQ,CAAC,EACrB,IAAI,KAAK,KAAK,KAAK,QAAQ,UAAW,KAAK,IAAKA,EAAQ,KAAK,CAAC,CAAC,EAC/D,IAAIA,EAAQ,KAAK,CAAC,EAEvB,KAAK,QAAQ,UACb,KAAK,IAAIA,EAAQ,IAAI,CAAC,EACjB,IAAI,KAAK,OAAO,KAAK,QAAQ,SAAS,MAAM,EAC3CA,EAAQ,OAAO,EACfA,EAAQ,MAAM,CAAC,EAChB,IAAI,KAAK,KAAK,KAAK,QAAQ,SAAU,OAAWA,EAAQ,KAAK,CAAC,CAAC,CAEhF,EACIF,EAAO,UAAU,YAAc,UAAY,CACvC,IAAIE,EAAU,KAAK,QACf,KAAK,WAAa,KAAK,UAAU,SACjC,KAAK,IAAIA,EAAQ,IAAI,CAAC,EACjB,IAAI,KAAK,KAAK,KAAK,UAAU,SAAU,KAAK,YAAaA,EAAQ,IAAI,CAAC,CAAC,EACvE,IAAIA,EAAQ,KAAK,CAAC,EAClB,IAAI,KAAK,KAAK,KAAK,WAAY,KAAK,IAAKA,EAAQ,IAAI,CAAC,CAAC,EAG5D,KAAK,IAAIA,EAAQ,QAAQ,CAAC,EAAE,IAAI,KAAK,KAAK,KAAK,WAAY,KAAK,IAAKA,EAAQ,KAAK,CAAC,CAAC,CAGhG,EACIF,EAAO,UAAU,WAAa,UAAY,CACtC,IAAIE,EAAU,KAAK,QACf,KAAK,UAAU,UAAY,CAAC,KAAK,UAAU,YAC3C,KAAK,IAAIA,EAAQ,IAAI,CAAC,EAAE,IAAI,KAAK,KAAK,KAAK,UAAU,SAAU,KAAK,WAAW,CAAC,EAEhF,KAAK,UAAU,YACX,KAAK,UAAU,UACf,KAAK,IAAIA,EAAQ,KAAK,CAAC,EAC3B,KAAK,IAAIA,EAAQ,QAAQ,CAAC,EAAE,IAAI,KAAK,KAAK,KAAK,UAAU,UAAW,KAAK,YAAaA,EAAQ,KAAK,CAAC,CAAC,EAEjH,EACIF,EAAO,UAAU,QAAU,UAAY,CACnC,IAAIE,EAAU,KAAK,QACnB,KAAK,IAAIA,EAAQ,IAAI,CAAC,EAAE,IAAI,KAAK,KAAK,KAAK,YAAY,OAAQ,OAAWA,EAAQ,KAAK,CAAC,CAAC,CACjG,EACIF,EAAO,UAAU,SAAW,UAAY,CACpC,KAAK,IAAI,KAAK,KAAK,KAAK,QAAQ,QAAS,KAAK,UAAW,KAAK,QAAQ,KAAK,CAAC,CAAC,CACrF,EACIA,EAAO,UAAU,IAAM,SAAUlG,EAAG,CAChCA,EAAI,SAASA,EAAE,SAAU,EAAE,EAAE,EAC7B,IAAI8G,EACAV,EAAU,KAAK,QACnB,GAAIpG,IAAM,GACN,OAAOoG,EAAQ,MAAM,EACzB,IAAIW,EAAO,KAAK,IAAI/G,CAAC,EACrB,OAAQ+G,EAAI,CACR,IAAK,GACL,IAAK,IACL,IAAK,IACDD,EAAMC,EAAOX,EAAQ,IAAI,EACzB,MACJ,IAAK,GACL,IAAK,IACDU,EAAMC,EAAOX,EAAQ,IAAI,EACzB,MACJ,IAAK,GACL,IAAK,IACDU,EAAMC,EAAOX,EAAQ,IAAI,EACzB,MACJ,QACIU,EAAMC,EAAOX,EAAQ,IAAI,CAChC,CACD,OAAOpG,EAAI,EAAI8G,EAAM,IAAMV,EAAQ,MAAM,EAAIU,CACrD,EACIZ,EAAO,UAAU,UAAY,SAAUjE,EAAG,CACtC,OAAO,KAAK,SAAS,WAAWA,EAAI,CAAC,CAC7C,EACIiE,EAAO,UAAU,YAAc,SAAUc,EAAM,CAC3C,IAAIjH,EAAUK,GAAS4G,CAAI,GAAKA,EAAO,GAAK,EAAIA,EAAK,eACrD,OAASA,EAAK,EAAI,KAAK,IAAIA,EAAK,CAAC,EAAI,IAAM,IACvC,KAAK,SAAS,SAASjH,CAAO,CAC1C,EACImG,EAAO,UAAU,OAAS,SAAUlG,EAAG,CACnC,OAAOA,EAAI,MAAQ,CAC3B,EACIkG,EAAO,UAAU,IAAM,SAAUhG,EAAG,CAChC,YAAK,KAAK,KAAK,GAAG,EAClB,KAAK,KAAK,KAAKA,CAAC,EACT,IACf,EACIgG,EAAO,UAAU,KAAO,SAAUpE,EAAKmF,EAAUC,EAAYC,EAAO,CAChE,IAAIxB,EAAQ,KACRwB,IAAU,SAAUA,EAAQ,KAC3B7G,GAAQwB,CAAG,IACZA,EAAM,CAACA,CAAG,GAEd,IAAIsF,EAAY,SAAUtG,EAAOuG,EAAWC,EAAgB,CAExD,QADIC,EAAO,GACF5G,EAAI,EAAGA,EAAIG,EAAM,OAAQH,IAC1BA,IAAM,IACFA,IAAMG,EAAM,OAAS,EACrByG,GAAQ,IAAMD,EAAiB,IAG/BC,GAAQF,EAAY,KAG5BE,GAAQzG,EAAMH,CAAC,EAEnB,OAAO4G,CACnB,EACQN,EACIA,GACI,SAAUO,EAAG,CACT,OAAOA,EAAE,UAC7B,EACQ,IAAIC,EAAe,SAAUC,EAAK,CAC9B,OAAOT,GAAYA,EAAS,KAAKtB,EAAO+B,CAAG,CACvD,EACQ,OAAIR,EACOE,EAAUtF,EAAI,IAAI2F,CAAY,EAAGN,EAAOD,CAAU,EAGlDpF,EAAI,IAAI2F,CAAY,EAAE,KAAKN,EAAQ,GAAG,CAEzD,EACWjB,CACX,ICnYIyB,GAAwB,UAAY,CACpC,SAASA,EAAOC,EAAO,CACnB,KAAK,KAAO,GACZ,KAAK,MAAQA,CAChB,CACD,OAAAD,EAAO,UAAU,MAAQ,SAAUE,EAAM,CACrC,YAAK,KAAOA,EACZ,KAAK,KAAO,GACL,KAAK,YACpB,EACIF,EAAO,UAAU,OAAS,UAAY,CAClC,OAAO,KAAK,MAAQ,KAAK,SAAW,IAC5C,EACIA,EAAO,UAAU,WAAa,UAAY,CACtC,IAAIG,EACAC,EACJ,KAAK,OAAS,KACd,KAAK,MAAQ,KACb,EAAG,CACC,GAAI,KAAK,KACL,MAAO,GACX,IAAIC,EAAO,OACXF,EAAO,KACP,QAASG,KAAU,KAAK,MAAO,CAC3BD,EAAO,KAAK,MAAMC,CAAM,EACxB,IAAIC,EAAQF,EAAK,KAAK,KAAK,IAAI,EAC3BE,IACIJ,IAAS,MAAQI,EAAM,CAAC,EAAE,OAASJ,EAAK,CAAC,EAAE,UAC3CA,EAAOI,EACPH,EAAaE,EAGxB,CAMD,GALIH,GAAQ,OACR,KAAK,KAAO,KAAK,KAAK,OAAOA,EAAK,CAAC,EAAE,MAAM,EACvC,KAAK,OAAS,KACd,KAAK,KAAO,KAEhBA,GAAQ,KAAM,CACd,KAAK,KAAO,GACZ,KAAK,OAAS,KACd,KAAK,MAAQ,KACb,MACH,CACb,OAAiBC,IAAe,QACxB,YAAK,OAASA,EACd,KAAK,MAAQD,EACN,EACf,EACIH,EAAO,UAAU,OAAS,SAAUQ,EAAM,CACtC,GAAI,KAAK,SAAWA,EAAM,CACtB,GAAI,KAAK,MAAO,CACZ,IAAIC,EAAI,KAAK,MACb,YAAK,WAAU,EACRA,CACV,CACD,YAAK,WAAU,EACR,EACV,CACD,MAAO,EACf,EACIT,EAAO,UAAU,aAAe,UAAY,CACxC,OAAO,KAAK,OAAO,QAAQ,CACnC,EACIA,EAAO,UAAU,OAAS,SAAUQ,EAAM,CACtC,GAAI,KAAK,OAAOA,CAAI,EAChB,MAAO,GACX,MAAM,IAAI,MAAM,YAAcA,EAAO,cAAgB,KAAK,MAAM,CACxE,EACWR,CACX,EAAC,EACc,SAASU,GAAUR,EAAMxB,EAAU,CAC1CA,IAAa,SAAUA,EAAWT,IACtC,IAAI0C,EAAU,CAAA,EACVC,EAAM,IAAIZ,GAAOtB,EAAS,MAAM,EACpC,GAAI,CAACkC,EAAI,MAAMV,CAAI,EACf,OAAO,KACX,OAAAW,IACOF,EACP,SAASE,GAAI,CAETD,EAAI,OAAO,OAAO,EAClB,IAAIvI,EAAIuI,EAAI,eAGZ,GAFIvI,IACAsI,EAAQ,SAAW,SAAStI,EAAE,CAAC,EAAG,EAAE,GACpCuI,EAAI,OAAQ,EACZ,MAAM,IAAI,MAAM,gBAAgB,EACpC,OAAQA,EAAI,OAAM,CACd,IAAK,SACDD,EAAQ,KAAOzB,EAAM,MACjB0B,EAAI,eACJE,IACAC,KAEJ,MAGJ,IAAK,aACDJ,EAAQ,KAAOzB,EAAM,OACrByB,EAAQ,UAAY,CAACzB,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAIA,EAAM,EAAE,EACrE0B,EAAI,WAAU,EACdE,IACAC,IACA,MACJ,IAAK,UACDJ,EAAQ,KAAOzB,EAAM,OACjB0B,EAAI,eACJI,IACAF,IACAC,KAEJ,MACJ,IAAK,UACDJ,EAAQ,KAAOzB,EAAM,OACjB0B,EAAI,eACJI,IACAD,KAEJ,MACJ,IAAK,YACDJ,EAAQ,KAAOzB,EAAM,SACjB0B,EAAI,eACJI,IACAD,KAEJ,MACJ,IAAK,WACDJ,EAAQ,KAAOzB,EAAM,QACjB0B,EAAI,eACJI,IACAD,KAEJ,MACJ,IAAK,UACDJ,EAAQ,KAAOzB,EAAM,OACjB0B,EAAI,eACJI,IACAD,KAEJ,MACJ,IAAK,SACL,IAAK,UACL,IAAK,YACL,IAAK,WACL,IAAK,SACL,IAAK,WACL,IAAK,SACDJ,EAAQ,KAAOzB,EAAM,OACrB,IAAIpK,EAAM8L,EAAI,OACT,OAAO,EAAG,CAAC,EACX,cAEL,GADAD,EAAQ,UAAY,CAACzB,EAAMpK,CAAG,CAAC,EAC3B,CAAC8L,EAAI,WAAY,EACjB,OAEJ,KAAOA,EAAI,OAAO,OAAO,GAAG,CACxB,GAAIA,EAAI,OAAQ,EACZ,MAAM,IAAI,MAAM,gBAAgB,EACpC,IAAIK,EAAMC,IACV,GAAI,CAACD,EACD,MAAM,IAAI,MAAM,qBAAuBL,EAAI,OAAS,oBAAoB,EAE5ED,EAAQ,UAAU,KAAKzB,EAAM+B,CAAG,CAAC,EACjCL,EAAI,WAAU,CACjB,CACDE,IACAK,IACAJ,IACA,MACJ,IAAK,UACL,IAAK,WACL,IAAK,QACL,IAAK,QACL,IAAK,MACL,IAAK,OACL,IAAK,OACL,IAAK,SACL,IAAK,YACL,IAAK,UACL,IAAK,WACL,IAAK,WAGD,GAFAJ,EAAQ,KAAOzB,EAAM,OACrByB,EAAQ,QAAU,CAACS,EAAO,CAAE,EACxB,CAACR,EAAI,WAAY,EACjB,OAEJ,KAAOA,EAAI,OAAO,OAAO,GAAG,CACxB,GAAIA,EAAI,OAAQ,EACZ,MAAM,IAAI,MAAM,gBAAgB,EACpC,IAAItG,EAAI8G,IACR,GAAI,CAAC9G,EACD,MAAM,IAAI,MAAM,qBAAuBsG,EAAI,OAAS,kBAAkB,EAE1ED,EAAQ,QAAQ,KAAKrG,CAAC,EACtBsG,EAAI,WAAU,CACjB,CACDI,IACAD,IACA,MACJ,QACI,MAAM,IAAI,MAAM,gBAAgB,CACvC,CACJ,CACD,SAASC,GAAK,CACV,IAAIK,EAAKT,EAAI,OAAO,IAAI,EACpBU,EAAMV,EAAI,OAAO,KAAK,EAC1B,GAAMS,GAAMC,EAEZ,EAAG,CACC,IAAInC,EAAMoC,IACNN,EAAMC,IACN5G,EAAI8G,IAER,GAAIjC,EAEI8B,GACAL,EAAI,WAAU,EACTD,EAAQ,YACTA,EAAQ,UAAY,IACxBA,EAAQ,UAAU,KAAKzB,EAAM+B,CAAG,EAAE,IAAI9B,CAAG,CAAC,IAGrCwB,EAAQ,aACTA,EAAQ,WAAa,IACzBA,EAAQ,WAAW,KAAKxB,CAAG,EAC3ByB,EAAI,OAAO,QAAQ,WAIlBK,EACLL,EAAI,WAAU,EACTD,EAAQ,YACTA,EAAQ,UAAY,IACxBA,EAAQ,UAAU,KAAKzB,EAAM+B,CAAG,CAAC,UAE5BL,EAAI,SAAW,aACpBA,EAAI,WAAU,EACTD,EAAQ,YACTA,EAAQ,UAAY,CAACzB,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAIA,EAAM,EAAE,WAGpE0B,EAAI,SAAW,UAAW,CAC/BA,EAAI,WAAU,EACd,IAAIvI,EAAIuI,EAAI,eACZ,GAAI,CAACvI,EACD,MAAM,IAAI,MAAM,qBAAuBuI,EAAI,OAAS,wBAAwB,EAGhF,IADAD,EAAQ,SAAW,CAAC,SAAStI,EAAE,CAAC,EAAG,EAAE,CAAC,EAC/BuI,EAAI,OAAO,OAAO,GAAG,CAExB,GADAvI,EAAIuI,EAAI,eACJ,CAACvI,EACD,MAAM,IAAI,MAAM,qBAAuBuI,EAAI,OAAS,qBAAqB,EAE7ED,EAAQ,SAAS,KAAK,SAAStI,EAAE,CAAC,EAAG,EAAE,CAAC,CAC3C,CACJ,SACQiC,EACLsG,EAAI,WAAU,EACTD,EAAQ,UACTA,EAAQ,QAAU,IACtBA,EAAQ,QAAQ,KAAKrG,CAAC,MAGtB,OAEP,OAAQsG,EAAI,OAAO,OAAO,GAAKA,EAAI,OAAO,KAAK,GAAKA,EAAI,OAAO,IAAI,EACvE,CACD,SAASE,GAAK,CACV,IAAIU,EAAKZ,EAAI,OAAO,IAAI,EACxB,GAAKY,EAEL,EAAG,CACC,IAAInJ,EAAIuI,EAAI,eACZ,GAAI,CAACvI,EACD,MAAM,IAAI,MAAM,qBAAuBuI,EAAI,OAAS,iBAAiB,EAGzE,IADAD,EAAQ,OAAS,CAAC,SAAStI,EAAE,CAAC,EAAG,EAAE,CAAC,EAC7BuI,EAAI,OAAO,OAAO,GAAG,CAExB,GADAvI,EAAIuI,EAAI,eACJ,CAACvI,EACD,MAAM,IAAI,MAAM,qBAAuBuI,EAAI,OAAS,iBAAiB,EAEzED,EAAQ,OAAO,KAAK,SAAStI,EAAE,CAAC,EAAG,EAAE,CAAC,CACzC,CACb,OAAiBuI,EAAI,OAAO,OAAO,GAAKA,EAAI,OAAO,IAAI,EAClD,CACD,SAASQ,GAAU,CACf,OAAQR,EAAI,OAAM,CACd,IAAK,UACD,MAAO,GACX,IAAK,WACD,MAAO,GACX,IAAK,QACD,MAAO,GACX,IAAK,QACD,MAAO,GACX,IAAK,MACD,MAAO,GACX,IAAK,OACD,MAAO,GACX,IAAK,OACD,MAAO,GACX,IAAK,SACD,MAAO,GACX,IAAK,YACD,MAAO,GACX,IAAK,UACD,MAAO,IACX,IAAK,WACD,MAAO,IACX,IAAK,WACD,MAAO,IACX,QACI,MAAO,EACd,CACJ,CACD,SAASM,GAAY,CACjB,OAAQN,EAAI,OAAM,CACd,IAAK,SACL,IAAK,UACL,IAAK,YACL,IAAK,WACL,IAAK,SACL,IAAK,WACL,IAAK,SACD,OAAOA,EAAI,OAAO,OAAO,EAAG,CAAC,EAAE,cACnC,QACI,MAAO,EACd,CACJ,CACD,SAASW,GAAY,CACjB,OAAQX,EAAI,OAAM,CACd,IAAK,OACD,OAAAA,EAAI,WAAU,EACP,GACX,IAAK,QACD,OAAAA,EAAI,WAAU,EACP,EACX,IAAK,SACD,OAAAA,EAAI,WAAU,EACPA,EAAI,OAAO,MAAM,EAAI,GAAK,EACrC,IAAK,QACD,OAAAA,EAAI,WAAU,EACPA,EAAI,OAAO,MAAM,EAAI,GAAK,EACrC,IAAK,MACD,IAAIH,EAAI,SAASG,EAAI,MAAM,CAAC,EAAG,EAAE,EACjC,GAAIH,EAAI,MAAQA,EAAI,IAChB,MAAM,IAAI,MAAM,qBAAuBA,CAAC,EAC5C,OAAAG,EAAI,WAAU,EACPA,EAAI,OAAO,MAAM,EAAI,CAACH,EAAIA,EACrC,QACI,MAAO,EACd,CACJ,CACD,SAASU,GAAQ,CACbP,EAAI,OAAO,IAAI,EACfA,EAAI,OAAO,KAAK,EAChB,IAAIzB,EAAMoC,IACV,GAAKpC,EAIL,IAFAwB,EAAQ,WAAa,CAACxB,CAAG,EACzByB,EAAI,WAAU,EACPA,EAAI,OAAO,OAAO,GAAG,CAExB,GADAzB,EAAMoC,EAAS,EACX,CAACpC,EACD,MAAM,IAAI,MAAM,qBAAuByB,EAAI,OAAS,qBAAqB,EAE7ED,EAAQ,WAAW,KAAKxB,CAAG,EAC3ByB,EAAI,WAAU,CACjB,CACJ,CACD,SAASG,GAAI,CACT,GAAIH,EAAI,SAAW,QAAS,CACxB,IAAInF,EAAO,KAAK,MAAMmF,EAAI,IAAI,EAC9B,GAAI,CAACnF,EACD,MAAM,IAAI,MAAM,2BAA6BmF,EAAI,IAAI,EACzDD,EAAQ,MAAQ,IAAI,KAAKlF,CAAI,CAChC,MACQmF,EAAI,OAAO,KAAK,IACrBD,EAAQ,MAAQ,SAASC,EAAI,MAAM,CAAC,EAAG,EAAE,EACzCA,EAAI,OAAO,QAAQ,EAG1B,CACL,CCrYO,IAAIa,GACV,SAAUA,EAAW,CAClBA,EAAUA,EAAU,OAAY,CAAC,EAAI,SACrCA,EAAUA,EAAU,QAAa,CAAC,EAAI,UACtCA,EAAUA,EAAU,OAAY,CAAC,EAAI,SACrCA,EAAUA,EAAU,MAAW,CAAC,EAAI,QACpCA,EAAUA,EAAU,OAAY,CAAC,EAAI,SACrCA,EAAUA,EAAU,SAAc,CAAC,EAAI,WACvCA,EAAUA,EAAU,SAAc,CAAC,EAAI,UAC3C,GAAGA,IAAcA,EAAY,CAAE,EAAC,EACzB,SAASC,GAAqBC,EAAM,CACvC,OAAOA,EAAOF,EAAU,MAC5B,CCkFA,IAAIG,GAAW,SAAU1B,EAAMxB,EAAU,CACrC,OAAIA,IAAa,SAAUA,EAAWT,IAC/B,IAAIiB,EAAMwB,GAAUR,EAAMxB,CAAQ,GAAK,MAAS,CAC3D,EACImD,GAAS,CACT,QACA,QACA,WACA,YACA,aACA,SACJ,EACAtD,GAAO,YAAc,CAAA,EACrBA,GAAO,YAAYkD,EAAU,MAAM,EAAII,GACvCtD,GAAO,YAAYkD,EAAU,QAAQ,EAAII,GACzCtD,GAAO,YAAYkD,EAAU,KAAK,EAAI,CAAC,QAAQ,EAAE,OAAOI,EAAM,EAC9DtD,GAAO,YAAYkD,EAAU,MAAM,EAAII,GACvCtD,GAAO,YAAYkD,EAAU,OAAO,EAAII,GACxCtD,GAAO,YAAYkD,EAAU,MAAM,EAAI,CAAC,WAAY,WAAW,EAAE,OAAOI,EAAM,EAI9E,IAAIC,GAAS,SAAUtD,EAAOC,EAASC,EAAUC,EAAe,CAC5D,OAAO,IAAIJ,GAAOC,EAAOC,EAASC,EAAUC,CAAa,EAAE,UAC/D,EACIoD,GAAqBxD,GAAO,mBCnH5ByD,GAAsB,UAAY,CAClC,SAASA,EAAKC,EAAMC,EAAQC,EAAQC,EAAa,CAC7C,KAAK,KAAOH,EACZ,KAAK,OAASC,EACd,KAAK,OAASC,EACd,KAAK,YAAcC,GAAe,CACrC,CACD,OAAAJ,EAAK,UAAU,SAAW,UAAY,CAClC,OAAO,KAAK,IACpB,EACIA,EAAK,UAAU,WAAa,UAAY,CACpC,OAAO,KAAK,MACpB,EACIA,EAAK,UAAU,WAAa,UAAY,CACpC,OAAO,KAAK,MACpB,EACIA,EAAK,UAAU,gBAAkB,UAAY,CACzC,OAAO,KAAK,WACpB,EACIA,EAAK,UAAU,QAAU,UAAY,CACjC,OAAS,KAAK,KAAO,GAAK,GAAK,KAAK,OAAS,GAAK,KAAK,QAAU,IAC7D,KAAK,WACjB,EACWA,CACX,EAAC,EAEGK,GAA0B,SAAUxE,EAAQ,CAC5CC,GAAUuE,EAAUxE,CAAM,EAC1B,SAASwE,EAAStH,EAAMc,EAAOyC,EAAK2D,EAAMC,EAAQC,EAAQC,EAAa,CACnE,IAAIpE,EAAQH,EAAO,KAAK,KAAMoE,EAAMC,EAAQC,EAAQC,CAAW,GAAK,KACpE,OAAApE,EAAM,KAAOjD,EACbiD,EAAM,MAAQnC,EACdmC,EAAM,IAAMM,EACLN,CACV,CACD,OAAAqE,EAAS,SAAW,SAAU5G,EAAM,CAChC,OAAO,IAAI,KAAKA,EAAK,eAAgB,EAAEA,EAAK,cAAgB,EAAGA,EAAK,WAAY,EAAEA,EAAK,cAAeA,EAAK,cAAa,EAAIA,EAAK,cAAe,EAAEA,EAAK,UAAY,GAAI,CAC/K,EACI4G,EAAS,UAAU,WAAa,UAAY,CACxC,OAAOvG,GAAW,IAAI,KAAK,KAAK,QAAO,CAAE,CAAC,CAClD,EACIuG,EAAS,UAAU,QAAU,UAAY,CACrC,OAAO,IAAI,KAAK,KAAK,IAAI,KAAK,KAAM,KAAK,MAAQ,EAAG,KAAK,IAAK,KAAK,KAAM,KAAK,OAAQ,KAAK,OAAQ,KAAK,WAAW,CAAC,EAAE,SAC9H,EACIA,EAAS,UAAU,OAAS,UAAY,CACpC,OAAO,KAAK,GACpB,EACIA,EAAS,UAAU,SAAW,UAAY,CACtC,OAAO,KAAK,KACpB,EACIA,EAAS,UAAU,QAAU,UAAY,CACrC,OAAO,KAAK,IACpB,EACIA,EAAS,UAAU,SAAW,SAAUC,EAAO,CAC3C,KAAK,MAAQA,CACrB,EACID,EAAS,UAAU,UAAY,SAAUE,EAAQ,CAE7C,GADA,KAAK,OAASA,EACV,KAAK,MAAQ,GAAI,CACjB,IAAIC,EAAU,KAAK,MAAM,KAAK,MAAQ,EAAE,EACpCC,EAAW7I,GAAM,KAAK,MAAO,EAAE,EACnC,KAAK,MAAQ6I,EACb,KAAK,MAAQD,EACT,KAAK,QAAU,IACf,KAAK,MAAQ,GACb,EAAE,KAAK,KAEd,CACT,EACIH,EAAS,UAAU,UAAY,SAAUtD,EAAM2D,EAAM,CAC7CA,EAAO,KAAK,aACZ,KAAK,KAAO,EAAE,KAAK,WAAY,EAAG,GAAK,EAAIA,IAAS3D,EAAO,EAG3D,KAAK,KAAO,EAAE,KAAK,WAAY,EAAG2D,GAAQ3D,EAAO,EAErD,KAAK,OAAM,CACnB,EACIsD,EAAS,UAAU,SAAW,SAAUtD,EAAM,CAC1C,KAAK,KAAOA,EACZ,KAAK,OAAM,CACnB,EACIsD,EAAS,UAAU,SAAW,SAAUM,EAAOC,EAAUC,EAAQ,CAK7D,IAJID,IAEA,KAAK,MAAQ,KAAK,OAAO,GAAK,KAAK,MAAQD,CAAK,EAAIA,KAE/C,CACL,KAAK,MAAQA,EACb,IAAIG,EAAKhJ,GAAO,KAAK,KAAM,EAAE,EAAGiJ,EAASD,EAAG,IAAKE,EAAUF,EAAG,IAK9D,GAJIC,IACA,KAAK,KAAOC,EACZ,KAAK,SAASD,CAAM,GAEpBhJ,GAAM8I,CAAM,GAAK3I,EAAS2I,EAAQ,KAAK,IAAI,EAC3C,KACP,CACT,EACIR,EAAS,UAAU,WAAa,SAAUY,EAASL,EAAUC,EAAQK,EAAU,CAM3E,IALIN,IAEA,KAAK,QACD,KAAK,OAAO,MAAQ,KAAK,KAAO,GAAK,KAAK,SAAWK,CAAO,EAAIA,KAE/D,CACL,KAAK,QAAUA,EACf,IAAIH,EAAKhJ,GAAO,KAAK,OAAQ,EAAE,EAAGqJ,EAAUL,EAAG,IAAKM,EAAYN,EAAG,IAKnE,GAJIK,IACA,KAAK,OAASC,EACd,KAAK,SAASD,EAAS,GAAON,CAAM,IAEnC9I,GAAM8I,CAAM,GAAK3I,EAAS2I,EAAQ,KAAK,IAAI,KAC3C9I,GAAMmJ,CAAQ,GAAKhJ,EAASgJ,EAAU,KAAK,MAAM,GAClD,KAEP,CACT,EACIb,EAAS,UAAU,WAAa,SAAUgB,EAAST,EAAUC,EAAQK,EAAUI,EAAU,CAOrF,IANIV,IAEA,KAAK,QACD,KAAK,OAAO,OAAS,KAAK,KAAO,KAAO,KAAK,OAAS,GAAK,KAAK,SAC5DS,CAAO,EAAIA,KAEd,CACL,KAAK,QAAUA,EACf,IAAIP,EAAKhJ,GAAO,KAAK,OAAQ,EAAE,EAAGyJ,EAAYT,EAAG,IAAKU,EAAYV,EAAG,IAKrE,GAJIS,IACA,KAAK,OAASC,EACd,KAAK,WAAWD,EAAW,GAAOV,EAAQK,CAAQ,IAEjDnJ,GAAM8I,CAAM,GAAK3I,EAAS2I,EAAQ,KAAK,IAAI,KAC3C9I,GAAMmJ,CAAQ,GAAKhJ,EAASgJ,EAAU,KAAK,MAAM,KACjDnJ,GAAMuJ,CAAQ,GAAKpJ,EAASoJ,EAAU,KAAK,MAAM,GAClD,KAEP,CACT,EACIjB,EAAS,UAAU,OAAS,UAAY,CACpC,GAAI,OAAK,KAAO,IAGhB,KAAIoB,EAAc1H,GAAW,KAAK,KAAM,KAAK,MAAQ,CAAC,EAAE,CAAC,EACzD,GAAI,OAAK,KAAO0H,GAGhB,KAAO,KAAK,IAAMA,GAAa,CAG3B,GAFA,KAAK,KAAOA,EACZ,EAAE,KAAK,MACH,KAAK,QAAU,KACf,KAAK,MAAQ,EACb,EAAE,KAAK,KACH,KAAK,KAAO9I,IACZ,OAGR8I,EAAc1H,GAAW,KAAK,KAAM,KAAK,MAAQ,CAAC,EAAE,CAAC,CACxD,EACT,EACIsG,EAAS,UAAU,IAAM,SAAU1B,EAASiC,EAAU,CAClD,IAAIjB,EAAOhB,EAAQ,KAAM+C,EAAW/C,EAAQ,SAAU+B,EAAO/B,EAAQ,KAAMkC,EAASlC,EAAQ,OAAQuC,EAAWvC,EAAQ,SAAU2C,EAAW3C,EAAQ,SACpJ,OAAQgB,EAAI,CACR,KAAKF,EAAU,OACX,OAAO,KAAK,SAASiC,CAAQ,EACjC,KAAKjC,EAAU,QACX,OAAO,KAAK,UAAUiC,CAAQ,EAClC,KAAKjC,EAAU,OACX,OAAO,KAAK,UAAUiC,EAAUhB,CAAI,EACxC,KAAKjB,EAAU,MACX,OAAO,KAAK,SAASiC,CAAQ,EACjC,KAAKjC,EAAU,OACX,OAAO,KAAK,SAASiC,EAAUd,EAAUC,CAAM,EACnD,KAAKpB,EAAU,SACX,OAAO,KAAK,WAAWiC,EAAUd,EAAUC,EAAQK,CAAQ,EAC/D,KAAKzB,EAAU,SACX,OAAO,KAAK,WAAWiC,EAAUd,EAAUC,EAAQK,EAAUI,CAAQ,CAC5E,CACT,EACWjB,CACX,EAAEL,EAAI,EChLC,SAAS2B,GAAkBhD,EAAS,CAIvC,QAHIiD,EAAU,CAAA,EACVC,EAAO,OAAO,KAAKlD,CAAO,EAErBmD,EAAK,EAAGC,EAASF,EAAMC,EAAKC,EAAO,OAAQD,IAAM,CACtD,IAAIhP,EAAMiP,EAAOD,CAAE,EACd5J,EAAS8J,GAAalP,CAAG,GAC1B8O,EAAQ,KAAK9O,CAAG,EAChBkG,GAAO2F,EAAQ7L,CAAG,CAAC,GAAK,CAACmG,GAAY0F,EAAQ7L,CAAG,CAAC,GACjD8O,EAAQ,KAAK9O,CAAG,CAEvB,CACD,GAAI8O,EAAQ,OACR,MAAM,IAAI,MAAM,oBAAsBA,EAAQ,KAAK,IAAI,CAAC,EAE5D,OAAOK,GAAS,GAAItD,CAAO,CAC/B,CACO,SAASuD,GAAavD,EAAS,CAClC,IAAIwD,EAAOF,GAASA,GAAS,CAAA,EAAIG,EAAe,EAAGT,GAAkBhD,CAAO,CAAC,EAG7E,GAFInI,GAAU2L,EAAK,QAAQ,IACvBA,EAAK,KAAOjF,EAAM,QAClB,EAAE1G,GAAU2L,EAAK,IAAI,GAAKjF,EAAM,YAAYiF,EAAK,IAAI,GACrD,MAAM,IAAI,MAAM,sBAAsB,OAAOA,EAAK,KAAM,GAAG,EAAE,OAAOxD,EAAQ,IAAI,CAAC,EAarF,GAXKwD,EAAK,UACNA,EAAK,QAAU,IAAI,KAAK,IAAI,KAAI,EAAG,gBAAgB,CAAC,CAAC,GACpD3L,GAAU2L,EAAK,IAAI,EAGf1L,GAAS0L,EAAK,IAAI,IAIvBA,EAAK,KAAOA,EAAK,KAAK,SANtBA,EAAK,KAAOjF,EAAM,GAAG,QAQrB1G,GAAU2L,EAAK,QAAQ,EAAG,CACtB1L,GAAS0L,EAAK,QAAQ,IACtBA,EAAK,SAAW,CAACA,EAAK,QAAQ,GAClC,QAASnL,EAAI,EAAGA,EAAImL,EAAK,SAAS,OAAQnL,IAAK,CAC3C,IAAIyH,EAAI0D,EAAK,SAASnL,CAAC,EACvB,GAAIyH,IAAM,GAAK,EAAEA,GAAK,MAAQA,GAAK,KAC/B,MAAM,IAAI,MAAM,4DAAiE,CAExF,CACJ,CACD,GAAI,EAAU0D,EAAK,UACflK,GAASkK,EAAK,QAAQ,GACtBlK,GAASkK,EAAK,SAAS,GACfA,EAAK,YACblK,GAASkK,EAAK,UAAU,GACxB3L,GAAU2L,EAAK,SAAS,GACxB3L,GAAU2L,EAAK,QAAQ,GACvB,OAAQA,EAAK,KAAI,CACb,KAAKjF,EAAM,OACFiF,EAAK,UACNA,EAAK,QAAUA,EAAK,QAAQ,YAAW,EAAK,GAChDA,EAAK,WAAaA,EAAK,QAAQ,WAAU,EACzC,MACJ,KAAKjF,EAAM,QACPiF,EAAK,WAAaA,EAAK,QAAQ,WAAU,EACzC,MACJ,KAAKjF,EAAM,OACPiF,EAAK,UAAY,CAACrI,GAAWqI,EAAK,OAAO,CAAC,EAC1C,KACP,CAaL,GAVI3L,GAAU2L,EAAK,OAAO,GAAK,CAACxL,GAAQwL,EAAK,OAAO,IAChDA,EAAK,QAAU,CAACA,EAAK,OAAO,GAG5B3L,GAAU2L,EAAK,SAAS,GACxB,CAACxL,GAAQwL,EAAK,SAAS,GACvB1L,GAAS0L,EAAK,SAAS,IACvBA,EAAK,UAAY,CAACA,EAAK,SAAS,GAGhC,CAAC3L,GAAU2L,EAAK,UAAU,EAC1BA,EAAK,WAAa,GAClBA,EAAK,YAAc,WAEdxL,GAAQwL,EAAK,UAAU,EAAG,CAG/B,QAFIvF,EAAa,CAAA,EACbC,EAAc,CAAA,EACT7F,EAAI,EAAGA,EAAImL,EAAK,WAAW,OAAQnL,IAAK,CAC7C,IAAIyH,EAAI0D,EAAK,WAAWnL,CAAC,EACrByH,EAAI,EACJ7B,EAAW,KAAK6B,CAAC,EAEZA,EAAI,GACT5B,EAAY,KAAK4B,CAAC,CAEzB,CACD0D,EAAK,WAAavF,EAClBuF,EAAK,YAActF,CACtB,MACQsF,EAAK,WAAa,GACvBA,EAAK,YAAc,CAACA,EAAK,UAAU,EACnCA,EAAK,WAAa,KAGlBA,EAAK,YAAc,GACnBA,EAAK,WAAa,CAACA,EAAK,UAAU,GAOtC,GAJI3L,GAAU2L,EAAK,QAAQ,GAAK,CAACxL,GAAQwL,EAAK,QAAQ,IAClDA,EAAK,SAAW,CAACA,EAAK,QAAQ,GAG9B,CAAC3L,GAAU2L,EAAK,SAAS,EACzBA,EAAK,WAAa,aAEb1L,GAAS0L,EAAK,SAAS,EAC5BA,EAAK,UAAY,CAACA,EAAK,SAAS,EAChCA,EAAK,WAAa,aAEbzL,GAAayL,EAAK,SAAS,EAChCA,EAAK,UAAY,CAAChM,GAAQ,QAAQgM,EAAK,SAAS,EAAE,OAAO,EACzDA,EAAK,WAAa,aAEbA,EAAK,qBAAqBhM,GAC3B,CAACgM,EAAK,UAAU,GAAKA,EAAK,KAAOjF,EAAM,SACvCiF,EAAK,UAAY,CAACA,EAAK,UAAU,OAAO,EACxCA,EAAK,WAAa,OAGlBA,EAAK,WAAa,CAAC,CAACA,EAAK,UAAU,QAASA,EAAK,UAAU,CAAC,CAAC,EAC7DA,EAAK,UAAY,UAGpB,CAGD,QAFIrF,EAAY,CAAA,EACZuF,EAAa,CAAA,EACRrL,EAAI,EAAGA,EAAImL,EAAK,UAAU,OAAQnL,IAAK,CAC5C,IAAIqG,EAAO8E,EAAK,UAAUnL,CAAC,EAC3B,GAAIP,GAAS4G,CAAI,EAAG,CAChBP,EAAU,KAAKO,CAAI,EACnB,QACH,SACQ3G,GAAa2G,CAAI,EAAG,CACzBP,EAAU,KAAK3G,GAAQ,QAAQkH,CAAI,EAAE,OAAO,EAC5C,QACH,CACG,CAACA,EAAK,GAAK8E,EAAK,KAAOjF,EAAM,QAC7BJ,EAAU,KAAKO,EAAK,OAAO,EAG3BgF,EAAW,KAAK,CAAChF,EAAK,QAASA,EAAK,CAAC,CAAC,CAE7C,CACD8E,EAAK,UAAYlK,GAAS6E,CAAS,EAAIA,EAAY,KACnDqF,EAAK,WAAalK,GAASoK,CAAU,EAAIA,EAAa,IACzD,CAED,OAAK7L,GAAU2L,EAAK,MAAM,EAGjB1L,GAAS0L,EAAK,MAAM,IACzBA,EAAK,OAAS,CAACA,EAAK,MAAM,GAH1BA,EAAK,OAASA,EAAK,KAAOjF,EAAM,OAAS,CAACiF,EAAK,QAAQ,YAAa,CAAA,EAAI,KAMvE3L,GAAU2L,EAAK,QAAQ,EAInB1L,GAAS0L,EAAK,QAAQ,IAC3BA,EAAK,SAAW,CAACA,EAAK,QAAQ,GAJ9BA,EAAK,SACDA,EAAK,KAAOjF,EAAM,SAAW,CAACiF,EAAK,QAAQ,eAAe,EAAI,KAMjE3L,GAAU2L,EAAK,QAAQ,EAInB1L,GAAS0L,EAAK,QAAQ,IAC3BA,EAAK,SAAW,CAACA,EAAK,QAAQ,GAJ9BA,EAAK,SACDA,EAAK,KAAOjF,EAAM,SAAW,CAACiF,EAAK,QAAQ,eAAe,EAAI,KAK/D,CAAE,cAAeA,EAC5B,CACO,SAASG,GAAaH,EAAM,CAC/B,IAAII,EAAoBJ,EAAK,QAAQ,QAAO,EAAK,IACjD,GAAI,CAACzC,GAAqByC,EAAK,IAAI,EAC/B,MAAO,GAEX,IAAIK,EAAU,CAAA,EACd,OAAAL,EAAK,OAAO,QAAQ,SAAUlC,EAAM,CAChCkC,EAAK,SAAS,QAAQ,SAAUjC,EAAQ,CACpCiC,EAAK,SAAS,QAAQ,SAAUhC,EAAQ,CACpCqC,EAAQ,KAAK,IAAIxC,GAAKC,EAAMC,EAAQC,EAAQoC,CAAiB,CAAC,CAC9E,CAAa,CACb,CAAS,CACT,CAAK,EACMC,CACX,CClMO,SAASC,GAAYC,EAAW,CACnC,IAAI/D,EAAU+D,EACT,MAAM;AAAA,CAAI,EACV,IAAIC,EAAS,EACb,OAAO,SAAUC,EAAG,CAAE,OAAOA,IAAM,IAAK,CAAE,EAC/C,OAAOX,GAASA,GAAS,CAAA,EAAItD,EAAQ,CAAC,CAAC,EAAGA,EAAQ,CAAC,CAAC,CACxD,CACO,SAASkE,GAAaC,EAAM,CAC/B,IAAInE,EAAU,CAAA,EACVoE,EAAkB,+CAA+C,KAAKD,CAAI,EAC9E,GAAI,CAACC,EACD,OAAOpE,EAEX,IAAIqE,EAAOD,EAAgB,CAAC,EAAGE,EAAUF,EAAgB,CAAC,EAC1D,OAAIC,IACArE,EAAQ,KAAOqE,GAEnBrE,EAAQ,QAAUjE,GAAkBuI,CAAO,EACpCtE,CACX,CACA,SAASgE,GAAUD,EAAW,CAE1B,GADAA,EAAYA,EAAU,QAAQ,YAAa,EAAE,EACzC,CAACA,EAAU,OACX,OAAO,KACX,IAAIQ,EAAS,iBAAiB,KAAKR,EAAU,YAAa,CAAA,EAC1D,GAAI,CAACQ,EACD,OAAOC,GAAWT,CAAS,EAE/B,IAAI5P,EAAMoQ,EAAO,CAAC,EAClB,OAAQpQ,EAAI,YAAa,EAAA,CACrB,IAAK,QACL,IAAK,SACD,OAAOqQ,GAAWT,CAAS,EAC/B,IAAK,UACD,OAAOG,GAAaH,CAAS,EACjC,QACI,MAAM,IAAI,MAAM,wBAAwB,OAAO5P,EAAK,MAAM,EAAE,OAAO4P,CAAS,CAAC,CACpF,CACL,CACA,SAASS,GAAWL,EAAM,CACtB,IAAIM,EAAeN,EAAK,QAAQ,WAAY,EAAE,EAC1CnE,EAAUkE,GAAaO,CAAY,EACnCC,EAAQP,EAAK,QAAQ,sBAAuB,EAAE,EAAE,MAAM,GAAG,EAC7D,OAAAO,EAAM,QAAQ,SAAUC,EAAM,CAC1B,IAAIxC,EAAKwC,EAAK,MAAM,GAAG,EAAGxQ,EAAMgO,EAAG,CAAC,EAAGhN,EAAQgN,EAAG,CAAC,EACnD,OAAQhO,EAAI,YAAa,EAAA,CACrB,IAAK,OACD6L,EAAQ,KAAOc,EAAU3L,EAAM,YAAa,CAAA,EAC5C,MACJ,IAAK,OACD6K,EAAQ,KAAO4E,GAAKzP,EAAM,YAAa,CAAA,EACvC,MACJ,IAAK,QACL,IAAK,WACL,IAAK,WACL,IAAK,UACL,IAAK,aACL,IAAK,YACL,IAAK,WACL,IAAK,SACL,IAAK,WACL,IAAK,WACD,IAAI4D,EAAM8L,GAAY1P,CAAK,EACvB2P,EAAY3Q,EAAI,cAGpB6L,EAAQ8E,CAAS,EAAI/L,EACrB,MACJ,IAAK,YACL,IAAK,QACDiH,EAAQ,UAAY+E,GAAa5P,CAAK,EACtC,MACJ,IAAK,UACL,IAAK,OAED,IAAImP,EAAUJ,GAAaC,CAAI,EAC/BnE,EAAQ,KAAOsE,EAAQ,KACvBtE,EAAQ,QAAUsE,EAAQ,QAC1B,MACJ,IAAK,QACDtE,EAAQ,MAAQjE,GAAkB5G,CAAK,EACvC,MACJ,IAAK,WACD6K,EAAQ,SAAW,OAAO7K,CAAK,EAC/B,MACJ,QACI,MAAM,IAAI,MAAM,2BAA6BhB,EAAM,GAAG,CAC7D,CACT,CAAK,EACM6L,CACX,CACA,SAAS6E,GAAY1P,EAAO,CACxB,GAAIA,EAAM,QAAQ,GAAG,IAAM,GAAI,CAC3B,IAAIlB,EAASkB,EAAM,MAAM,GAAG,EAC5B,OAAOlB,EAAO,IAAI+Q,EAAqB,CAC1C,CACD,OAAOA,GAAsB7P,CAAK,CACtC,CACA,SAAS6P,GAAsB7P,EAAO,CAClC,MAAI,aAAa,KAAKA,CAAK,EAChB,OAAOA,CAAK,EAEhBA,CACX,CACA,SAAS4P,GAAa5P,EAAO,CACzB,IAAIiJ,EAAOjJ,EAAM,MAAM,GAAG,EAC1B,OAAOiJ,EAAK,IAAI,SAAUT,EAAK,CAC3B,GAAIA,EAAI,SAAW,EAEf,OAAOiH,GAAKjH,CAAG,EAGnB,IAAIsH,EAAQtH,EAAI,MAAM,4BAA4B,EAClD,GAAI,CAACsH,GAASA,EAAM,OAAS,EACzB,MAAM,IAAI,YAAY,2BAA2B,OAAOtH,CAAG,CAAC,EAEhE,IAAIjG,EAAI,OAAOuN,EAAM,CAAC,CAAC,EACnBC,EAAWD,EAAM,CAAC,EAClBvG,EAAOkG,GAAKM,CAAQ,EAAE,QAC1B,OAAO,IAAI1N,GAAQkH,EAAMhH,CAAC,CAClC,CAAK,CACL,CC7HA,IAAIyN,GAA8B,UAAY,CAC1C,SAASA,EAAarK,EAAMuJ,EAAM,CAC9B,GAAI,MAAMvJ,EAAK,QAAO,CAAE,EACpB,MAAM,IAAI,WAAW,qCAAqC,EAE9D,KAAK,KAAOA,EACZ,KAAK,KAAOuJ,CACf,CACD,cAAO,eAAec,EAAa,UAAW,QAAS,CACnD,IAAK,UAAY,CACb,MAAO,CAAC,KAAK,MAAQ,KAAK,KAAK,YAAa,IAAK,KACpD,EACD,WAAY,GACZ,aAAc,EACtB,CAAK,EACDA,EAAa,UAAU,SAAW,UAAY,CAC1C,IAAIC,EAAUvJ,GAAkB,KAAK,KAAK,UAAW,KAAK,KAAK,EAC/D,OAAK,KAAK,MAGH,IAAI,OAAOuJ,CAAO,EAFd,SAAS,OAAO,KAAK,KAAM,GAAG,EAAE,OAAOA,CAAO,CAGjE,EACID,EAAa,UAAU,QAAU,UAAY,CACzC,OAAO,KAAK,KAAK,SACzB,EACIA,EAAa,UAAU,YAAc,UAAY,CAC7C,OAAI,KAAK,MACE,KAAK,KAET7I,GAAe,KAAK,KAAM,KAAK,IAAI,CAClD,EACW6I,CACX,IC5BO,SAASE,GAAgBrF,EAAS,CAKrC,QAJInC,EAAQ,CAAA,EACRyG,EAAU,GACVpB,EAAO,OAAO,KAAKlD,CAAO,EAC1BqD,EAAc,OAAO,KAAKI,EAAe,EACpCpL,EAAI,EAAGA,EAAI6K,EAAK,OAAQ7K,IAC7B,GAAI6K,EAAK7K,CAAC,IAAM,QAEXkB,EAAS8J,EAAaH,EAAK7K,CAAC,CAAC,EAElC,KAAIlE,EAAM+O,EAAK7K,CAAC,EAAE,YAAW,EACzBlD,EAAQ6K,EAAQkD,EAAK7K,CAAC,CAAC,EACvBiN,EAAW,GACf,GAAI,GAACzN,GAAU1C,CAAK,GAAM6C,GAAQ7C,CAAK,GAAK,CAACA,EAAM,QAEnD,QAAQhB,EAAG,CACP,IAAK,OACDmR,EAAW/G,EAAM,YAAYyB,EAAQ,IAAI,EACzC,MACJ,IAAK,OACGlI,GAAS3C,CAAK,EACdmQ,EAAW,IAAI9N,GAAQrC,CAAK,EAAE,SAAQ,EAGtCmQ,EAAWnQ,EAAM,WAErB,MACJ,IAAK,YAYDhB,EAAM,QACNmR,EAAW7M,GAAQtD,CAAK,EACnB,IAAI,SAAUuJ,EAAM,CACrB,OAAIA,aAAgBlH,GACTkH,EAEP1G,GAAQ0G,CAAI,EACL,IAAIlH,GAAQkH,EAAK,CAAC,EAAGA,EAAK,CAAC,CAAC,EAEhC,IAAIlH,GAAQkH,CAAI,CAC3C,CAAiB,EACI,WACL,MACJ,IAAK,UACD4F,EAAUiB,GAAapQ,EAAO6K,EAAQ,IAAI,EAC1C,MACJ,IAAK,QACDsF,EAAWzJ,GAAkB1G,EAAO,CAAC6K,EAAQ,IAAI,EACjD,MACJ,QACI,GAAIhI,GAAQ7C,CAAK,EAAG,CAEhB,QADIqQ,EAAY,CAAA,EACPC,EAAI,EAAGA,EAAItQ,EAAM,OAAQsQ,IAC9BD,EAAUC,CAAC,EAAI,OAAOtQ,EAAMsQ,CAAC,CAAC,EAElCH,EAAWE,EAAU,UACxB,MAEGF,EAAW,OAAOnQ,CAAK,CAElC,CACGmQ,GACAzH,EAAM,KAAK,CAAC1J,EAAKmR,CAAQ,CAAC,GAGlC,IAAIhG,EAAQzB,EACP,IAAI,SAAUsE,EAAI,CACnB,IAAIhO,EAAMgO,EAAG,CAAC,EAAGhN,EAAQgN,EAAG,CAAC,EAC7B,MAAO,GAAG,OAAOhO,EAAK,GAAG,EAAE,OAAOgB,EAAM,SAAQ,CAAE,CAC1D,CAAK,EACI,KAAK,GAAG,EACTuQ,EAAa,GACjB,OAAIpG,IAAU,KACVoG,EAAa,SAAS,OAAOpG,CAAK,GAE/B,CAACgF,EAASoB,CAAU,EAAE,OAAO,SAAUzB,EAAG,CAAE,MAAO,CAAC,CAACA,CAAE,CAAE,EAAE,KAAK;AAAA,CAAI,CAC/E,CACA,SAASsB,GAAajB,EAASD,EAAM,CACjC,OAAKC,EAGE,UAAY,IAAIa,GAAa,IAAI,KAAKb,CAAO,EAAGD,CAAI,EAAE,WAFlD,EAGf,CC7FA,SAASsB,GAAUC,EAAMC,EAAO,CAC5B,OAAI,MAAM,QAAQD,CAAI,EACd,CAAC,MAAM,QAAQC,CAAK,GAEpBD,EAAK,SAAWC,EAAM,OACf,GACJD,EAAK,MAAM,SAAU9K,EAAMzC,EAAG,CAAE,OAAOyC,EAAK,QAAS,IAAK+K,EAAMxN,CAAC,EAAE,QAAS,CAAG,CAAA,EAEtFuN,aAAgB,KACTC,aAAiB,MAAQD,EAAK,QAAO,IAAOC,EAAM,UAEtDD,IAASC,CACpB,CACA,IAAIC,GAAuB,UAAY,CACnC,SAASA,GAAQ,CACb,KAAK,IAAM,GACX,KAAK,OAAS,GACd,KAAK,MAAQ,GACb,KAAK,QAAU,EAClB,CAMD,OAAAA,EAAM,UAAU,UAAY,SAAUC,EAAM5Q,EAAO0H,EAAM,CACjD1H,IACAA,EAAQA,aAAiB,KAAOoG,GAAMpG,CAAK,EAAIsG,GAAWtG,CAAK,GAE/D4Q,IAAS,MACT,KAAK,IAAM5Q,GAGX0H,EAAK,OAAS1H,EACd,KAAK4Q,CAAI,EAAE,KAAKlJ,CAAI,EAEhC,EAQIiJ,EAAM,UAAU,UAAY,SAAUC,EAAMlJ,EAAM,CAC9C,IAAImJ,EAAS,GACTC,EAAWpJ,EAAO,OAAO,KAAKA,CAAI,EAAI,GACtCqJ,EAAgB,SAAU3Q,EAAM,CAChC,QAAS8C,EAAI,EAAGA,EAAI4N,EAAS,OAAQ5N,IAAK,CACtC,IAAIlE,EAAM8R,EAAS5N,CAAC,EACpB,GAAI,CAACsN,GAAU9I,EAAK1I,CAAG,EAAGoB,EAAKpB,CAAG,CAAC,EAC/B,MAAO,EAEd,CACD,MAAO,EACnB,EACYgS,EAAe,KAAKJ,CAAI,EAC5B,GAAIA,IAAS,MACTC,EAAS,KAAK,YAEThO,GAAQmO,CAAY,EAGzB,QAAS9N,EAAI,EAAGA,EAAI8N,EAAa,OAAQ9N,IAAK,CAC1C,IAAI9C,EAAO4Q,EAAa9N,CAAC,EACzB,GAAI,EAAA4N,EAAS,QAAUC,EAAc3Q,CAAI,GAEzC,CAAAyQ,EAASzQ,EAAK,OACd,MACH,CAEL,GAAI,CAACyQ,GAAU,KAAK,IAAK,CAIrB,QADII,EAAa,IAAIzJ,GAAWoJ,EAAMlJ,CAAI,EACjCxE,EAAI,EAAGA,EAAI,KAAK,IAAI,QACpB+N,EAAW,OAAO,KAAK,IAAI/N,CAAC,CAAC,EADDA,IACjC,CAGJ2N,EAASI,EAAW,WACpB,KAAK,UAAUL,EAAMC,EAAQnJ,CAAI,CACpC,CACD,OAAO7E,GAAQgO,CAAM,EACfvK,GAAWuK,CAAM,EACjBA,aAAkB,KACdzK,GAAMyK,CAAM,EACZA,CAClB,EACWF,CACX,ICtFIO,GAAWC,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAc,CAAE,EAAEhO,EAAO,EAAG,EAAE,EAAG,EAAI,EAAGA,EAAO,EAAG,EAAE,EAAG,EAAI,EAAGA,EAAO,EAAG,EAAE,EAAG,EAAI,EAAGA,EAAO,EAAG,EAAE,EAAG,EAAI,EAAGA,EAAO,EAAG,EAAE,EAAG,EAAI,EAAGA,EAAO,EAAG,EAAE,EAAG,EAAI,EAAGA,EAAO,EAAG,EAAE,EAAG,EAAI,EAAGA,EAAO,EAAG,EAAE,EAAG,EAAI,EAAGA,EAAO,EAAG,EAAE,EAAG,EAAI,EAAGA,EAAO,GAAI,EAAE,EAAG,EAAI,EAAGA,EAAO,GAAI,EAAE,EAAG,EAAI,EAAGA,EAAO,GAAI,EAAE,EAAG,EAAI,EAAGA,EAAO,EAAG,CAAC,EAAG,EAAI,EACleiO,GAAWD,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAc,CAAE,EAAEhO,EAAO,EAAG,EAAE,EAAG,EAAI,EAAGA,EAAO,EAAG,EAAE,EAAG,EAAI,EAAGA,EAAO,EAAG,EAAE,EAAG,EAAI,EAAGA,EAAO,EAAG,EAAE,EAAG,EAAI,EAAGA,EAAO,EAAG,EAAE,EAAG,EAAI,EAAGA,EAAO,EAAG,EAAE,EAAG,EAAI,EAAGA,EAAO,EAAG,EAAE,EAAG,EAAI,EAAGA,EAAO,EAAG,EAAE,EAAG,EAAI,EAAGA,EAAO,EAAG,EAAE,EAAG,EAAI,EAAGA,EAAO,GAAI,EAAE,EAAG,EAAI,EAAGA,EAAO,GAAI,EAAE,EAAG,EAAI,EAAGA,EAAO,GAAI,EAAE,EAAG,EAAI,EAAGA,EAAO,EAAG,CAAC,EAAG,EAAI,EAClekO,GAAMvO,GAAM,EAAG,EAAE,EACjBwO,GAAMxO,GAAM,EAAG,EAAE,EACjByO,GAAMzO,GAAM,EAAG,EAAE,EACjB0O,GAAM1O,GAAM,EAAG,EAAE,EACjB2O,GAAcN,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAc,CAAE,EAAEK,GAAK,EAAI,EAAGF,GAAK,EAAI,EAAGE,GAAK,EAAI,EAAGD,GAAK,EAAI,EAAGC,GAAK,EAAI,EAAGD,GAAK,EAAI,EAAGC,GAAK,EAAI,EAAGA,GAAK,EAAI,EAAGD,GAAK,EAAI,EAAGC,GAAK,EAAI,EAAGD,GAAK,EAAI,EAAGC,GAAK,EAAI,EAAGA,GAAI,MAAM,EAAG,CAAC,EAAG,EAAI,EAC7WE,GAAcP,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAc,CAAE,EAAEK,GAAK,EAAI,EAAGH,GAAK,EAAI,EAAGG,GAAK,EAAI,EAAGD,GAAK,EAAI,EAAGC,GAAK,EAAI,EAAGD,GAAK,EAAI,EAAGC,GAAK,EAAI,EAAGA,GAAK,EAAI,EAAGD,GAAK,EAAI,EAAGC,GAAK,EAAI,EAAGD,GAAK,EAAI,EAAGC,GAAK,EAAI,EAAGA,GAAI,MAAM,EAAG,CAAC,EAAG,EAAI,EAC7WG,GAAO7O,GAAM,IAAK,CAAC,EACnB8O,GAAO9O,GAAM,IAAK,CAAC,EACnB+O,GAAO/O,GAAM,IAAK,CAAC,EACnBgP,GAAOhP,GAAM,IAAK,CAAC,EACnBiP,GAAeZ,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAc,CAAE,EAAEW,GAAM,EAAI,EAAGF,GAAM,EAAI,EAAGE,GAAM,EAAI,EAAGD,GAAM,EAAI,EAAGC,GAAM,EAAI,EAAGD,GAAM,EAAI,EAAGC,GAAM,EAAI,EAAGA,GAAM,EAAI,EAAGD,GAAM,EAAI,EAAGC,GAAM,EAAI,EAAGD,GAAM,EAAI,EAAGC,GAAM,EAAI,EAAGA,GAAK,MAAM,EAAG,CAAC,EAAG,EAAI,EAC3XE,GAAeb,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAc,CAAE,EAAEW,GAAM,EAAI,EAAGH,GAAM,EAAI,EAAGG,GAAM,EAAI,EAAGD,GAAM,EAAI,EAAGC,GAAM,EAAI,EAAGD,GAAM,EAAI,EAAGC,GAAM,EAAI,EAAGA,GAAM,EAAI,EAAGD,GAAM,EAAI,EAAGC,GAAM,EAAI,EAAGD,GAAM,EAAI,EAAGC,GAAM,EAAI,EAAGA,GAAK,MAAM,EAAG,CAAC,EAAG,EAAI,EAC3XG,GAAY,CAAC,EAAG,GAAI,GAAI,GAAI,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,GAAG,EACvEC,GAAY,CAAC,EAAG,GAAI,GAAI,GAAI,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,GAAG,EACvEC,GAAY,UAAY,CAExB,QADIC,EAAW,CAAA,EACNlP,EAAI,EAAGA,EAAI,GAAIA,IACpBkP,EAAWA,EAAS,OAAOtP,GAAM,CAAC,CAAC,EACvC,OAAOsP,CACX,EAAI,ECvBG,SAASC,GAAYpN,EAAM4F,EAAS,CACvC,IAAIyH,EAAYhO,GAASW,EAAM,EAAG,CAAC,EAC/BsN,EAAUvN,GAAWC,CAAI,EAAI,IAAM,IACnCuN,EAAcxN,GAAWC,EAAO,CAAC,EAAI,IAAM,IAC3CwN,EAAc/M,GAAU4M,CAAS,EACjCI,EAAc1M,GAAWsM,CAAS,EAClCK,EAASxE,GAASA,GAAS,CAAE,QAASoE,EAAS,YAAaC,EAAa,YAAaC,EAAa,YAAaC,CAAa,EAAEE,GAAc3N,CAAI,CAAC,EAAG,CAAE,QAAS,IAAI,CAAE,EAC1K,GAAIhB,GAAM4G,EAAQ,QAAQ,EACtB,OAAO8H,EAEXA,EAAO,QAAUxP,EAAO,EAAGoP,EAAU,CAAC,EACtC,IAAIM,EACAC,EACAC,EAAWF,EAAY/O,GAAM,EAAI4O,EAAc7H,EAAQ,KAAM,CAAC,EAC9DkI,GAAW,GACXA,EAAU,EAGVD,EAAWH,EAAO,QAAU7O,GAAM4O,EAAc7H,EAAQ,KAAM,CAAC,GAK/DiI,EAAWP,EAAUQ,EAKzB,QAHIC,EAAM,KAAK,MAAMF,EAAW,CAAC,EAC7BG,EAAMnP,GAAMgP,EAAU,CAAC,EACvBI,EAAW,KAAK,MAAMF,EAAMC,EAAM,CAAC,EAC9B3C,EAAI,EAAGA,EAAIzF,EAAQ,SAAS,OAAQyF,IAAK,CAC9C,IAAI/N,EAAIsI,EAAQ,SAASyF,CAAC,EAI1B,GAHI/N,EAAI,IACJA,GAAK2Q,EAAW,GAEd3Q,EAAI,GAAKA,GAAK2Q,EAGpB,KAAIhQ,EAAI,OACJX,EAAI,GACJW,EAAI6P,GAAWxQ,EAAI,GAAK,EACpBwQ,IAAYF,IACZ3P,GAAK,EAAI2P,IAIb3P,EAAI6P,EAER,QAASI,EAAI,EAAGA,EAAI,IAChBR,EAAO,QAAQzP,CAAC,EAAI,EACpBA,IACIyP,EAAO,SAASzP,CAAC,IAAM2H,EAAQ,MAHhBsI,IAGnB,EAGP,CACD,GAAI/O,EAASyG,EAAQ,SAAU,CAAC,EAAG,CAG/B,IAAI3H,EAAI6P,EAAUG,EAAW,EAG7B,GAFIH,IAAYF,IACZ3P,GAAK,EAAI2P,GACT3P,EAAIqP,EAGJ,QAASjC,EAAI,EAAGA,EAAI,IAChBqC,EAAO,QAAQzP,CAAC,EAAI,EACpBA,GAAK,EACDyP,EAAO,SAASzP,CAAC,IAAM2H,EAAQ,MAHhByF,IAGnB,CAIX,CACD,GAAIyC,EAAS,CAOT,IAAIK,EAAY,OAChB,GAAKhP,EAASyG,EAAQ,SAAU,EAAE,EAe9BuI,EAAY,OAfqB,CACjC,IAAIC,EAAerN,GAAW1B,GAASW,EAAO,EAAG,EAAG,CAAC,CAAC,EAClDqO,EAAWxP,GAAM,EAAIuP,EAAa,QAAO,EAAKxI,EAAQ,KAAM,CAAC,EAC7D0I,EAAWvO,GAAWC,EAAO,CAAC,EAAI,IAAM,IACxCuO,EAAS,OACTF,GAAY,GACZA,EAAW,EACXE,EAASD,EAAWzP,GAAMuP,EAAexI,EAAQ,KAAM,CAAC,GAGxD2I,EAASjB,EAAUQ,EAEvBK,EAAY,KAAK,MAAM,GAAKtP,GAAM0P,EAAQ,CAAC,EAAI,CAAC,CACnD,CAID,GAAIpP,EAASyG,EAAQ,SAAUuI,CAAS,EACpC,QAASlQ,EAAI,EAAGA,EAAI6P,EAAS7P,IACzByP,EAAO,QAAQzP,CAAC,EAAI,CAE/B,CACD,OAAOyP,CACX,CACA,SAASC,GAAc3N,EAAM,CACzB,IAAIsN,EAAUvN,GAAWC,CAAI,EAAI,IAAM,IACnCqN,EAAYhO,GAASW,EAAM,EAAG,CAAC,EAC/BsE,EAAOvD,GAAWsM,CAAS,EAC/B,OAAIC,IAAY,IACL,CACH,MAAOrB,GACP,SAAUQ,GACV,UAAWM,GACX,SAAUG,GAAS,MAAM5I,CAAI,EAC7B,OAAQ2I,EACpB,EAEW,CACH,MAAOd,GACP,SAAUK,GACV,UAAWM,GACX,SAAUI,GAAS,MAAM5I,CAAI,EAC7B,OAAQ0I,EAChB,CACA,CC5HO,SAASwB,GAAaxO,EAAMc,EAAOwM,EAASmB,EAAQtB,EAAUvH,EAAS,CAC1E,IAAI8H,EAAS,CACT,SAAU1N,EACV,UAAWc,EACX,UAAW,CAAE,CACrB,EACQ4N,EAAS,CAAA,EACb,GAAI9I,EAAQ,OAASzB,EAAM,OACvB,GAAInF,GAAM4G,EAAQ,OAAO,EACrB8I,EAAS,CAAC,CAAC,EAAGpB,CAAO,CAAC,MAGtB,SAASjC,EAAI,EAAGA,EAAIzF,EAAQ,QAAQ,OAAQyF,IACxCvK,EAAQ8E,EAAQ,QAAQyF,CAAC,EACzBqD,EAAO,KAAKD,EAAO,MAAM3N,EAAQ,EAAGA,EAAQ,CAAC,CAAC,OAIjD8E,EAAQ,OAASzB,EAAM,UAC5BuK,EAAS,CAACD,EAAO,MAAM3N,EAAQ,EAAGA,EAAQ,CAAC,CAAC,GAEhD,GAAI9B,GAAM0P,CAAM,EACZ,OAAOhB,EAIXA,EAAO,UAAYxP,EAAO,EAAGoP,CAAO,EACpC,QAASjC,EAAI,EAAGA,EAAIqD,EAAO,OAAQrD,IAI/B,QAHIrN,EAAO0Q,EAAOrD,CAAC,EACfsD,EAAQ3Q,EAAK,CAAC,EACd4Q,EAAO5Q,EAAK,CAAC,EAAI,EACZkQ,EAAI,EAAGA,EAAItI,EAAQ,WAAW,OAAQsI,IAAK,CAChD,IAAIjQ,EAAI,OACJ8J,EAAKnC,EAAQ,WAAWsI,CAAC,EAAG5J,EAAOyD,EAAG,CAAC,EAAGzK,EAAIyK,EAAG,CAAC,EAClDzK,EAAI,GACJW,EAAI2Q,GAAQtR,EAAI,GAAK,EACrBW,GAAKY,GAAMsO,EAASlP,CAAC,EAAIqG,EAAM,CAAC,IAGhCrG,EAAI0Q,GAASrR,EAAI,GAAK,EACtBW,GAAKY,GAAM,EAAIsO,EAASlP,CAAC,EAAIqG,EAAM,CAAC,GAEpCqK,GAAS1Q,GAAKA,GAAK2Q,IACnBlB,EAAO,UAAUzP,CAAC,EAAI,EAC7B,CAEL,OAAOyP,CACX,CCjDO,SAASmB,GAAOvP,EAAGwP,EAAQ,CAC1BA,IAAW,SAAUA,EAAS,GAClC,IAAI7U,EAAIqF,EAAI,GACRpF,EAAI,KAAK,MAAMoF,EAAI,GAAG,EACtByP,EAAIzP,EAAI,IACRE,EAAI,KAAK,MAAMtF,EAAI,CAAC,EACpB8U,EAAI9U,EAAI,EACR+U,EAAI,KAAK,OAAO/U,EAAI,GAAK,EAAE,EAC3BgV,EAAI,KAAK,OAAOhV,EAAI+U,EAAI,GAAK,CAAC,EAC9BxP,EAAI,KAAK,MAAM,GAAKxF,EAAIC,EAAIsF,EAAI0P,EAAI,EAAE,EAAI,GAC1CjR,EAAI,KAAK,MAAM8Q,EAAI,CAAC,EACpBb,EAAIa,EAAI,EACRI,EAAI,KAAK,MAAM,GAAK,EAAIH,EAAI,EAAI/Q,EAAIwB,EAAIyO,CAAC,EAAI,EAC7C,EAAI,KAAK,OAAOjU,EAAI,GAAKwF,EAAI,GAAK0P,GAAK,GAAG,EAC1CrO,EAAQ,KAAK,OAAOrB,EAAI0P,EAAI,EAAI,EAAI,KAAO,EAAE,EAC7C5L,GAAQ9D,EAAI0P,EAAI,EAAI,EAAI,KAAO,GAAM,EACrCzO,EAAO,KAAK,IAAIpB,EAAGwB,EAAQ,EAAGyC,EAAMuL,CAAM,EAC1CM,EAAY,KAAK,IAAI9P,EAAG,EAAG,CAAC,EAChC,MAAO,CAAC,KAAK,MAAMoB,EAAO0O,IAAc,IAAO,GAAK,GAAK,GAAG,CAAC,CACjE,CCTA,IAAIC,GAA0B,UAAY,CAEtC,SAASA,EAASzJ,EAAS,CACvB,KAAK,QAAUA,CAClB,CACD,OAAAyJ,EAAS,UAAU,QAAU,SAAUrP,EAAMc,EAAO,CAChD,IAAI8E,EAAU,KAAK,QAInB,GAHI5F,IAAS,KAAK,WACd,KAAK,SAAWoN,GAAYpN,EAAM4F,CAAO,GAEzC1G,GAAS0G,EAAQ,UAAU,IAC1B9E,IAAU,KAAK,WAAad,IAAS,KAAK,UAAW,CACtD,IAAI+H,EAAK,KAAK,SAAUuF,EAAUvF,EAAG,QAAS0G,EAAS1G,EAAG,OAAQoF,EAAWpF,EAAG,SAChF,KAAK,UAAYyG,GAAaxO,EAAMc,EAAOwM,EAASmB,EAAQtB,EAAUvH,CAAO,CAChF,CACGnI,GAAUmI,EAAQ,QAAQ,IAC1B,KAAK,WAAaiJ,GAAO7O,EAAM4F,EAAQ,QAAQ,EAE3D,EACI,OAAO,eAAeyJ,EAAS,UAAW,WAAY,CAClD,IAAK,UAAY,CACb,OAAO,KAAK,UAAY,KAAK,UAAU,SAAW,IACrD,EACD,WAAY,GACZ,aAAc,EACtB,CAAK,EACD,OAAO,eAAeA,EAAS,UAAW,YAAa,CACnD,IAAK,UAAY,CACb,OAAO,KAAK,UAAY,KAAK,UAAU,UAAY,IACtD,EACD,WAAY,GACZ,aAAc,EACtB,CAAK,EACD,OAAO,eAAeA,EAAS,UAAW,UAAW,CACjD,IAAK,UAAY,CACb,OAAO,KAAK,SAAS,OACxB,EACD,WAAY,GACZ,aAAc,EACtB,CAAK,EACD,OAAO,eAAeA,EAAS,UAAW,cAAe,CACrD,IAAK,UAAY,CACb,OAAO,KAAK,SAAS,WACxB,EACD,WAAY,GACZ,aAAc,EACtB,CAAK,EACD,OAAO,eAAeA,EAAS,UAAW,SAAU,CAChD,IAAK,UAAY,CACb,OAAO,KAAK,SAAS,MACxB,EACD,WAAY,GACZ,aAAc,EACtB,CAAK,EACD,OAAO,eAAeA,EAAS,UAAW,WAAY,CAClD,IAAK,UAAY,CACb,OAAO,KAAK,SAAS,QACxB,EACD,WAAY,GACZ,aAAc,EACtB,CAAK,EACD,OAAO,eAAeA,EAAS,UAAW,QAAS,CAC/C,IAAK,UAAY,CACb,OAAO,KAAK,SAAS,KACxB,EACD,WAAY,GACZ,aAAc,EACtB,CAAK,EACD,OAAO,eAAeA,EAAS,UAAW,UAAW,CACjD,IAAK,UAAY,CACb,OAAO,KAAK,SAAS,OACxB,EACD,WAAY,GACZ,aAAc,EACtB,CAAK,EACD,OAAO,eAAeA,EAAS,UAAW,YAAa,CACnD,IAAK,UAAY,CACb,OAAO,KAAK,UAAY,KAAK,UAAU,UAAY,CAAA,CACtD,EACD,WAAY,GACZ,aAAc,EACtB,CAAK,EACD,OAAO,eAAeA,EAAS,UAAW,cAAe,CACrD,IAAK,UAAY,CACb,OAAO,KAAK,SAAS,WACxB,EACD,WAAY,GACZ,aAAc,EACtB,CAAK,EACD,OAAO,eAAeA,EAAS,UAAW,WAAY,CAClD,IAAK,UAAY,CACb,OAAO,KAAK,SAAS,QACxB,EACD,WAAY,GACZ,aAAc,EACtB,CAAK,EACD,OAAO,eAAeA,EAAS,UAAW,YAAa,CACnD,IAAK,UAAY,CACb,OAAO,KAAK,SAAS,SACxB,EACD,WAAY,GACZ,aAAc,EACtB,CAAK,EACDA,EAAS,UAAU,QAAU,UAAY,CACrC,MAAO,CAACxR,GAAM,KAAK,OAAO,EAAG,EAAG,KAAK,OAAO,CACpD,EACIwR,EAAS,UAAU,QAAU,SAAUC,EAAGxO,EAAO,CAI7C,QAHIhD,EAAQ,KAAK,OAAOgD,EAAQ,CAAC,EAC7B/C,EAAM,KAAK,OAAO+C,CAAK,EACvByO,EAAMrR,EAAO,KAAM,KAAK,OAAO,EAC1B,EAAIJ,EAAO,EAAIC,EAAK,IACzBwR,EAAI,CAAC,EAAI,EACb,MAAO,CAACA,EAAKzR,EAAOC,CAAG,CAC/B,EACIsR,EAAS,UAAU,QAAU,SAAUrP,EAAMc,EAAOyC,EAAK,CAKrD,QAHIgM,EAAMrR,EAAO,KAAM,KAAK,QAAU,CAAC,EACnCD,EAAIwC,GAAUpB,GAASW,EAAMc,EAAOyC,CAAG,CAAC,EAAI,KAAK,YACjDzF,EAAQG,EACHoN,EAAI,EAAGA,EAAI,IAChBkE,EAAItR,CAAC,EAAIA,EACT,EAAEA,EACE,KAAK,SAASA,CAAC,IAAM,KAAK,QAAQ,MAHnBoN,IAGnB,CAGJ,MAAO,CAACkE,EAAKzR,EAAOG,CAAC,CAC7B,EACIoR,EAAS,UAAU,QAAU,SAAUrP,EAAMc,EAAOyC,EAAK,CACrD,IAAIgM,EAAMrR,EAAO,KAAM,KAAK,OAAO,EAC/BD,EAAIwC,GAAUpB,GAASW,EAAMc,EAAOyC,CAAG,CAAC,EAAI,KAAK,YACrD,OAAAgM,EAAItR,CAAC,EAAIA,EACF,CAACsR,EAAKtR,EAAGA,EAAI,CAAC,CAC7B,EACIoR,EAAS,UAAU,SAAW,SAAUnI,EAAMoI,EAAGlI,EAAQC,EAAa,CAClE,IAAIpE,EAAQ,KACRsM,EAAM,CAAA,EACV,YAAK,QAAQ,SAAS,QAAQ,SAAUpI,EAAQ,CAC5CoI,EAAMA,EAAI,OAAOtM,EAAM,SAASiE,EAAMC,EAAQC,EAAQC,CAAW,CAAC,CAC9E,CAAS,EACD7F,GAAK+N,CAAG,EACDA,CACf,EACIF,EAAS,UAAU,SAAW,SAAUnI,EAAMC,EAAQmI,EAAGjI,EAAa,CAClE,IAAIkI,EAAM,KAAK,QAAQ,SAAS,IAAI,SAAUnI,EAAQ,CAAE,OAAO,IAAIH,GAAKC,EAAMC,EAAQC,EAAQC,CAAW,CAAE,CAAE,EAC7G,OAAA7F,GAAK+N,CAAG,EACDA,CACf,EACIF,EAAS,UAAU,SAAW,SAAUnI,EAAMC,EAAQC,EAAQC,EAAa,CACvE,MAAO,CAAC,IAAIJ,GAAKC,EAAMC,EAAQC,EAAQC,CAAW,CAAC,CAC3D,EACIgI,EAAS,UAAU,UAAY,SAAUzI,EAAM,CAC3C,OAAQA,EAAI,CACR,KAAKF,EAAU,OACX,OAAO,KAAK,QAAQ,KAAK,IAAI,EACjC,KAAKA,EAAU,QACX,OAAO,KAAK,QAAQ,KAAK,IAAI,EACjC,KAAKA,EAAU,OACX,OAAO,KAAK,QAAQ,KAAK,IAAI,EACjC,KAAKA,EAAU,MACX,OAAO,KAAK,QAAQ,KAAK,IAAI,EACjC,QACI,OAAO,KAAK,QAAQ,KAAK,IAAI,CACpC,CACT,EACI2I,EAAS,UAAU,WAAa,SAAUzI,EAAM,CAC5C,OAAQA,EAAI,CACR,KAAKF,EAAU,OACX,OAAO,KAAK,SAAS,KAAK,IAAI,EAClC,KAAKA,EAAU,SACX,OAAO,KAAK,SAAS,KAAK,IAAI,EAClC,KAAKA,EAAU,SACX,OAAO,KAAK,SAAS,KAAK,IAAI,CACrC,CACT,EACW2I,CACX,ICvLO,SAASG,GAAaC,EAAUhG,EAAS3L,EAAOC,EAAK2R,EAAIC,EAAQ,CAEpE,QADIC,EAAU,CAAA,EACLvE,EAAI,EAAGA,EAAIoE,EAAS,OAAQpE,IAAK,CACtC,IAAIwE,EAAS,OACTC,EAAU,OACVC,EAAMN,EAASpE,CAAC,EAChB0E,EAAM,GACNF,EAAS,KAAK,MAAME,EAAMtG,EAAQ,MAAM,EACxCqG,EAAUjR,GAAMkR,EAAKtG,EAAQ,MAAM,IAGnCoG,EAAS,KAAK,OAAOE,EAAM,GAAKtG,EAAQ,MAAM,EAC9CqG,EAAUjR,GAAMkR,EAAM,EAAGtG,EAAQ,MAAM,GAG3C,QADIuG,EAAM,CAAA,EACD9B,EAAIpQ,EAAOoQ,EAAInQ,EAAKmQ,IAAK,CAC9B,IAAI5V,EAAMqX,EAAOzB,CAAC,EACbzQ,GAAUnF,CAAG,GAElB0X,EAAI,KAAK1X,CAAG,CACf,CACD,IAAI2F,EAAI,OACJ4R,EAAS,EACT5R,EAAI+R,EAAI,MAAMH,CAAM,EAAE,CAAC,EAGvB5R,EAAI+R,EAAIH,CAAM,EAElB,IAAI3O,EAAOuI,EAAQqG,CAAO,EACtBpP,EAAOC,GAAY+O,EAAG,YAAczR,CAAC,EACrC2E,EAAM3B,GAAQP,EAAMQ,CAAI,EAGvB/B,EAASyQ,EAAShN,CAAG,GACtBgN,EAAQ,KAAKhN,CAAG,CACvB,CACD,OAAApB,GAAKoO,CAAO,EACLA,CACX,CC/BO,SAASK,GAAKjE,EAAYpG,EAAS,CACtC,IAAIsE,EAAUtE,EAAQ,QAASgB,EAAOhB,EAAQ,KAAM+C,EAAW/C,EAAQ,SAAUhE,EAAQgE,EAAQ,MAAO6J,EAAW7J,EAAQ,SACvHsK,EAAQtK,EAAQ,MACpB,GAAIsK,IAAU,GAAKvH,IAAa,EAC5B,OAAOwH,GAAWnE,CAAU,EAEhC,IAAIoE,EAAc9I,GAAS,SAAS4C,CAAO,EACvCwF,EAAK,IAAIL,GAASzJ,CAAO,EAC7B8J,EAAG,QAAQU,EAAY,KAAMA,EAAY,KAAK,EAE9C,QADI3G,EAAU4G,GAAYX,EAAIU,EAAaxK,CAAO,IACzC,CACL,IAAImC,EAAK2H,EAAG,UAAU9I,CAAI,EAAEwJ,EAAY,KAAMA,EAAY,MAAOA,EAAY,GAAG,EAAGT,EAAS5H,EAAG,CAAC,EAAGjK,EAAQiK,EAAG,CAAC,EAAGhK,EAAMgK,EAAG,CAAC,EACxHF,EAAWyI,GAAmBX,EAAQ7R,EAAOC,EAAK2R,EAAI9J,CAAO,EACjE,GAAI1G,GAASuQ,CAAQ,EAEjB,QADIG,EAAUJ,GAAaC,EAAUhG,EAAS3L,EAAOC,EAAK2R,EAAIC,CAAM,EAC3DtE,EAAI,EAAGA,EAAIuE,EAAQ,OAAQvE,IAAK,CACrC,IAAIzI,EAAMgN,EAAQvE,CAAC,EACnB,GAAIzJ,GAASgB,EAAMhB,EACf,OAAOuO,GAAWnE,CAAU,EAEhC,GAAIpJ,GAAOsH,EAAS,CAChB,IAAIqG,EAAcC,GAAe5N,EAAKgD,CAAO,EAI7C,GAHI,CAACoG,EAAW,OAAOuE,CAAW,GAG9BL,IACA,EAAEA,EACE,CAACA,GACD,OAAOC,GAAWnE,CAAU,CAGvC,CACJ,KAGD,SAASX,EAAIvN,EAAOuN,EAAItN,EAAKsN,IAAK,CAC9B,IAAIoF,EAAad,EAAOtE,CAAC,EACzB,GAAK5N,GAAUgT,CAAU,EAIzB,QADI/P,EAAOC,GAAY+O,EAAG,YAAce,CAAU,EACzCvC,EAAI,EAAGA,EAAIzE,EAAQ,OAAQyE,IAAK,CACrC,IAAIhN,EAAOuI,EAAQyE,CAAC,EAChBtL,EAAM3B,GAAQP,EAAMQ,CAAI,EAC5B,GAAIU,GAASgB,EAAMhB,EACf,OAAOuO,GAAWnE,CAAU,EAEhC,GAAIpJ,GAAOsH,EAAS,CAChB,IAAIqG,EAAcC,GAAe5N,EAAKgD,CAAO,EAI7C,GAHI,CAACoG,EAAW,OAAOuE,CAAW,GAG9BL,IACA,EAAEA,EACE,CAACA,GACD,OAAOC,GAAWnE,CAAU,CAGvC,CACJ,CACJ,CAOL,GALIpG,EAAQ,WAAa,IAIzBwK,EAAY,IAAIxK,EAASiC,CAAQ,EAC7BuI,EAAY,KAAOxQ,IACnB,OAAOuQ,GAAWnE,CAAU,EAE3BrF,GAAqBC,CAAI,IAC1B6C,EAAUiG,EAAG,WAAW9I,CAAI,EAAEwJ,EAAY,KAAMA,EAAY,OAAQA,EAAY,OAAQ,CAAC,GAE7FV,EAAG,QAAQU,EAAY,KAAMA,EAAY,KAAK,CACjD,CACL,CACA,SAASM,GAAWhB,EAAIe,EAAY7K,EAAS,CACzC,IAAI+K,EAAU/K,EAAQ,QAASgL,EAAWhL,EAAQ,SAAU7B,EAAY6B,EAAQ,UAAWiL,EAAWjL,EAAQ,SAAU/B,EAAa+B,EAAQ,WAAY9B,EAAc8B,EAAQ,YAAakL,EAAYlL,EAAQ,UAChN,OAAS1G,GAASyR,CAAO,GAAK,CAACxR,EAASwR,EAASjB,EAAG,MAAMe,CAAU,CAAC,GAChEvR,GAAS0R,CAAQ,GAAK,CAAClB,EAAG,QAAQe,CAAU,GAC5CvR,GAAS6E,CAAS,GAAK,CAAC5E,EAAS4E,EAAW2L,EAAG,SAASe,CAAU,CAAC,GACnEvR,GAASwQ,EAAG,SAAS,GAAK,CAACA,EAAG,UAAUe,CAAU,GAClDI,IAAa,MAAQ,CAAC1R,EAASuQ,EAAG,WAAYe,CAAU,IACvDvR,GAAS2E,CAAU,GAAK3E,GAAS4E,CAAW,IAC1C,CAAC3E,EAAS0E,EAAY6L,EAAG,SAASe,CAAU,CAAC,GAC7C,CAACtR,EAAS2E,EAAa4L,EAAG,UAAUe,CAAU,CAAC,GAClDvR,GAAS4R,CAAS,IACbL,EAAaf,EAAG,SACd,CAACvQ,EAAS2R,EAAWL,EAAa,CAAC,GACnC,CAACtR,EAAS2R,EAAW,CAACpB,EAAG,QAAUe,CAAU,GAC5CA,GAAcf,EAAG,SACd,CAACvQ,EAAS2R,EAAWL,EAAa,EAAIf,EAAG,OAAO,GAChD,CAACvQ,EAAS2R,EAAW,CAACpB,EAAG,YAAce,EAAaf,EAAG,OAAO,EAClF,CACA,SAASc,GAAe9P,EAAMkF,EAAS,CACnC,OAAO,IAAImF,GAAarK,EAAMkF,EAAQ,IAAI,EAAE,aAChD,CACA,SAASuK,GAAWnE,EAAY,CAC5B,OAAOA,EAAW,UACtB,CACA,SAASsE,GAAmBX,EAAQ7R,EAAOC,EAAK2R,EAAI9J,EAAS,CAEzD,QADIiC,EAAW,GACNkJ,EAAajT,EAAOiT,EAAahT,EAAKgT,IAAc,CACzD,IAAIN,EAAad,EAAOoB,CAAU,EAClClJ,EAAW6I,GAAWhB,EAAIe,EAAY7K,CAAO,EACzCiC,IACA8H,EAAOc,CAAU,EAAI,KAC5B,CACD,OAAO5I,CACX,CACA,SAASwI,GAAYX,EAAIU,EAAaxK,EAAS,CAC3C,IAAIgB,EAAOhB,EAAQ,KAAMkC,EAASlC,EAAQ,OAAQuC,EAAWvC,EAAQ,SAAU2C,EAAW3C,EAAQ,SAClG,OAAIe,GAAqBC,CAAI,EAClB2C,GAAa3D,CAAO,EAE1BgB,GAAQzC,EAAM,QACfjF,GAAS4I,CAAM,GACf,CAAC3I,EAAS2I,EAAQsI,EAAY,IAAI,GACjCxJ,GAAQzC,EAAM,UACXjF,GAASiJ,CAAQ,GACjB,CAAChJ,EAASgJ,EAAUiI,EAAY,MAAM,GACzCxJ,GAAQzC,EAAM,UACXjF,GAASqJ,CAAQ,GACjB,CAACpJ,EAASoJ,EAAU6H,EAAY,MAAM,EACnC,GAEJV,EAAG,WAAW9I,CAAI,EAAEwJ,EAAY,KAAMA,EAAY,OAAQA,EAAY,OAAQA,EAAY,WAAW,CAChH,CC1HO,IAAI5F,GAAO,CACd,GAAI,IAAIpN,GAAQ,CAAC,EACjB,GAAI,IAAIA,GAAQ,CAAC,EACjB,GAAI,IAAIA,GAAQ,CAAC,EACjB,GAAI,IAAIA,GAAQ,CAAC,EACjB,GAAI,IAAIA,GAAQ,CAAC,EACjB,GAAI,IAAIA,GAAQ,CAAC,EACjB,GAAI,IAAIA,GAAQ,CAAC,CACrB,EACWiM,GAAkB,CACzB,KAAM3C,EAAU,OAChB,QAAS,KACT,SAAU,EACV,KAAM8D,GAAK,GACX,MAAO,KACP,MAAO,KACP,KAAM,KACN,SAAU,KACV,QAAS,KACT,WAAY,KACZ,YAAa,KACb,UAAW,KACX,SAAU,KACV,UAAW,KACX,WAAY,KACZ,OAAQ,KACR,SAAU,KACV,SAAU,KACV,SAAU,IACd,EACWvB,GAAc,OAAO,KAAKI,EAAe,EAOhDlF,EAAuB,UAAY,CACnC,SAASA,EAAMyB,EAASoL,EAAS,CACzBpL,IAAY,SAAUA,EAAU,CAAE,GAClCoL,IAAY,SAAUA,EAAU,IAEpC,KAAK,OAASA,EAAU,KAAO,IAAItF,GAEnC,KAAK,YAAc9C,GAAkBhD,CAAO,EAC5C,IAAIqL,EAAgB9H,GAAavD,CAAO,EAAE,cAC1C,KAAK,QAAUqL,CAClB,CACD,OAAA9M,EAAM,UAAY,SAAUgB,EAAMxB,EAAU,CACxC,OAAOgC,GAAUR,EAAMxB,CAAQ,CACvC,EACIQ,EAAM,SAAW,SAAUgB,EAAMxB,EAAU,CACvC,OAAOkD,GAAS1B,EAAMxB,CAAQ,CACtC,EACIQ,EAAM,WAAa,SAAU5G,EAAK,CAC9B,OAAO,IAAI4G,EAAMA,EAAM,YAAY5G,CAAG,GAAK,MAAS,CAC5D,EACI4G,EAAM,UAAU,MAAQ,SAAU6H,EAAY,CAC1C,OAAOiE,GAAKjE,EAAY,KAAK,OAAO,CAC5C,EACI7H,EAAM,UAAU,UAAY,SAAUwH,EAAMlJ,EAAM,CAC9C,OAAK,KAAK,OAEH,KAAK,OAAO,UAAUkJ,EAAMlJ,CAAI,EAD5B,EAEnB,EACI0B,EAAM,UAAU,UAAY,SAAUwH,EAAM5Q,EAAO0H,EAAM,CACrD,GAAK,KAAK,OAEV,OAAO,KAAK,OAAO,UAAUkJ,EAAM5Q,EAAO0H,CAAI,CACtD,EAOI0B,EAAM,UAAU,IAAM,SAAUnB,EAAU,CACtC,GAAIA,EACA,OAAO,KAAK,MAAM,IAAIH,GAAmB,MAAO,CAAE,EAAEG,CAAQ,CAAC,EAEjE,IAAI0K,EAAS,KAAK,UAAU,KAAK,EACjC,OAAIA,IAAW,KACXA,EAAS,KAAK,MAAM,IAAInL,GAAW,MAAO,CAAE,CAAA,CAAC,EAC7C,KAAK,UAAU,MAAOmL,CAAM,GAEzBA,CACf,EASIvJ,EAAM,UAAU,QAAU,SAAU+M,EAAOC,EAAQC,EAAKpO,EAAU,CAE9D,GADIoO,IAAQ,SAAUA,EAAM,IACxB,CAAClR,GAAYgR,CAAK,GAAK,CAAChR,GAAYiR,CAAM,EAC1C,MAAM,IAAI,MAAM,yCAAyC,EAE7D,IAAI1O,EAAO,CACP,OAAQ0O,EACR,MAAOD,EACP,IAAKE,CACjB,EACQ,GAAIpO,EACA,OAAO,KAAK,MAAM,IAAIH,GAAmB,UAAWJ,EAAMO,CAAQ,CAAC,EAEvE,IAAI0K,EAAS,KAAK,UAAU,UAAWjL,CAAI,EAC3C,OAAIiL,IAAW,KACXA,EAAS,KAAK,MAAM,IAAInL,GAAW,UAAWE,CAAI,CAAC,EACnD,KAAK,UAAU,UAAWiL,EAAQjL,CAAI,GAEnCiL,CACf,EAQIvJ,EAAM,UAAU,OAAS,SAAUkN,EAAID,EAAK,CAExC,GADIA,IAAQ,SAAUA,EAAM,IACxB,CAAClR,GAAYmR,CAAE,EACf,MAAM,IAAI,MAAM,wCAAwC,EAE5D,IAAI5O,EAAO,CAAE,GAAI4O,EAAI,IAAKD,CAAG,EACzB1D,EAAS,KAAK,UAAU,SAAUjL,CAAI,EAC1C,OAAIiL,IAAW,KACXA,EAAS,KAAK,MAAM,IAAInL,GAAW,SAAUE,CAAI,CAAC,EAClD,KAAK,UAAU,SAAUiL,EAAQjL,CAAI,GAElCiL,CACf,EAQIvJ,EAAM,UAAU,MAAQ,SAAUkN,EAAID,EAAK,CAEvC,GADIA,IAAQ,SAAUA,EAAM,IACxB,CAAClR,GAAYmR,CAAE,EACf,MAAM,IAAI,MAAM,uCAAuC,EAE3D,IAAI5O,EAAO,CAAE,GAAI4O,EAAI,IAAKD,CAAG,EACzB1D,EAAS,KAAK,UAAU,QAASjL,CAAI,EACzC,OAAIiL,IAAW,KACXA,EAAS,KAAK,MAAM,IAAInL,GAAW,QAASE,CAAI,CAAC,EACjD,KAAK,UAAU,QAASiL,EAAQjL,CAAI,GAEjCiL,CACf,EAKIvJ,EAAM,UAAU,MAAQ,UAAY,CAChC,OAAO,KAAK,IAAK,EAAC,MAC1B,EAOIA,EAAM,UAAU,SAAW,UAAY,CACnC,OAAO8G,GAAgB,KAAK,WAAW,CAC/C,EAKI9G,EAAM,UAAU,OAAS,SAAUT,EAASC,EAAUC,EAAe,CACjE,OAAOmD,GAAO,KAAMrD,EAASC,EAAUC,CAAa,CAC5D,EACIO,EAAM,UAAU,yBAA2B,UAAY,CACnD,OAAO6C,GAAmB,IAAI,CACtC,EAKI7C,EAAM,UAAU,MAAQ,UAAY,CAChC,OAAO,IAAIA,EAAM,KAAK,WAAW,CACzC,EAEIA,EAAM,YAAc,CAChB,SACA,UACA,SACA,QACA,SACA,WACA,UACR,EACIA,EAAM,OAASuC,EAAU,OACzBvC,EAAM,QAAUuC,EAAU,QAC1BvC,EAAM,OAASuC,EAAU,OACzBvC,EAAM,MAAQuC,EAAU,MACxBvC,EAAM,OAASuC,EAAU,OACzBvC,EAAM,SAAWuC,EAAU,SAC3BvC,EAAM,SAAWuC,EAAU,SAC3BvC,EAAM,GAAKqG,GAAK,GAChBrG,EAAM,GAAKqG,GAAK,GAChBrG,EAAM,GAAKqG,GAAK,GAChBrG,EAAM,GAAKqG,GAAK,GAChBrG,EAAM,GAAKqG,GAAK,GAChBrG,EAAM,GAAKqG,GAAK,GAChBrG,EAAM,GAAKqG,GAAK,GAChBrG,EAAM,YAAcuF,GACpBvF,EAAM,gBAAkB8G,GACjB9G,CACX,IClOO,SAASmN,GAAQtF,EAAYuF,EAAQC,EAASC,EAAQC,EAASzH,EAAM,CACxE,IAAI0H,EAAc,CAAA,EACdC,EAAU5F,EAAW,OACzB,SAAS6F,EAAWX,EAAOC,EAAQ,CAC/BK,EAAQ,QAAQ,SAAU/N,EAAO,CAC7BA,EAAM,QAAQyN,EAAOC,EAAQ,EAAI,EAAE,QAAQ,SAAUzQ,EAAM,CACvDiR,EAAY,OAAOjR,CAAI,CAAC,EAAI,EAC5C,CAAa,CACb,CAAS,CACJ,CACDgR,EAAQ,QAAQ,SAAUhR,EAAM,CAC5B,IAAIoR,EAAY,IAAI/G,GAAarK,EAAMuJ,CAAI,EAAE,cAC7C0H,EAAY,OAAOG,CAAS,CAAC,EAAI,EACzC,CAAK,EACD9F,EAAW,OAAS,SAAUtL,EAAM,CAChC,IAAI2Q,EAAK,OAAO3Q,CAAI,EACpB,OAAI,MAAM2Q,CAAE,EACDO,EAAQ,KAAK,KAAMlR,CAAI,EAC9B,CAACiR,EAAYN,CAAE,IACfQ,EAAW,IAAI,KAAKR,EAAK,CAAC,EAAG,IAAI,KAAKA,EAAK,CAAC,CAAC,EACzC,CAACM,EAAYN,CAAE,IACfM,EAAYN,CAAE,EAAI,GACXO,EAAQ,KAAK,KAAMlR,CAAI,GAG/B,EACf,EACQsL,EAAW,SAAW,YACtB6F,EAAW7F,EAAW,KAAK,MAAOA,EAAW,KAAK,MAAM,EACxDA,EAAW,OAAS,SAAUtL,EAAM,CAChC,IAAI2Q,EAAK,OAAO3Q,CAAI,EACpB,OAAKiR,EAAYN,CAAE,EAIZ,IAHHM,EAAYN,CAAE,EAAI,GACXO,EAAQ,KAAK,KAAMlR,CAAI,EAG9C,GAEI,QAASzC,EAAI,EAAGA,EAAIwT,EAAO,OAAQxT,IAAK,CACpC,IAAI6T,EAAY,IAAI/G,GAAa0G,EAAOxT,CAAC,EAAGgM,CAAI,EAAE,cAClD,GAAI,CAAC+B,EAAW,OAAO,IAAI,KAAK8F,EAAU,QAAO,CAAE,CAAC,EAChD,KACP,CACDP,EAAO,QAAQ,SAAU9N,EAAO,CAC5BwM,GAAKjE,EAAYvI,EAAM,OAAO,CACtC,CAAK,EACD,IAAIb,EAAMoJ,EAAW,QAErB,OADAxK,GAAKoB,CAAG,EACAoJ,EAAW,OAAM,CACrB,IAAK,MACL,IAAK,UACD,OAAOpJ,EACX,IAAK,SACD,OAASA,EAAI,QAAUA,EAAIA,EAAI,OAAS,CAAC,GAAM,KACnD,IAAK,QACL,QACI,OAASA,EAAI,QAAUA,EAAI,CAAC,GAAM,IACzC,CACL,CCnDA,IAAIyG,GAAkB,CAClB,QAAS,KACT,MAAO,GACP,OAAQ,GACR,SAAU,GACV,WAAY,GACZ,KAAM,IACV,EACO,SAAS0I,GAAWvU,EAAGoI,EAAS,CACnC,IAAIoM,EAAY,CAAA,EACZC,EAAY,CAAA,EACZC,EAAa,CAAA,EACbC,EAAa,CAAA,EACbC,EAAgBtI,GAAatM,CAAC,EAC9B0M,EAAUkI,EAAc,QACxBnI,EAAOmI,EAAc,KACrBC,EAAQC,GAAe9U,EAAGoI,EAAQ,MAAM,EAC5C,OAAAyM,EAAM,QAAQ,SAAUtI,EAAM,CAC1B,IAAIhC,EACJ,GAAKgC,EAEL,KAAIwI,EAAKC,GAAczI,CAAI,EAAGtE,EAAO8M,EAAG,KAAME,EAAQF,EAAG,MAAOxX,EAAQwX,EAAG,MAC3E,OAAQ9M,EAAK,YAAa,EAAA,CACtB,IAAK,QACD,GAAIgN,EAAM,OACN,MAAM,IAAI,MAAM,2BAA2B,OAAOA,EAAM,KAAK,GAAG,CAAC,CAAC,EAEtET,EAAU,KAAKtI,GAAYK,CAAI,CAAC,EAChC,MACJ,IAAK,QACD,IAAI2I,GAAM3K,EAAK,4BAA4B,KAAKgC,CAAI,KAAO,MAAQhC,IAAO,OAASA,EAAK,CAAA,EAAI4K,EAAYD,EAAG,CAAC,EACxGC,GAAa,CAAC1I,IACdA,EAAO0I,GAEXV,EAAYA,EAAU,OAAOW,GAAW7X,EAAO0X,CAAK,CAAC,EACrD,MACJ,IAAK,SACD,GAAIA,EAAM,OACN,MAAM,IAAI,MAAM,4BAA4B,OAAOA,EAAM,KAAK,GAAG,CAAC,CAAC,EAEvEP,EAAW,KAAKxI,GAAY3O,CAAK,CAAC,EAClC,MACJ,IAAK,SACDoX,EAAaA,EAAW,OAAOS,GAAW7X,EAAO0X,CAAK,CAAC,EACvD,MACJ,IAAK,UACD,MACJ,QACI,MAAM,IAAI,MAAM,yBAA2BhN,CAAI,CACtD,EACT,CAAK,EACM,CACH,QAASyE,EACT,KAAMD,EACN,UAAW+H,EACX,UAAWC,EACX,WAAYC,EACZ,WAAYC,CACpB,CACA,CACA,SAASU,GAAUrV,EAAGoI,EAAS,CAC3B,IAAImC,EAAKgK,GAAWvU,EAAGoI,CAAO,EAAGoM,EAAYjK,EAAG,UAAWkK,EAAYlK,EAAG,UAAWmK,EAAanK,EAAG,WAAYoK,EAAapK,EAAG,WAAYmC,EAAUnC,EAAG,QAASkC,EAAOlC,EAAG,KACzKiJ,EAAUpL,EAAQ,QAAU,GAKhC,GAJIA,EAAQ,aACRA,EAAQ,SAAW,GACnBA,EAAQ,OAAS,IAEjBA,EAAQ,UACRoM,EAAU,OAAS,GACnBC,EAAU,QACVC,EAAW,QACXC,EAAW,OAAQ,CACnB,IAAIW,EAAS,IAAIC,GAAS/B,CAAO,EACjC,OAAA8B,EAAO,QAAQ5I,CAAO,EACtB4I,EAAO,KAAK7I,GAAQ,MAAS,EAC7B+H,EAAU,QAAQ,SAAU1Z,EAAK,CAC7Bwa,EAAO,MAAM,IAAI3O,EAAM6O,GAAkB1a,EAAK4R,EAASD,CAAI,EAAG+G,CAAO,CAAC,CAClF,CAAS,EACDiB,EAAU,QAAQ,SAAUvR,EAAM,CAC9BoS,EAAO,MAAMpS,CAAI,CAC7B,CAAS,EACDwR,EAAW,QAAQ,SAAU5Z,EAAK,CAC9Bwa,EAAO,OAAO,IAAI3O,EAAM6O,GAAkB1a,EAAK4R,EAASD,CAAI,EAAG+G,CAAO,CAAC,CACnF,CAAS,EACDmB,EAAW,QAAQ,SAAUzR,EAAM,CAC/BoS,EAAO,OAAOpS,CAAI,CAC9B,CAAS,EACGkF,EAAQ,YAAcA,EAAQ,SAC9BkN,EAAO,MAAM5I,CAAO,EACjB4I,CACV,CACD,IAAIxa,EAAM0Z,EAAU,CAAC,GAAK,CAAA,EAC1B,OAAO,IAAI7N,EAAM6O,GAAkB1a,EAAKA,EAAI,SAAWsN,EAAQ,SAAWsE,EAAS5R,EAAI,MAAQsN,EAAQ,MAAQqE,CAAI,EAAG+G,CAAO,CACjI,CACO,SAASiC,GAASzV,EAAGoI,EAAS,CACjC,OAAIA,IAAY,SAAUA,EAAU,CAAE,GAC/BiN,GAAUrV,EAAGoL,GAAkBhD,CAAO,CAAC,CAClD,CACA,SAASoN,GAAkB1a,EAAK4R,EAASD,EAAM,CAC3C,OAAOf,GAASA,GAAS,CAAE,EAAE5Q,CAAG,EAAG,CAAE,QAAS4R,EAAS,KAAMD,CAAI,CAAE,CACvE,CACA,SAASrB,GAAkBhD,EAAS,CAChC,IAAIiD,EAAU,CAAA,EACVC,EAAO,OAAO,KAAKlD,CAAO,EAC1BqD,EAAc,OAAO,KAAKI,EAAe,EAK7C,GAJAP,EAAK,QAAQ,SAAU/O,EAAK,CACnBoF,EAAS8J,EAAalP,CAAG,GAC1B8O,EAAQ,KAAK9O,CAAG,CAC5B,CAAK,EACG8O,EAAQ,OACR,MAAM,IAAI,MAAM,oBAAsBA,EAAQ,KAAK,IAAI,CAAC,EAE5D,OAAOK,GAASA,GAAS,CAAA,EAAIG,EAAe,EAAGzD,CAAO,CAC1D,CACA,SAASsN,GAAYnJ,EAAM,CACvB,GAAIA,EAAK,QAAQ,GAAG,IAAM,GACtB,MAAO,CACH,KAAM,QACN,MAAOA,CACnB,EAEI,IAAIhC,EAAKtJ,GAAMsL,EAAM,IAAK,CAAC,EAAGtE,EAAOsC,EAAG,CAAC,EAAGhN,EAAQgN,EAAG,CAAC,EACxD,MAAO,CACH,KAAMtC,EACN,MAAO1K,CACf,CACA,CACA,SAASyX,GAAczI,EAAM,CACzB,IAAIhC,EAAKmL,GAAYnJ,CAAI,EAAGtE,EAAOsC,EAAG,KAAMhN,EAAQgN,EAAG,MACnD0K,EAAQhN,EAAK,MAAM,GAAG,EAC1B,GAAI,CAACgN,EACD,MAAM,IAAI,MAAM,qBAAqB,EACzC,MAAO,CACH,KAAMA,EAAM,CAAC,EAAE,YAAa,EAC5B,MAAOA,EAAM,MAAM,CAAC,EACpB,MAAO1X,CACf,CACA,CACA,SAASuX,GAAe9U,EAAG2V,EAAQ,CAG/B,GAFIA,IAAW,SAAUA,EAAS,IAClC3V,EAAIA,GAAKA,EAAE,OACP,CAACA,EACD,MAAM,IAAI,MAAM,sBAAsB,EAG1C,GAAI,CAAC2V,EACD,OAAO3V,EAAE,MAAM,IAAI,EAIvB,QAFI6U,EAAQ7U,EAAE,MAAM;AAAA,CAAI,EACpBS,EAAI,EACDA,EAAIoU,EAAM,QAAQ,CAErB,IAAItI,EAAQsI,EAAMpU,CAAC,EAAIoU,EAAMpU,CAAC,EAAE,QAAQ,QAAS,EAAE,EAC9C8L,EAGI9L,EAAI,GAAK8L,EAAK,CAAC,IAAM,KAC1BsI,EAAMpU,EAAI,CAAC,GAAK8L,EAAK,MAAM,CAAC,EAC5BsI,EAAM,OAAOpU,EAAG,CAAC,GAGjBA,GAAK,EAPLoU,EAAM,OAAOpU,EAAG,CAAC,CASxB,CACD,OAAOoU,CACX,CACA,SAASe,GAAiBX,EAAO,CAC7BA,EAAM,QAAQ,SAAUY,EAAM,CAC1B,GAAI,CAAC,+BAA+B,KAAKA,CAAI,EACzC,MAAM,IAAI,MAAM,kCAAoCA,CAAI,CAEpE,CAAK,CACL,CACA,SAAST,GAAWU,EAAUb,EAAO,CACjC,OAAAW,GAAiBX,CAAK,EACfa,EAAS,MAAM,GAAG,EAAE,IAAI,SAAUtI,EAAS,CAAE,OAAOrJ,GAAkBqJ,CAAO,CAAI,CAAA,CAC5F,CCnLA,SAASuI,GAAmBC,EAAW,CACnC,IAAIvQ,EAAQ,KACZ,OAAO,SAAUwQ,EAAO,CAIpB,GAHIA,IAAU,SACVxQ,EAAM,IAAI,OAAOuQ,CAAS,CAAC,EAAIC,GAE/BxQ,EAAM,IAAI,OAAOuQ,CAAS,CAAC,IAAM,OACjC,OAAOvQ,EAAM,IAAI,OAAOuQ,CAAS,CAAC,EAEtC,QAASvV,EAAI,EAAGA,EAAIgF,EAAM,OAAO,OAAQhF,IAAK,CAC1C,IAAIyV,EAAUzQ,EAAM,OAAOhF,CAAC,EAAE,YAAYuV,CAAS,EACnD,GAAIE,EACA,OAAOA,CAEd,CACT,CACA,CACA,IAAIX,GAA0B,SAAUjQ,EAAQ,CAC5CC,GAAUgQ,EAAUjQ,CAAM,EAO1B,SAASiQ,EAAS/B,EAAS,CACnBA,IAAY,SAAUA,EAAU,IACpC,IAAI/N,EAAQH,EAAO,KAAK,KAAM,GAAIkO,CAAO,GAAK,KAC9C,OAAA/N,EAAM,QAAUsQ,GAAmB,MAAMtQ,EAAO,CAAC,SAAS,CAAC,EAC3DA,EAAM,KAAOsQ,GAAmB,MAAMtQ,EAAO,CAAC,MAAM,CAAC,EACrDA,EAAM,OAAS,GACfA,EAAM,OAAS,GACfA,EAAM,QAAU,GAChBA,EAAM,QAAU,GACTA,CACV,CACD,OAAA8P,EAAS,UAAU,MAAQ,SAAU/G,EAAY,CAC7C,OAAOsF,GAAQtF,EAAY,KAAK,OAAQ,KAAK,QAAS,KAAK,OAAQ,KAAK,QAAS,KAAK,KAAM,CAAA,CACpG,EAMI+G,EAAS,UAAU,MAAQ,SAAUtP,EAAO,CACxCkQ,GAASlQ,EAAO,KAAK,MAAM,CACnC,EAMIsP,EAAS,UAAU,OAAS,SAAUtP,EAAO,CACzCkQ,GAASlQ,EAAO,KAAK,OAAO,CACpC,EAMIsP,EAAS,UAAU,MAAQ,SAAUrS,EAAM,CACvCkT,GAASlT,EAAM,KAAK,MAAM,CAClC,EAMIqS,EAAS,UAAU,OAAS,SAAUrS,EAAM,CACxCkT,GAASlT,EAAM,KAAK,OAAO,CACnC,EAMIqS,EAAS,UAAU,OAAS,UAAY,CACpC,OAAO,KAAK,OAAO,IAAI,SAAU/D,EAAG,CAAE,OAAOiE,GAASjE,EAAE,UAAU,CAAI,CAAA,CAC9E,EAMI+D,EAAS,UAAU,QAAU,UAAY,CACrC,OAAO,KAAK,QAAQ,IAAI,SAAU/D,EAAG,CAAE,OAAOiE,GAASjE,EAAE,UAAU,CAAI,CAAA,CAC/E,EAMI+D,EAAS,UAAU,OAAS,UAAY,CACpC,OAAO,KAAK,OAAO,IAAI,SAAU/D,EAAG,CAAE,OAAO,IAAI,KAAKA,EAAE,SAAS,CAAI,CAAA,CAC7E,EAMI+D,EAAS,UAAU,QAAU,UAAY,CACrC,OAAO,KAAK,QAAQ,IAAI,SAAU/D,EAAG,CAAE,OAAO,IAAI,KAAKA,EAAE,SAAS,CAAI,CAAA,CAC9E,EACI+D,EAAS,UAAU,QAAU,UAAY,CACrC,IAAIrF,EAAS,CAAA,EACb,MAAI,CAAC,KAAK,OAAO,QAAU,KAAK,WAC5BA,EAASA,EAAO,OAAOzC,GAAgB,CAAE,QAAS,KAAK,QAAU,CAAA,CAAC,GAEtE,KAAK,OAAO,QAAQ,SAAUxH,EAAO,CACjCiK,EAASA,EAAO,OAAOjK,EAAM,SAAQ,EAAG,MAAM;AAAA,CAAI,CAAC,CAC/D,CAAS,EACD,KAAK,QAAQ,QAAQ,SAAUoQ,EAAQ,CACnCnG,EAASA,EAAO,OAAOmG,EAClB,SAAU,EACV,MAAM;AAAA,CAAI,EACV,IAAI,SAAU9J,EAAM,CAAE,OAAOA,EAAK,QAAQ,UAAW,SAAS,EAAI,EAClE,OAAO,SAAUA,EAAM,CAAE,MAAO,CAAC,WAAW,KAAKA,CAAI,CAAI,CAAA,CAAC,CAC3E,CAAS,EACG,KAAK,OAAO,QACZ2D,EAAO,KAAKoG,GAAe,QAAS,KAAK,OAAQ,KAAK,KAAM,CAAA,CAAC,EAE7D,KAAK,QAAQ,QACbpG,EAAO,KAAKoG,GAAe,SAAU,KAAK,QAAS,KAAK,KAAM,CAAA,CAAC,EAE5DpG,CACf,EAOIqF,EAAS,UAAU,SAAW,UAAY,CACtC,OAAO,KAAK,QAAO,EAAG,KAAK;AAAA,CAAI,CACvC,EAIIA,EAAS,UAAU,MAAQ,UAAY,CACnC,IAAIgB,EAAM,IAAIhB,EAAS,CAAC,CAAC,KAAK,MAAM,EACpC,YAAK,OAAO,QAAQ,SAAUzN,EAAM,CAAE,OAAOyO,EAAI,MAAMzO,EAAK,OAAO,CAAI,CAAA,EACvE,KAAK,QAAQ,QAAQ,SAAUA,EAAM,CAAE,OAAOyO,EAAI,OAAOzO,EAAK,OAAO,CAAI,CAAA,EACzE,KAAK,OAAO,QAAQ,SAAU5E,EAAM,CAAE,OAAOqT,EAAI,MAAM,IAAI,KAAKrT,EAAK,QAAS,CAAA,CAAC,CAAI,CAAA,EACnF,KAAK,QAAQ,QAAQ,SAAUA,EAAM,CAAE,OAAOqT,EAAI,OAAO,IAAI,KAAKrT,EAAK,QAAS,CAAA,CAAC,CAAI,CAAA,EAC9EqT,CACf,EACWhB,CACX,EAAE5O,CAAK,EAEP,SAASwP,GAASlQ,EAAOuQ,EAAY,CACjC,GAAI,EAAEvQ,aAAiBU,GACnB,MAAM,IAAI,UAAU,OAAOV,CAAK,EAAI,wBAAwB,EAE3DtE,EAAS6U,EAAW,IAAI,MAAM,EAAG,OAAOvQ,CAAK,CAAC,GAC/CuQ,EAAW,KAAKvQ,CAAK,CAE7B,CACA,SAASmQ,GAASlT,EAAMsT,EAAY,CAChC,GAAI,EAAEtT,aAAgB,MAClB,MAAM,IAAI,UAAU,OAAOA,CAAI,EAAI,uBAAuB,EAEzDvB,EAAS6U,EAAW,IAAI,MAAM,EAAG,OAAOtT,CAAI,CAAC,IAC9CsT,EAAW,KAAKtT,CAAI,EACpBc,GAAKwS,CAAU,EAEvB,CACA,SAASF,GAAeG,EAAOC,EAAQjK,EAAM,CACzC,IAAIkK,EAAQ,CAAClK,GAAQA,EAAK,YAAW,IAAO,MACxCE,EAASgK,EAAQ,GAAG,OAAOF,EAAO,GAAG,EAAI,GAAG,OAAOA,EAAO,QAAQ,EAAE,OAAOhK,EAAM,GAAG,EACpFmK,EAAaF,EACZ,IAAI,SAAUG,EAAO,CAAE,OAAO5S,GAAkB4S,EAAM,QAAS,EAAEF,CAAK,EAAI,EAC1E,KAAK,GAAG,EACb,MAAO,GAAG,OAAOhK,CAAM,EAAE,OAAOiK,CAAU,CAC9C,CCpLO,MAAME,GAAkB,CAC9B,OAAQ,SACR,SAAU,UACX,EAEaC,EAAiB,CAC7B,KAAM,OACN,MAAO,QACP,OAAQ,SACR,OAAQ,QACT,EAiBaC,GAAmB,CAAE,IAAK,IAAK,IAAK,GAAK,ECzB/C,SAASC,GAAaC,EAAQC,EAAQ,GAAQ,CAEpD,IAAIC,EAAW,IAEVF,EAAO,SAAW,KAEtBE,GAAYF,EAAO,IAIpB,SAAY,CAAE,SAAAG,EAAU,UAAAC,CAAW,IAAIC,GAAiBL,CAAM,EAE7DE,GAAY,IAAMC,EAAS,MAAO,EAAG,EAAK,EAAG,IAAMC,EAAU,YAAaH,CAAK,EAIhF,OAAAC,GAAY,IAELA,CAER,CAEO,SAAUG,GAAiBC,EAAMC,EAAS,GAAQ,CAExD,UAAYJ,KAAYG,EAAO,CAG9B,GAAKH,EAAS,WAAY,GAAK,IAAK,GAAO,SAE3C,MAAMH,EAASM,EAAMH,GAErB,GAAK,MAAM,QAASH,CAAM,IAAO,GAEhC,QAAUzW,EAAI,EAAGA,EAAIyW,EAAO,OAAQzW,IAAO,CAE1C,MAAMiX,EAAQR,EAAQzW,GAEjBiX,IAAWA,EAAM,SAAW,IAAQD,GAAU,OAAOC,EAAM,QAAW,cAE1E,KAAM,CAAE,SAAAL,EAAU,MAAO5W,EAAG,UAAWiX,CAAK,EAI7C,SAEUR,GAAUA,EAAO,SAAW,GAEvC,KAAM,CAAE,SAAAG,EAAU,UAAWH,WAElB,OAAOA,GAAW,SAE7B,UAAYS,KAAeT,EAAS,CAEnC,MAAMQ,EAAQR,EAAQS,GAEjBD,IAAWA,EAAM,SAAW,IAAQD,GAAU,OAAOC,EAAM,QAAW,cAE1E,KAAM,CAAE,SAAAL,EAAU,MAAOM,EAAa,UAAWD,CAAK,EAIvD,CAIF,CAEF,CAEO,SAASE,GAAcra,EAAQ,CAErC,GAA4BA,GAAU,KAAO,OAAO,KAEpD,MAAMsa,EAAS,OAAOta,EAEtB,OAAKA,EAAM,SAAW,GAEd,OAEIsa,IAAW,SAEf,QAEIA,IAAW,UAEf,OAEIA,IAAW,SAEf,SAEIA,IAAW,WAEf,SAEIta,EAAM,YAAc,GAExB,OAEIA,EAAM,YAAc,GAExB,OAEIA,EAAM,YAAc,GAExB,OAEIA,EAAM,YAAc,GAExB,OAEIA,EAAM,YAAc,GAExB,OAEIA,EAAM,UAAY,GAEtB,QAEIA,aAAiB,YAErB,cAID,IAER,CAEO,SAASua,GAAkBC,KAASC,EAAS,CAEnD,MAAMC,EAAQF,EAAOA,EAAK,MAAO,EAAK,EAAG,OAUzC,OARKC,EAAO,SAAW,IAEjBC,IAAU,OAASD,EAAS,CAAEA,EAAQ,GAAKA,EAAQ,CAAC,GAC/CC,IAAU,OAASD,EAAS,CAAEA,EAAQ,GAAKA,EAAQ,CAAG,EAAEA,EAAQ,CAAG,CAAA,EACnEC,IAAU,SAASD,EAAS,CAAEA,EAAQ,CAAC,EAAIA,EAAQ,CAAG,EAAEA,EAAQ,CAAC,EAAIA,EAAQ,CAAG,CAAA,IAItFD,IAAS,QAEN,IAAIG,GAAO,GAAGF,GAEVC,IAAU,OAEd,IAAIE,GAAS,GAAGH,GAEZC,IAAU,OAEd,IAAIG,GAAS,GAAGJ,GAEZC,IAAU,OAEd,IAAII,GAAS,GAAGL,GAEZC,IAAU,OAEd,IAAIK,GAAS,GAAGN,GAEZC,IAAU,OAEd,IAAIM,GAAS,GAAGP,GAEZD,IAAS,OAEbC,EAAQ,CAAG,GAAI,GAETD,IAAS,SAAeA,IAAS,OAAaA,IAAS,OAE7DC,EAAQ,CAAG,GAAI,EAEXD,IAAS,SAEbC,EAAQ,CAAG,GAAI,GAEXD,IAAS,cAEbS,GAAqBR,EAAQ,CAAC,GAI/B,IAER,CAEO,SAASS,GAAqBC,EAAc,CAElD,IAAIC,EAAQ,GAEZ,MAAM/X,EAAQ,IAAI,WAAY8X,GAE9B,QAAUjY,EAAI,EAAGA,EAAIG,EAAM,OAAQH,IAElCkY,GAAS,OAAO,aAAc/X,EAAOH,CAAG,CAAA,EAIzC,OAAO,KAAMkY,EAEd,CAEO,SAASH,GAAqBI,EAAS,CAE7C,OAAO,WAAW,KAAM,KAAMA,CAAQ,EAAErH,GAAKA,EAAE,WAAY,CAAG,CAAA,EAAG,MAElE,CC5MA,MAAMsH,GAAc,IAAI,IAExB,IAAIC,GAAU,EAEd,MAAMC,UAAaC,EAAgB,CAElC,YAAaC,EAAW,KAAO,CAE9B,QAEA,KAAK,SAAWA,EAEhB,KAAK,WAAalC,EAAe,KACjC,KAAK,iBAAmBA,EAAe,KACvC,KAAK,gBAAkBA,EAAe,KAEtC,KAAK,KAAOmC,GAAU,eAEtB,KAAK,QAAU,EAEf,KAAK,UAAY,KACjB,KAAK,iBAAmB,EAExB,KAAK,OAAS,GAEd,KAAK,OAAS,GAEd,OAAO,eAAgB,KAAM,KAAM,CAAE,MAAOJ,IAAU,EAEtD,CAED,IAAI,YAAavb,EAAQ,CAEnBA,IAAU,IAEd,KAAK,SAIN,CAED,IAAI,MAAO,CAEV,OAAO,KAAK,YAAY,IAExB,CAED,SAAUwJ,EAAUoS,EAAa,CAEhC,YAAK,WAAaA,EAClB,KAAK,OAASpS,EAAS,KAAM,KAAK,QAAO,GAElC,IAEP,CAED,cAAeA,EAAW,CAEzB,OAAO,KAAK,SAAUA,EAAUgQ,EAAe,KAAK,CAEpD,CAED,eAAgBhQ,EAAW,CAE1B,OAAO,KAAK,SAAUA,EAAUgQ,EAAe,MAAM,CAErD,CAED,eAAgBhQ,EAAW,CAE1B,OAAO,KAAK,SAAUA,EAAUgQ,EAAe,MAAM,CAErD,CAED,YAAahQ,EAAW,CAEvB,YAAK,gBAAkBA,EAAS,KAAM,KAAK,QAAO,GAE3C,IAEP,CAED,SAAU,CAIT,OAAO,KAAK,MAAQ,IAEpB,CAED,iBAA6B,CAE5B,OAAO,IAEP,CAED,UAAwB,CAEvB,OAAO,KAAK,MAEZ,CAED,CAAE,aAAc,CAEf,SAAY,CAAE,UAAAuQ,CAAS,IAAMC,GAAiB,IAAI,EAEjD,MAAMD,CAIP,CAED,SAAU,CAET,KAAK,cAAe,CAAE,KAAM,SAAW,CAAA,CAEvC,CAED,SAAUvQ,EAAW,CAEpBA,EAAU,IAAI,EAEd,UAAYuQ,KAAa,KAAK,cAE7BA,EAAU,SAAUvQ,EAIrB,CAED,YAAaoQ,EAAQ,GAAQ,CAE5B,OAAAA,EAAQA,GAAS,KAAK,UAAY,KAAK,kBAElCA,IAAU,IAAQ,KAAK,YAAc,QAEzC,KAAK,UAAYF,GAAa,KAAME,CAAK,EACzC,KAAK,iBAAmB,KAAK,SAIvB,KAAK,SAEZ,CAED,SAAuB,CAEtB,OAAO,KAAK,IAEZ,CAED,eAAgB,CAEf,OAAO,KAAK,UAEZ,CAED,qBAAsB,CAErB,OAAO,KAAK,gBAEZ,CAED,oBAAqB,CAEpB,OAAO,KAAK,eAEZ,CAED,eAAgBiC,EAAU,CAEzB,MAAMrB,EAAO,KAAK,YAAaqB,CAAO,EAGtC,OAFoBA,EAAQ,eAAgBrB,CAAI,CAIhD,CAED,YAAaqB,EAAU,CAEtB,MAAMC,EAAiBD,EAAQ,kBAAmB,IAAI,EAEtD,OAAKC,EAAe,WAEZA,EAAe,WAAW,YAAaD,CAAO,EAI/C,KAAK,QAEZ,CAED,UAAWA,EAAU,CAEpB,MAAME,EAAO,KAAK,QAASF,CAAO,EAGlC,OAFqBA,EAAQ,gBAAiBE,CAAI,GAE3B,IAEvB,CAED,MAAOF,EAAU,CAEhB,MAAMC,EAAiBD,EAAQ,kBAAmB,IAAI,EAEtD,IAAIG,EAAQ,EAEZ,UAAYjC,KAAa,KAAK,cAE7B+B,EAAgB,OAASE,GAAQ,EAAKjC,EAKvC,OAAO,IAEP,CAED,UAAW8B,EAAU,CAEpB,eAAQ,KAAM,+DAEP,KAAK,MAAOA,EAEnB,CAED,cAAeA,EAAU,CAExB,MAAMI,EAAWJ,EAAQ,gBAAiB,IAAI,EAC9C,OAAAI,EAAS,WAAaA,EAAS,aAAe,OAAY,EAAIA,EAAS,WAAa,EAE7EA,EAAS,UAEhB,CAED,QAASJ,EAAU,CAIlB,GAFmB,KAAK,cAAeA,CAAO,IAE1B,EAAI,CAIvB,MAAMC,EAAiBD,EAAQ,kBAAmB,IAAI,EAEtD,UAAY9B,KAAa,OAAO,OAAQ+B,CAAc,EAEhD/B,GAAaA,EAAU,SAAW,IAEtCA,EAAU,MAAO8B,EAMnB,CAED,CAED,SAAUA,EAASld,EAAS,CAE3B,KAAM,CAAE,WAAAud,CAAY,EAAGL,EAAQ,kBAAmB,IAAI,EAEtD,GAAKK,GAAcA,EAAW,SAAW,GAExC,OAAOA,EAAW,MAAOL,EAASld,CAAM,CAIzC,CAED,cAA0B,CAEzB,QAAQ,KAAM,qBAEd,CAED,aAAyB,CAExB,QAAQ,KAAM,qBAEd,CAED,QAAoB,CAEnB,QAAQ,KAAM,qBAEd,CAED,MAAOkd,EAASld,EAAS,KAAO,CAE/B,MAAMwd,EAAU,KAAK,UAAWN,CAAO,EAEvC,GAAK,OAASM,EAEb,OAAOA,EAAQ,MAAON,EAASld,CAAM,EAItCkd,EAAQ,QAAS,MACjBA,EAAQ,SAAU,MAOlB,IAAIlJ,EAAS,KAEb,MAAMyJ,EAAaP,EAAQ,gBAE3B,GAAKO,IAAe,QAAU,CAE7B,KAAK,gBAAiBP,GAEtB,MAAMQ,EAAaR,EAAQ,kBAAmB,IAAI,EAElD,GAAKQ,EAAW,cAAgB,GAAO,CAEtC,MAAMC,EAAwBT,EAAQ,MAAM,MAAM,OAElDQ,EAAW,YAAc,GACzBA,EAAW,WAAa,KAAK,MAAOR,CAAO,EAEtCQ,EAAW,aAAe,MAAQR,EAAQ,MAAM,MAAM,SAAWS,IAErED,EAAW,WAAaR,EAAQ,OAIjC,UAAY9B,KAAa,OAAO,OAAQsC,CAAU,EAE5CtC,GAAaA,EAAU,SAAW,IAEtCA,EAAU,MAAO8B,EAMnB,CAEJ,SAAcO,IAAe,UAE1B,KAAK,QAASP,WAEHO,IAAe,WAI1B,GAFuB,KAAK,SAAS,SAAW,EAE1B,CAErB,MAAM5B,EAAO,KAAK,YAAaqB,CAAO,EAChCI,EAAWJ,EAAQ,gBAAiB,IAAI,EAE9ClJ,EAASsJ,EAAS,QAEbtJ,IAAW,SAEfA,EAAS,KAAK,SAAUkJ,CAAO,GAAM,GAErCI,EAAS,QAAUtJ,GAIpBA,EAASkJ,EAAQ,OAAQlJ,EAAQ6H,EAAM7b,CAAM,CAEjD,MAEIgU,EAAS,KAAK,SAAUkJ,EAASld,CAAM,GAAM,GAM/C,OAAAkd,EAAQ,YAAa,MAEdlJ,CAEP,CAED,sBAAuB,CAEtB,OAAOqH,GAAiB,KAExB,CAED,UAAWuC,EAAO,CAEjB,MAAMC,EAAe,KAAK,uBAEpBC,EAAa,CAAA,EAEnB,SAAY,CAAE,SAAA3C,EAAU,MAAAkC,EAAO,UAAAjC,CAAS,IAAMyC,EAExCR,IAAU,QAETS,EAAY3C,CAAU,IAAK,SAE/B2C,EAAY3C,CAAQ,EAAK,OAAO,UAAWkC,CAAO,EAAG,CAAE,EAAG,IAI3DS,EAAY3C,GAAYkC,GAAUjC,EAAU,OAAQwC,EAAK,IAAM,EAAC,MAIhEE,EAAY3C,CAAQ,EAAKC,EAAU,OAAQwC,EAAK,IAAM,EAAC,KAMpD,OAAO,KAAME,CAAU,EAAG,OAAS,IAEvCF,EAAK,WAAaE,EAInB,CAED,YAAaF,EAAO,CAEnB,GAAKA,EAAK,aAAe,OAAY,CAEpC,MAAMG,EAAQH,EAAK,KAAK,MAExB,UAAYzC,KAAYyC,EAAK,WAE5B,GAAK,MAAM,QAASA,EAAK,WAAYzC,CAAU,CAAA,EAAK,CAEnD,MAAM6C,EAAa,CAAA,EAEnB,UAAYC,KAAQL,EAAK,WAAYzC,CAAQ,EAE5C6C,EAAW,KAAMD,EAAOE,CAAM,CAAA,EAI/B,KAAM9C,CAAU,EAAG6C,CAEnB,SAAW,OAAOJ,EAAK,WAAYzC,CAAQ,GAAO,SAAW,CAE7D,MAAM+C,EAAc,CAAA,EAEpB,UAAYzC,KAAemC,EAAK,WAAYzC,CAAQ,EAAK,CAExD,MAAM8C,EAAOL,EAAK,WAAYzC,CAAU,EAAEM,CAAW,EAErDyC,EAAazC,CAAW,EAAKsC,EAAOE,CAAI,CAExC,CAED,KAAM9C,CAAU,EAAG+C,CAExB,KAAW,CAEN,MAAMD,EAAOL,EAAK,WAAYzC,CAAQ,EAEtC,KAAMA,CAAQ,EAAK4C,EAAOE,CAAI,CAE9B,CAIF,CAED,CAED,OAAQE,EAAO,CAEd,KAAM,CAAE,KAAAF,EAAM,KAAApC,CAAM,EAAG,KACjBuC,EAAWD,IAAS,QAAa,OAAOA,GAAS,SAElDC,IAEJD,EAAO,CACN,SAAU,CAAE,EACZ,OAAQ,CAAE,EACV,MAAO,CAAE,CACb,GAME,IAAIE,EAAOF,EAAK,MAAOF,CAAI,EAEtBI,IAAS,SAEbA,EAAO,CACN,KAAAJ,EACA,KAAApC,EACA,KAAAsC,EACA,SAAU,CACT,QAAS,IACT,KAAM,OACN,UAAW,aACX,CACL,EAEQC,IAAW,KAAOD,EAAK,MAAOE,EAAK,IAAM,EAAGA,GAEjD,KAAK,UAAWA,GAEhB,OAAOA,EAAK,MAMb,SAASC,EAAkBC,EAAQ,CAElC,MAAMpe,EAAS,CAAA,EAEf,UAAYE,KAAOke,EAAQ,CAE1B,MAAMF,EAAOE,EAAOle,GACpB,OAAOge,EAAK,SACZle,EAAO,KAAMke,EAEb,CAED,OAAOle,CAEP,CAED,GAAKie,EAAS,CAEb,MAAMI,EAAWF,EAAkBH,EAAK,QAAQ,EAC1CM,EAASH,EAAkBH,EAAK,MAAM,EACtCJ,EAAQO,EAAkBH,EAAK,KAAK,EAErCK,EAAS,OAAS,IAAIH,EAAK,SAAWG,GACtCC,EAAO,OAAS,IAAIJ,EAAK,OAASI,GAClCV,EAAM,OAAS,IAAIM,EAAK,MAAQN,EAErC,CAED,OAAOM,CAEP,CAEF,CAIO,SAASK,EAAc7C,EAAM8C,EAAY,CAE/C,GAAK,OAAOA,GAAc,YAAc,CAAE9C,EAAO,MAAM,IAAI,MAAO,cAAeA,CAAM,iBAAgB,EACvG,GAAKc,GAAY,IAAKd,GAAS,CAE9B,QAAQ,KAAM,8BAA+BA,CAAI,EAAG,EACpD,MAEA,CAEDc,GAAY,IAAKd,EAAM8C,GACvBA,EAAU,KAAO9C,CAElB,CCnjBA,MAAM+C,UAAiB/B,CAAK,CAE3B,YAAahB,EAAO,CAEnB,MAAOA,CAAI,EAEX,KAAK,WAAa,EAElB,CAED,gBAAiBqB,EAAU,CAE1B,OAAOA,EAAQ,gBAAiB,IAAI,EAAG,WAAa,CAEpD,CAED,MAAOA,EAASld,EAAS,CAIxB,GAFmBkd,EAAQ,kBAEP,WAAa,CAEhC,MAAMrB,EAAOqB,EAAQ,cAAe,KAAK,YAAaA,EAASld,CAAM,GAC/Dsd,EAAWJ,EAAQ,gBAAiB,IAAI,EAE9C,GAAKI,EAAS,eAAiB,OAE9B,OAAOJ,EAAQ,OAAQI,EAAS,aAAczB,EAAM7b,GAE9C,GAAK6b,IAAS,QAAU7b,IAAW,QAAU,KAAK,gBAAiBkd,GAAY,CAErF,MAAM2B,EAAU,MAAM,MAAO3B,EAASrB,CAAI,EAEpCiD,EAAU5B,EAAQ,eAAgB,KAAM,KAAMrB,GAC9CkD,EAAe7B,EAAQ,gBAAiB4B,CAAO,EAErD,OAAA5B,EAAQ,gBAAiB,GAAG6B,CAAY,MAAMF,CAAO,IAErDvB,EAAS,QAAUuB,EACnBvB,EAAS,aAAeyB,EAEjB7B,EAAQ,OAAQI,EAAS,aAAczB,EAAM7b,EAEpD,CAED,CAED,OAAO,MAAM,MAAOkd,EAASld,CAAM,CAEnC,CAEF,CAIA0e,EAAc,WAAYE,CAAU,ECvDpC,MAAMI,WAAyBnC,CAAK,CAEnC,YAAavB,EAAM2D,EAAY,CAE9B,QAEA,KAAK,KAAO3D,EACZ,KAAK,UAAY2D,EAEjB,KAAK,mBAAqB,EAE1B,CAED,YAAa/B,EAAU,CAEtB,OAAO,KAAK,KAAK,eAAgBA,CAAO,CAExC,CAED,SAAUA,EAAU,CAEnB,MAAMgC,EAAc,KAAK,KAAK,MAAOhC,CAAO,EACtCiC,EAAe,KAAK,UAAU,MAAOjC,EAAS,QAEpD,MAAO,GAAGgC,CAAW,KAAKC,CAAY,IAEtC,CAEF,CAIAT,EAAc,mBAAoBM,EAAkB,EChCpD,MAAMI,WAAoBvC,CAAK,CAE9B,YAAavB,EAAM+D,EAAY,CAE9B,QAEA,KAAK,KAAO/D,EACZ,KAAK,UAAY+D,CAEjB,CAED,YAAanC,EAAU,CAEtB,MAAMoC,EAAc,KAAK,KAAK,YAAapC,CAAO,EAElD,IAAImC,EAAY,KAEhB,UAAYE,KAAmB,KAAK,UAAU,MAAO,GAAG,GAElDF,IAAc,MAAQnC,EAAQ,cAAeoC,CAAW,IAAOpC,EAAQ,cAAeqC,MAE1FF,EAAYE,GAMd,OAAOF,CAEP,CAED,UAAWhB,EAAO,CAEjB,MAAM,UAAWA,GAEjBA,EAAK,UAAY,KAAK,SAEtB,CAED,YAAaA,EAAO,CAEnB,MAAM,YAAaA,GAEnB,KAAK,UAAYA,EAAK,SAEtB,CAED,SAAUnB,EAASld,EAAS,CAE3B,MAAMsb,EAAO,KAAK,KACZO,EAAO,KAAK,YAAaqB,CAAO,EAEhC2B,EAAUvD,EAAK,MAAO4B,EAASrB,CAAI,EAEzC,OAAOqB,EAAQ,OAAQ2B,EAAShD,EAAM7b,CAAM,CAE5C,CAEF,CAIA0e,EAAc,cAAeU,EAAa,EC7D1C,MAAMI,WAAiBZ,CAAS,CAE/B,YAAab,EAAQ,GAAIhB,EAAW,KAAO,CAE1C,MAAOA,CAAQ,EAEf,KAAK,MAAQgB,CAEb,CAED,YAAab,EAAU,CAEtB,OAAK,KAAK,WAAa,KAEfA,EAAQ,cAAe,KAAK,QAAQ,EAIrCA,EAAQ,kBAAmB,KAAK,MAAM,OAAQ,CAAE1G,EAAOiJ,IAASjJ,EAAQ0G,EAAQ,cAAeuC,EAAI,YAAavC,EAAW,EAAE,CAAC,EAErI,CAED,SAAUA,EAASld,EAAS,CAE3B,MAAM6b,EAAO,KAAK,YAAaqB,CAAO,EAChCa,EAAQ,KAAK,MAEb2B,EAAgBxC,EAAQ,iBAAkBrB,CAAI,EAE9C8D,EAAgB,CAAA,EAEtB,UAAYC,KAAS7B,EAAQ,CAE5B,IAAI8B,EAAeD,EAAM,MAAO1C,CAAO,EAEvC,MAAM4C,EAAqB5C,EAAQ,iBAAkB0C,EAAM,YAAa1C,CAAO,GAE1E4C,IAAuBJ,IAE3BG,EAAe3C,EAAQ,OAAQ2C,EAAcC,EAAoBJ,CAAa,GAI/EC,EAAc,KAAME,EAEpB,CAED,MAAMhB,EAAU,GAAI3B,EAAQ,QAASrB,CAAI,MAAS8D,EAAc,KAAM,IAAM,CAAA,KAE5E,OAAOzC,EAAQ,OAAQ2B,EAAShD,EAAM7b,CAAM,CAE5C,CAEF,CAIA0e,EAAc,WAAYc,EAAU,ECzDpC,MAAMO,GAAyBjF,GAAiB,KAAM,IAEtD,MAAMkF,WAAkBnD,CAAK,CAE5B,YAAavB,EAAM2E,EAAa,IAAM,CAErC,QAEA,KAAK,KAAO3E,EACZ,KAAK,WAAa2E,EAElB,KAAK,YAAc,EAEnB,CAED,iBAAkB,CAEjB,IAAIC,EAAe,KAAK,WAAW,OAEnC,UAAY7K,KAAK,KAAK,WAErB6K,EAAe,KAAK,IAAKpF,GAAiB,QAASzF,CAAG,EAAG,EAAG6K,GAI7D,OAAOA,CAEP,CAED,iBAAkBhD,EAAU,CAE3B,OAAOA,EAAQ,iBAAkB,KAAK,KAAK,YAAaA,CAAO,EAE/D,CAED,YAAaA,EAAU,CAEtB,OAAOA,EAAQ,kBAAmB,KAAK,WAAW,OAAQ,KAAK,iBAAkBA,CAAO,EAExF,CAED,SAAUA,EAASld,EAAS,CAE3B,MAAMsb,EAAO,KAAK,KACZ6E,EAAiBjD,EAAQ,cAAe5B,EAAK,YAAa4B,CAAO,GAEvE,IAAI2B,EAAU,KAEd,GAAKsB,EAAiB,EAAI,CAEzB,IAAItE,EAAO,KAEc,KAAK,mBAELsE,IAIxBtE,EAAOqB,EAAQ,kBAAmB,KAAK,gBAAiB,EAAE,KAAK,iBAAkBA,CAAO,IAIzF,MAAMgC,EAAc5D,EAAK,MAAO4B,EAASrB,CAAI,EAExC,KAAK,WAAW,SAAWsE,GAAkB,KAAK,aAAeJ,GAAuB,MAAO,EAAG,KAAK,WAAW,MAAM,EAI5HlB,EAAU3B,EAAQ,OAAQgC,EAAarD,EAAM7b,CAAM,EAInD6e,EAAU3B,EAAQ,OAAQ,GAAGgC,CAAW,IAAI,KAAK,UAAU,GAAI,KAAK,YAAahC,CAAS,EAAEld,CAAM,CAItG,MAIG6e,EAAUvD,EAAK,MAAO4B,EAASld,CAAM,EAItC,OAAO6e,CAEP,CAED,UAAWR,EAAO,CAEjB,MAAM,UAAWA,GAEjBA,EAAK,WAAa,KAAK,UAEvB,CAED,YAAaA,EAAO,CAEnB,MAAM,YAAaA,GAEnB,KAAK,WAAaA,EAAK,UAEvB,CAEF,CAIAK,EAAc,YAAasB,EAAW,EC3GtC,MAAMI,WAAgBxB,CAAS,CAE9B,YAAayB,EAAYJ,EAAYK,EAAa,CAEjD,QAEA,KAAK,WAAaD,EAClB,KAAK,WAAaJ,EAClB,KAAK,WAAaK,CAElB,CAED,YAAapD,EAAU,CAEtB,OAAO,KAAK,WAAW,YAAaA,CAAO,CAE3C,CAED,SAAUA,EAAU,CAEnB,KAAM,CAAE,WAAAmD,EAAY,WAAAJ,EAAY,WAAAK,CAAU,EAAK,KAEzCC,EAAa,KAAK,YAAarD,CAAO,EACtCsD,EAAatD,EAAQ,kBAAmB+C,EAAW,MAAM,EAEzDQ,EAAgBH,EAAW,MAAOpD,EAASsD,CAAU,EACrDE,EAAgBL,EAAW,MAAOnD,EAASqD,CAAU,EAErDI,EAASzD,EAAQ,cAAeqD,CAAU,EAC1CZ,EAAgB,CAAA,EAEtB,QAAUpb,EAAI,EAAGA,EAAIoc,EAAQpc,IAAO,CAEnC,MAAMzB,EAAYgY,GAAkBvW,GAE/BzB,IAAcmd,EAAY,IAE9BN,EAAc,KAAMc,GAEpBlc,GAAK0b,EAAW,OAAS,GAIzBN,EAAc,KAAMe,EAAgB,IAAM5d,CAAS,CAIpD,CAED,MAAO,GAAIoa,EAAQ,QAASqD,CAAY,CAAA,KAAOZ,EAAc,KAAM,IAAM,CAAA,IAEzE,CAEF,CAIAjB,EAAc,UAAW0B,EAAS,EC1DlC,MAAMQ,WAAkB/D,CAAK,CAE5B,YAAaxb,EAAO0b,EAAW,KAAO,CAErC,MAAOA,CAAQ,EAEf,KAAK,YAAc,GAEnB,KAAK,MAAQ1b,EACb,KAAK,UAAY,IAEjB,CAED,aAA2B,CAE1B,OAAK,KAAK,WAAa,KAEfqa,GAAc,KAAK,OAIpB,KAAK,QAEZ,CAED,aAAcwB,EAAU,CAEvB,OAAO,KAAK,YAAaA,EAEzB,CAED,aAAc2D,EAAY,CAEzB,YAAK,UAAYA,EAEV,IAEP,CAED,UAAWxC,EAAO,CAEjB,MAAM,UAAWA,GAEjBA,EAAK,MAAQ,KAAK,MAEb,KAAK,OAAS,KAAK,MAAM,UAAUA,EAAK,MAAQ,KAAK,MAAM,QAAO,GAEvEA,EAAK,UAAY3C,GAAc,KAAK,KAAK,EACzC2C,EAAK,SAAW,KAAK,SAEhBA,EAAK,YAAc,gBAAgBA,EAAK,MAAQ9B,GAAqB8B,EAAK,QAE/EA,EAAK,UAAY,KAAK,SAEtB,CAED,YAAaA,EAAO,CAEnB,MAAM,YAAaA,GAEnB,KAAK,SAAWA,EAAK,SACrB,KAAK,MAAQ,MAAM,QAASA,EAAK,KAAK,EAAKzC,GAAkByC,EAAK,UAAW,GAAGA,EAAK,KAAK,EAAKA,EAAK,MAEpG,KAAK,UAAYA,EAAK,WAAa,KAE9B,KAAK,OAAS,KAAK,MAAM,YAAY,KAAK,MAAQ,KAAK,MAAM,UAAWA,EAAK,KAAK,EAEvF,CAED,UAAgC,CAE/B,QAAQ,KAAM,qBAEd,CAEF,CAIAK,EAAc,YAAakC,EAAW,EC/EtC,MAAME,WAAkBF,EAAU,CAEjC,YAAavf,EAAO0b,EAAW,KAAO,CAErC,MAAO1b,EAAO0b,GAEd,KAAK,YAAc,EAEnB,CAED,cAAeG,EAAU,CAExB,OAAOA,EAAQ,cAAe,KAAK,YAAaA,GAAW,KAAK,MAEhE,CAED,SAAUA,EAASld,EAAS,CAE3B,MAAM6b,EAAO,KAAK,YAAaqB,CAAO,EAEtC,OAAOA,EAAQ,OAAQ,KAAK,cAAeA,GAAWrB,EAAM7b,EAE5D,CAEF,CAIA0e,EAAc,YAAaoC,EAAW,ECpBtC,IAAIC,GAAe,KAEnB,MAAMC,GAAe,IAAI,IAElB,SAASC,EAAgBlV,EAAMmV,EAAc,CAEnD,GAAKF,GAAa,IAAKjV,GAAS,CAE/B,QAAQ,KAAM,gCAAiCA,CAAI,EAAG,EACtD,MAEA,CAED,GAAK,OAAOmV,GAAgB,WAAa,MAAM,IAAI,MAAO,gBAAiBnV,uBAE3EiV,GAAa,IAAKjV,EAAMmV,EAEzB,CAEA,MAAMC,GAAiB3f,GAAWA,EAAM,QAAS,OAAQ,GAAK,EAAC,QAAS,OAAQ,GAAK,EAAC,QAAS,OAAQ,GAAK,EAAC,QAAS,OAAQ,KAExH4f,GAAoB,CAEzB,MAAOC,EAAavF,EAAS,CAE5B,MAAMwF,EAASxF,EAAO,QAEtB,OAAOuF,EAAaE,GAAaD,CAAM,EAAI,GAAGxF,CAAM,CAEpD,EAED,IAAKR,EAAMkG,EAAMC,EAAU,CAE1B,GAAK,OAAOD,GAAS,UAAYlG,EAAMkG,CAAI,IAAO,OAAY,CAE7D,GAAKlG,EAAK,cAAgB,IAAQkG,IAAS,SAE1C,MAAO,IAAK1F,KAEXiF,GAAa,OAAQU,EAAS,GAAG3F,CAAM,EAEhC2F,GAIF,GAAKT,GAAa,IAAKQ,GAAS,CAEtC,MAAMN,EAAcF,GAAa,IAAKQ,CAAI,EAE1C,OAAOlG,EAAK,YAAc,IAAKQ,IAAY2F,EAAQ,IAAKP,EAAa,GAAGpF,CAAQ,CAAA,EAAK,IAAKA,IAAYoF,EAAaO,EAAS,GAAG3F,EAEnI,KAAU,IAAK0F,IAAS,OAEpB,OAAOlG,EAED,GAAKkG,EAAK,SAAU,QAAQ,GAAMR,GAAa,IAAKQ,EAAK,MAAO,EAAGA,EAAK,OAAS,CAAiB,CAAA,EAAK,CAE7G,MAAMN,EAAcF,GAAa,IAAKQ,EAAK,MAAO,EAAGA,EAAK,OAAS,CAAiB,CAAA,EAEpF,OAAOlG,EAAK,YAAc,IAAKQ,IAAY2F,EAAQ,OAAQ3F,EAAQ,CAAC,EAAIoF,EAAa,GAAGpF,EAAU,EAAG,IAAKA,IAAY2F,EAAQ,OAAQP,EAAaO,EAAS,GAAG3F,CAAM,EAErK,KAAM,IAAK,wBAAwB,KAAM0F,CAAI,IAAO,GAIpD,OAAAA,EAAOL,GAAcK,GAEdE,EAAY,IAAI1B,GAAWyB,EAASD,CAAM,CAAA,EAE3C,GAAK,2BAA2B,KAAMA,CAAI,IAAO,GAIvD,OAAAA,EAAOL,GAAcK,EAAK,MAAO,CAAG,EAAC,YAAW,GAIhDA,EAAOA,EAAK,MAAO,EAAE,EAAG,OAAO,KAAM,IAE5BngB,GAAWqgB,EAAY,IAAItB,GAAS9E,EAAMkG,EAAMngB,CAAK,GAExD,GAAKmgB,IAAS,SAAWA,IAAS,UAAYA,IAAS,QAI7D,OAAKA,IAAS,QAAUA,EAAO,IACrBA,IAAS,SAAWA,EAAO,IAC3BA,IAAS,UAAUA,EAAO,KAE7BE,EAAY,IAAI1B,GAAW1E,EAAMkG,CAAM,CAAA,EAExC,GAAK,QAAQ,KAAMA,CAAI,IAAO,GAIpC,OAAOE,EAAY,IAAI1C,GAAkByC,EAAS,IAAIX,GAAW,OAAQU,CAAM,EAAE,MAAQ,CAAA,IAI1F,CAED,OAAO,QAAQ,IAAKlG,EAAMkG,EAAMC,CAAO,CAEvC,EAED,IAAKnG,EAAMkG,EAAMngB,EAAOogB,EAAU,CAEjC,OAAK,OAAOD,GAAS,UAAYlG,EAAMkG,CAAI,IAAO,SAI5C,wBAAwB,KAAMA,CAAM,IAAK,IAAQA,IAAS,SAAWA,IAAS,UAAYA,IAAS,SAAW,QAAQ,KAAMA,CAAM,IAAK,KAE3IC,EAASD,CAAI,EAAG,OAAQngB,CAAK,EAEtB,IAMF,QAAQ,IAAKia,EAAMkG,EAAMngB,EAAOogB,EAEvC,CAEF,EAEME,GAAsB,IAAI,QAC1BC,GAA+B,IAAI,QAEnCC,GAAmB,SAAWtc,EAAKuc,EAAU,KAAO,CAEzD,MAAMjG,EAAOH,GAAcnW,GAE3B,GAAKsW,IAAS,OAAS,CAEtB,IAAI6F,EAAaC,GAAoB,IAAKpc,CAAG,EAE7C,OAAKmc,IAAe,SAEnBA,EAAa,IAAI,MAAOnc,EAAK6b,EAAiB,EAE9CO,GAAoB,IAAKpc,EAAKmc,GAC9BC,GAAoB,IAAKD,EAAYA,IAI/BA,CAEP,KAAM,IAAOI,IAAY,OAAUjG,IAAS,SAAWA,IAAS,YAAmBA,GAAQA,IAAS,UAAYA,IAAS,SAEzH,OAAO6F,EAAYK,GAAcxc,EAAKuc,CAAS,CAAA,EAEzC,GAAKjG,IAAS,SAEpB,OAAOmG,EAAOzc,GAIf,OAAOA,CAER,EAEM0c,GAAoB,SAAWC,EAASJ,EAAU,KAAO,CAE9D,UAAY/V,KAAQmW,EAEnBA,EAASnW,CAAI,EAAK2V,EAAYQ,EAASnW,CAAI,EAAI+V,GAIhD,OAAOI,CAER,EAEMC,GAAkB,SAAWzd,EAAOod,EAAU,KAAO,CAE1D,MAAMM,EAAM1d,EAAM,OAElB,QAAUH,EAAI,EAAGA,EAAI6d,EAAK7d,IAEzBG,EAAOH,CAAC,EAAKmd,EAAYhd,EAAOH,CAAC,EAAIud,GAItC,OAAOpd,CAER,EAEM2d,GAAkB,SAAWC,EAAWC,EAAQ,KAAMC,EAAS,KAAMC,EAAW,KAAO,CAE5F,MAAMC,EAAepH,GAAUoG,EAAYe,IAAa,KAAO,OAAO,OAAQnH,EAAMmH,CAAU,EAAGnH,CAAI,EAErG,OAAKiH,IAAU,KAEP,IAAKzG,IAEJ4G,EAAY,IAAIJ,EAAW,GAAGK,GAAW7G,CAAQ,CAAA,GAI9C0G,IAAW,MAEtBA,EAASd,EAAYc,GAEd,IAAK1G,IAEJ4G,EAAY,IAAIJ,EAAWC,EAAO,GAAGI,GAAW7G,CAAM,EAAI0G,CAAM,IAMjE,IAAK1G,IAEJ4G,EAAY,IAAIJ,EAAWC,EAAO,GAAGI,GAAW7G,CAAQ,CAAA,EAMlE,EAEM8G,GAAsB,SAAWN,KAAcxG,EAAS,CAE7D,OAAO4F,EAAY,IAAIY,EAAW,GAAGK,GAAW7G,CAAQ,CAAA,EAEzD,EAEA,MAAM+G,WAA+BhG,CAAK,CAEzC,YAAaiG,EAAYhF,EAAa,CAErC,QAEA,KAAK,WAAagF,EAClB,KAAK,WAAahF,CAElB,CAED,YAAaZ,EAAU,CAEtB,MAAMQ,EAAaR,EAAQ,kBAAmB,IAAI,EAElD,OAAKQ,EAAW,aAAe,OAE9BA,EAAW,WAAa,KAAK,YAAaR,CAAO,GAI3CQ,EAAW,WAAW,YAAaR,CAAO,CAEjD,CAED,KAAMA,EAAU,CAEf,KAAM,CAAE,WAAA4F,EAAY,WAAAhF,CAAY,EAAG,KAEnC,GAAKgF,EAAW,OAAS,CAExB,IAAIC,EAAwBnB,GAA6B,IAAK1E,EAAQ,WAAW,EAE5E6F,IAA0B,SAE9BA,EAAwB,IAAI,QAE5BnB,GAA6B,IAAK1E,EAAQ,YAAa6F,CAAqB,GAI7E,IAAIC,EAAeD,EAAsB,IAAKD,CAAU,EAExD,OAAKE,IAAiB,SAErBA,EAAetB,EAAYxE,EAAQ,kBAAmB4F,CAAY,CAAA,EAElEC,EAAsB,IAAKD,EAAYE,IAInC9F,EAAQ,sBAAwB,MAEpCA,EAAQ,oBAAoB,SAAS,KAAM8F,CAAY,EAIjDtB,EAAYsB,EAAa,KAAMlF,CAAY,CAAA,CAElD,CAED,MAAMmF,EAASH,EAAW,OACpBvF,EAAaO,IAAe,KAAOmF,EAAQnF,EAAYZ,EAAQ,MAAOA,CAAS,EAAG+F,EAAQ/F,EAAQ,MAAOA,CAAO,EAEtH,OAAOwE,EAAYnE,EAEnB,CAED,MAAOL,EAAU,CAEhB,KAAM,CAAE,WAAAK,CAAY,EAAGL,EAAQ,kBAAmB,IAAI,EAEtD,OAAOK,GAAc,KAAK,YAAaL,CAAO,CAE9C,CAED,YAAaA,EAAU,CAEtB,OAAAA,EAAQ,SAAQ,EAEhBA,EAAQ,MAAM,WAAa,KAAK,KAAMA,CAAO,EAEtCA,EAAQ,aAEf,CAED,SAAUA,EAASld,EAAS,CAE3B,KAAM,CAAE,WAAAud,CAAY,EAAGL,EAAQ,kBAAmB,IAAI,EAEtD,OAAKK,IAAe,KAIZ,KAAK,KAAML,CAAO,EAAG,MAAOA,EAASld,GAItC,MAAM,SAAUkd,EAASld,CAAM,CAEtC,CAEF,CAEA,MAAMkjB,WAA2BrG,CAAK,CAErC,YAAaoG,EAAS,CAErB,QAEA,KAAK,OAASA,EACd,KAAK,OAAS,KAEd,KAAK,OAAS,EAEd,CAED,IAAI,cAAe,CAElB,MAAO,cAAc,KAAM,KAAK,OAAO,SAAU,CAAA,CAEjD,CAED,UAAWE,EAAS,CAEnB,YAAK,OAASA,EAEP,IAEP,CAED,KAAM7B,EAAS,KAAO,CAErB,OAAAC,GAAaD,CAAM,EAEZI,EAAY,IAAImB,GAAwB,KAAMvB,CAAQ,CAAA,CAE7D,CAED,OAAQ,CAEP,OAAO,KAAK,MAEZ,CAEF,CAEA,MAAM8B,GAAQ,CAAE,GAAO,IACjBC,GAAQ,CAAE,EAAG,EAAG,EAAG,CAAC,EACpBC,GAAO,CAAE,GAAK,EAAG,EACjBC,GAAS,CAAE,GAAK,IAAK,EAAI,EAAG,KAAM,IAAK,KAAK,GAAI,KAAK,GAAK,EAAG,EAAI,KAAK,GAAI,EAAI,KAAK,GAAI,GAAM,KAAK,GAAK,GAAK,KAAK,GAAK,CAAC,EAEvHC,GAAgB,IAAI,IAC1B,UAAYC,KAAQL,GAAQI,GAAc,IAAKC,EAAM,IAAI3C,GAAW2C,CAAI,GAExE,MAAMC,GAAgB,IAAI,IAC1B,UAAYC,KAAQN,GAAQK,GAAc,IAAKC,EAAM,IAAI7C,GAAW6C,EAAM,MAAM,GAEhF,MAAMC,GAAe,IAAI,IAAK,CAAE,GAAGF,EAAe,EAAC,IAAKG,GAAM,IAAI/C,GAAW+C,EAAG,MAAO,KAAK,CAAI,CAAA,EAChG,UAAYC,KAAOR,GAAOM,GAAa,IAAKE,EAAK,IAAIhD,GAAWgD,EAAK,KAAK,GAE1E,MAAMC,GAAiB,IAAI,IAAK,CAAE,GAAGH,EAAY,EAAG,IAAKC,GAAM,IAAI/C,GAAW+C,EAAG,KAAK,CAAI,CAAA,EAC1F,UAAYG,KAAST,GAASQ,GAAe,IAAKC,EAAO,IAAIlD,GAAWkD,CAAK,GAC7E,UAAYA,KAAST,GAASQ,GAAe,IAAK,CAAEC,EAAO,IAAIlD,GAAW,CAAEkD,CAAK,GAEjF,MAAMC,GAAY,CAAE,KAAMT,GAAe,KAAME,GAAe,KAAME,GAAc,MAAOG,IAEnFG,GAAqB,IAAI,IAAK,CAAE,GAAGV,GAAe,GAAGO,EAAc,GAEnEhC,GAAe,CAAE1gB,EAAOwa,IAExBqI,GAAmB,IAAK7iB,GAErB6iB,GAAmB,IAAK7iB,GAEpBA,EAAM,SAAW,GAErBA,EAIA,IAAIyf,GAAWzf,EAAOwa,GAMzBsI,GAAoB7I,GAAU,CAEnC,GAAI,CAEH,OAAOA,EAAK,aAEZ,MAAa,CAEb,MAEA,CAEF,EAEM8I,EAAc,SAAWvI,EAAMwI,EAAW,KAAO,CAEtD,MAAO,IAAKvI,IAAY,CAQvB,IANKA,EAAO,SAAW,GAAO,CAAE,CAAE,OAAQ,QAAS,MAAO,MAAM,EAAG,SAAUD,CAAI,GAAMC,EAAO,MAAOvB,GAAS,OAAOA,GAAU,QAAQ,KAEtIuB,EAAS,CAAEF,GAAkBC,EAAM,GAAGC,CAAQ,CAAA,GAI1CA,EAAO,SAAW,GAAKuI,IAAa,MAAQA,EAAS,IAAKvI,EAAQ,CAAC,GAEvE,OAAO4F,EAAY2C,EAAS,IAAKvI,EAAQ,CAAG,CAAA,GAI7C,GAAKA,EAAO,SAAW,EAAI,CAE1B,MAAMR,EAAOyG,GAAcjG,EAAQ,CAAG,EAAED,CAAI,EAC5C,OAAKsI,GAAiB7I,CAAM,IAAKO,EAAc6F,EAAYpG,GACpDoG,EAAY,IAAItC,GAAa9D,EAAMO,CAAM,CAAA,CAEhD,CAED,MAAMkC,EAAQjC,EAAO,IAAKvB,GAASwH,GAAcxH,CAAK,GACtD,OAAOmH,EAAY,IAAIlC,GAAUzB,EAAOlC,CAAM,CAAA,CAEhD,CAEA,EAIayI,GAAYjjB,GAAWA,GAASA,EAAM,MAItCkjB,GAAqBljB,GAAoCA,GAAU,KAAWA,EAAM,UAAYA,EAAM,YAAe,OAAOA,GAAU,SAAWA,EAAQ,MAAW,KAI1K,SAASmjB,GAAYvB,EAAS,CAEpC,OAAO,IAAI,MAAO,IAAIC,GAAoBD,CAAQ,EAAE7B,EAAiB,CAEtE,CAEO,MAAMM,EAAa,CAAE9iB,EAAKkjB,EAAU,OAAoBD,GAAkBjjB,EAAKkjB,GACzEP,GAAc,CAAE3iB,EAAKkjB,EAAU,OAAU,IAAIG,GAAmBrjB,EAAKkjB,GACrEa,GAAY,CAAE/jB,EAAKkjB,EAAU,OAAU,IAAIK,GAAiBvjB,EAAKkjB,GACjE2C,EAAY,IAAK3I,IAAY,IAAIuG,GAAiB,GAAGvG,CAAM,EAC3D4I,EAAgB,IAAK5I,IAAY,IAAI8G,GAAqB,GAAG9G,CAAM,EAEnEkG,EAAUiB,GAAY,CAElC,MAAMH,EAAa,IAAI0B,GAAYvB,GAE7B0B,EAAK,IAAK7I,IAAY,CAE3B,IAAIwF,EAEJ,OAAAC,GAAazF,CAAM,EAEdA,EAAQ,CAAG,GAAIA,EAAQ,CAAC,EAAG,OAE/BwF,EAAS,CAAE,GAAGxF,GAIdwF,EAASxF,EAAQ,GAIXgH,EAAW,KAAMxB,EAE1B,EAEC,OAAAqD,EAAG,WAAa7B,EAChB6B,EAAG,UAAcxB,IAEhBL,EAAW,UAAWK,GAEfwB,GAIDA,CAER,EAEAjG,EAAc,aAAc8F,IAI5BvD,EAAgB,WAAc3F,IAE7BA,EAAK,OAAS,GAEPA,IAMD,MAAMsJ,GAAoBC,GAAW,CAQ3C9D,GAAe8D,CAEhB,EAEaC,GAAkB,IAAM/D,GAExBgE,GAAK,IAAKjJ,IAAYiF,GAAa,GAAI,GAAGjF,GAEhD,SAASkJ,GAAQ1J,EAAO,CAE9B,OAAKyF,IAAeA,GAAa,IAAKzF,CAAI,EAEnCA,CAER,CAEA2F,EAAgB,SAAU+D,IAKnB,MAAMC,GAAQ,IAAIb,EAAa,SAEzBJ,EAAQ,IAAII,EAAa,QAASH,GAAU,KAAK,EACjDH,GAAM,IAAIM,EAAa,MAAOH,GAAU,IAAI,EAC5CN,GAAO,IAAIS,EAAa,OAAQH,GAAU,IAAI,EAC9CR,GAAO,IAAIW,EAAa,OAAQH,GAAU,IAAI,EAE9CiB,EAAO,IAAId,EAAa,QACxBe,GAAQ,IAAIf,EAAa,SACzBgB,GAAQ,IAAIhB,EAAa,SACzBiB,GAAQ,IAAIjB,EAAa,SAEzBkB,EAAO,IAAIlB,EAAa,QACxBmB,GAAQ,IAAInB,EAAa,SACzBoB,GAAQ,IAAIpB,EAAa,SACzBqB,GAAQ,IAAIrB,EAAa,SAEzBsB,EAAO,IAAItB,EAAa,QACxBuB,GAAQ,IAAIvB,EAAa,SACzBwB,GAAQ,IAAIxB,EAAa,SACzByB,GAAQ,IAAIzB,EAAa,SAEzB0B,GAAO,IAAI1B,EAAa,QACxB2B,GAAQ,IAAI3B,EAAa,SACzB4B,GAAQ,IAAI5B,EAAa,SACzB6B,GAAQ,IAAI7B,EAAa,SAEzB8B,GAAO,IAAI9B,EAAa,QACxB+B,GAAQ,IAAI/B,EAAa,SACzBgC,GAAQ,IAAIhC,EAAa,SACzBiC,GAAQ,IAAIjC,EAAa,SAEzBkC,GAAO,IAAIlC,EAAa,QACxBmC,GAAQ,IAAInC,EAAa,SACzBoC,GAAQ,IAAIpC,EAAa,SACzBqC,GAAQ,IAAIrC,EAAa,SAKtCnD,EAAgB,UAAWgE,IAC3BhE,EAAgB,UAAW+C,GAC3B/C,EAAgB,QAAS6C,IACzB7C,EAAgB,SAAU0C,IAC1B1C,EAAgB,SAAUwC,IAC1BxC,EAAgB,SAAUiE,GAC1BjE,EAAgB,UAAWkE,IAC3BlE,EAAgB,UAAWmE,IAC3BnE,EAAgB,UAAWoE,IAC3BpE,EAAgB,SAAUqE,GAC1BrE,EAAgB,UAAWsE,IAC3BtE,EAAgB,UAAWuE,IAC3BvE,EAAgB,UAAWwE,IAC3BxE,EAAgB,SAAUyE,GAC1BzE,EAAgB,UAAW0E,IAC3B1E,EAAgB,UAAW2E,IAC3B3E,EAAgB,UAAW4E,IAC3B5E,EAAgB,SAAU6E,IAC1B7E,EAAgB,UAAW8E,IAC3B9E,EAAgB,UAAW+E,IAC3B/E,EAAgB,UAAWgF,IAC3BhF,EAAgB,SAAUiF,IAC1BjF,EAAgB,UAAWkF,IAC3BlF,EAAgB,UAAWmF,IAC3BnF,EAAgB,UAAWoF,IAC3BpF,EAAgB,SAAUqF,IAC1BrF,EAAgB,UAAWsF,IAC3BtF,EAAgB,UAAWuF,IAC3BvF,EAAgB,UAAWwF,IAIpB,MAAMC,GAAUjC,EAAWzF,IACrB2H,GAAU,CAAErL,EAAMsL,IAAWlF,EAAY,IAAItC,GAAasC,EAAYpG,CAAI,EAAIsL,CAAK,GAGhG3F,EAAgB,UAAWyF,IAC3BzF,EAAgB,UAAW0F,EAAS,ECtoBpC,MAAME,WAAmBjI,CAAS,CAEjC,YAAa0B,EAAYD,EAAa,CAErC,QAEA,KAAK,WAAaC,EAClB,KAAK,WAAaD,CAElB,CAED,iBAAkB,CAEjB,MAAO,EAEP,CAED,YAAanD,EAASld,EAAS,CAE9B,OAAOA,IAAW,OAAS,KAAK,WAAW,YAAakd,CAAS,EAAG,MAEpE,CAED,iBAAkBA,EAAU,CAE3B,KAAM,CAAE,WAAAoD,CAAY,EAAG,KAEvB,GAAKpD,EAAQ,YAAa,eAAe,IAAO,IAASoD,EAAW,aAAeA,EAAW,WAAW,OAAS,EAAI,CAErH,MAAMzb,EAAeqY,EAAQ,cAAeoD,EAAW,KAAK,YAAapD,CAAO,GAGhF,OAF6BpC,GAAiB,KAAM,EAAI,EAAC,MAAO,EAAGjW,CAAY,IAAOyb,EAAW,UAIjG,CAED,MAAO,EAEP,CAED,SAAUpD,EAASld,EAAS,CAE3B,KAAM,CAAE,WAAAsgB,EAAY,WAAAD,CAAY,EAAG,KAE7ByG,EAAmB,KAAK,iBAAkB5J,CAAO,EAEjDsD,EAAaF,EAAW,YAAapD,CAAO,EAE5C6J,EAASzG,EAAW,QAAS,CAAE,OAAQ,GAAQ,EAAC,MAAOpD,GACvD8J,EAAS3G,EAAW,MAAOnD,EAASsD,CAAU,EAE9CD,EAAaF,EAAW,YAAanD,CAAO,EAE5CI,EAAWJ,EAAQ,gBAAiB,IAAI,EAI9C,IAAI2B,EAEJ,GAAKvB,EAAS,cAAgB,GAExBtd,IAAW,SAEf6e,EAAUkI,WAIAD,EAAmB,CAE9B,MAAMG,EAAY/J,EAAQ,eAAgB,KAAM,KAAMsD,GAChD0G,EAAiBhK,EAAQ,gBAAiB+J,CAAS,EAEzD/J,EAAQ,gBAAiB,GAAIgK,CAAgB,MAAMF,CAAQ,IAE3D,MAAMG,EAAa7G,EAAW,KAAK,QAAS,CAAE,OAAQ,GAAQ,EAAC,MAAOpD,GAEtE,QAAU3Y,EAAI,EAAGA,EAAI+b,EAAW,WAAW,OAAQ/b,IAAO,CAEzD,MAAMzB,EAAYwd,EAAW,WAAY/b,CAAC,EAE1C2Y,EAAQ,gBAAiB,GAAIiK,CAAY,IAAIrkB,OAAiBokB,CAAc,KAAO3iB,CAAG,IAAG,CAEzF,CAEIvE,IAAW,SAEf6e,EAAUkI,EAId,MAEGlI,EAAU,GAAIkI,CAAQ,MAAMC,CAAQ,IAE/BhnB,IAAW,QAAUugB,IAAe,UAExCrD,EAAQ,gBAAiB2B,GAEpB7e,IAAW,SAEf6e,EAAUkI,IAQb,OAAAzJ,EAAS,YAAc,GAEhBJ,EAAQ,OAAQ2B,EAAS2B,EAAYxgB,CAAM,CAElD,CAEF,CAIO,MAAMonB,GAAS3C,EAAWoC,IAEjCnI,EAAc,aAAcmI,IAE5B5F,EAAgB,SAAUmG,EAAQ,EC3HlC,MAAMC,WAAoBxK,CAAK,CAE9B,YAAavB,EAAMvP,EAAO,KAAO,CAEhC,QAEA,KAAK,KAAOuP,EACZ,KAAK,KAAOvP,EAEZ,KAAK,cAAgB,EAErB,CAED,UAAW,CAEV,MAAO,EAEP,CAED,QAASmR,EAAU,CAElB,OAAO,KAAK,MAAQ,MAAM,QAASA,CAAO,CAE1C,CAED,YAAaA,EAAU,CAItB,OAAO,KAAK,KAAK,YAAaA,CAAO,CAErC,CAED,aAAcA,EAAU,CAEvB,MAAMQ,EAAaR,EAAQ,kBAAmB,IAAI,EAElD,IAAIoK,EAAU5J,EAAW,QAEzB,GAAK4J,IAAY,OAAY,CAE5B,MAAMvb,EAAO,KAAK,KACZ8P,EAAO,KAAK,YAAaqB,CAAO,EAEtCQ,EAAW,QAAU4J,EAAUpK,EAAQ,mBAAoB,KAAMnR,EAAM8P,GACvE6B,EAAW,KAAO,KAAK,IAEvB,CAGD,OAAA4J,EAAQ,qBAAwBA,EAAQ,mBAAuBpK,EAAQ,cAAgB,YAEhFoK,CAEP,CAED,MAAOpK,EAAU,CAEhB,KAAK,aAAcA,EAEnB,CAED,QAASA,EAAU,CAElB,YAAK,aAAcA,GAEZ,KAAK,KAAK,QAASA,CAAO,CAEjC,CAED,SAAUA,EAAU,CAEnB,MAAMQ,EAAaR,EAAQ,kBAAmB,IAAI,EAC5CoK,EAAU,KAAK,aAAcpK,CAAO,EAE1C,GAAKQ,EAAW,eAAiB,OAAY,CAE5C,MAAM7B,EAAO,KAAK,YAAaqB,CAAO,EAChC6B,EAAe7B,EAAQ,gBAAiBoK,EAAS1M,GAAgB,QAGvEsC,EAAQ,wBAAyBtC,GAAgB,OAAQ,KAAK,KAAMiB,EAAMkD,GAE1ErB,EAAW,aAAeqB,CAE1B,CAED,OAAO7B,EAAQ,gBAAiBoK,EAEhC,CAEF,CAIO,MAAMA,GAAU7C,EAAW4C,IAElCpG,EAAgB,UAAWqG,IAE3B5I,EAAc,cAAe2I,EAAa,ECnG1C,MAAME,WAAsB1K,CAAK,CAEhC,YAAa2K,EAAezK,EAAW,KAAM0K,EAAc,KAAO,CAEjE,MAAO1K,CAAQ,EAEf,KAAK,YAAc0K,EAEnB,KAAK,OAAS,GAEd,KAAK,eAAiBD,CAEtB,CAED,QAAStK,EAAU,CAElB,OAAO,KAAK,iBAAkBA,EAE9B,CAED,YAAaA,EAAU,CAEtB,IAAIH,EAAW,MAAM,YAAaG,CAAO,EAEzC,GAAKH,IAAa,KAAO,CAExB,MAAMyK,EAAgB,KAAK,iBAAkBtK,CAAO,EAEpD,GAAKA,EAAQ,qBAAsBsK,GAAkB,CAEpD,MAAME,EAAYxK,EAAQ,SAAS,aAAcsK,CAAa,EAE9DzK,EAAWG,EAAQ,qBAAsBwK,EAE7C,MAEI3K,EAAW,OAIZ,CAED,OAAOA,CAEP,CAED,iBAAkByK,EAAgB,CAEjC,YAAK,eAAiBA,EAEf,IAEP,CAED,kBAAgC,CAE/B,OAAO,KAAK,cAEZ,CAED,SAAUtK,EAAU,CAEnB,MAAMsK,EAAgB,KAAK,iBAAkBtK,CAAO,EAC9CH,EAAW,KAAK,YAAaG,CAAO,EAG1C,GAF0BA,EAAQ,qBAAsBsK,CAAa,IAE1C,GAAO,CAEjC,MAAME,EAAYxK,EAAQ,SAAS,aAAcsK,CAAa,EACxDG,EAAgBzK,EAAQ,qBAAsBwK,CAAS,EAEvDE,EAAgB1K,EAAQ,aAAcsK,EAAeG,CAAa,EAExE,OAAKzK,EAAQ,cAAgB,SAErBA,EAAQ,OAAQ0K,EAAc,KAAMD,EAAe5K,GAItCuK,GAAS,MAEV,MAAOpK,EAASH,CAAQ,CAI/C,KAAS,CAEN,QAAQ,KAAM,oCAAqCyK,CAAe,0BAAyB,EAE3F,KAAM,CAAE,YAAAC,CAAa,EAAG,KAExB,OAAKA,IAAgB,KAEbA,EAAY,MAAOvK,EAASH,CAAQ,EAIpCG,EAAQ,cAAeH,EAI/B,CAED,CAEF,CAIO,MAAM2K,GAAY,CAAE3b,EAAMgR,EAAU0K,IAAiB/F,EAAY,IAAI6F,GAAexb,EAAMgR,EAAU2E,EAAY+F,CAAW,CAAI,CAAA,EAEtI/I,EAAc,gBAAiB6I,EAAe,EChH9C,MAAMM,WAAmBhL,CAAK,CAE7B,YAAaiL,EAAYC,EAAW,CAEnC,QAEA,KAAK,aAAe,GAEpB,KAAK,WAAaD,EAClB,KAAK,SAAWC,CAEhB,CAED,YAAa7K,EAAU,CAEtB,OAAO,KAAK,WAAW,YAAaA,CAAO,CAE3C,CAED,SAAUA,EAAU,CAEnB,MAAM2B,EAAU,KAAK,SAAS,MAAO3B,EAAS,QAE9C,OAAK2B,IAAY,IAEhB3B,EAAQ,gBAAiB2B,GAInB,KAAK,WAAW,MAAO3B,CAAO,CAErC,CAEF,CAIO,MAAM8K,GAASvD,EAAWoD,IAEjC5G,EAAgB,SAAU+G,IAE1BtJ,EAAc,aAAcmJ,EAAY,ECzCxC,MAAMI,WAAkBpL,CAAK,CAE5B,YAAavB,EAAM4M,EAAS,GAAO,CAElC,QAEA,KAAK,KAAO5M,EACZ,KAAK,OAAS4M,EAEd,KAAK,YAAc,EAEnB,CAED,YAAahL,EAAU,CAEtB,OAAO,KAAK,KAAK,YAAaA,CAAO,CAErC,CAED,MAAOA,KAAYpB,EAAS,CAE3B,MAAMqM,EAAgBjL,EAAQ,WACxBqB,EAAQrB,EAAQ,iBAAkB,KAAM,MAAM,EAEpDA,EAAQ,SAAUqB,GAElB,MAAMF,EAAO,KAAK,KAAK,MAAOnB,EAAS,GAAGpB,GAE1C,OAAAoB,EAAQ,SAAUiL,GAEX9J,CAEP,CAEF,CAIO,MAAME,GAAQ,CAAEjD,KAASQ,IAAY4F,EAAY,IAAIuG,GAAWvG,EAAYpG,CAAI,EAAI,GAAGQ,CAAQ,CAAA,EAEtGmF,EAAgB,QAAS1C,IAEzBG,EAAc,YAAauJ,EAAW,EC1CtC,MAAMG,WAAoBvL,CAAK,CAE9B,YAAavB,EAAM+M,EAAU,GAAK,CAEjC,QAEA,KAAK,cAAgB,GAErB,KAAK,KAAO/M,EACZ,KAAK,QAAU+M,CAEf,CAED,YAAanL,EAAU,CAEtB,OAAO,KAAK,KAAK,YAAaA,CAAO,CAErC,CAED,QAASA,EAAU,CAElB,KAAK,KAAK,MAAOA,EAEjB,CAED,MAAOA,EAAU,CAEhB,MAAMoL,EAAkBpL,EAAQ,aAEhCA,EAAQ,WAAY,CAAE,GAAGA,EAAQ,QAAS,GAAG,KAAK,OAAO,GAEzD,MAAM5B,EAAO,KAAK,KAAK,MAAO4B,CAAO,EAErC,OAAAA,EAAQ,WAAYoL,GAEbhN,CAEP,CAED,SAAU4B,EAASld,EAAS,CAE3B,MAAMsoB,EAAkBpL,EAAQ,aAEhCA,EAAQ,WAAY,CAAE,GAAGA,EAAQ,QAAS,GAAG,KAAK,OAAO,GAEzD,MAAM2B,EAAU,KAAK,KAAK,MAAO3B,EAASld,GAE1C,OAAAkd,EAAQ,WAAYoL,GAEbzJ,CAEP,CAEF,CAIO,MAAMwJ,GAAU5D,EAAW2D,IACrBG,GAAQ,CAAEjN,EAAMvP,IAAUsc,GAAS/M,EAAM,CAAE,MAAOvP,CAAI,GAEnEkV,EAAgB,UAAWoH,IAC3BpH,EAAgB,QAASsH,IAEzB7J,EAAc,cAAe0J,EAAa,EC9D1C,MAAMI,WAAkB3L,CAAK,CAE5B,YAAa0F,EAAQ,CAEpB,MAAO,MAAM,EAEb,KAAK,MAAQA,EAEb,KAAK,oBAAsB,EAE3B,CAED,SAAUrF,EAAU,CAEnB,MAAMH,EAAW,KAAK,YAAaG,CAAO,EACpCqF,EAAQ,KAAK,MAEnB,IAAIxD,EAEJ,GAAKwD,IAAUiG,GAAU,OAExBzJ,EAAe7B,EAAQ,yBAEZqF,IAAUiG,GAAU,SAE/BzJ,EAAe7B,EAAQ,2BAEZqF,IAAUiG,GAAU,KAE/BzJ,EAAe7B,EAAQ,mBAIvB,OAAM,IAAI,MAAO,mCAAqCqF,GAIvD,IAAIviB,EAEJ,OAAKkd,EAAQ,cAAgB,UAAYA,EAAQ,cAAgB,UAEhEld,EAAS+e,EAMT/e,EAFoBsnB,GAAS,MAER,MAAOpK,EAASH,CAAQ,EAIvC/c,CAEP,CAEF,CAEAwoB,GAAU,OAAS,SACnBA,GAAU,SAAW,WACrBA,GAAU,KAAO,OAIV,MAAMC,GAAc/D,EAAe8D,GAAWA,GAAU,MAAM,EACxDE,GAAgBhE,EAAe8D,GAAWA,GAAU,QAAQ,EAC5DG,GAAYjE,EAAe8D,GAAWA,GAAU,IAAI,EAEjE9J,EAAc,YAAa8J,EAAW,ECvEtC,MAAMI,EAAc,CAEnB,OAAmC,CAAG,CAEtC,QAAoC,CAAG,CAEvC,QAAoC,CAAG,CAEvC,gBAA4C,CAAE,CAE9C,iBAA6C,CAAG,CAEhD,kBAA8C,CAAG,CAEjD,kBAA8C,CAAG,CAElD,CCbA,MAAMC,WAAgBhM,CAAK,CAE1B,YAAavB,EAAMvP,EAAO,KAAO,CAEhC,QAEA,KAAK,KAAOuP,EACZ,KAAK,KAAOvP,EAEZ,KAAK,OAAS,GAEd,KAAK,UAAY,EAEjB,CAED,QAASmR,EAAU,CAElB,OAAO,KAAK,MAAQ,MAAM,QAASA,CAAO,CAE1C,CAED,YAAaA,EAAU,CAEtB,OAAO,KAAK,KAAK,YAAaA,CAAO,CAErC,CAED,SAAUA,EAAU,CAEnB,KAAM,CAAE,KAAA5B,EAAM,KAAAvP,CAAM,EAAG,KAEjB+S,EAAU5B,EAAQ,eAAgB,KAAMnR,EAAMmR,EAAQ,cAAe,KAAK,YAAaA,CAAO,CAAI,CAAA,EAElG6B,EAAe7B,EAAQ,gBAAiB4B,CAAO,EAE/CD,EAAUvD,EAAK,MAAO4B,EAAS4B,EAAQ,MAE7C,OAAA5B,EAAQ,gBAAiB,GAAG6B,CAAY,MAAMF,CAAO,IAE9CE,CAEP,CAEF,CAIO,MAAM+J,GAAOrE,EAAWoE,IAE/B5H,EAAgB,OAAQ6H,IACxB7H,EAAgB,QAAS,IAAKnF,IAAYgN,GAAM,GAAGhN,CAAQ,EAAC,OAAM,GAElE4C,EAAc,UAAWmK,EAAS,ECpDlC,MAAME,UAAqBlM,CAAK,CAE/B,YAAaE,EAAUhR,EAAO,KAAMub,EAAU,GAAQ,CAErD,MAAOvK,CAAQ,EAEf,KAAK,KAAOhR,EACZ,KAAK,QAAUub,EAEf,KAAK,eAAiB,EAEtB,CAED,QAASpK,EAAU,CAElB,OAAO,KAAK,MAAQ,MAAM,QAASA,CAAO,CAE1C,CAED,UAAwB,CAEvB,MAAO,EAEP,CAED,SAAUA,EAAU,CAEnB,IAAI4B,EAEJ,OAAK,KAAK,UAAY,IAErBA,EAAU5B,EAAQ,mBAAoB,KAAM,KAAK,IAAI,EACrD4B,EAAQ,mBAAqB,IAI7BA,EAAU5B,EAAQ,eAAgB,KAAM,KAAK,IAAI,EAI3CA,EAAQ,gBAAiB4B,EAEhC,CAEF,CAIO,MAAM3D,GAAW,CAAEU,EAAM9P,IAAU2V,EAAY,IAAIqH,EAAclN,EAAM9P,CAAI,GACrEid,GAAkB,CAAEnN,EAAM9P,IAAU2V,EAAY,IAAIqH,EAAclN,EAAM9P,EAAM,EAAI,GAElFkd,EAAevE,EAAeqE,EAAc,OAAQ,cAAc,EAClEG,GAAYxE,EAAeqE,EAAc,QAAS,WAAW,EAC7DI,GAAYzE,EAAeqE,EAAc,QAAS,WAAW,EAC7DK,GAAY1E,EAAeqE,EAAc,QAAS,WAAW,EAC7DM,GAAqB3E,EAAeqE,EAAc,QAAS,oBAAoB,EAC/EO,GAAQ5E,EAAeqE,EAAc,OAAQ,OAAO,EACpDQ,GAAiB7E,EAAeqE,EAAc,QAAS,gBAAgB,EACvES,GAAc9E,EAAeqE,EAAc,QAAS,aAAa,EACjEU,GAAiB/E,EAAeqE,EAAc,QAAS,gBAAgB,EACvEW,GAAuBhF,EAAeqE,EAAc,QAAS,sBAAsB,EACnFY,GAASjF,EAAeqE,EAAc,QAAS,QAAQ,EACvDa,GAAalF,EAAeqE,EAAc,QAAS,YAAY,EAC/Dc,GAAcnF,EAAeqE,EAAc,OAAQ,aAAa,EAChEe,GAAcpF,EAAeqE,EAAc,OAAQ,aAAa,EAChEgB,GAAgBrF,EAAeqE,EAAc,QAAS,eAAe,EACrEiB,GAActF,EAAeqE,EAAc,QAAS,aAAa,EACjEkB,GAAYvF,EAAeqE,EAAc,QAAS,WAAW,EAC7D/oB,GAAS0kB,EAAeqE,EAAc,OAAQ,QAAQ,EACtDmB,GAAWxF,EAAeqE,EAAc,QAAS,UAAU,EAC3DoB,GAAUzF,EAAeqE,EAAc,QAAS,SAAS,EAC5CrE,EAAeqE,EAAc,QAAS,YAAe,EACxE,MAAMqB,GAAM1F,EAAeqE,EAAc,QAAS,KAAK,EACjDsB,GAAe3F,EAAeqE,EAAc,QAAS,cAAc,EACnEuB,GAAY5F,EAAeqE,EAAc,QAAS,WAAW,EAC7DwB,GAAsB7F,EAAeqE,EAAc,QAAS,qBAAqB,EACjFyB,GAAmB9F,EAAeqE,EAAc,QAAS,kBAAkB,EAC3E0B,GAAa/F,EAAeqE,EAAc,QAAS,YAAY,EAE5ErK,EAAc,eAAgBqK,CAAc,EC9E5C,MAAM2B,WAAsB3B,CAAa,CAExC,YAAahM,EAAUhR,EAAO,KAAO,CAEpC,MAAOgR,EAAUhR,GAEjB,KAAK,gBAAkB,EAEvB,CAED,SAAU,CAET,OAAO,KAAK,IAEZ,CAED,UAAW,CAEV,OAAO,KAAK,IAEZ,CAEF,CAMA2S,EAAc,gBAAiBgM,EAAe,EC7B9C,MAAMC,WAAiB9N,CAAK,CAE3B,YAAa+N,EAAO,GAAInlB,EAAW,CAAE,EAAEwE,EAAW,GAAK,CAEtD,MAAO,MAAM,EAEb,KAAK,WAAa,GAElB,KAAK,KAAO2gB,EACZ,KAAK,SAAW3gB,EAEhB,KAAK,SAAWxE,CAEhB,CAED,UAAW,CAEV,MAAO,EAEP,CAED,YAAaA,EAAW,CAEvB,YAAK,SAAWA,EAET,IAEP,CAED,aAA2B,CAE1B,OAAO,KAAK,QAEZ,CAED,SAAUyX,EAAU,CAEnB,MAAMzX,EAAW,KAAK,YAAayX,CAAO,EAE1C,UAAY2N,KAAWplB,EAEtBolB,EAAQ,MAAO3N,GAIhB,MAAM4N,EAAW5N,EAAQ,gBAAiB,KAAM,KAAK,YAAaA,CAAO,GACzE,OAAA4N,EAAS,KAAO,KAAK,KAEdA,EAAS,IAEhB,CAED,UAAWzM,EAAO,CAEjB,MAAM,UAAWA,GAEjBA,EAAK,KAAO,KAAK,KACjBA,EAAK,SAAW,KAAK,QAErB,CAED,YAAaA,EAAO,CAEnB,MAAM,YAAaA,GAEnB,KAAK,KAAOA,EAAK,KACjB,KAAK,SAAWA,EAAK,QAErB,CAEF,CAIoBoG,EAAWkG,EAAW,EAM1CjM,EAAc,WAAYiM,EAAU,EC/EpC,MAAMI,WAAqBJ,EAAS,CAEnC,YAAaC,EAAO,GAAInlB,EAAW,CAAE,EAAEwE,EAAW,GAAK,CAEtD,MAAO2gB,EAAMnlB,EAAUwE,GAEvB,KAAK,SAAW,EAEhB,CAED,YAAaiT,EAAU,CAEtB,OAAO,KAAK,gBAAiBA,CAAO,EAAG,IAEvC,CAED,UAAWA,EAAU,CAEpB,OAAO,KAAK,gBAAiBA,CAAO,EAAG,MAEvC,CAED,gBAAiBA,EAAU,CAE1B,MAAMI,EAAWJ,EAAQ,gBAAiB,IAAI,EAE9C,IAAI8N,EAAe1N,EAAS,aAE5B,OAAK0N,IAAiB,SAErBA,EAAe9N,EAAQ,OAAO,cAAe,KAAK,IAAI,EAEtDI,EAAS,aAAe0N,GAIlBA,CAEP,CAED,SAAU9N,EAASld,EAAS,CAE3B,MAAM,SAAUkd,GAEhB,MAAM8N,EAAe,KAAK,gBAAiB9N,CAAO,EAE5CnR,EAAOif,EAAa,KACpBnP,EAAOmP,EAAa,KAEpBF,EAAW5N,EAAQ,gBAAiB,KAAMrB,CAAI,EAE/C9P,IAAS,KAIb+e,EAAS,KAAO/e,GAIjB,MAAMgT,EAAe7B,EAAQ,gBAAiB4N,CAAQ,EAEtD,IAAIF,EAAO,KAAK,gBAAiB1N,CAAO,EAAG,QAAS6B,GAEpD,MAAMkM,EAAW,KAAK,SAChBC,EAAqB,OAAO,KAAMD,CAAQ,EAEhD,GAAKC,EAAmB,OAAS,EAEhC,UAAY/P,KAAY+P,EAAqB,CAE5C,MAAMC,EAAiB,IAAI,OAAQ,MAAMhQ,CAAQ,MAAO,KAClDiQ,EAAeH,EAAU9P,CAAQ,EAAG,MAAO+B,EAAS,YAE1D0N,EAAOA,EAAK,QAASO,EAAgBC,CAAY,CAEjD,CAMF,OAFAN,EAAS,KAAOF,EAAO;AAAA,EAElB5qB,IAAW,WAER+e,EAIA7B,EAAQ,OAAQ,GAAI6B,CAAc,KAAKlD,EAAM7b,EAIrD,CAEF,CAgCA0e,EAAc,eAAgBqM,EAAc,EC9H5C,MAAMM,WAAyBxO,CAAK,CAEnC,YAAa9Q,EAAMuf,EAAS,GAAQ,CAEnC,MAAO,QAAQ,EAEf,KAAK,KAAOvf,EACZ,KAAK,QAAU,EAEf,KAAK,OAASuf,EAEd,KAAK,eAAiB,EAEtB,CAED,IAAI,YAAajqB,EAAQ,CAEnBA,IAAU,IAAO,KAAK,SAE3B,CAEF,CAEO,MAAMkqB,GAAiBxf,GAAU,IAAIsf,GAAkBtf,CAAI,EACrDyf,GAAuBzf,GAAU,IAAIsf,GAAkBtf,EAAM,EAAI,EAEpDyf,GAAoB,OAAU,EAC7BA,GAAoB,QAAW,EACnD,MAAMC,GAAcF,GAAc,UAIzC7M,EAAc,mBAAoB2M,EAAkB,EC9BpD,MAAMK,WAAoB9K,EAAU,CAEnC,YAAavf,EAAO0b,EAAW,KAAO,CAErC,MAAO1b,EAAO0b,GAEd,KAAK,cAAgB,GAErB,KAAK,KAAO,GACZ,KAAK,UAAY0O,EAEjB,CAED,MAAO1f,EAAO,CAEb,YAAK,KAAOA,EAEL,IAEP,CAED,SAAU4f,EAAQ,CAEjB,YAAK,UAAYA,EAEV,IAEP,CAED,UAAW,CAEV,OAAO,KAAK,SAEZ,CAED,eAAgBzO,EAAU,CAEzB,OAAO,KAAK,QAASA,EAErB,CAED,SAAUrS,EAAUoS,EAAa,CAEhC,MAAM2O,EAAO,KAAK,UAElB,OAAA/gB,EAAWA,EAAS,KAAM+gB,GAEnB,MAAM,SAAYC,GAAW,CAEnC,MAAMxqB,EAAQwJ,EAAUghB,EAAOD,CAAI,EAE9BvqB,IAAU,SAEd,KAAK,MAAQA,EAIb,EAAE4b,CAAU,CAEd,CAED,SAAUC,EAASld,EAAS,CAE3B,MAAM6b,EAAO,KAAK,YAAaqB,CAAO,EAEhCE,EAAO,KAAK,eAAgBF,CAAO,EAEzC,IAAI4O,EAAa5O,EAAQ,gBAAiBE,CAAI,EAEzC0O,IAAe,SAEnB5O,EAAQ,YAAa,KAAME,GAE3B0O,EAAa,MAId,MAAMC,EAAiBD,EAAW,aAAc5O,CAAO,EAEjD8O,EAAc9O,EAAQ,mBAAoB4O,EAAYC,EAAgB7O,EAAQ,YAAa,KAAK,MAAQA,EAAQ,QAAQ,KAAK,EAC7H6B,EAAe7B,EAAQ,gBAAiB8O,CAAW,EAEzD,OAAK9O,EAAQ,QAAQ,QAAU,QAAY,OAAOA,EAAQ,QAAQ,MAE3DA,EAAQ,OAAQ6B,EAAclD,EAAM7b,CAAM,CAEjD,CAEF,CAIO,MAAMisB,EAAU,CAAEC,EAAMC,IAAU,CAExC,MAAMpP,EAAWwH,GAAkB4H,GAAQD,CAAI,EAGzC7qB,EAAU6qB,GAAQA,EAAK,SAAW,GAAWA,EAAK,MAAQA,EAAK,KAAK,OAAWA,EAAK,MAAQA,EAElG,OAAOxK,EAAY,IAAIgK,GAAarqB,EAAO0b,CAAU,CAAA,CAEtD,EAEA2B,EAAc,cAAegN,EAAa,EC1GnC,MAAMU,GAAO/O,GAAWqK,GAAW,MAASrK,EAAQ,EAAIA,EAAQ,IAAM,MAAQ,ECErF,MAAMgP,WAAwBxP,CAAK,CAElC,YAAayP,EAAaC,EAAY,KAAO,CAE5C,MAAO,OAAO,EAEd,KAAK,kBAAoB,GAEzB,KAAK,YAAcD,EACnB,KAAK,UAAYC,CAEjB,CAED,SAAUrP,EAASld,EAAS,CAE3B,MAAMwsB,EAAkB,KAAK,YAAY,MAAOtP,EAAS,YACnDqP,EAAY,KAAK,UAAU,MAAOrP,EAAS,OAEjD,OAAOA,EAAQ,OAAQ,GAAIA,EAAQ,UAAW,mBAAqB,CAAA,KAAOsP,CAAiB,KAAKD,CAAW,KAAK,KAAK,YAAarP,CAAO,EAAIld,EAE7I,CAEF,CAIO,MAAMysB,GAAchI,EAAW4H,IAEtCpL,EAAgB,cAAewL,IAE/B/N,EAAc,kBAAmB2N,EAAiB,EC9BlD,MAAMK,UAAqB9N,CAAS,CAEnC,YAAa+N,EAAIC,EAAOC,KAAU/Q,EAAS,CAI1C,GAFA,QAEKA,EAAO,OAAS,EAAI,CAExB,IAAIgR,EAAU,IAAIJ,EAAcC,EAAIC,EAAOC,CAAK,EAEhD,QAAU,EAAI,EAAG,EAAI/Q,EAAO,OAAS,EAAG,IAEvCgR,EAAU,IAAIJ,EAAcC,EAAIG,EAAShR,EAAQ,CAAC,GAInD8Q,EAAQE,EACRD,EAAQ/Q,EAAQA,EAAO,OAAS,CAAC,CAEjC,CAED,KAAK,GAAK6Q,EACV,KAAK,MAAQC,EACb,KAAK,MAAQC,CAEb,CAED,YAAa3P,EAASld,EAAS,CAE9B,MAAM2sB,EAAK,KAAK,GAEVC,EAAQ,KAAK,MACbC,EAAQ,KAAK,MAEbE,EAAQH,EAAM,YAAa1P,CAAO,EAClC8P,EAAQ,OAAOH,EAAU,IAAcA,EAAM,YAAa3P,CAAS,EAAG,KAE5E,GAAK6P,IAAU,QAAUC,IAAU,OAElC,MAAO,OAED,GAAKL,IAAO,IAElB,OAAOI,EAED,GAAKJ,IAAO,KAAOA,IAAO,KAAOA,IAAO,KAAOA,IAAO,KAAOA,IAAO,MAAQA,IAAO,KAEzF,OAAOzP,EAAQ,eAAgB6P,GAEzB,GAAKJ,IAAO,KAAOA,IAAO,MAAQA,IAAO,MAAQA,IAAO,MAAQA,IAAO,KAE7E,MAAO,OAED,GAAKA,IAAO,KAAOA,IAAO,KAAOA,IAAO,MAAQA,IAAO,KAAO,CAEpE,MAAMM,EAAajtB,EAASkd,EAAQ,cAAeld,CAAQ,EAAG,KAAK,IAAKkd,EAAQ,cAAe6P,CAAO,EAAE7P,EAAQ,cAAe8P,CAAK,GAEpI,OAAOC,EAAa,EAAI,OAAQA,CAAU,GAAM,MAEnD,KAEG,QAAKF,IAAU,SAAW7P,EAAQ,SAAU8P,CAAK,EAEzCA,EAEI9P,EAAQ,SAAU6P,CAAO,GAAI7P,EAAQ,SAAU8P,GAInD9P,EAAQ,oBAAqB6P,GAEzB7P,EAAQ,SAAU6P,CAAO,GAAI7P,EAAQ,SAAU8P,GAInD9P,EAAQ,oBAAqB8P,GAEzB9P,EAAQ,cAAe8P,CAAO,EAAG9P,EAAQ,cAAe6P,GAI5DC,EAIDD,CAIR,CAED,SAAU7P,EAASld,EAAS,CAE3B,MAAM2sB,EAAK,KAAK,GAEVC,EAAQ,KAAK,MACbC,EAAQ,KAAK,MAEbhR,EAAO,KAAK,YAAaqB,EAASld,CAAM,EAE9C,IAAI+sB,EAAQ,KACRC,EAAQ,KAEPnR,IAAS,QAEbkR,EAAQH,EAAM,YAAa1P,GAC3B8P,EAAQ,OAAOH,EAAU,IAAcA,EAAM,YAAa3P,CAAS,EAAG,KAEjEyP,IAAO,KAAOA,IAAO,KAAOA,IAAO,MAAQA,IAAO,MAAQA,IAAO,KAEhEzP,EAAQ,SAAU6P,GAEtBC,EAAQD,EAIRA,EAAQC,EAAQ,QAINL,IAAO,MAAQA,IAAO,MAEjCI,EAAQlR,EACRmR,EAAQ9P,EAAQ,oBAAqB8P,EAAO,MAAM,GAEvC9P,EAAQ,SAAU6P,CAAO,GAAI7P,EAAQ,SAAU8P,GAI1DA,EAAQ9P,EAAQ,oBAAqB6P,GAE1B7P,EAAQ,SAAU6P,CAAO,GAAI7P,EAAQ,SAAU8P,GAI1DD,EAAQ7P,EAAQ,oBAAqB8P,GAMrCD,EAAQC,EAAQnR,GAMjBkR,EAAQC,EAAQnR,EAIjB,MAAMtb,EAAIqsB,EAAM,MAAO1P,EAAS6P,CAAK,EAC/BvsB,EAAI,OAAOqsB,EAAU,IAAcA,EAAM,MAAO3P,EAAS8P,CAAO,EAAG,KAEnEE,EAAehQ,EAAQ,cAAeld,CAAM,EAC5CmtB,EAAcjQ,EAAQ,oBAAqByP,CAAE,EAEnD,GAAK3sB,IAAW,OAEf,OAAK2sB,IAAO,KAAOO,EAAe,EAE1BhQ,EAAQ,OAAQ,GAAIA,EAAQ,UAAW,UAAY,CAAA,KAAO3c,CAAC,KAAOC,CAAC,KAAOqb,EAAM7b,GAE5E2sB,IAAO,MAAQO,EAAe,EAElChQ,EAAQ,OAAQ,GAAIA,EAAQ,UAAW,eAAiB,CAAA,KAAO3c,CAAC,KAAOC,CAAC,KAAOqb,EAAM7b,GAEjF2sB,IAAO,KAAOO,EAAe,EAEjChQ,EAAQ,OAAQ,GAAIA,EAAQ,UAAW,aAAe,CAAA,KAAO3c,CAAC,KAAOC,CAAC,KAAOqb,EAAM7b,GAE/E2sB,IAAO,MAAQO,EAAe,EAElChQ,EAAQ,OAAQ,GAAIA,EAAQ,UAAW,kBAAoB,CAAA,KAAO3c,CAAC,KAAOC,CAAC,KAAOqb,EAAM7b,GAEpF2sB,IAAO,KAAOA,IAAO,IAEzBzP,EAAQ,OAAQ,IAAIyP,CAAE,GAAGpsB,CAAC,IAAKwsB,EAAO/sB,GAElCmtB,EAEJjQ,EAAQ,OAAQ,GAAIiQ,CAAa,KAAK5sB,MAAQC,CAAC,KAAOqb,EAAM7b,CAAM,EAIlEkd,EAAQ,OAAQ,KAAM3c,CAAC,IAAMosB,CAAI,IAAInsB,CAAG,KAAKqb,EAAM7b,CAAM,EAI3D,GAAK+sB,IAAU,OAErB,OAAKI,EAEGjQ,EAAQ,OAAQ,GAAIiQ,CAAa,KAAK5sB,MAAQC,CAAC,KAAOqb,EAAM7b,CAAM,EAIlEkd,EAAQ,OAAQ,GAAI3c,CAAC,IAAMosB,CAAI,IAAInsB,CAAG,GAAGqb,EAAM7b,CAAM,CAM9D,CAED,UAAWqe,EAAO,CAEjB,MAAM,UAAWA,GAEjBA,EAAK,GAAK,KAAK,EAEf,CAED,YAAaA,EAAO,CAEnB,MAAM,YAAaA,GAEnB,KAAK,GAAKA,EAAK,EAEf,CAEF,CAIO,MAAM+O,GAAM3I,EAAWiI,EAAc,KAC/BW,GAAM5I,EAAWiI,EAAc,KAC/BY,EAAM7I,EAAWiI,EAAc,KAC/BrY,GAAMoQ,EAAWiI,EAAc,KAC/Ba,GAAY9I,EAAWiI,EAAc,KACrCc,GAAQ/I,EAAWiI,EAAc,MACjCe,GAAWhJ,EAAWiI,EAAc,MACpCgB,GAAWjJ,EAAWiI,EAAc,KACpCiB,GAAclJ,EAAWiI,EAAc,KACvCkB,GAAgBnJ,EAAWiI,EAAc,MACzCmB,GAAmBpJ,EAAWiI,EAAc,MAC5CoB,GAAMrJ,EAAWiI,EAAc,MAC/BqB,GAAKtJ,EAAWiI,EAAc,MAC9BsB,GAAMvJ,EAAWiI,EAAc,KAC/BuB,GAAMxJ,EAAWiI,EAAc,MAC/BwB,GAASzJ,EAAWiI,EAAc,KAClCyB,GAAS1J,EAAWiI,EAAc,KAClC0B,GAAQ3J,EAAWiI,EAAc,KACjC2B,GAAS5J,EAAWiI,EAAc,KAClC4B,GAAY7J,EAAWiI,EAAc,MACrC6B,GAAa9J,EAAWiI,EAAc,MAEnDzL,EAAgB,MAAOmM,IACvBnM,EAAgB,MAAOoM,IACvBpM,EAAgB,MAAOqM,GACvBrM,EAAgB,MAAO5M,IACvB4M,EAAgB,YAAasM,IAC7BtM,EAAgB,QAASuM,IACzBvM,EAAgB,WAAYwM,IAC5BxM,EAAgB,WAAYyM,IAC5BzM,EAAgB,cAAe0M,IAC/B1M,EAAgB,gBAAiB2M,IACjC3M,EAAgB,mBAAoB4M,IACpC5M,EAAgB,MAAO6M,IACvB7M,EAAgB,KAAM8M,IACtB9M,EAAgB,MAAO+M,IACvB/M,EAAgB,MAAOgN,IACvBhN,EAAgB,SAAUiN,IAC1BjN,EAAgB,SAAUkN,IAC1BlN,EAAgB,QAASmN,IACzBnN,EAAgB,SAAUoN,IAC1BpN,EAAgB,YAAaqN,IAC7BrN,EAAgB,aAAcsN,IAE9B7P,EAAc,eAAgBgO,CAAc,EC5Q5C,MAAM8B,UAAiB5P,CAAS,CAE/B,YAAa9V,EAAQ8jB,EAAOC,EAAQ,KAAM4B,EAAQ,KAAO,CAExD,QAEA,KAAK,OAAS3lB,EAEd,KAAK,MAAQ8jB,EACb,KAAK,MAAQC,EACb,KAAK,MAAQ4B,CAEb,CAED,aAAcvR,EAAU,CAEvB,MAAMwR,EAAQ,KAAK,MAAM,YAAaxR,CAAO,EACvCyR,EAAQ,KAAK,MAAQ,KAAK,MAAM,YAAazR,CAAS,EAAG,KACzD0R,EAAQ,KAAK,MAAQ,KAAK,MAAM,YAAa1R,CAAS,EAAG,KAEzD2R,EAAO3R,EAAQ,SAAUwR,CAAK,EAAK,EAAIxR,EAAQ,cAAewR,GAC9DI,EAAO5R,EAAQ,SAAUyR,CAAK,EAAK,EAAIzR,EAAQ,cAAeyR,GAC9DI,EAAO7R,EAAQ,SAAU0R,CAAK,EAAK,EAAI1R,EAAQ,cAAe0R,GAEpE,OAAKC,EAAOC,GAAQD,EAAOE,EAEnBL,EAEII,EAAOC,EAEXJ,EAEII,EAAOF,EAEXD,EAIDF,CAEP,CAED,YAAaxR,EAAU,CAEtB,MAAMpU,EAAS,KAAK,OAEpB,OAAKA,IAAW0lB,EAAS,QAAU1lB,IAAW0lB,EAAS,UAAY1lB,IAAW0lB,EAAS,IAE/E,QAEI1lB,IAAW0lB,EAAS,MAExB,OAEI1lB,IAAW0lB,EAAS,IAExB,OAEI1lB,IAAW0lB,EAAS,OAExBtR,EAAQ,oBAAqB,KAAK,MAAM,YAAaA,CAAO,EAAI,QAE5DpU,IAAW0lB,EAAS,IAExB,KAAK,MAAM,YAAatR,CAAO,EAI/B,KAAK,aAAcA,EAI3B,CAED,SAAUA,EAASld,EAAS,CAE3B,MAAM8I,EAAS,KAAK,OAEd+S,EAAO,KAAK,YAAaqB,CAAO,EAChC8R,EAAY,KAAK,aAAc9R,CAAO,EAEtC3c,EAAI,KAAK,MACTC,EAAI,KAAK,MACT,EAAI,KAAK,MAETyuB,EAAU/R,EAAQ,SAAS,kBAAoB,GAErD,GAAKpU,IAAW0lB,EAAS,oBAAsB,CAK9C,IAAIU,EAAK3uB,EACL4uB,EAAK3uB,EAEJ0c,EAAQ,SAAUgS,EAAG,YAAahS,CAAS,CAAA,EAE/CiS,EAAKzJ,EAAMJ,EAAM6J,CAAI,EAAE,CAAG,EAI1BD,EAAKxJ,EAAMJ,EAAM4J,CAAI,EAAE,CAAG,EAI3B,MAAME,EAAU9B,EAAK4B,EAAIC,CAAE,EAAG,IAE9B,OAAOE,GAAWD,CAAS,EAAC,MAAOlS,EAASld,CAAM,CAErD,KAAS,IAAK8I,IAAW0lB,EAAS,OAE/B,OAAOtR,EAAQ,OAAQ,OAAS3c,EAAE,MAAO2c,EAAS8R,GAAc,KAAMnT,EAAM7b,CAAM,EAE5E,GAAK8I,IAAW0lB,EAAS,UAE/B,OAAOnB,GAAK,EAAK9sB,CAAC,EAAG,MAAO2c,EAASld,GAE/B,GAAK8I,IAAW0lB,EAAS,WAE/B,OAAOna,GAAK,EAAK9T,CAAC,EAAG,MAAO2c,EAASld,GAE/B,GAAK8I,IAAW0lB,EAAS,WAE/B,OAAOc,GAAKjC,GAAK9sB,EAAGC,CAAG,CAAA,EAAG,MAAO0c,EAASld,GAEpC,CAEN,MAAM8b,EAAS,CAAA,EAEf,OAAKhT,IAAW0lB,EAAS,OAAS1lB,IAAW0lB,EAAS,IAErD1S,EAAO,KACNvb,EAAE,MAAO2c,EAASrB,CAAM,EACxBrb,EAAE,MAAO0c,EAASrB,CAAM,CAC7B,EAEe/S,IAAW0lB,EAAS,KAE/B1S,EAAO,KACNvb,EAAE,MAAO2c,EAASA,EAAQ,cAAe3c,EAAE,YAAa2c,CAAO,CAAI,IAAK,EAAI,QAAU8R,CAAW,EACjGxuB,EAAE,MAAO0c,EAAS8R,CAAW,CAClC,EAEiBC,IAAanmB,IAAW0lB,EAAS,KAAO1lB,IAAW0lB,EAAS,MAAW1lB,IAAW0lB,EAAS,IAExG1S,EAAO,KACNvb,EAAE,MAAO2c,EAAS8R,CAAW,EAC7BxuB,EAAE,MAAO0c,EAASA,EAAQ,cAAe1c,EAAE,YAAa0c,CAAO,CAAI,IAAK,EAAI,QAAU8R,CAAW,CACtG,EAEelmB,IAAW0lB,EAAS,QAE/B1S,EAAO,KACNvb,EAAE,MAAO2c,EAAS8R,CAAW,EAC7BxuB,EAAE,MAAO0c,EAAS8R,CAAW,EAC7B,EAAE,MAAO9R,EAAS,OAAS,CAChC,EAEepU,IAAW0lB,EAAS,IAE/B1S,EAAO,KACNvb,EAAE,MAAO2c,EAAS8R,CAAW,EAC7BxuB,EAAE,MAAO0c,EAAS8R,CAAW,EAC7B,EAAE,MAAO9R,EAASA,EAAQ,cAAe,EAAE,YAAaA,CAAO,CAAI,IAAK,EAAI,QAAU8R,CAAW,CACtG,GAIIlT,EAAO,KAAMvb,EAAE,MAAO2c,EAAS8R,CAAS,GACnCxuB,IAAM,MAAOsb,EAAO,KAAMtb,EAAE,MAAO0c,EAAS8R,CAAS,GACrD,IAAM,MAAOlT,EAAO,KAAM,EAAE,MAAOoB,EAAS8R,CAAS,IAIpD9R,EAAQ,OAAQ,GAAIA,EAAQ,UAAWpU,EAAQ+S,CAAM,CAAA,KAAMC,EAAO,KAAM,IAAM,CAAA,KAAMD,EAAM7b,EAEjG,EAED,CAED,UAAWqe,EAAO,CAEjB,MAAM,UAAWA,GAEjBA,EAAK,OAAS,KAAK,MAEnB,CAED,YAAaA,EAAO,CAEnB,MAAM,YAAaA,GAEnB,KAAK,OAASA,EAAK,MAEnB,CAEF,CAIAmQ,EAAS,IAAM,MACfA,EAAS,IAAM,MACfA,EAAS,OAAS,SAElBA,EAAS,QAAU,UACnBA,EAAS,QAAU,UACnBA,EAAS,IAAM,MACfA,EAAS,KAAO,OAChBA,EAAS,IAAM,MACfA,EAAS,KAAO,OAChBA,EAAS,KAAO,OAChBA,EAAS,aAAe,cACxBA,EAAS,MAAQ,QACjBA,EAAS,KAAO,OAChBA,EAAS,UAAY,YACrBA,EAAS,MAAQ,QACjBA,EAAS,IAAM,MACfA,EAAS,IAAM,MACfA,EAAS,IAAM,MACfA,EAAS,KAAO,OAChBA,EAAS,KAAO,OAChBA,EAAS,KAAO,OAChBA,EAAS,IAAM,MACfA,EAAS,KAAO,OAChBA,EAAS,OAAS,SAClBA,EAAS,OAAS,SAClBA,EAAS,UAAY,WACrBA,EAAS,KAAO,OAChBA,EAAS,KAAO,OAChBA,EAAS,MAAQ,QACjBA,EAAS,WAAa,aACtBA,EAAS,MAAQ,QACjBA,EAAS,OAAS,SAClBA,EAAS,QAAU,UACnBA,EAAS,UAAY,YAIrBA,EAAS,MAAQ,QACjBA,EAAS,IAAM,MACfA,EAAS,IAAM,MACfA,EAAS,IAAM,MACfA,EAAS,KAAO,OAChBA,EAAS,QAAU,UACnBA,EAAS,SAAW,WACpBA,EAAS,WAAa,aACtBA,EAAS,IAAM,MACfA,EAAS,MAAQ,QACjBA,EAAS,IAAM,MACfA,EAAS,oBAAsB,qBAI/BA,EAAS,IAAM,MACfA,EAAS,MAAQ,QACjBA,EAAS,QAAU,UACnBA,EAAS,WAAa,aACtBA,EAAS,YAAc,cAIhB,MAAMe,GAAUvL,EAAO,MACNA,EAAO,GAAM,EAC9B,MAAMwL,GAAKxL,EAAO,KAAK,IACXA,EAAO,KAAK,GAAK,CAAI,EAEjC,MAAMyL,GAAMhL,EAAW+J,EAAUA,EAAS,GAAG,EACvCkB,GAAMjL,EAAW+J,EAAUA,EAAS,GAAG,EACvCmB,GAASlL,EAAW+J,EAAUA,EAAS,MAAM,EAE7CoB,GAAUnL,EAAW+J,EAAUA,EAAS,OAAO,EAC/CqB,GAAUpL,EAAW+J,EAAUA,EAAS,OAAO,EAC/CsB,GAAMrL,EAAW+J,EAAUA,EAAS,GAAG,EACvCuB,GAAOtL,EAAW+J,EAAUA,EAAS,IAAI,EACzCwB,GAAMvL,EAAW+J,EAAUA,EAAS,GAAG,EACvCyB,GAAOxL,EAAW+J,EAAUA,EAAS,IAAI,EACzC0B,GAAOzL,EAAW+J,EAAUA,EAAS,IAAI,EACzC2B,GAAc1L,EAAW+J,EAAUA,EAAS,YAAY,EACxD4B,GAAQ3L,EAAW+J,EAAUA,EAAS,KAAK,EAC3C6B,GAAO5L,EAAW+J,EAAUA,EAAS,IAAI,EACzCa,GAAY5K,EAAW+J,EAAUA,EAAS,SAAS,EACnD8B,GAAQ7L,EAAW+J,EAAUA,EAAS,KAAK,EAC3C+B,GAAM9L,EAAW+J,EAAUA,EAAS,GAAG,EACvCgC,GAAM/L,EAAW+J,EAAUA,EAAS,GAAG,EACvCiC,GAAMhM,EAAW+J,EAAUA,EAAS,GAAG,EACvCkC,GAAOjM,EAAW+J,EAAUA,EAAS,IAAI,EACzCmC,GAAOlM,EAAW+J,EAAUA,EAAS,IAAI,EACzCoC,GAAOnM,EAAW+J,EAAUA,EAAS,IAAI,EACzCc,GAAM7K,EAAW+J,EAAUA,EAAS,GAAG,EACvCqC,GAAOpM,EAAW+J,EAAUA,EAAS,IAAI,EACzC7N,GAAS8D,EAAW+J,EAAUA,EAAS,MAAM,EAC7CsC,GAASrM,EAAW+J,EAAUA,EAAS,MAAM,EAC7CuC,GAAWtM,EAAW+J,EAAUA,EAAS,SAAS,EAClDwC,GAAOvM,EAAW+J,EAAUA,EAAS,IAAI,EACzCyC,GAAOxM,EAAW+J,EAAUA,EAAS,IAAI,EACzC0C,GAAQzM,EAAW+J,EAAUA,EAAS,KAAK,EAC3C2C,GAAa1M,EAAW+J,EAAUA,EAAS,UAAU,EACrD4C,GAAQ3M,EAAW+J,EAAUA,EAAS,KAAK,EAC3C6C,GAAS5M,EAAW+J,EAAUA,EAAS,MAAM,EACnC/J,EAAW+J,EAAUA,EAAS,OAAU,EACxD,MAAM8C,GAAY7M,EAAW+J,EAAUA,EAAS,SAAS,EAEnD+C,GAAQ9M,EAAW+J,EAAUA,EAAS,KAAK,EAC3CgD,GAAM/M,EAAW+J,EAAUA,EAAS,GAAG,EACvCiD,GAAMhN,EAAW+J,EAAUA,EAAS,GAAG,EACvCla,GAAMmQ,EAAW+J,EAAUA,EAAS,GAAG,EACvCkD,GAAOjN,EAAW+J,EAAUA,EAAS,IAAI,EACzCmD,GAAUlN,EAAW+J,EAAUA,EAAS,OAAO,EAC/CoD,GAAWnN,EAAW+J,EAAUA,EAAS,QAAQ,EACjDqD,GAAapN,EAAW+J,EAAUA,EAAS,UAAU,EACrDsD,GAAMrN,EAAW+J,EAAUA,EAAS,GAAG,EACvCuD,GAAQtN,EAAW+J,EAAUA,EAAS,KAAK,EAC3CwD,GAAMvN,EAAW+J,EAAUA,EAAS,GAAG,EACvCyD,GAAOxN,EAAW+J,EAAUA,EAAS,IAAK,CAAC,EAC3C0D,GAAOzN,EAAW+J,EAAUA,EAAS,IAAK,CAAC,EAC3C2D,GAAO1N,EAAW+J,EAAUA,EAAS,IAAK,CAAC,EAC3C4D,GAAqB3N,EAAW+J,EAAUA,EAAS,mBAAmB,EAEtE6D,GAAS9xB,GAAO+sB,EAAKuD,GAAMtwB,CAAG,EAAEyxB,GAAK1C,GAAK/uB,CAAG,EAAE,EAAM,CAAK,CAAA,EAC1D+xB,GAAa/xB,GAAOuxB,GAAKvxB,EAAGA,CAAC,EAC7BgyB,GAAM9N,EAAW+J,EAAUA,EAAS,GAAG,EACvCgE,GAAQ,CAAEnxB,EAAOoxB,EAAM,EAAGC,EAAO,IAAOhR,EAAY,IAAI8M,EAAUA,EAAS,MAAO9M,EAAYrgB,CAAK,EAAIqgB,EAAY+Q,CAAG,EAAI/Q,EAAYgR,CAAM,CAAA,GAC5IC,GAAatxB,GAAWmxB,GAAOnxB,CAAK,EACpCuxB,GAAUnO,EAAW+J,EAAUA,EAAS,OAAO,EAC/CqE,GAAapO,EAAW+J,EAAUA,EAAS,UAAU,EACrDsE,GAAcrO,EAAW+J,EAAUA,EAAS,WAAW,EAEvDuE,GAAa,CAAEC,EAAGC,EAAIC,IAAQX,GAAKU,EAAIC,EAAIF,GAC3CG,GAAoB,CAAEhjB,EAAGsiB,EAAKC,IAAUG,GAAYJ,EAAKC,EAAMviB,GAE5E8Q,EAAgB,MAAOwO,IACvBxO,EAAgB,MAAOyO,IACvBzO,EAAgB,SAAU0O,IAE1B1O,EAAgB,UAAW2O,IAC3B3O,EAAgB,UAAW4O,IAC3B5O,EAAgB,MAAO6O,IACvB7O,EAAgB,OAAQ8O,IACxB9O,EAAgB,MAAO+O,IACvB/O,EAAgB,OAAQgP,IACxBhP,EAAgB,OAAQiP,IACxBjP,EAAgB,cAAekP,IAC/BlP,EAAgB,QAASmP,IACzBnP,EAAgB,OAAQoP,IACxBpP,EAAgB,YAAaoO,IAC7BpO,EAAgB,QAASqP,IACzBrP,EAAgB,MAAOsP,IACvBtP,EAAgB,MAAOuP,IACvBvP,EAAgB,MAAOwP,IACvBxP,EAAgB,OAAQyP,IACxBzP,EAAgB,OAAQ0P,IACxB1P,EAAgB,OAAQ2P,IACxB3P,EAAgB,MAAOqO,IACvBrO,EAAgB,OAAQ4P,IACxB5P,EAAgB,SAAUN,IAC1BM,EAAgB,WAAYqR,IAC5BrR,EAAgB,SAAU6P,IAC1B7P,EAAgB,WAAY8P,IAC5B9P,EAAgB,OAAQ+P,IACxB/P,EAAgB,OAAQgQ,IACxBhQ,EAAgB,QAASiQ,IACzBjQ,EAAgB,aAAckQ,IAC9BlQ,EAAgB,QAASmQ,IACzBnQ,EAAgB,SAAUoQ,IAC1BpQ,EAAgB,QAASsQ,IACzBtQ,EAAgB,MAAOuQ,IACvBvQ,EAAgB,MAAOwQ,IACvBxQ,EAAgB,MAAO3M,IACvB2M,EAAgB,OAAQyQ,IACxBzQ,EAAgB,UAAW0Q,IAC3B1Q,EAAgB,WAAY2Q,IAC5B3Q,EAAgB,MAAO6Q,IACvB7Q,EAAgB,QAAS8Q,IACzB9Q,EAAgB,MAAO+Q,IACvB/Q,EAAgB,OAAQgR,IACxBhR,EAAgB,OAAQiR,IACxBjR,EAAgB,OAAQkR,IACxBlR,EAAgB,qBAAsBmR,IACtCnR,EAAgB,MAAO8R,IACvB9R,EAAgB,QAASuR,IACzBvR,EAAgB,UAAW2R,IAC3B3R,EAAgB,aAAckS,IAC9BlS,EAAgB,cAAe6R,IAC/B7R,EAAgB,aAAc4Q,IAC9B5Q,EAAgB,WAAY0R,IAC5B1R,EAAgB,OAAQoR,IACxBpR,EAAgB,YAAaqQ,IAE7B5S,EAAc,WAAY8P,CAAU,EClYpC,MAAM4E,GAAqBpR,EAASV,GAAY,CAE/C,KAAM,CAAE,MAAAjgB,CAAO,EAAGigB,EACZ,CAAE,IAAA+R,CAAK,EAAGhyB,EAEVd,EAAI8yB,EAAI,IAAK,WAAY,EAAG,IAAK,WAAc,EAAC,IAAK,KACrD7yB,EAAI6yB,EAAI,IAAK,WAAY,EACzB7Q,EAAS6Q,EAAI,cAAe,MAAO,EAEnCC,EAAYf,GAAKhyB,EAAGC,EAAGgiB,CAAM,EAEnC,OAAOkD,EAAM4N,EAAWjyB,EAAM,CAAC,CAEhC,GAEMkyB,GAAqBvR,EAASV,GAAY,CAE/C,KAAM,CAAE,MAAAjgB,CAAO,EAAGigB,EACZ,CAAE,IAAA+R,CAAK,EAAGhyB,EAEVd,EAAI8yB,EAAI,IAAK,MAAO,EAAG,IAAK,KAAO,EAAC,IAAK,MACzC7yB,EAAI6yB,EAAI,IAAK,KAAK,EAClB7Q,EAAS6Q,EAAI,cAAe,QAAS,EAErCC,EAAYf,GAAKhyB,EAAGC,EAAGgiB,CAAM,EAEnC,OAAOkD,EAAM4N,EAAWjyB,EAAM,CAAC,CAEhC,GAEMmyB,GAAwBC,GAAgB,CAE7C,IAAI3qB,EAAS,KAEb,OAAK2qB,IAAeC,GAEnB5qB,EAAS,SAEE2qB,IAAeE,KAE1B7qB,EAAS,QAIHA,CAER,EAEM8qB,GAAY,CAAE5M,EAAQD,IAEpByM,GAAqBxM,CAAQ,EAAG,KAAOwM,GAAqBzM,CAAM,EAI1E,MAAM8M,WAAuBjV,CAAS,CAErC,YAAa9V,EAAQwS,EAAO,CAE3B,MAAO,MAAM,EAEb,KAAK,OAASxS,EACd,KAAK,KAAOwS,CAEZ,CAED,OAAQ,CAEP,KAAM,CAAE,OAAAxS,EAAQ,KAAAwS,CAAM,EAAG,KAEzB,OAAKxS,IAAW+qB,GAAe,iBACvBvY,EAEDwY,GAAShrB,CAAQ,EAAE,CAAE,MAAOwS,CAAM,CAAA,CAEzC,CAEF,CAEAuY,GAAe,iBAAmB,iBAClCA,GAAe,eAAiB,eAChCA,GAAe,eAAiB,eAEhC,MAAMC,GAAU,CACf,CAAED,GAAe,gBAAkBN,GACnC,CAAEM,GAAe,gBAAkBT,EACpC,EAIaW,GAAqB,CAAEzY,EAAMmY,IAAgB/R,EAAY,IAAImS,GAAgBD,GAAWF,GAAsBD,CAAY,EAAE/R,EAAYpG,CAAI,CAAI,CAAA,EAChJ0Y,GAAqB,CAAE1Y,EAAMmY,IAAgB/R,EAAY,IAAImS,GAAgBD,GAAWH,EAAYC,EAAsB,EAAEhS,EAAYpG,CAAI,CAAI,CAAA,EAEhJ2Y,GAAexP,EAAWoP,GAAgBA,GAAe,cAAc,EACvEK,GAAezP,EAAWoP,GAAgBA,GAAe,cAAc,EAEpF5S,EAAgB,eAAgBgT,IAChChT,EAAgB,eAAgBiT,IAChCjT,EAAgB,qBAAsB8S,IACtC9S,EAAgB,qBAAsB+S,IAEtCtV,EAAc,iBAAkBmV,EAAgB,ECxGhD,MAAMM,WAAuBtX,CAAK,CAEjC,YAAagC,EAAU,GAAI9B,EAAW,OAAS,CAE9C,MAAOA,CAAQ,EAEf,KAAK,QAAU8B,CAEf,CAED,SAAU3B,EAASld,EAAS,CAE3B,MAAM6b,EAAO,KAAK,YAAaqB,CAAO,EAChC2B,EAAU,KAAK,QAErB,GAAKhD,IAAS,OAEbqB,EAAQ,gBAAiB2B,OAIzB,QAAO3B,EAAQ,OAAQ,KAAM2B,CAAO,KAAOhD,EAAM7b,EAIlD,CAEF,CAIO,MAAMo0B,GAAa3P,EAAW0P,IAErCzV,EAAc,iBAAkByV,EAAgB,EC/BhD,MAAME,WAAwB3I,EAAY,CAEzC,YAAaY,EAAc,CAE1B,MAAO,CAAC,EAER,KAAK,YAAcA,EAEnB,KAAK,WAAazR,EAAe,KAEjC,CAED,IAAI,SAAU,CAEb,OAAO,KAAK,YAAY,KAExB,CAED,QAAS,CAER,MAAMyZ,EAAU,KAAK,QACf7V,EAAS6V,EAAQ,OACjBC,EAAU9V,GAAUA,EAAO,OAAS,EAAUA,EAAQ,CAAG,GAAIA,EAAQ,CAAC,EAAG,OAAWA,EAAQ,CAAG,EAAK6V,EAAQ,MAElH,GAAKC,GAASA,EAAM,QAAU,OAAY,CAEzC,KAAM,CAAE,MAAAh1B,EAAO,OAAAi1B,CAAQ,EAAGD,EAE1B,KAAK,MAAQ,KAAK,KAAM,KAAK,IAAKh1B,EAAOi1B,CAAM,EAE/C,CAED,CAEF,CAIO,MAAMC,GAAchQ,EAAW4P,IAEtC3V,EAAc,kBAAmB2V,EAAiB,EClClD,MAAMK,WAAoBhJ,EAAY,CAErC,YAAarqB,EAAOszB,EAAS,KAAMpI,EAAY,KAAO,CAErD,MAAOlrB,CAAK,EAEZ,KAAK,cAAgB,GAErB,KAAK,OAASszB,EACd,KAAK,UAAYpI,EACjB,KAAK,YAAc,KACnB,KAAK,UAAY,KACjB,KAAK,SAAW,KAEhB,KAAK,QAAU,GACf,KAAK,aAAe,GACpB,KAAK,WAAa1R,EAAe,KAEjC,KAAK,cAAgB,KAErB,KAAK,OAASxZ,EAEd,KAAK,gBAAiBszB,IAAW,KAEjC,CAED,IAAI,MAAOtzB,EAAQ,CAEb,KAAK,cAET,KAAK,cAAc,MAAQA,EAI3B,KAAK,OAASA,CAIf,CAED,IAAI,OAAQ,CAEX,OAAO,KAAK,cAAgB,KAAK,cAAc,MAAQ,KAAK,MAE5D,CAED,gBAA8B,CAE7B,OAAO,KAAK,MAAM,IAElB,CAED,aAA2B,CAE1B,OAAK,KAAK,MAAM,iBAAmB,GAAc,QAE5C,KAAK,MAAM,OAASuzB,GAEjB,QAEI,KAAK,MAAM,OAASC,GAExB,QAID,MAEP,CAED,cAA4B,CAE3B,MAAO,SAEP,CAED,cAAe,CAEd,OAAOzI,GAAI,KAAK,MAAM,OAAO,CAE7B,CAED,iBAA6B,CAE5B,OAAO,KAAK,KAEZ,CAED,iBAAkBuI,EAAS,CAE1B,MAAML,EAAU,KAAK,MAErB,OAAOrI,EAASqI,EAAQ,QAAS,IAAKhP,EAAMqP,EAAQ,EAAK,EAAC,EAE1D,CAED,gBAAiBtzB,EAAQ,CAExB,YAAK,aAAeA,EACpB,KAAK,WAAaA,EAAQwZ,EAAe,MAAQA,EAAe,KAEzD,IAEP,CAED,QAASqC,EAASyX,EAAS,CAE1B,MAAML,EAAU,KAAK,MAErB,OAAKpX,EAAQ,QAAO,IAAQoX,EAAQ,wBAA0B,IAAQA,EAAQ,uBAAyB,IAAQA,EAAQ,iBAAmB,MAEzIK,EAASA,EAAO,KAAMA,EAAO,EAAE,SAAQ,IAIjCA,CAEP,CAED,MAAOzX,EAAU,CAEhB,MAAMQ,EAAaR,EAAQ,kBAAmB,IAAI,EAIlD,IAAIyX,EAAS,KAAK,QAEXA,IAAW,MAAQzX,EAAQ,QAAQ,iBAAmB,KAAUA,EAAQ,QAAQ,QAEtFyX,EAASzX,EAAQ,QAAQ,MAAO,IAAI,GAI9ByX,IAASA,EAAS,KAAK,aAAY,GAErC,KAAK,eAAiB,KAE1BA,EAAS,KAAK,iBAAkBA,IAIjCA,EAAS,KAAK,QAASzX,EAASyX,CAAM,EAItC,IAAIpI,EAAY,KAAK,UAEhBA,IAAc,MAAQrP,EAAQ,QAAQ,kBAE1CqP,EAAYrP,EAAQ,QAAQ,gBAAiB,IAAI,GAMlDQ,EAAW,OAASiX,EACpBjX,EAAW,UAAY6O,EACvB7O,EAAW,YAAc,KAAK,YAC9BA,EAAW,SAAW,KAAK,SAC3BA,EAAW,UAAY,KAAK,SAE5B,CAED,WAAYR,EAASyX,EAAS,CAE7B,OAAOA,EAAO,MAAOzX,EAAS,KAAK,UAAY,GAAO,OAAS,QAE/D,CAED,gBAAiBA,EAASsP,EAAiBsI,EAAWC,EAAcC,EAAcC,EAAgBC,EAAc,CAE/G,MAAMZ,EAAU,KAAK,MAErB,IAAIzV,EAEJ,OAAKkW,EAEJlW,EAAU3B,EAAQ,qBAAsBoX,EAAS9H,EAAiBsI,EAAWC,EAAcC,GAEhFE,EAEXrW,EAAU3B,EAAQ,oBAAqBoX,EAAS9H,EAAiBsI,EAAWI,EAAaF,GAE9EC,EAEXpW,EAAU3B,EAAQ,uBAAwBoX,EAAS9H,EAAiBsI,EAAWG,EAAgBD,GAEpF,KAAK,UAAY,GAE5BnW,EAAU3B,EAAQ,oBAAqBoX,EAAS9H,EAAiBsI,EAAWE,GAI5EnW,EAAU3B,EAAQ,gBAAiBoX,EAAS9H,EAAiBsI,EAAWE,GAIlEnW,CAEP,CAED,SAAU3B,EAASld,EAAS,CAE3B,MAAM0d,EAAaR,EAAQ,kBAAmB,IAAI,EAE5CoX,EAAU,KAAK,MAErB,GAAK,CAAEA,GAAWA,EAAQ,YAAc,GAEvC,MAAM,IAAI,MAAO,yCAIlB,MAAM9H,EAAkB,MAAM,SAAUtP,EAAS,UAAU,EAE3D,GAAKld,IAAW,UAEf,OAAOwsB,EAAkB,WAEnB,GAAKtP,EAAQ,YAAald,GAEhC,OAAOwsB,EAED,CAEN,MAAMlP,EAAWJ,EAAQ,gBAAiB,IAAI,EAE9C,IAAI6B,EAAezB,EAAS,aAE5B,GAAKyB,IAAiB,OAAY,CAEjC,KAAM,CAAE,OAAA4V,EAAQ,UAAApI,EAAW,YAAA4I,EAAa,UAAAC,EAAW,SAAAC,CAAU,EAAG3X,EAE1DoX,EAAY,KAAK,WAAY5X,EAASyX,CAAM,EAC5CI,EAAexI,EAAYA,EAAU,MAAOrP,EAAS,OAAS,EAAG,KACjE8X,EAAeI,EAAYA,EAAU,MAAOlY,EAAS,KAAO,EAAG,KAC/D+X,EAAiBE,EAAcA,EAAY,MAAOjY,EAAS,OAAS,EAAG,KACvEgY,EAAcG,EAAW,CAAEA,EAAU,CAAG,EAAC,MAAOnY,EAAS,MAAQ,EAAEmY,EAAU,CAAC,EAAG,MAAOnY,EAAS,MAAM,CAAI,EAAG,KAE9G4B,EAAU5B,EAAQ,eAAgB,IAAI,EAE5C6B,EAAe7B,EAAQ,gBAAiB4B,GAExC,MAAMD,EAAU,KAAK,gBAAiB3B,EAASsP,EAAiBsI,EAAWC,EAAcC,EAAcC,EAAgBC,CAAW,EAElIhY,EAAQ,gBAAiB,GAAG6B,CAAY,MAAMF,CAAO,IAErDvB,EAAS,QAAUuB,EACnBvB,EAAS,aAAeyB,CAExB,CAED,IAAIF,EAAUE,EACd,MAAMhC,EAAW,KAAK,YAAaG,CAAO,EAE1C,OAAKA,EAAQ,wBAAyBoX,KAErCzV,EAAUmV,GAAoBI,GAAYvV,EAAS9B,CAAU,EAAEuX,EAAQ,UAAU,EAAG,MAAOpX,CAAS,EAAC,MAAOA,EAASH,CAAQ,GAIvHG,EAAQ,OAAQ2B,EAAS9B,EAAU/c,CAAM,CAEhD,CAED,CAED,WAAYqB,EAAQ,CAEnB,YAAK,QAAUA,EAER,IAEP,CAED,YAAa,CAEZ,OAAO,KAAK,OAEZ,CAID,GAAIszB,EAAS,CAEZ,MAAMrI,EAAc,KAAK,QACzB,OAAAA,EAAY,OAASqI,EACrBrI,EAAY,cAAgB,KAErB5K,EAAY4K,EAEnB,CAED,KAAMC,EAAY,CAEjB,MAAMD,EAAc,KAAK,QACzB,OAAAA,EAAY,UAAYC,EAAU,IAAKkI,GAAanI,CAAW,GAC/DA,EAAY,cAAgB,KAErB5K,EAAY4K,EAEnB,CAED,MAAOC,EAAY,CAElB,MAAMD,EAAc,KAAK,QACzB,OAAAA,EAAY,UAAYC,EACxBD,EAAY,cAAgB,KAErBA,CAEP,CAED,KAAMC,EAAY,CAEjB,OAAOE,GAAa,KAAMF,EAE1B,CAED,QAAS4I,EAAc,CAEtB,MAAM7I,EAAc,KAAK,QACzB,OAAAA,EAAY,YAAc5K,EAAYyT,GACtC7I,EAAY,cAAgB,KAErB5K,EAAY4K,EAEnB,CAED,KAAMgJ,EAAWC,EAAY,CAE5B,MAAMjJ,EAAc,KAAK,QACzB,OAAAA,EAAY,SAAW,CAAE5K,EAAY4T,CAAS,EAAI5T,EAAY6T,CAAS,GAEvEjJ,EAAY,cAAgB,KAErB5K,EAAY4K,EAEnB,CAED,MAAO8I,EAAY,CAElB,MAAM9I,EAAc,KAAK,QACzB,OAAAA,EAAY,UAAY5K,EAAY0T,GACpC9I,EAAY,cAAgB,KAErB5K,EAAY4K,EAEnB,CAID,UAAWjO,EAAO,CAEjB,MAAM,UAAWA,GAEjBA,EAAK,MAAQ,KAAK,MAAM,OAAQA,EAAK,IAAM,EAAC,IAE5C,CAED,YAAaA,EAAO,CAEnB,MAAM,YAAaA,GAEnB,KAAK,MAAQA,EAAK,KAAK,SAAUA,EAAK,MAEtC,CAED,QAAS,CAER,MAAMiW,EAAU,KAAK,MAEhBA,EAAQ,mBAAqB,IAEjCA,EAAQ,aAAY,CAIrB,CAED,OAAQ,CAEP,MAAMkB,EAAU,IAAI,KAAK,YAAa,KAAK,MAAO,KAAK,OAAQ,KAAK,WACpE,OAAAA,EAAQ,QAAU,KAAK,QAEhBA,CAEP,CAEF,CAIO,MAAMlB,GAAU7P,EAAWiQ,IACrBe,GAAc,IAAK3Z,IAAYwY,GAAS,GAAGxY,GAAS,WAAY,IAM7EmF,EAAgB,UAAWqT,IAG3B5V,EAAc,cAAegW,EAAa,EC1Z1C,MAAMgB,WAAmBhK,EAAY,CAEpC,YAAarqB,EAAOs0B,EAAYC,EAAc,EAAI,CAEjD,MAAOv0B,EAAOs0B,GAEd,KAAK,aAAe,GAEpB,KAAK,WAAaA,EAClB,KAAK,YAAcC,CAEnB,CAED,eAAgB1Y,EAAU,CAEzB,OAAO,KAAK,YAAaA,EAEzB,CAED,cAA4B,CAE3B,MAAO,QAEP,CAEF,CAIO,MAAM2Y,GAAS,CAAEx0B,EAAOwa,EAAMrF,IAAWkL,EAAY,IAAIgU,GAAYr0B,EAAOwa,EAAMrF,CAAO,CAAA,EAEhGkI,EAAc,aAAcgX,EAAY,EC5BxC,MAAMI,WAA4B9W,EAAiB,CAElD,YAAaxC,EAAayC,EAAY,CAErC,MAAOzC,EAAayC,GAEpB,KAAK,yBAA2B,EAEhC,CAED,YAAa/B,EAAU,CAEtB,OAAO,KAAK,KAAK,eAAgBA,CAAO,CAExC,CAED,SAAUA,EAAU,CAEnB,MAAM2B,EAAU,MAAM,SAAU3B,CAAO,EACjCrB,EAAO,KAAK,cAElB,OAAOqB,EAAQ,OAAQ2B,EAAS,OAAQhD,CAAI,CAE5C,CAEF,CAEA,MAAMka,WAAqBL,EAAW,CAErC,YAAar0B,EAAO20B,EAAc,KAAO,CAExC,MAAO,KAAM,QAEb,KAAK,MAAQ30B,EACb,KAAK,YAAc20B,EAEnB,KAAK,aAAe,KACpB,KAAK,eAAiB,EAEtB,KAAK,WAAanb,EAAe,OAEjC,KAAK,kBAAoB,EAEzB,CAED,gBAAiB,CAEhB,OAAO,KAAK,aAAe,KAAK,YAEhC,CAED,kBAAmB,CAElB,OAAO,KAAK,cAEZ,CAED,QAAoB,CAEnB,KAAM,CAAE,MAAAnW,EAAO,MAAArD,CAAO,EAAG,KAEnB40B,EAAgB,KAAK,mBACrBD,EAAc,KAAK,iBAEzB,GAAKC,IAAkB,EAEtB,QAAU1xB,EAAI,EAAGA,EAAIG,EAAM,OAAQH,IAAO,CAEzC,MAAM8Y,EAAQ9Y,EAAI,EAElBlD,EAAOgc,CAAK,EAAK3Y,EAAOH,CAAC,CAEzB,SAEUyxB,IAAgB,QAE3B,QAAUzxB,EAAI,EAAGA,EAAIG,EAAM,OAAQH,IAAO,CAEzC,MAAM8Y,EAAQ9Y,EAAI,EACZ2xB,EAASxxB,EAAOH,GAEtBlD,EAAOgc,CAAK,EAAK6Y,EAAO,EACxB70B,EAAOgc,EAAQ,GAAM6Y,EAAO,EAC5B70B,EAAOgc,EAAQ,CAAC,EAAK6Y,EAAO,GAAK,CAGjC,KAID,SAAU3xB,EAAI,EAAGA,EAAIG,EAAM,OAAQH,IAAO,CAEzC,MAAM8Y,EAAQ9Y,EAAI,EACZ2xB,EAASxxB,EAAOH,GAEtBlD,EAAOgc,CAAK,EAAK6Y,EAAO,EACxB70B,EAAOgc,EAAQ,GAAM6Y,EAAO,EAC5B70B,EAAOgc,EAAQ,CAAC,EAAK6Y,EAAO,GAAK,EACjC70B,EAAOgc,EAAQ,CAAC,EAAK6Y,EAAO,GAAK,CAEjC,CAIF,CAED,MAAOhZ,EAAU,CAEhB,MAAMyD,EAAS,KAAK,MAAM,OAE1B,KAAK,aAAe,KAAK,cAAgB,KAAOjF,GAAc,KAAK,MAAO,CAAC,GAAO,KAAK,YACvF,KAAK,eAAiBwB,EAAQ,cAAe,KAAK,YAAY,EAE9D,IAAIiZ,EAAY,aAEhB,OAAK,KAAK,aAAa,OAAQ,CAAC,IAAO,IAAMA,EAAY,WAC/C,KAAK,aAAa,OAAQ,CAAC,IAAO,MAAMA,EAAY,aAE9D,KAAK,MAAQ,IAAIA,EAAWxV,EAAS,CAAC,EACtC,KAAK,YAAcA,EACnB,KAAK,WAAazD,EAAQ,oBAAqB,OAAQA,EAAQ,iBAAkB,KAAK,YAAY,GAE3F,MAAM,MAAOA,EAEpB,CAED,QAAS+B,EAAY,CAEpB,OAAOyC,EAAY,IAAIoU,GAAqB,KAAMpU,EAAYzC,CAAW,CAAA,EAEzE,CAEF,CAIO,MAAMmX,GAAW,CAAEj2B,EAAQ4c,IAAc2E,EAAY,IAAIqU,GAAc51B,EAAQ4c,CAAQ,GAE9F2B,EAAc,eAAgBqX,EAAc,ECxI5C,MAAMM,WAA6BrX,EAAiB,CAEnD,YAAasX,EAAerX,EAAY,CAEvC,MAAOqX,EAAerX,GAEtB,KAAK,cAAgBqX,EAErB,KAAK,uBAAyB,EAE9B,CAED,aAAc,CAEb,OAAO,KAAK,cAAc,WAE1B,CAED,SAAUpZ,EAAU,CAEnB,MAAM2B,EAAU,MAAM,SAAU3B,CAAO,EACjCiZ,EAAY,KAAK,cAAc,YAAW,EAC1CH,EAAc,KAAK,cAEzB,OAAO9Y,EAAQ,OAAQ2B,EAASsX,EAAWH,CAAW,CAEtD,CAEF,CAEA,MAAMO,WAAsB1Z,CAAK,CAEhC,YAAa1B,EAAUqb,EAAaxb,EAAS,KAAMxE,EAAQ,KAAO,CAEjE,QAEA,KAAK,SAAW2E,EAChB,KAAK,YAAcqb,EACnB,KAAK,OAASxb,EACd,KAAK,MAAQxE,EAEb,KAAK,WAAa2E,EAAS,MAAO,GAAG,EACrC,KAAK,UAAY,KACjB,KAAK,KAAO,KAEZ,KAAK,WAAaN,EAAe,MAEjC,CAED,QAASoE,EAAY,CAEpB,OAAOyC,EAAY,IAAI2U,GAAsB,KAAM3U,EAAYzC,CAAW,CAAA,EAE1E,CAED,YAAauX,EAAc,CAE1B,IAAIlb,EAAO,KAEN,KAAK,QAAU,KAEnBA,EAAOua,GAAQ,KAAMW,EAAa,KAAK,KAAK,EAEjC,MAAM,QAAS,KAAK,sBAAuB,CAAA,EAEtDlb,EAAO8a,GAAU,KAAMI,GAEZA,IAAgB,UAE3Blb,EAAOgZ,GAAS,MAIhBhZ,EAAO2Q,EAAS,KAAMuK,GAIvB,KAAK,KAAOlb,CAEZ,CAED,YAAa4B,EAAU,CAEtB,OAAK,KAAK,OAAS,MAElB,KAAK,YAAW,EAIV,KAAK,KAAK,YAAaA,CAAO,CAErC,CAED,sBAAuBlC,EAAS,KAAK,UAAY,CAEhD,KAAM,CAAE,WAAA0C,CAAY,EAAG,KAEvB,IAAIrc,EAAQ2Z,EAAQ0C,EAAY,CAAG,CAAA,EAEnC,QAAUnZ,EAAI,EAAGA,EAAImZ,EAAW,OAAQnZ,IAEvClD,EAAQA,EAAOqc,EAAYnZ,CAAG,CAAA,EAI/B,OAAOlD,CAEP,CAED,gBAAiBo1B,EAAQ,CAExB,YAAK,UAAY,KAAK,SAAW,KAAO,KAAK,OAASA,EAAM,OAErD,KAAK,SAEZ,CAED,OAAQ,CAEP,YAAK,YAAW,EAET,KAAK,IAEZ,CAED,QAAoB,CAEnB,KAAK,YAAW,CAEhB,CAED,aAAc,CAER,KAAK,OAAS,MAAO,KAAK,YAAa,KAAK,aAEjD,MAAMp1B,EAAQ,KAAK,wBAEd,MAAM,QAASA,GAEnB,KAAK,KAAK,MAAQA,EAIlB,KAAK,KAAK,MAAQA,CAInB,CAEF,CAIO,MAAMq1B,GAAY,CAAE3qB,EAAM8P,EAAMb,IAAY0G,EAAY,IAAI6U,GAAexqB,EAAM8P,EAAMb,CAAQ,CAAA,EACzF2b,GAAkB,CAAE5qB,EAAM8P,EAAMrF,EAAOwE,IAAY0G,EAAY,IAAI6U,GAAexqB,EAAM8P,EAAMb,EAAQxE,CAAO,CAAA,EAE1HkI,EAAc,gBAAiB6X,EAAe,EC/J9C,MAAMK,WAA8BL,EAAc,CAEjD,YAAapb,EAAU6T,EAAW6H,EAAW,KAAO,CAEnD,MAAO1b,EAAU6T,EAAW6H,GAE5B,KAAK,SAAWA,CAIhB,CAUD,gBAAiBJ,EAAQ,CAExB,YAAK,UAAY,KAAK,WAAa,KAAO,KAAK,SAAWA,EAAM,SAEzD,KAAK,SAEZ,CAEF,CAIO,MAAMK,GAAoB,CAAE/qB,EAAM8P,EAAMgb,IAAcnV,EAAY,IAAIkV,GAAuB7qB,EAAM8P,EAAMgb,CAAU,CAAA,EAE1HnY,EAAc,wBAAyBkY,EAAuB,ECpC9D,MAAMG,GAA4BvL,GAAoB,QAAU,EAAC,eAAgB,IAAM,CAEtFuL,GAAY,YAAc,EAE3B,GAEaC,GAA2B/K,EAAS,OAAO,EAAG,MAAO,YAAc,EAAC,SAAU8K,EAAW,EAAG,eAAgB,CAAE,CAAE,OAAAE,CAAQ,IAAMA,EAAO,IAAI,EACzIC,GAA0BjL,EAAS,OAAO,EAAG,MAAO,WAAa,EAAC,SAAU8K,EAAW,EAAG,eAAgB,CAAE,CAAE,OAAAE,CAAQ,IAAMA,EAAO,GAAG,EACtIE,GAA+BlL,EAAS,OAAO,EAAG,MAAO,gBAAkB,EAAC,SAAU8K,IAAc,eAAgB,CAAE,CAAE,OAAAE,CAAM,IAAQ,GAAQ,KAAK,IAAKA,EAAO,IAAM,GAAQ,KAAK,MAClLG,GAAuCnL,EAAS,MAAM,EAAG,MAAO,wBAA0B,EAAC,SAAU8K,EAAW,EAAG,eAAgB,CAAE,CAAE,OAAAE,CAAQ,IAAMA,EAAO,gBAAgB,EAE5KI,GAAiCpL,EAAS,MAAM,EAAG,MAAO,kBAAoB,EAAC,SAAU8K,EAAW,EAAG,eAAgB,CAAE,CAAE,OAAAE,CAAQ,IAAMA,EAAO,kBAAkB,EAGlKK,GAA+BrL,EAAS,IAAI/P,EAAS,EAAG,MAAO,gBAAgB,EAAG,SAAU6a,EAAa,EAAC,eAAgB,CAAE,CAAE,OAAAE,CAAQ,EAAErL,IAAUA,EAAK,MAAM,sBAAuBqL,EAAO,YAAe,ECXvN,MAAMM,UAAqB1a,CAAK,CAE/B,YAAa0F,EAAQgV,EAAa,YAAaC,EAAW,KAAO,CAEhE,QAEA,KAAK,MAAQjV,EACb,KAAK,SAAWiV,EAEhB,KAAK,WAAa3c,EAAe,OAEjC,KAAK,aAAe,IAAI6Q,GAAa,IAAI,CAEzC,CAED,aAAc,CAEb,MAAMnJ,EAAQ,KAAK,MAEnB,GAAKA,IAAUgV,EAAa,cAAgBhV,IAAUgV,EAAa,YAElE,MAAO,OAED,GAAKhV,IAAUgV,EAAa,cAElC,MAAO,OAED,GAAKhV,IAAUgV,EAAa,UAAYhV,IAAUgV,EAAa,eAAiBhV,IAAUgV,EAAa,WAAahV,IAAUgV,EAAa,MAEjJ,MAAO,MAIR,CAED,OAAQ1L,EAAQ,CAEf,MAAM7Q,EAAS,KAAK,SACdyc,EAAc,KAAK,aACnBlV,EAAQ,KAAK,MAEnB,GAAKA,IAAUgV,EAAa,YAE3BE,EAAY,MAAQzc,EAAO,wBAEhBuH,IAAUgV,EAAa,cAElCE,EAAY,MAAQzc,EAAO,qBAEhBuH,IAAUgV,EAAa,aAElCE,EAAY,MAAQzc,EAAO,oBAEhBuH,IAAUgV,EAAa,SAElCE,EAAY,MAAQA,EAAY,OAAS,IAAIvb,GAE7Cub,EAAY,MAAM,sBAAuBzc,EAAO,WAAW,UAEhDuH,IAAUgV,EAAa,MAElCE,EAAY,MAAQA,EAAY,OAAS,IAAIvb,GAE7Cub,EAAY,MAAM,mBAAoBzc,EAAO,WAAW,UAE7CuH,IAAUgV,EAAa,UAElCE,EAAY,MAAQA,EAAY,OAAS,IAAIvb,GAE7ClB,EAAO,kBAAmByc,EAAY,eAE3BlV,IAAUgV,EAAa,cAAgB,CAElD,MAAMN,EAASpL,EAAM,OAErB4L,EAAY,MAAQA,EAAY,OAAS,IAAIvb,GAC7Cub,EAAY,MAAM,sBAAuBzc,EAAO,WAAW,EAE3Dyc,EAAY,MAAM,aAAcR,EAAO,kBAAkB,CAEzD,CAED,CAED,SAAU/Z,EAAU,CAEnB,MAAMqF,EAAQ,KAAK,MAEnB,OAAKA,IAAUgV,EAAa,cAAgBhV,IAAUgV,EAAa,YAElE,KAAK,aAAa,SAAW,OAElBhV,IAAUgV,EAAa,cAElC,KAAK,aAAa,SAAW,QAElBhV,IAAUgV,EAAa,UAAYhV,IAAUgV,EAAa,eAAiBhV,IAAUgV,EAAa,WAAahV,IAAUgV,EAAa,SAEjJ,KAAK,aAAa,SAAW,QAIvB,KAAK,aAAa,MAAOra,CAAO,CAEvC,CAED,UAAWmB,EAAO,CAEjB,MAAM,UAAWA,GAEjBA,EAAK,MAAQ,KAAK,KAElB,CAED,YAAaA,EAAO,CAEnB,MAAM,YAAaA,GAEnB,KAAK,MAAQA,EAAK,KAElB,CAEF,CAEAkZ,EAAa,YAAc,aAC3BA,EAAa,cAAgB,eAC7BA,EAAa,aAAe,cAC5BA,EAAa,SAAW,WACxBA,EAAa,MAAQ,QACrBA,EAAa,cAAgB,eAC7BA,EAAa,UAAY,YAIM9S,EAAW8S,EAAcA,EAAa,SAAY,EACjD9S,EAAW8S,EAAcA,EAAa,WAAc,EAClD9S,EAAW8S,EAAcA,EAAa,aAAgB,EACvD9S,EAAW8S,EAAcA,EAAa,YAAe,EAC/E,MAAMG,GAAiBjT,EAAW8S,EAAcA,EAAa,QAAQ,EACjD9S,EAAW8S,EAAcA,EAAa,KAAQ,EAClE,MAAMI,GAAqBlT,EAAW8S,EAAcA,EAAa,aAAa,EAErF7Y,EAAc,eAAgB6Y,CAAc,EC/I5C,MAAMK,WAAkBL,CAAa,CAEpC,YAAahV,EAAQqV,GAAU,YAAc,CAE5C,MAAOrV,CAAK,CAEZ,CAED,OAAQsJ,EAAQ,CAEf,KAAK,SAAWA,EAAM,OAEtB,MAAM,OAAQA,EAEd,CAEF,CAI8BnH,EAAekT,GAAWA,GAAU,SAAY,EACvE,MAAMC,GAAkBnT,EAAekT,GAAWA,GAAU,WAAW,EAAG,MAAO,iBAAmB,EAAC,KAAM,mBACrGE,GAAoBpT,EAAekT,GAAWA,GAAU,aAAa,EACrEG,GAAmBrT,EAAekT,GAAWA,GAAU,YAAY,EACnDlT,EAAekT,GAAWA,GAAU,QAAW,EAClDlT,EAAekT,GAAWA,GAAU,KAAQ,EACrClT,EAAekT,GAAWA,GAAU,aAAgB,EAC9E,MAAMI,GAA0B/L,EAAS,IAAI5P,EAAW,EAAC,eAAgB,CAAE,CAAE,OAAArB,CAAQ,EAAE4Q,IAAUA,EAAK,MAAM,KAAM5Q,EAAO,WAAa,EAAC,OAAM,GAEpJ0D,EAAc,YAAakZ,EAAW,EC5B/B,MAAMK,GAA+BvQ,GAAW,SAAU,OAAQpC,EAAM,EAAG,EAAG,CAAC,GACzE4S,GAA4BD,GAAe,MAAO,eAClDE,GAA2B7Q,GAASwQ,GAAkB,IAAKI,EAAW,EAAI,cAAc,EAAG,UAAS,EAAG,MAAO,YAAY,EAC1HE,GAA4B9Q,GAAS6Q,GAAW,mBAAoBd,EAAgB,EAAI,eAAe,EAAG,UAAS,EAAG,MAAO,wBAAwB,EACrJgB,GAAsCld,GAAU,OAAQ,yBACxDmd,GAAuCD,GAAsB,mBAAoBhB,EAAgB,EAAG,YAAY,MAAO,0BACvHkB,GAA+Cpd,GAAU,OAAQ,gCAAkC,ECL1Gqd,GAAiB,IAAI,IAE3B,MAAMC,UAAqB5b,CAAK,CAE/B,YAAa0F,EAAQ,CAEpB,QAEA,KAAK,MAAQA,CAEb,CAED,SAAUpH,EAAUU,EAAO,CAE1B,IAAIP,EAAOkd,GAAe,IAAKrd,CAAQ,EAEvC,OAAKG,IAAS,SAEbA,EAAOwb,GAAmB3b,EAAUU,GAEpC2c,GAAe,IAAKrd,EAAUG,IAIxBA,CAEP,CAED,SAAUH,EAAW,CAEpB,OAAO,KAAK,SAAUA,EAAU,OAAO,CAEvC,CAED,SAAUA,EAAW,CAEpB,OAAO,KAAK,SAAUA,EAAU,OAAO,CAEvC,CAED,WAAYA,EAAW,CAEtB,OAAO,KAAK,SAAUA,IAAa,MAAQ,MAAQA,EAAW,MAAO,UAErE,CAED,MAAO+B,EAAU,CAEhB,MAAM2Z,EAAW3Z,EAAQ,QAAQ,SAC3BqF,EAAQ,KAAK,MAEnB,IAAIjH,EAAO,KAEX,GAAKiH,IAAUkW,EAAa,MAAQ,CAEnC,MAAMC,EAAY,KAAK,SAAUnW,CAAK,EAEjCsU,EAAS,KAAOA,EAAS,IAAI,YAAc,GAE/Cvb,EAAOod,EAAU,IAAK,KAAK,WAAY,KAAK,GAI5Cpd,EAAOod,CAIX,SAAcnW,IAAUkW,EAAa,QAAU,CAE5C,MAAME,EAAc,KAAK,SAAUpW,CAAK,EAEnCsU,EAAS,UAAYA,EAAS,SAAS,YAAc,GAEzDvb,EAAOqd,EAAY,IAAK,KAAK,WAAY,OAAO,GAIhDrd,EAAOqd,CAIX,SAAcpW,IAAUkW,EAAa,kBAE7B5B,EAAS,aAAeA,EAAS,YAAY,YAAc,GAE/Dvb,EAAO,KAAK,WAAY,UAAU,EAAG,EAIrCA,EAAO0I,EAAO,WAIJzB,IAAUkW,EAAa,mBAAqB,CAEvD,MAAMG,EAAoB,KAAK,SAAUrW,CAAK,EAEzCsU,EAAS,YAEbvb,EAAOsd,EAAkB,IAAK,KAAK,WAAYrW,CAAK,EAAG,GAIvDjH,EAAOsd,CAIX,SAAcrW,IAAUkW,EAAa,eAAiB,CAEnD,MAAMI,EAAoB,KAAK,SAAUtW,CAAK,EAEzCsU,EAAS,kBAAoBA,EAAS,iBAAiB,YAAc,GAEzEvb,EAAOud,EAAkB,IAAK,KAAK,WAAYtW,CAAK,EAAG,KAIvDjH,EAAOud,CAIX,SAActW,IAAUkW,EAAa,UAAY,CAE9C,MAAMK,EAAgB,KAAK,SAAUvW,CAAK,EAErCsU,EAAS,cAAgBA,EAAS,aAAa,YAAc,GAEjEvb,EAAOwd,EAAc,IAAK,KAAK,WAAYvW,CAAK,EAAG,GAInDjH,EAAOwd,CAIX,SAAcvW,IAAUkW,EAAa,UAAY,CAE9C,MAAMM,EAAgB,KAAK,SAAUxW,CAAK,EAErCsU,EAAS,cAAgBA,EAAS,aAAa,YAAc,GAEjEvb,EAAOyd,EAAc,IAAK,KAAK,WAAYxW,CAAK,EAAG,GAInDjH,EAAOyd,CAIX,SAAcxW,IAAUkW,EAAa,SAAW,CAE7C,MAAMO,EAAe,KAAK,SAAUzW,CAAK,EAEpCsU,EAAS,aAAeA,EAAS,YAAY,YAAc,GAE/Dvb,EAAO0d,EAAa,IAAK,KAAK,WAAYzW,CAAK,GAI/CjH,EAAO0d,CAIX,SAAczW,IAAUkW,EAAa,OAE7B5B,EAAS,UAEbvb,EAAO,KAAK,WAAY,UAAW,UAAW,KAAK,SAAU,cAAe,MAAM,GAEvEub,EAAS,QAEpBvb,EAAO,KAAK,WAAY,QAAS,EAAE,QAAS,KAAK,SAAU,WAAW,GAItEA,EAAO6c,WAIG5V,IAAUkW,EAAa,UAAY,CAE9C,MAAMQ,EAAgB,KAAK,SAAU1W,CAAK,EAErCsU,EAAS,cAAgBA,EAAS,aAAa,YAAc,GAEjEvb,EAAO2d,EAAc,IAAK,KAAK,WAAY1W,CAAK,EAAG,GAInDjH,EAAO2d,CAIX,SAAc1W,IAAUkW,EAAa,oBAAsB,CAExD,MAAMS,EAAyB,KAAK,SAAU3W,CAAK,EAE9CsU,EAAS,uBAAyBA,EAAS,sBAAsB,YAAc,GAEnFvb,EAAO4d,EAAuB,IAAK,KAAK,WAAY3W,CAAK,EAAG,GAI5DjH,EAAO4d,CAIX,SAAc3W,IAAUkW,EAAa,iBAE7B5B,EAAS,mBAEbvb,EAAO,KAAK,WAAYiH,CAAO,EAAC,UAAW,KAAK,SAAUA,EAAQ,QAAS,MAAQ,CAAA,EAInFjH,EAAO6c,WAIG5V,IAAUkW,EAAa,MAAQ,CAE1C,MAAMU,EAAY,KAAK,SAAU,YAAY,EAAG,IAAK,KAAK,SAAU,OAAO,GAEtEtC,EAAS,eAAiBA,EAAS,cAAc,YAAc,GAEnEvb,EAAO6d,EAAU,IAAK,KAAK,WAAY,YAAY,EAAG,KAItD7d,EAAO6d,CAIX,SAAc5W,IAAUkW,EAAa,gBAAkB,CAEpD,MAAMW,EAAqB,KAAK,SAAU7W,CAAK,EAE1CsU,EAAS,mBAAqBA,EAAS,kBAAkB,YAAc,GAE3Evb,EAAO8d,EAAmB,IAAK,KAAK,WAAY7W,CAAK,EAAG,GAIxDjH,EAAO8d,EAIR9d,EAAOA,EAAK,MAAO,IAAM,CAAG,CAE/B,SAAciH,IAAUkW,EAAa,WAElC,GAAK5B,EAAS,eAAiBA,EAAS,cAAc,YAAc,GAAO,CAE1E,MAAMwC,EAAkB,KAAK,WAAY9W,CAAK,EAG9CjH,EAFsBwK,GAAMwT,GAAyB,EAAGA,GAAyB,EAAGA,GAAyB,EAAE,OAAM,EAAIA,GAAyB,CAAC,EAE9H,IAAKD,EAAgB,GAAG,IAAK,GAAM,IAAKnU,EAAM,CAAK,CAAA,EAAG,UAAS,EAAG,IAAKmU,EAAgB,CAAC,EAEjH,MAEI/d,EAAOge,WAIG/W,IAAUkW,EAAa,sBAAwB,CAE1D,MAAMc,EAA8B7C,GAAW,IAAK,QAASG,EAAS,2BAEtE,GAAKA,EAAS,wBAA0B,CAEvC,MAAM2C,EAA8B9C,GAAW,IAAK,QAASG,EAAS,2BAEtEvb,EAAOie,EAA4B,IAAKC,CAA2B,EAAG,IAAK,KAAK,WAAYjX,CAAK,EAAG,CAAG,EAAC,IAAKiX,CAA2B,CAE5I,MAEIle,EAAOie,CAIX,SAAchX,IAAUkW,EAAa,aAAe,CAEjD,MAAMgB,EAAmB,KAAK,SAAUlX,CAAK,EAExCsU,EAAS,gBAEbvb,EAAOme,EAAiB,IAAK,KAAK,WAAYlX,CAAK,EAAG,GAItDjH,EAAOme,CAIX,SAAclX,IAAUkW,EAAa,UAAY,CAE9C,MAAMiB,EAAgB,KAAK,SAAUnX,CAAK,EAErCsU,EAAS,aAEbvb,EAAOoe,EAAc,IAAK,KAAK,WAAYnX,CAAK,EAAG,GAInDjH,EAAOoe,CAIX,SAAcnX,IAAUkW,EAAa,IAElCnd,EAAO,KAAK,SAAUiH,OAEhB,CAEN,MAAMoX,EAAa,KAAK,YAAazc,CAAO,EAE5C5B,EAAO,KAAK,SAAUiH,EAAOoX,CAAU,CAEvC,CAED,OAAOre,CAEP,CAEF,CAEAmd,EAAa,WAAa,YAC1BA,EAAa,MAAQ,QACrBA,EAAa,QAAU,UACvBA,EAAa,UAAY,YACzBA,EAAa,SAAW,WACxBA,EAAa,kBAAoB,mBACjCA,EAAa,mBAAqB,oBAClCA,EAAa,eAAiB,gBAC9BA,EAAa,aAAe,eAC5BA,EAAa,UAAY,YACzBA,EAAa,UAAY,YACzBA,EAAa,OAAS,SACtBA,EAAa,UAAY,YACzBA,EAAa,oBAAsB,qBACnCA,EAAa,iBAAmB,kBAChCA,EAAa,SAAW,WACxBA,EAAa,SAAW,WACxBA,EAAa,MAAQ,QACrBA,EAAa,gBAAkB,iBAC/BA,EAAa,WAAa,aAC1BA,EAAa,YAAc,cAC3BA,EAAa,gBAAkB,iBAC/BA,EAAa,sBAAwB,uBACrCA,EAAa,IAAM,MACnBA,EAAa,aAAe,eAC5BA,EAAa,UAAY,YACzBA,EAAa,qBAAuB,sBACpCA,EAAa,kBAAoB,mBACjCA,EAAa,WAAa,QAC1BA,EAAa,eAAiB,WAC9BA,EAAa,cAAgB,UAC7BA,EAAa,WAAa,YAC1BA,EAAa,iBAAmB,aAChCA,EAAa,YAAc,aAC3BA,EAAa,WAAa,aAInB,MAAMmB,GAAoBlV,EAAe+T,EAAcA,EAAa,UAAU,EACxEoB,GAAgBnV,EAAe+T,EAAcA,EAAa,KAAK,EAC/DqB,GAAoBpV,EAAe+T,EAAcA,EAAa,SAAS,EACvEsB,GAAmBrV,EAAe+T,EAAcA,EAAa,QAAQ,EACrEuB,GAAkBtV,EAAe+T,EAAcA,EAAa,OAAO,EACnEwB,GAAmBvV,EAAe+T,EAAcA,EAAa,QAAQ,EAErEyB,GAA4BxV,EAAe+T,EAAcA,EAAa,kBAAkB,EACxF0B,GAAwBzV,EAAe+T,EAAcA,EAAa,cAAc,EAEhF2B,GAA2B1V,EAAe+T,EAAcA,EAAa,iBAAiB,EAC/D/T,EAAe+T,EAAcA,EAAa,YAAe,EACtF,MAAM4B,GAAoB3V,EAAe+T,EAAcA,EAAa,SAAS,EACvE6B,GAAoB5V,EAAe+T,EAAcA,EAAa,SAAS,EACvE8B,GAAiB7V,EAAe+T,EAAcA,EAAa,MAAM,EACjE+B,GAAoB9V,EAAe+T,EAAcA,EAAa,SAAS,EACvEgC,GAA6B/V,EAAe+T,EAAcA,EAAa,mBAAmB,EAC1FiC,GAA0BhW,EAAe+T,EAAcA,EAAa,gBAAgB,EACpFkC,GAAmBjW,EAAe+T,EAAcA,EAAa,QAAQ,EACrEmC,GAAgBlW,EAAe+T,EAAcA,EAAa,KAAK,EAC/DoC,GAAyBnW,EAAe+T,EAAcA,EAAa,eAAe,EAClFqC,GAAqBpW,EAAe+T,EAAcA,EAAa,UAAU,EACzEsC,GAAsBrW,EAAe+T,EAAcA,EAAa,WAAW,EAC3EuC,GAAyBtW,EAAe+T,EAAcA,EAAa,eAAe,EAClFwC,GAA+BvW,EAAe+T,EAAcA,EAAa,qBAAqB,EAC9FyC,GAAuBxW,EAAe+T,EAAcA,EAAa,YAAY,EAC7E0C,GAAoBzW,EAAe+T,EAAcA,EAAa,SAAS,EACvE2C,GAAc1W,EAAe+T,EAAcA,EAAa,GAAG,EAC3D4C,GAA8B3W,EAAe+T,EAAcA,EAAa,oBAAoB,EAC5F6C,GAA2B5W,EAAe+T,EAAcA,EAAa,iBAAiB,EACtF8C,GAAoB7W,EAAe+T,EAAcA,EAAa,UAAU,EACxE+C,GAAuB9W,EAAe+T,EAAcA,EAAa,cAAc,EAC/EgD,GAAsB/W,EAAe+T,EAAcA,EAAa,aAAa,EAC7EiD,GAAoBhX,EAAe+T,EAAcA,EAAa,UAAU,EACxEkD,GAAyBjX,EAAe+T,EAAcA,EAAa,gBAAgB,EACnFmD,GAAqBlX,EAAe+T,EAAcA,EAAa,WAAW,EAC1EoD,GAAqBnX,EAAe+T,EAAcA,EAAa,UAAU,EACzEa,GAA2BrN,EAAS,IAAIhQ,EAAS,EAAG,YAAa,SAAW4P,EAAQ,CAEhG,OAAOA,EAAM,QAEd,CAAC,EAAG,eAAgB,SAAW,CAAE,SAAAgL,GAAa,CAE7C,KAAK,MAAM,IAAKA,EAAS,WAAa,KAAK,IAAKA,EAAS,kBAAkB,EAAIA,EAAS,WAAa,KAAK,IAAKA,EAAS,kBAAkB,EAE3I,GAEAnY,EAAc,eAAgB+Z,CAAc,EC/ZrC,MAAMqD,GAAiCpU,GAAW,WAAY,QACxDqU,GAA8BD,GAAiB,MAAO,iBACtDE,GAA8B1U,GAASyQ,GAAiB,IAAKgE,IAAgB,IAAK,mBAClFE,GAAuC3U,GAASyU,GAAc,mBAAoBhE,EAAgB,EAAI,0BAA0B,EAAG,UAAS,EAAG,MAAO,wBAAwB,EAC9KmE,GAA6B5U,GAASuQ,GAAgB,IAAKkE,IAAgB,IAAK,kBAChFI,EAAsC7U,GAAS4U,GAAa,OAAQ,EAAE,yBAAyB,EAAG,UAAS,EAAG,MAAO,uBAAyB,ECD3J,MAAME,WAAgCxd,CAAS,CAE9C,YAAayd,EAAe,KAAO,CAElC,MAAO,MAAM,EAEb,KAAK,aAAeA,CAEpB,CAED,MAAOnf,EAAU,CAEhB,GAAKA,EAAQ,cAAgB,WAE5B,OAAOoK,GAASpK,EAAQ,QAAQ,GAAG,EAIpC,MAAMof,EAAW,KAAK,cAAgBP,GAEtC,OAAO3E,GAAuB,IAAKS,EAAiB,EAAC,IAAKyE,CAAQ,CAElE,CAEF,CAIO,MAAMC,GAAsB9X,EAAW2X,IAE9C1d,EAAc,0BAA2B0d,EAAyB,EChClE,MAAMI,WAA4B5b,EAAU,CAE3C,YAAavf,EAAOs0B,EAAa,KAAM8G,EAAe,EAAGC,EAAe,EAAI,CAE3E,MAAOr7B,EAAOs0B,GAEd,KAAK,aAAe,GAEpB,KAAK,WAAaA,EAClB,KAAK,aAAe8G,EACpB,KAAK,aAAeC,EAEpB,KAAK,MAAQC,GACb,KAAK,UAAY,GAEjB,KAAK,UAAY,KAEjB,KAAK,OAAS,GAETt7B,GAASA,EAAM,oBAAsB,KAEzC,KAAK,UAAYA,EACjB,KAAK,MAAQA,EAAM,MACnB,KAAK,UAAYA,EAAM,2BAIxB,CAED,QAAS6b,EAAU,CAElB,GAAK,KAAK,eAAiB,GAAK,KAAK,eAAiB,EAAI,CAEzD,IAAI0f,EAAa1f,EAAQ,YAAY,QAAS,KAAK,OAEnD,OAAK0f,IAAe,SAEnBA,EAAa,CACZ,KAAM,IACX,EAEI1f,EAAQ,YAAY,QAAS,KAAK,MAAO0f,CAAU,GAI7CA,EAAW,KAAK,IAEvB,CAED,OAAO,KAAK,IAEZ,CAED,YAAa1f,EAAU,CAEtB,OAAK,KAAK,aAAe,OAExB,KAAK,WAAaA,EAAQ,qBAAsB,KAAK,SAAS,GAIxD,KAAK,UAEZ,CAED,MAAOA,EAAU,CAEhB,GAAK,KAAK,YAAc,KAAO,OAE/B,MAAMrB,EAAO,KAAK,YAAaqB,CAAO,EAChCxY,EAAQ,KAAK,MACbm4B,EAAW3f,EAAQ,cAAerB,CAAI,EACtCihB,EAAS,KAAK,cAAgBD,EAC9BznB,EAAS,KAAK,aAEdygB,EAASnxB,EAAM,sBAAwB,GAAOA,EAAQ,IAAIq4B,GAAmBr4B,EAAOo4B,GACpFE,EAAkB,IAAIC,GAA4BpH,EAAQgH,EAAUznB,CAAM,EAEhFygB,EAAO,SAAU,KAAK,OAEtB,KAAK,UAAYmH,EACjB,KAAK,UAAU,2BAA6B,KAAK,SAEjD,CAED,SAAU9f,EAAU,CAEnB,MAAMH,EAAW,KAAK,YAAaG,CAAO,EAEpC0K,EAAgB1K,EAAQ,2BAA4B,KAAMH,CAAQ,EAClEgC,EAAe7B,EAAQ,gBAAiB0K,CAAa,EAE3D,IAAI5nB,EAAS,KAEb,OAAKkd,EAAQ,cAAgB,UAAYA,EAAQ,cAAgB,WAEhE,KAAK,KAAO6B,EAEZ/e,EAAS+e,GAMT/e,EAFoBsnB,GAAS,MAER,MAAOpK,EAASH,CAAQ,EAIvC/c,CAEP,CAED,cAA4B,CAE3B,MAAO,iBAEP,CAED,SAAUqB,EAAQ,CAEjB,YAAK,MAAQA,EAER,KAAK,WAAa,KAAK,UAAU,oBAAsB,KAE3D,KAAK,UAAU,MAAQA,GAIjB,IAEP,CAED,aAAcA,EAAQ,CAErB,YAAK,UAAYA,EAEV,IAEP,CAEF,CAIO,MAAM27B,GAAkB,CAAEt4B,EAAOmX,EAAMihB,EAAQ1nB,IAAYsM,EAAY,IAAI8a,GAAqB93B,EAAOmX,EAAMihB,EAAQ1nB,CAAQ,CAAA,EACvH8nB,GAAyB,CAAEx4B,EAAOmX,EAAMihB,EAAQ1nB,IAAY4nB,GAAiBt4B,EAAOmX,EAAMihB,EAAQ1nB,CAAQ,EAAC,SAAU+nB,EAAgB,EAErIC,GAA2B,CAAE14B,EAAOmX,EAAMihB,EAAQ1nB,IAAY4nB,GAAiBt4B,EAAOmX,EAAMihB,EAAQ1nB,CAAQ,EAAC,aAAc,EAAI,EAC/HioB,GAAkC,CAAE34B,EAAOmX,EAAMihB,EAAQ1nB,IAAY8nB,GAAwBx4B,EAAOmX,EAAMihB,EAAQ1nB,CAAQ,EAAC,aAAc,EAAI,EAE1J6L,EAAgB,cAAiBqc,GAAgBN,GAAiBM,EAAW,KAAK,GAElF5e,EAAc,sBAAuB8d,EAAqB,ECrJ1D,MAAMe,WAAqB1gB,CAAK,CAE/B,YAAa2gB,EAAe,CAE3B,MAAO,MAAM,EAEb,KAAK,aAAeA,EAEpB,KAAK,mBAAqB,KAE1B,KAAK,kBAAoB,KAEzB,KAAK,WAAa3iB,EAAe,MAEjC,KAAK,OAAS,KACd,KAAK,YAAc,IAEnB,CAED,OAAqB,CAEpB,IAAI4iB,EAAqB,KAAK,mBAE9B,MAAMD,EAAe,KAAK,aAE1B,GAAKC,IAAuB,KAAO,CAElC,MAAMC,EAAoBF,EAAa,eACjC3H,EAAS,IAAI8H,GAA4BD,EAAkB,MAAO,GAAI,GAE5E,KAAK,OAAS7H,EACd,MAAM+H,EAAWF,EAAkB,QAAUP,GAAmBE,GAAkCD,GAE5FS,EAAkB,CAEvBD,EAAU/H,EAAQ,OAAQ,GAAI,CAAG,EACjC+H,EAAU/H,EAAQ,OAAQ,GAAI,CAAG,EACjC+H,EAAU/H,EAAQ,OAAQ,GAAI,CAAG,EACjC+H,EAAU/H,EAAQ,OAAQ,GAAI,EAAI,CACtC,EAEG4H,EAAqBnX,GAAM,GAAGuX,GAE9B,KAAK,mBAAqBJ,CAE1B,CAED,MAAMK,EAAyBN,EAAa,cAE5C,GAAKM,GAA0B,KAAK,oBAAsB,KAAO,CAEhE,MAAMjI,EAAS,IAAIkI,GAA0BD,EAAuB,MAAO,CAAC,EACtEF,EAAWE,EAAuB,QAAUX,GAAmBE,GAAkCD,GAEvG,KAAK,YAAcvH,EACnB,KAAK,kBAAoBvQ,EAAMsY,EAAU/H,EAAQ,OAAQ,EAAG,CAAC,EAE7D,CAID,MAAMmI,EAAmBP,EAAmB,IAAK1B,EAAa,EAAG,IAI3Dl2B,EAAIqgB,GAAMuX,EAAoB,CAAC,EAAG,IAAKA,EAAoB,CAAC,EAAG,IAAKA,EAAoB,CAAG,EAAC,GAAG,EAE/FQ,EAAoB/F,GAAY,IAAK5S,EAAMzf,EAAG,CAAG,EAAC,IAAKA,EAAG,CAAC,CAAI,EAAEA,EAAG,CAAG,EAAC,IAAKA,EAAG,CAAC,CAAI,EAAEA,EAAG,CAAG,EAAC,IAAKA,EAAG,CAAG,CAAA,CAAI,CAAA,EAE7Gq4B,EAAiBr4B,EAAE,IAAKo4B,CAAiB,EAAG,IAIlDlC,GAAc,OAAQiC,GACtB9F,GAAY,OAAQgG,GAIf,KAAK,oBAAsB,MAE/BlV,GAAiB,OAAQ,gBAAgB,EAAG,OAAQ,KAAK,kBAI1D,CAED,QAAoB,CAEd,KAAK,aAAa,eAAe,QAAUmU,IAAoB,KAAK,aAAa,eAAe,UAAY,KAAK,OAAO,UAE5H,KAAK,OAAO,QAAU,KAAK,aAAa,eAAe,SAInD,KAAK,aAAa,eAAiB,KAAK,aAAa,cAAc,QAAUA,IAAoB,KAAK,aAAa,cAAc,UAAY,KAAK,YAAY,UAElK,KAAK,YAAY,QAAU,KAAK,aAAa,cAAc,QAI5D,CAEF,CAIO,MAAMgB,GAAW1Z,EAAW8Y,IAEnC7e,EAAc,eAAgB6e,EAAc,EC/GrC,MAAMa,GAAgCpc,EAAO,CAAE6C,EAAO3H,KAEvDA,EAAQ,SAAS,aAAc,SAAS,IAAO,IAEnDA,EAAQ,SAAS,kBAIXwK,GAAW,UAAW,QAE7B,IAEY2W,GAA6BD,GAAgB,IAAI,MAAO,cAAc,EACtEE,GAA4BhX,GAASuQ,GAAgB,IAAKnS,EAAM2Y,GAAc,CAAG,CAAA,EAAG,IAAK,eAAiB,EAAC,UAAS,EAAG,MAAO,aAAe,ECV1J,MAAME,WAAkB1hB,CAAK,CAE5B,YAAa2hB,EAAY,CAExB,MAAO,MAAM,EAEb,KAAK,UAAYA,EAGjB,KAAK,kBAAoB,KAEzB,KAAK,eAAiB,IAEtB,CAED,MAAOthB,EAAU,CAIX,KAAK,iBAAmB,OAEvBA,EAAQ,aAAc,IAAK,KAE/B,KAAK,eAAiBwL,GAItB,KAAK,eAAiBC,IAMxB,MAAM8V,EAAmBzc,EAAO,CAAE,CAAErY,CAAE,IAAQ,CAE7C,MAAMlL,EAAOguB,GAAagJ,GAAa,KAAK,UAAU,gBAAgB,EAAI,GACpEtlB,EAAI2T,GAAKna,CAAE,EAAG,UAAWma,GAAKrlB,CAAI,GAClCmH,EAAIke,GAAKna,CAAE,EAAG,IAAKma,GAAKrlB,CAAI,GAClC,OAAOg3B,GAAa,KAAK,UAAU,iBAAkBtQ,GAAOhV,EAAGvK,GAAK,KAAM,OAAO,EAAG,CAEpF,CAAA,EAAG,UAAW,CACd,KAAM,mBACN,KAAM,OACN,OAAQ,CACP,CAAE,KAAM,KAAM,KAAM,KAAO,CAC3B,CACJ,GAEQ84B,EAAiB,KAAK,UAAU,iBAEhCjgC,EAAOguB,GAAagJ,GAAaiJ,CAAgB,EAAE,CAAC,EACpD/sB,EAAIqS,EAAOya,EAAkB3a,GAAK,KAAK,cAAgB,CAAA,CAAI,EAAC,IAAK,CAAG,EAAC,MAAK,EAE1E3T,EAAI2T,GAAKnS,EAAE,IAAKlT,CAAM,CAAA,EACtBmH,EAAIke,GAAKnS,CAAC,EAAG,IAAKmS,GAAKrlB,CAAI,GAC3BkgC,EAAiBrY,GACtBmP,GAAaiJ,EAAgBvZ,GAAOhV,EAAGvK,CAAC,CAAI,EAC5C6vB,GAAaiJ,EAAgBvZ,GAAOhV,EAAE,IAAK,CAAC,EAAIvK,EAAK,EACrD6vB,GAAaiJ,EAAgBvZ,GAAOhV,EAAE,IAAK,CAAC,EAAIvK,EAAK,EACrD6vB,GAAaiJ,EAAgBvZ,GAAOhV,EAAE,IAAK,CAAC,EAAIvK,EAAK,CACxD,EAEQg5B,EAAK1Y,GACVyY,EAAgB,CAAC,EAAG,IACpBA,EAAgB,CAAC,EAAG,IACpBA,EAAgB,CAAC,EAAG,GACvB,EAEE5C,GAAc,OAAQ4C,EAAe,IAAK5C,EAAe,CAAA,EAEzD,MAAMkC,EAAoB/F,GAAY,IAAK5S,EAAMsZ,EAAI,CAAG,EAAC,IAAKA,EAAI,CAAC,CAAI,EAAEA,EAAI,CAAG,EAAC,IAAKA,EAAI,CAAC,CAAI,EAAEA,EAAI,CAAG,EAAC,IAAKA,EAAI,CAAG,CAAA,CAAI,CAAA,EAEnHC,EAAiBD,EAAG,IAAKX,CAAiB,EAAG,IAEnD/F,GAAY,OAAQ2G,GAEf3hB,EAAQ,qBAAsB,YAElCmhB,GAAa,UAAWO,EAIzB,CAEF,CAIO,MAAME,GAAQra,EAAW8Z,IAEhC7f,EAAc,QAAS6f,EAAW,ECvFlC,MAAMQ,WAAqBliB,CAAK,CAE/B,YAAamiB,EAAaC,EAAe,GAAQ,CAEhD,MAAO,MAAM,EAEb,KAAK,YAAcD,EACnB,KAAK,aAAeC,EAEpB,KAAK,WAAapkB,EAAe,OAIjC,KAAK,cAAgB6M,GAAW,YAAa,OAAO,EACpD,KAAK,eAAiBA,GAAW,aAAc,MAAM,EAErD,IAAIwX,EAAgBC,EAAuBC,EAEtCH,GAEJC,EAAiBxI,GAAW,aAAc,QAC1CyI,EAAwBzI,GAAW,oBAAqB,QACxD0I,EAAmBzI,GAAiB,wBAAyB,OAAQqI,EAAY,SAAS,MAAM,UAIhGE,EAAiBjT,EAAS+S,EAAY,WAAY,MAAM,EACxDG,EAAwBlT,EAAS+S,EAAY,kBAAmB,MAAM,EACtEI,EAAmBvJ,GAAQmJ,EAAY,SAAS,aAAc,OAAQA,EAAY,SAAS,MAAM,SAIlG,KAAK,eAAiBE,EACtB,KAAK,sBAAwBC,EAC7B,KAAK,iBAAmBC,CAExB,CAED,MAAOliB,EAAU,CAEhB,KAAM,CAAE,cAAAmiB,EAAe,eAAAC,EAAgB,eAAAJ,EAAgB,sBAAAC,EAAuB,iBAAAC,CAAkB,EAAG,KAE7FG,EAAWH,EAAiB,QAASC,EAAc,CAAC,EACpDG,EAAWJ,EAAiB,QAASC,EAAc,CAAC,EACpDI,EAAWL,EAAiB,QAASC,EAAc,CAAC,EACpDK,EAAWN,EAAiB,QAASC,EAAc,CAAC,EAIpDM,EAAaT,EAAe,IAAKnD,EAAa,EAE9C6D,EAAUxS,GACfmS,EAAS,IAAKD,EAAe,CAAC,EAAG,IAAKK,CAAY,EAClDH,EAAS,IAAKF,EAAe,CAAC,EAAG,IAAKK,CAAY,EAClDF,EAAS,IAAKH,EAAe,CAAC,EAAG,IAAKK,CAAY,EAClDD,EAAS,IAAKJ,EAAe,CAAC,EAAG,IAAKK,CAAY,CACrD,EAEQE,EAAeV,EAAsB,IAAKS,CAAO,EAAG,IAI1D,IAAIE,EAAa1S,GAChBkS,EAAe,EAAE,IAAKC,CAAU,EAChCD,EAAe,EAAE,IAAKE,CAAU,EAChCF,EAAe,EAAE,IAAKG,CAAU,EAChCH,EAAe,EAAE,IAAKI,CAAU,CACnC,EAEEI,EAAaX,EAAsB,IAAKW,CAAU,EAAG,IAAKZ,GAE1D,MAAMa,EAAaD,EAAW,mBAAoB5H,EAAW,EAAG,IAIhE6D,GAAc,OAAQ8D,GACtB3H,GAAY,OAAQ6H,GAEf7iB,EAAQ,qBAAsB,YAElCmhB,GAAa,OAAQ0B,EAItB,CAED,SAAU7iB,EAASld,EAAS,CAE3B,GAAKA,IAAW,OAEf,OAAO+7B,GAAc,MAAO7e,EAASld,CAAM,CAI5C,CAED,OAAQ6rB,EAAQ,EAEA,KAAK,aAAeA,EAAM,OAAS,KAAK,aAEhD,SAAS,QAEhB,CAEF,CAKO,MAAMmU,GAAsBhB,GAAiBtd,EAAY,IAAIqd,GAAcC,EAAa,EAAI,GAEnGtgB,EAAc,eAAgBqgB,EAAc,ECtH5C,MAAMkB,WAAiBpjB,CAAK,CAE3B,YAAaf,EAAS,GAAK,CAE1B,QAEA,KAAK,OAASA,CAEd,CAED,WAAYuB,EAAQ,CAEnB,OAAO,OAAO,aAAc,IAAmBA,CAAK,CAEpD,CAED,cAAeH,EAAU,CAExB,MAAMQ,EAAaR,EAAQ,kBAAmB,IAAI,EAElD,GAAKQ,EAAW,YAAc,OAAY,OAAOA,EAIjD,MAAM4D,EAAS,CAAA,EAEf,QAAU/c,EAAI,EAAGkR,EAAI,KAAK,OAAO,OAAS,EAAGlR,EAAIkR,EAAGlR,IAAO,CAE1D,MAAMgW,EAAQ,KAAK,OAAQhW,CAAC,EAEtBwH,EAASwO,EAAM,SAAW,IAAQA,EAAM,MAAU,KAAK,WAAYhW,GACnEsX,EAAStB,EAAM,SAAW,IAAQA,EAAM,MAAU,MAExD+G,EAAQvV,CAAM,EAAGqoB,GAAYroB,EAAM8P,CAAI,CAEvC,CAED,MAAMgJ,EAAQ3H,EAAQ,WAEtB,OAAAQ,EAAW,YAAc,KAAK,OAAQ,KAAK,OAAO,OAAS,CAAC,EAAI4D,EAAQuD,EAAO3H,CAAO,EACtFQ,EAAW,UAAYmH,EAEvB3H,EAAQ,YAAW,EAEZQ,CAEP,CAED,YAAaR,EAAU,CAEtB,KAAM,CAAE,YAAAgjB,CAAa,EAAG,KAAK,cAAehjB,CAAO,EAEnD,OAAOgjB,EAAcA,EAAY,YAAahjB,CAAO,EAAK,MAE1D,CAED,MAAOA,EAAU,CAIhB,KAAK,cAAeA,EAEpB,CAED,SAAUA,EAAU,CAEnB,MAAMQ,EAAa,KAAK,cAAeR,CAAO,EAExCpB,EAAS,KAAK,OACdqkB,EAAYziB,EAAW,UAE7B,QAAUnZ,EAAI,EAAGkR,EAAIqG,EAAO,OAAS,EAAGvX,EAAIkR,EAAGlR,IAAO,CAErD,MAAMgW,EAAQuB,EAAQvX,GAEtB,IAAIH,EAAQ,KAAMC,EAAM,KAAM0H,EAAO,KAAM8P,EAAO,KAAMukB,EAAY,KAAMC,EAAS,KAE9E9lB,EAAM,QAEVsB,EAAO,MACP9P,EAAO,KAAK,WAAYxH,GACxBH,EAAQ,IACRC,EAAMkW,EAAM,MAAO2C,EAASrB,CAAI,EAChCukB,EAAY,MAIZvkB,EAAOtB,EAAM,MAAQ,MACrBxO,EAAOwO,EAAM,MAAQ,KAAK,WAAYhW,CAAC,EACvCH,EAAQmW,EAAM,MACdlW,EAAMkW,EAAM,IACZ6lB,EAAY7lB,EAAM,UAClB8lB,EAAS9lB,EAAM,OAEV,OAAOnW,GAAU,SAAWA,EAAQA,EAAM,SAAQ,EAC7CA,GAASA,EAAM,SAASA,EAAQA,EAAM,MAAO8Y,EAASrB,IAE3D,OAAOxX,GAAQ,SAAWA,EAAMA,EAAI,SAAQ,EACvCA,GAAOA,EAAI,SAASA,EAAMA,EAAI,MAAO6Y,EAASrB,IAEnDzX,IAAU,QAAaC,IAAQ,QAEnCD,EAAQA,EAAQ,OAChBC,EAAM,IACN+7B,EAAY,MAED/7B,IAAQ,QAAaD,IAAU,SAE1CA,EAAQ,IACRg8B,EAAY,KAIRA,IAAc,SAEb,OAAQh8B,CAAK,EAAK,OAAQC,CAAG,EAEjC+7B,EAAY,KAIZA,EAAY,MAQf,MAAME,EAAgB,CAAE,MAAAl8B,EAAO,IAAAC,EAAK,UAAA+7B,CAAS,EAIvCG,EAAeD,EAAc,MAC7BE,EAAaF,EAAc,IAEjC,IAAIG,EAAqB,GACrBC,EAAqB,GACrBC,EAAgB,GAEbN,IAEDxkB,IAAS,OAASA,IAAS,OAE1BukB,EAAU,SAAU,GAAG,EAAKC,EAAS,KACrCA,EAAS,KAITD,EAAU,SAAU,GAAG,EAAKC,EAAS,QACrCA,EAAS,SAMhBI,GAAsBvjB,EAAQ,OAAQrB,EAAM9P,CAAM,EAAG,MAAQw0B,EAE7DG,GAAsB30B,EAAO,IAAMq0B,EAAY,IAAMI,EACrDG,GAAiB50B,EAAO,IAAMs0B,EAE9B,MAAMO,EAAa,SAAUH,CAAoB,KAAKC,MAAyBC,CAAe,KAE9FzjB,EAAQ,aAAe3Y,IAAM,EAAI;AAAA,EAAO,IAAO2Y,EAAQ,IAAM0jB,EAAa;AAAA;AAAA,CAAU,EAAC,WAAU,CAE/F,CAED,MAAMC,EAAeV,EAAU,MAAOjjB,EAAS,MAAM,EAE/C4jB,EAAiBpjB,EAAW,YAAcA,EAAW,YAAY,MAAOR,CAAS,EAAG,GAE1FA,EAAQ,cAAa,EAAG,YAAa;AAAA,EAAOA,EAAQ,IAAM2jB,GAE1D,QAAUt8B,EAAI,EAAGkR,EAAI,KAAK,OAAO,OAAS,EAAGlR,EAAIkR,EAAGlR,IAEnD2Y,EAAQ,aAAe3Y,IAAM,EAAI,GAAK2Y,EAAQ,KAAQ;AAAA;AAAA,GAAU,gBAIjE,OAAAA,EAAQ,WAAU,EAEX4jB,CAEP,CAEF,CAIO,MAAMC,GAAO,IAAKjlB,IAAY4F,EAAY,IAAIue,GAAUtd,GAAW7G,EAAQ,KAAK,EAAM,EAAC,OAAM,EAEvFklB,GAAQ,IAAM5M,GAAY,OAAS,EAAC,OAAM,EAEvDnT,EAAgB,OAAQ,CAAEggB,KAAYnlB,IAAYkM,GAAQiZ,EAASF,GAAM,GAAGjlB,CAAQ,CAAA,GAEpF4C,EAAc,WAAYuhB,EAAU,EC3LpC,MAAMiB,GAAgB,IAAI,QACpBC,GAAY,IAAIhlB,GAEhBilB,GAAWpf,EAAO,CAAE,CAAE,UAAAqf,EAAW,UAAAC,EAAW,OAAAxE,EAAQ,MAAAv9B,EAAO,MAAAgiC,EAAO,OAAAnsB,KAAc,CAErF,MAAMosB,EAAa1d,GAAK2E,EAAa,EAAC,IAAKqU,CAAQ,EAAC,IAAK1nB,GAEnDxP,EAAI47B,EAAW,IAAKjiC,CAAK,EACzB4Q,EAAIqxB,EAAW,IAAK57B,EAAE,IAAKrG,CAAK,GAItC,OAFqBk2B,GAAa4L,EAAWlc,GAAOhV,EAAGvK,EAAK,EAAC,MAAO27B,GAEhD,IAAKD,EAE1B,GAEA,SAASG,GAAUC,EAAW,CAE7B,MAAMC,EAAmBD,EAAS,gBAAgB,WAAa,OACzDE,EAAkBF,EAAS,gBAAgB,SAAW,OACtDG,EAAiBH,EAAS,gBAAgB,QAAU,OAKpDI,EAAiBJ,EAAS,gBAAgB,UAAYA,EAAS,gBAAgB,QAAUA,EAAS,gBAAgB,MAClHK,EAAsBD,IAAmB,OAAcA,EAAe,OAAS,EAErF,IAAIE,EAAQd,GAAc,IAAKQ,CAAQ,EAEvC,GAAKM,IAAU,QAAaA,EAAM,QAAUD,EAAoB,CA8F/D,IAASE,EAAT,UAA0B,CAEzBC,EAAc,QAAO,EAErBhB,GAAc,OAAQQ,GAEtBA,EAAS,oBAAqB,UAAWO,EAEzC,EApGID,IAAU,QAAYA,EAAM,QAAQ,QAAO,EAEhD,MAAMG,EAAeT,EAAS,gBAAgB,UAAY,CAAA,EACpDU,EAAeV,EAAS,gBAAgB,QAAU,CAAA,EAClDW,EAAcX,EAAS,gBAAgB,OAAS,CAAA,EAEtD,IAAIY,EAAkB,EAEjBX,IAAqB,KAAOW,EAAkB,GAC9CV,IAAoB,KAAOU,EAAkB,GAC7CT,IAAmB,KAAOS,EAAkB,GAEjD,IAAI/iC,EAAQmiC,EAAS,WAAW,SAAS,MAAQY,EAC7C9N,EAAS,EAEb,MAAM+N,EAAiB,KAElBhjC,EAAQgjC,IAEZ/N,EAAS,KAAK,KAAMj1B,EAAQgjC,CAAc,EAC1ChjC,EAAQgjC,GAIT,MAAM1M,EAAS,IAAI,aAAct2B,EAAQi1B,EAAS,EAAIuN,GAEhDG,EAAgB,IAAIM,GAAkB3M,EAAQt2B,EAAOi1B,EAAQuN,GACnEG,EAAc,KAAOO,GACrBP,EAAc,YAAc,GAI5B,MAAMQ,EAAmBJ,EAAkB,EAE3C,QAAU/9B,EAAI,EAAGA,EAAIw9B,EAAmBx9B,IAAO,CAE9C,MAAMo+B,EAAcR,EAAc59B,GAC5Bq+B,EAAcR,EAAc79B,GAC5Bs+B,EAAaR,EAAa99B,GAE1B6Q,EAAS7V,EAAQi1B,EAAS,EAAIjwB,EAEpC,QAAUoN,EAAI,EAAGA,EAAIgxB,EAAY,MAAOhxB,IAAO,CAE9C,MAAMmrB,EAASnrB,EAAI+wB,EAEdf,IAAqB,KAEzBR,GAAU,oBAAqBwB,EAAahxB,GAE5CkkB,EAAQzgB,EAAS0nB,EAAS,CAAC,EAAKqE,GAAU,EAC1CtL,EAAQzgB,EAAS0nB,EAAS,CAAC,EAAKqE,GAAU,EAC1CtL,EAAQzgB,EAAS0nB,EAAS,CAAC,EAAKqE,GAAU,EAC1CtL,EAAQzgB,EAAS0nB,EAAS,CAAC,EAAK,GAI5B8E,IAAoB,KAExBT,GAAU,oBAAqByB,EAAajxB,GAE5CkkB,EAAQzgB,EAAS0nB,EAAS,CAAC,EAAKqE,GAAU,EAC1CtL,EAAQzgB,EAAS0nB,EAAS,CAAC,EAAKqE,GAAU,EAC1CtL,EAAQzgB,EAAS0nB,EAAS,CAAC,EAAKqE,GAAU,EAC1CtL,EAAQzgB,EAAS0nB,EAAS,CAAC,EAAK,GAI5B+E,IAAmB,KAEvBV,GAAU,oBAAqB0B,EAAYlxB,GAE3CkkB,EAAQzgB,EAAS0nB,EAAS,CAAC,EAAKqE,GAAU,EAC1CtL,EAAQzgB,EAAS0nB,EAAS,CAAC,EAAKqE,GAAU,EAC1CtL,EAAQzgB,EAAS0nB,EAAS,EAAE,EAAKqE,GAAU,EAC3CtL,EAAQzgB,EAAS0nB,EAAS,IAAS+F,EAAW,WAAa,EAAM1B,GAAU,EAAI,EAIhF,CAED,CAEDa,EAAQ,CACP,MAAOD,EACP,QAASG,EACT,OAAQI,EACR,KAAM,IAAIrmB,GAAS1c,EAAOi1B,CAAQ,CACrC,EAEE0M,GAAc,IAAKQ,EAAUM,GAY7BN,EAAS,iBAAkB,UAAWO,EAEtC,CAED,OAAOD,CAER,CAGA,MAAMc,WAAkBjmB,CAAK,CAE5B,YAAakmB,EAAO,CAEnB,MAAO,MAAM,EAEb,KAAK,KAAOA,EACZ,KAAK,mBAAqB9W,EAAS,GAEnC,KAAK,WAAapR,EAAe,MAEjC,CAED,MAAOqC,EAAU,CAEhB,KAAM,CAAE,SAAAwkB,CAAU,EAAGxkB,EAEfykB,EAAmBD,EAAS,gBAAgB,WAAa,OACzDE,EAAkBF,EAAS,gBAAgB,SAAW,OAEtDI,EAAiBJ,EAAS,gBAAgB,UAAYA,EAAS,gBAAgB,QAAUA,EAAS,gBAAgB,MAClHK,EAAsBD,IAAmB,OAAcA,EAAe,OAAS,EAI/E,CAAE,QAAST,EAAW,OAAAvE,EAAQ,KAAAr+B,GAASgjC,GAAUC,GAElDC,IAAqB,IAAO5F,GAAc,UAAW,KAAK,oBAC1D6F,IAAoB,IAAO1J,GAAY,UAAW,KAAK,oBAE5D,MAAM34B,EAAQukB,GAAKrlB,EAAK,KAAK,EAE7BsiC,GAAMgB,EAAmB,CAAE,CAAE,EAAAx9B,KAAS,CAErC,MAAM+8B,EAAYtd,EAAO,CAAG,EAAC,MAAK,EAE7B,KAAK,KAAK,MAAQ,GAAO,KAAK,KAAK,eAAiB,MAAQ,KAAK,KAAK,eAAiB,OAE3Fsd,EAAU,OAAQ7L,GAAa,KAAK,KAAK,aAActQ,GAAOrB,GAAKvf,CAAC,EAAG,IAAK,GAAKuf,GAAK4E,GAAiB,CAAA,EAAG,GAI1G4Y,EAAU,OAAQ5K,GAAW,wBAAyB,SAAU,QAASnyB,CAAC,EAAG,MAAK,GAI9Eo9B,IAAqB,IAEzB5F,GAAc,UAAWqF,GAAU,CAClC,UAAAC,EACA,UAAAC,EACA,OAAAxE,EACA,MAAAv9B,EACA,MAAOgF,EACP,OAAQuf,GAAK,CAAG,CAChB,CAAA,GAIG8d,IAAoB,IAExB1J,GAAY,UAAWkJ,GAAU,CAChC,UAAAC,EACA,UAAAC,EACA,OAAAxE,EACA,MAAAv9B,EACA,MAAOgF,EACP,OAAQuf,GAAK,CAAG,CAChB,CAAA,EAIL,EAEE,CAED,QAAS,CAER,MAAMkf,EAAqB,KAAK,mBAE3B,KAAK,KAAK,SAAS,qBAEvBA,EAAmB,MAAQ,EAI3BA,EAAmB,MAAQ,EAAI,KAAK,KAAK,sBAAsB,OAAQ,CAAEziC,EAAGC,IAAOD,EAAIC,EAAG,CAAC,CAI5F,CAEF,CAIO,MAAMyiC,GAAiBxe,EAAWqe,IAEzCpkB,EAAc,YAAaokB,EAAW,EC1P/B,MAAMI,GAA4B/G,EAAsB,OAAQ,EAAC,QAAS9D,EAAqB,EACzF8K,GAA8BD,GAAY,mBAAoB7L,EAAgB,EAAG,MAAO,eAAiB,ECCtH,MAAM+L,WAAwB1O,EAAY,CAEzC,YAAarzB,EAAOszB,EAAS,KAAMpI,EAAY,KAAO,CAErD,MAAOlrB,EAAOszB,EAAQpI,GAEtB,KAAK,kBAAoB,EAEzB,CAED,cAA4B,CAE3B,MAAO,aAEP,CAED,cAAe,CAEd,OAAO4W,EAEP,CAED,iBAAoC,CAAG,CAEvC,QAASjmB,EAASyX,EAAS,CAE1B,MAAML,EAAU,KAAK,MAErB,OAAKpX,EAAQ,SAAS,mBAAqBmmB,IAA0B,CAAE/O,EAAQ,sBAEvEhP,EAAMqP,EAAO,EAAE,OAAM,EAAIA,EAAO,IAIhCA,CAIR,CAED,WAAYzX,EAASomB,EAAS,CAE7B,OAAOA,EAAO,MAAOpmB,EAAS,MAAM,CAEpC,CAEF,CAIO,MAAMqmB,GAAc9e,EAAW2e,IAEtCniB,EAAgB,cAAesiB,IAE/B7kB,EAAc,kBAAmB0kB,EAAiB,EC1DlD,MAAMI,WAAqB3mB,CAAK,CAE/B,aAAc,CAEb,MAAO,MAAM,CAEb,CAED,UAAwB,CAEvB,QAAQ,KAAM,qBAEd,CAEF,CAIA6B,EAAc,eAAgB8kB,EAAc,ECN5C,IAAIC,GAAmB,KAEvB,MAAMC,WAA0BF,EAAa,CAE5C,YAAaG,EAAQ,KAAO,CAE3B,QAEA,KAAK,WAAa9oB,EAAe,MAEjC,KAAK,MAAQ8oB,EAEb,KAAK,IAAM,KACX,KAAK,WAAa,KAClB,KAAK,eAAiB,KAEtB,KAAK,MAAQ,IAAI3nB,GACjB,KAAK,kBAAoBiQ,EAAS,KAAK,KAAK,EAE5C,KAAK,UAAY,KAAK,kBAEtB,KAAK,oBAAsB,EAE3B,CAED,aAAc,CAEb,OAAO,MAAM,YAAW,EAAK,KAAQ,KAAK,MAAM,GAAK,KAAQ,KAAK,MAAM,WAAa,IAAM,KAE3F,CAED,SAAU,CAET,OAAO,KAAK,MAAM,IAElB,CAED,YAAa/O,EAAU,CAEtB,KAAM,CAAE,OAAAlC,CAAQ,EAAGkC,EAEnB,GAAKlC,EAAO,gBAAkB,GAAQ,OAEtC,IAAI4oB,EAAa,KAAK,WAEtB,GAAKA,IAAe,KAAO,CAErBH,KAAqB,OAEzBA,GAAmBvmB,EAAQ,qBAC3BumB,GAAiB,aAAe/d,EAAM,EAAG,EAAG,EAAG,GAC/C+d,GAAiB,qBAAuB,IAIzC,MAAMI,EAAS,KAAK,MAAM,OACpBC,EAAM5mB,EAAQ,mBAAoB2mB,EAAO,QAAQ,MAAOA,EAAO,QAAQ,QAEvEE,EAAe,IAAIC,GACzBD,EAAa,UAAYE,GACzBF,EAAa,UAAYE,GACzBF,EAAa,MAAM,MAAQF,EAAO,QAAQ,MAC1CE,EAAa,MAAM,OAASF,EAAO,QAAQ,OAC3CE,EAAa,gBAAkBG,GAE/BJ,EAAI,aAAeC,EAEnBF,EAAO,OAAO,yBAId,MAAMM,EAAkBzN,GAAW,YAAa,QAASmN,CAAM,EACzDO,EAAO1N,GAAW,OAAQ,QAASmN,CAAM,EACzCQ,EAAa3N,GAAW,aAAc,QAASmN,CAAM,EAErDvH,EAAWthB,EAAO,SAAS,oBAAsBghB,GAEvD,IAAIsI,EAAcrY,EAAS4X,EAAO,MAAQ,EAAC,IAAKvH,EAAS,IAAKlE,GAAY,IAAKiM,CAAU,CAAI,CAAA,EAC7FC,EAAcA,EAAY,IAAI,IAAKA,EAAY,CAAC,EAEhD,MAAMC,EAAcD,EAAY,EAAE,iBAAkB,CAAG,EACrD,IAAKA,EAAY,EAAE,cAAe,CAAC,CAAI,EACvC,IAAKA,EAAY,EAAE,iBAAkB,CAAC,CAAI,EAC1C,IAAKA,EAAY,EAAE,cAAe,CAAC,CAAI,EACvC,IAAKA,EAAY,EAAE,cAAe,CAAG,CAAA,EAEvC,IAAIE,EAASF,EAAY,EAAE,IAAKF,CAAI,EAE/BlnB,EAAQ,SAAS,mBAAqBmmB,KAE1CmB,EAASA,EAAO,IAAK,CAAC,EAAG,IAAK,IAI/BF,EAAchf,EACbgf,EAAY,EACZA,EAAY,EAAE,SAAU,EACxBE,CACJ,EAOGZ,GALuB,CAAEG,EAAcO,EAAaG,IAAanQ,GAASyP,EAAcO,CAAW,EAAG,QAASG,CAAO,GAKzFV,EAAcO,EAAY,GAAIA,EAAY,GAuCvE,MAAMI,EAAcpQ,GAASwP,EAAI,QAASQ,CAAW,EAC/CK,EAAiBJ,EAAY,IAAK,EAAGX,EAAW,IAAKc,EAAY,EAAE,IAAK,EAAGA,CAAW,EAAI,CAAG,CAAA,EAEnG,KAAK,IAAMZ,EACX,KAAK,UAAY,KAAK,UAAU,IAAKvR,GAAK,EAAGoS,EAAgBR,CAAe,GAE5E,KAAK,WAAaP,EAClB,KAAK,eAAiBe,EAItB,KAAK,iBAAmB9pB,EAAe,MAEvC,CAED,CAED,MAAOqC,EAAU,CAEX,KAAK,MAAM,WAAa,KAAK,YAAaA,GACrC,KAAK,aAAe,MAAO,KAAK,cAAa,CAEvD,CAED,aAAc2O,EAAQ,CAErB,KAAM,CAAE,IAAAiY,EAAK,MAAAH,CAAO,EAAG,KACjB,CAAE,SAAAiB,EAAU,MAAAC,EAAO,OAAA5N,CAAM,EAAKpL,EAE9BiZ,EAA0BD,EAAM,iBAEtCA,EAAM,iBAAmBpB,GAEzBK,EAAI,QAASH,EAAM,OAAO,QAAQ,MAAOA,EAAM,OAAO,QAAQ,QAE9DA,EAAM,OAAO,eAAgBA,GAC7BA,EAAM,OAAO,OAAO,OAAO,KAAO1M,EAAO,OAAO,KAEhD,MAAM8N,EAAqBH,EAAS,YAC9BI,EAAsBJ,EAAS,kBAC/BK,EAA8BL,EAAS,0BAE7CA,EAAS,wBAAyB,CAAE5pB,KAAWc,IAAY,CAErDd,EAAO,aAAe,IAE1B4pB,EAAS,aAAc5pB,EAAQ,GAAGc,CAAM,CAI5C,GAEE8oB,EAAS,gBAAiBd,GAC1Bc,EAAS,YAAcM,GAEvBN,EAAS,OAAQC,EAAOlB,EAAM,OAAO,MAAM,EAE3CiB,EAAS,gBAAiBI,GAC1BJ,EAAS,wBAAyBK,GAElCL,EAAS,YAAcG,EAEvBF,EAAM,iBAAmBC,CAEzB,CAED,eAAgB,CAEf,KAAK,IAAI,UAET,KAAK,WAAa,KAClB,KAAK,eAAiB,KACtB,KAAK,IAAM,KAEX,KAAK,UAAY,KAAK,iBAEtB,CAED,aAAcjZ,EAAQ,CAErB,KAAM,CAAE,MAAA8X,CAAO,EAAG,KAEbA,EAAM,YAAa,KAAK,aAAc9X,CAAK,CAEhD,CAED,QAAoB,CAEnB,KAAM,CAAE,MAAA8X,CAAO,EAAG,KAElB,KAAK,MAAM,KAAMA,EAAM,KAAK,EAAG,eAAgBA,EAAM,UAErD,CAEF,CAIAjlB,EAAc,oBAAqBglB,EAAmB,EC5PtD,MAAMyB,GAAa,IAAI,QAEjBC,GAAeC,GAEbA,EAAO,KAAM,CAAE9kC,EAAGC,IAAOD,EAAE,GAAKC,EAAE,IAI1C,MAAM8kC,WAAmBzoB,CAAK,CAE7B,YAAa0oB,EAAa,GAAK,CAE9B,MAAO,MAAM,EAEb,KAAK,iBAAmBjgB,EAAM,EAAC,KAAM,cAAc,EACnD,KAAK,kBAAoBA,EAAM,EAAC,KAAM,eAAe,EAErD,KAAK,kBAAoBA,EAAM,EAAC,KAAM,eAAe,EAErD,KAAK,WAAaigB,EAElB,KAAK,MAAQ,IAEb,CAED,IAAI,UAAW,CAEd,OAAO,KAAK,WAAW,OAAS,CAEhC,CAED,SAAU,CAET,GAAK,KAAK,QAAU,KAAO,CAE1B,MAAMnoB,EAAO,CAAA,EAEb,UAAYooB,KAAa,KAAK,WAE7BpoB,EAAK,KAAMooB,EAAU,QAAS,CAAA,EAI/B,KAAK,MAAQ,UAAYpoB,EAAK,KAAM,GAAG,CAEvC,CAED,OAAO,KAAK,KAEZ,CAED,QAASF,EAAU,CAElB,MAAMQ,EAAaR,EAAQ,gBAAiB,IAAI,EAEhD,UAAY5B,KAAQoC,EAAW,MAE9BpC,EAAK,MAAO4B,EAIb,CAED,MAAOA,EAAU,CAEhB,MAAMmL,EAAUnL,EAAQ,QAClBuoB,EAAgBpd,EAAQ,cAE9B,IAAIqd,EAAoB,KAAK,kBAE7B,GAAKD,EAAgB,CAEpB,KAAM,CAAE,WAAAF,EAAY,iBAAAI,EAAkB,kBAAAC,CAAiB,EAAK,KAE5Dvd,EAAQ,cAAgBqd,EAExB,MAAM7gB,EAAQ3H,EAAQ,WAIhBQ,EAAaR,EAAQ,gBAAiB,IAAI,EAChDQ,EAAW,MAAQmH,EAAM,MAIzB4gB,EAAc,MAAOpd,EAASxD,EAAO3H,CAAO,EAI5C,UAAYsoB,KAAaD,EAExBC,EAAU,MAAOtoB,GAMlBuoB,EAAc,gBAAiBpd,EAASxD,EAAO3H,CAAO,EACtDuoB,EAAc,iBAAkBpd,EAASxD,EAAO3H,CAAO,EACvDuoB,EAAc,iBAAkBpd,EAASxD,EAAO3H,CAAO,EAIvD,KAAM,CAAE,SAAA2oB,EAAU,cAAAC,CAAe,EAAGzd,EAC9B,CAAE,cAAA0d,EAAe,eAAAC,EAAgB,gBAAAC,EAAiB,iBAAAC,CAAkB,EAAG7d,EAAQ,eAErF,IAAI8d,EAAeJ,EAAc,IAAKE,CAAe,EAEhDJ,IAAa,OAEZC,IAAkB,KAEtBK,EAAe7gB,EAAMwgB,EAAc,IAAKK,EAAcN,CAAQ,GAI9DM,EAAe7gB,EAAMugB,GAItBxd,EAAQ,SAAS,YAAc,IAIhCsd,EAAiB,OAAQQ,GACzBP,EAAkB,OAAQI,EAAe,IAAKE,CAAkB,CAAA,EAEhER,EAAkB,OAAQC,EAAiB,IAAKC,CAAmB,CAAA,EAInEH,EAAc,OAAQpd,EAASxD,EAAO3H,CAAO,EAI7CwoB,EAAoBA,EAAkB,OAAQxoB,EAAQ,YAAa,CAAA,CAEnE,CAED,OAAOwoB,CAEP,CAED,kBAAmB/7B,EAAK,CAEvB,UAAY67B,KAAa,KAAK,WAE7B,GAAKA,EAAU,qBAAuBA,EAAU,MAAM,KAAO77B,EAE5D,OAAO67B,EAMT,OAAO,IAEP,CAED,WAAYH,EAAS,GAAK,CAEzB,MAAME,EAAa,CAAA,EAEnBF,EAASD,GAAYC,GAErB,UAAY1B,KAAS0B,EAAS,CAE7B,IAAIG,EAAY,KAAK,kBAAmB7B,EAAM,EAAE,EAEhD,GAAK6B,IAAc,KAAO,CAEzB,MAAMY,EAAazC,EAAM,YACnB0C,EAAiBlB,GAAW,IAAKiB,CAAU,EAAKjB,GAAW,IAAKiB,CAAY,EAAG1C,GAErF8B,EAAY9jB,EAAY,IAAI2kB,EAAgB1C,CAAO,CAAA,CAEnD,CAED4B,EAAW,KAAMC,EAEjB,CAED,YAAK,WAAaD,EAClB,KAAK,MAAQ,KAEN,IAEP,CAEF,CAKO,MAAMe,GAAa7hB,EAAW6gB,IAE9B,SAASiB,GAAcH,EAAYC,EAAiB,CAE1D,GAAKlB,GAAW,IAAKiB,GAAe,CAEnC,QAAQ,KAAM,8BAA+BC,EAAe,IAAM,IAClE,MAEA,CAED,GAAK,OAAOD,GAAe,WAAa,MAAM,IAAI,MAAO,SAAUA,EAAW,uBAC9E,GAAK,OAAOC,GAAmB,YAAc,CAAEA,EAAe,KAAO,MAAM,IAAI,MAAO,cAAeA,EAAe,IAAM,iBAAgB,EAE1IlB,GAAW,IAAKiB,EAAYC,EAE7B,CCnNA,MAAMG,WAAehD,EAAa,CAEjC,YAAaiD,EAAS,KAAO,CAE5B,QAEA,KAAK,OAASA,CAEd,CAED,MAAOvpB,EAAU,CAGhB,MAAMupB,EAAS,KAAK,OAAO,EAAE,IAAK,CAAK,EAAC,IAAK,CAAW,EAAG,IAAK,CAAG,EAEnEvpB,EAAQ,QAAQ,iBAAiB,UAAWupB,CAAM,CAElD,CAEF,CAIA/nB,EAAc,SAAU8nB,EAAQ,ECtBhC,MAAME,WAA4Bte,EAAY,CAE7C,YAAa9M,EAAMmqB,EAAgB,KAAMkB,EAAe,KAAMC,EAAoB,KAAO,CAExF,MAAOtrB,CAAI,EAEX,KAAK,cAAgBmqB,EACrB,KAAK,aAAekB,EACpB,KAAK,kBAAoBC,EAEzB,KAAK,SAAW,IAEhB,CAED,YAAa,CAEZ,KAAM,CAAE,aAAAD,EAAc,kBAAAC,CAAmB,EAAG,KAEtCb,EAAgBzgB,IAAO,KAAM,eAAiB,EACnD0gB,EAAiB1gB,EAAI,EAAG,KAAM,gBAAkB,EAChD2gB,EAAkB3gB,EAAI,EAAG,KAAM,iBAAmB,EAClD4gB,EAAmB5gB,EAAI,EAAG,KAAM,kBAAkB,EAE7CuhB,EAAiB,CACtB,cAAAd,EACA,eAAAC,EACA,gBAAAC,EACA,iBAAAC,CACH,EAYE,MAVgB,CACf,SAAU5gB,EAAI,EAAG,KAAM,UAAY,EACnC,WAAYA,EAAI,EAAG,KAAM,YAAc,EACvC,cAAeA,EAAI,EAAG,KAAM,eAAiB,EAC7C,iBAAkBtB,EAAO,GAAI,KAAM,kBAAoB,EACvD,eAAA6iB,EACA,SAAUF,EACV,cAAeC,CAClB,CAIE,CAED,MAAO1pB,EAAU,CAEhB,YAAK,QAAU,KAAK,WAAc,KAAK,SAAW,KAAK,WAAU,GACjE,KAAK,QAAQ,cAAgB,KAAK,eAAiBA,EAAQ,QAAQ,cAE5D,MAAM,MAAOA,EAEpB,CAEF,CAIO,MAAM4pB,GAAkBriB,EAAWiiB,IAE1CzlB,EAAgB,kBAAmB6lB,IAEnCpoB,EAAc,sBAAuBgoB,EAAqB,EC5D1D,MAAMK,GAAiBC,GAAwBA,EAAmB,IAAK5I,GAAgB,CAAG,EAAC,IAI9E6I,GAA8B3f,GAASyf,GAAc5O,GAAW,MAAOmG,GAAe,EAAE,iBAAiB,EAAG,YAAY,MAAO,eAAiB,ECDhJ4I,GAAgBhhB,GAAMoY,GAAa2I,GAAe9O,EAAU,EAExCgE,EAAsB,IAAK+K,IAGrD,MAAMC,IAA8B,IAAM,CAIhD,IAAIC,EAAatd,GAAY,MAAOqS,CAAqB,EACzD,OAAAiL,EAAaA,EAAW,MAAOtd,EAAa,EAAC,UAAS,EACtDsd,EAAa7U,GAAK6U,EAAY/O,GAAuBzO,GAAW,IAAKV,GAAU,SAAU,CAAA,EAAG,SAAU,EAAC,KAAI,EAAG,KAAM,CAAA,EAAG,YAEhHke,CAGR,GAAK,ECpBL,MAAMC,WAAiBxqB,CAAK,CAE3B,YAAayqB,EAAUC,EAAQC,EAAW,KAAO,CAEhD,QAEA,KAAK,SAAWF,EAEhB,KAAK,OAASC,EACd,KAAK,SAAWC,CAEhB,CAED,YAAatqB,EAAU,CAEtB,MAAMuqB,EAAS,KAAK,OAAO,YAAavqB,CAAO,EAE/C,GAAK,KAAK,WAAa,KAAO,CAE7B,MAAMwqB,EAAW,KAAK,SAAS,YAAaxqB,CAAO,EAEnD,GAAKA,EAAQ,cAAewqB,CAAQ,EAAKxqB,EAAQ,cAAeuqB,GAE/D,OAAOC,CAIR,CAED,OAAOD,CAEP,CAED,MAAOvqB,EAAU,CAEhB,MAAMQ,EAAaR,EAAQ,kBAAmB,IAAI,EAClDQ,EAAW,SAAW,KAAK,SAAS,MAAK,EACzCA,EAAW,OAAS,KAAK,OAAO,MAAK,EACrCA,EAAW,SAAW,KAAK,SAAW,KAAK,SAAS,MAAO,EAAG,IAE9D,CAED,SAAUR,EAASld,EAAS,CAE3B,MAAM6b,EAAO,KAAK,YAAaqB,CAAO,EAEhCI,EAAWJ,EAAQ,gBAAiB,IAAI,EAE9C,GAAKI,EAAS,eAAiB,OAE9B,OAAOA,EAAS,aAIjB,KAAM,CAAE,SAAAgqB,EAAU,OAAAC,EAAQ,SAAAC,CAAU,EAAGtqB,EAAQ,kBAAmB,MAE5DyqB,EAAc3nC,IAAW,OACzBorB,EAAeuc,EAAcxsB,GAAUU,CAAM,EAAC,MAAOqB,CAAS,EAAG,GAEvEI,EAAS,aAAe8N,EAExB,MAAMlM,EAAcooB,EAAS,MAAOpqB,EAAS,MAAM,EAEnDA,EAAQ,YAAa;AAAA,EAAMA,EAAQ,WAAagC,CAAa;AAAA;AAAA,CAAW,EAAC,WAAU,EAEnF,IAAI0oB,EAAYL,EAAO,MAAOrqB,EAASrB,CAAI,EAkB3C,GAhBK+rB,IAECD,EAEJC,EAAYxc,EAAe,MAAQwc,EAAY,IAI/CA,EAAY,UAAYA,EAAY,KAMtC1qB,EAAQ,cAAa,EAAG,YAAaA,EAAQ,IAAM,IAAO0qB,EAAY;AAAA;AAAA,EAAS1qB,EAAQ,IAAM,GAAG,EAE3FsqB,IAAa,KAAO,CAExBtqB,EAAQ,YAAa;AAAA;AAAA,CAAe,EAAC,WAAU,EAE/C,IAAI2qB,EAAcL,EAAS,MAAOtqB,EAASrB,CAAI,EAE1CgsB,IAECF,EAEJE,EAAczc,EAAe,MAAQyc,EAAc,IAInDA,EAAc,UAAYA,EAAc,KAM1C3qB,EAAQ,cAAa,EAAG,YAAaA,EAAQ,IAAM,IAAO2qB,EAAc;AAAA;AAAA,EAAS3qB,EAAQ,IAAM;AAAA;AAAA,CAAO,CAEzG,MAEGA,EAAQ,YAAa;AAAA;AAAA,GAItB,OAAOA,EAAQ,OAAQkO,EAAcvP,EAAM7b,CAAM,CAEjD,CAEF,CAIO,MAAM8nC,GAAOrjB,EAAW4iB,IAE/BpmB,EAAgB,OAAQ6mB,IAExBppB,EAAc,WAAY2oB,EAAU,ECvHpC,MAAMU,GAAY/jB,EAAO,GACnBgkB,GAAYhkB,EAAO,IACnBikB,GAAYjkB,EAAO,IACnBkkB,GAAYlkB,EAAO,IACnBmkB,GAAYnkB,EAAO,IACnBokB,GAAYpkB,EAAO,GACnBqkB,GAAYrkB,EAAO,MACnBskB,GAAYtkB,EAAO,GACnBukB,GAAYvkB,EAAO,KACnBwkB,GAAYxkB,EAAO,GAEnBykB,GAAqBzkB,EAAO,GAC5B0kB,GAAqB1kB,EAAO,IAM5B2kB,GAAU3mB,EAAO,CAAE,CAAEzjB,KAAiB,CAE3C,MAAMqqC,EAAetjB,EAAMgK,GAAK/wB,CAAW,CAAA,EAAG,QACxCsqC,EAAO7kB,EAAO,EAAO,EAAC,MAAK,EAEjC,OAAAe,GAAI6jB,EAAa,EAAE,YAAaA,EAAa,CAAC,EAAI,IAAM,CAEvD7jB,GAAI6jB,EAAa,EAAE,YAAaA,EAAa,CAAC,EAAI,IAAM,CAEvDC,EAAK,OAAQf,GAAMvpC,EAAU,EAAE,YAAa,GAAO,EAAK,CAAG,EAE9D,CAAK,EAAC,KAAM,IAAM,CAEfsqC,EAAK,OAAQf,GAAMvpC,EAAU,EAAE,YAAa,GAAO,EAAK,CAAG,EAE9D,EAEA,CAAI,EAAC,KAAM,IAAM,CAEfwmB,GAAI6jB,EAAa,EAAE,YAAaA,EAAa,CAAC,EAAI,IAAM,CAEvDC,EAAK,OAAQf,GAAMvpC,EAAU,EAAE,YAAa,GAAO,EAAK,CAAG,EAE9D,CAAK,EAAC,KAAM,IAAM,CAEfsqC,EAAK,OAAQf,GAAMvpC,EAAU,EAAE,YAAa,GAAO,EAAK,CAAG,EAE9D,EAEA,GAEQsqC,CAER,CAAC,EAAG,UAAW,CACd,KAAM,UACN,KAAM,QACN,OAAQ,CACP,CAAE,KAAM,YAAa,KAAM,MAAQ,CACnC,CACF,GAGMC,GAAQ9mB,EAAO,CAAE,CAAEzjB,EAAWsqC,CAAI,IAAQ,CAE/C,MAAMzc,EAAKlH,IAAO,QAElB,OAAAH,GAAI8jB,EAAK,MAAO,CAAK,EAAE,IAAM,CAE5Bzc,EAAG,OAAQlH,EAAM3mB,EAAU,EAAGA,EAAU,CAAG,EAAC,IAAK+wB,GAAK/wB,EAAU,CAAC,CAAI,CAAA,CAErE,CAAA,EAAG,OAAQsqC,EAAK,MAAO,CAAK,EAAE,IAAM,CAEpCzc,EAAG,OAAQlH,EAAM3mB,EAAU,EAAE,OAAM,EAAIA,EAAU,EAAE,OAAM,CAAI,EAAC,IAAK+wB,GAAK/wB,EAAU,CAAG,CAAA,EAErF,CAAA,EAAG,OAAQsqC,EAAK,MAAO,CAAK,EAAE,IAAM,CAEpCzc,EAAG,OAAQlH,EAAM3mB,EAAU,EAAE,OAAM,EAAIA,EAAU,CAAG,EAAC,IAAK+wB,GAAK/wB,EAAU,CAAC,CAAI,CAAA,CAE9E,CAAA,EAAG,OAAQsqC,EAAK,MAAO,CAAK,EAAE,IAAM,CAEpCzc,EAAG,OAAQlH,EAAM3mB,EAAU,EAAE,OAAM,EAAIA,EAAU,CAAG,EAAC,IAAK+wB,GAAK/wB,EAAU,CAAC,CAAI,CAAA,CAE9E,CAAA,EAAG,OAAQsqC,EAAK,MAAO,CAAK,EAAE,IAAM,CAEpCzc,EAAG,OAAQlH,EAAM3mB,EAAU,EAAE,OAAM,EAAIA,EAAU,CAAG,EAAC,IAAK+wB,GAAK/wB,EAAU,CAAC,CAAI,CAAA,CAEhF,CAAI,EAAC,KAAM,IAAM,CAEf6tB,EAAG,OAAQlH,EAAM3mB,EAAU,EAAGA,EAAU,CAAG,EAAC,IAAK+wB,GAAK/wB,EAAU,CAAC,CAAI,CAAA,CAEvE,GAEQ+uB,EAAK,GAAKlB,EAAG,IAAK,CAAK,CAAA,CAE/B,CAAC,EAAG,UAAW,CACd,KAAM,QACN,KAAM,OACN,OAAQ,CACP,CAAE,KAAM,YAAa,KAAM,MAAQ,EACnC,CAAE,KAAM,OAAQ,KAAM,OAAS,CAC/B,CACF,GAEM2c,GAAiB/mB,EAAO,CAAE,CAAEkH,KAAiB,CAElD,MAAM8f,EAAMhlB,EAAO,CAAK,EAAC,MAAK,EAE9B,OAAAe,GAAImE,EAAU,iBAAkB+e,EAAW,EAAE,IAAM,CAElDe,EAAI,OAAQjB,GAAU,IAAK7e,CAAS,EAAG,IAAKgf,GAAU,IAAKF,EAAW,CAAA,EAAG,IAAKD,GAAU,IAAKE,EAAW,CAAA,EAAG,IAAKD,EAAS,EAEzH,CAAA,EAAG,OAAQ9e,EAAU,iBAAkBif,EAAW,EAAE,IAAM,CAE1Da,EAAI,OAAQf,GAAU,IAAK/e,CAAS,EAAG,IAAKkf,GAAU,IAAKF,EAAW,CAAA,EAAG,IAAKD,GAAU,IAAKE,EAAW,CAAA,EAAG,IAAKD,EAAS,EAEzH,CAAA,EAAG,OAAQhf,EAAU,iBAAkBmf,EAAW,EAAE,IAAM,CAE1DW,EAAI,OAAQb,GAAU,IAAKjf,CAAS,EAAG,IAAKof,GAAU,IAAKF,EAAW,CAAA,EAAG,IAAKD,GAAU,IAAKE,EAAW,CAAA,EAAG,IAAKD,EAAS,EAEzH,CAAA,EAAG,OAAQlf,EAAU,iBAAkBqf,EAAW,EAAE,IAAM,CAE1DS,EAAI,OAAQX,GAAU,IAAKnf,CAAS,EAAG,IAAKsf,GAAU,IAAKF,EAAW,CAAA,EAAG,IAAKD,GAAU,IAAKE,EAAW,CAAA,EAAG,IAAKD,EAAS,EAE3H,CAAI,EAAC,KAAM,IAAM,CAEfU,EAAI,OAAQhlB,EAAO,EAAK,EAAG,IAAKiM,GAAM3C,EAAK,KAAMpE,CAAW,CAAA,CAAI,CAAA,CAElE,GAEQ8f,CAER,CAAC,EAAG,UAAW,CACd,KAAM,iBACN,KAAM,QACN,OAAQ,CACP,CAAE,KAAM,YAAa,KAAM,OAAS,CACpC,CACF,GAG4BhnB,EAAO,CAAE,CAAEinB,EAAcJ,KAAY,CAEhE,MAAMzc,EAAK6c,EAAa,QACxB7c,EAAG,OAAQkB,EAAK,EAAKlB,CAAE,EAAG,IAAK,CAAG,GAClC,MAAM7tB,EAAY+mB,EAAM8G,EAAI,CAAK,EAAC,MAAK,EAEvC,OAAArH,GAAI8jB,EAAK,MAAO,CAAK,EAAE,IAAM,CAE5BtqC,EAAU,OAAQA,EAAU,IAE5B,CAAA,EAAG,OAAQsqC,EAAK,MAAO,CAAK,EAAE,IAAM,CAEpCtqC,EAAU,OAAQA,EAAU,KAC5BA,EAAU,GAAG,UAAW,EAAK,CAE7B,CAAA,EAAG,OAAQsqC,EAAK,MAAO,CAAK,EAAE,IAAM,CAEpCtqC,EAAU,EAAE,UAAW,EAAK,CAE5B,CAAA,EAAG,OAAQsqC,EAAK,MAAO,CAAK,EAAE,IAAM,CAEpCtqC,EAAU,OAAQA,EAAU,KAC5BA,EAAU,GAAG,UAAW,EAAK,CAE7B,CAAA,EAAG,OAAQsqC,EAAK,MAAO,CAAK,EAAE,IAAM,CAEpCtqC,EAAU,OAAQA,EAAU,KAC5BA,EAAU,GAAG,UAAW,EAAK,CAE7B,CAAA,EAAG,OAAQsqC,EAAK,MAAO,CAAK,EAAE,IAAM,CAEpCtqC,EAAU,EAAE,UAAW,EAAK,CAE9B,GAEQA,CAER,CAAC,EAAG,UAAW,CACd,KAAM,eACN,KAAM,OACN,OAAQ,CACP,CAAE,KAAM,KAAM,KAAM,MAAQ,EAC5B,CAAE,KAAM,OAAQ,KAAM,OAAS,CAC/B,CACF,CAAI,EAIG,MAAM2qC,GAAgBlnB,EAAO,CAAE,CAAEmnB,EAAQC,EAAqBC,EAAqBC,EAAoBC,EAAqBC,KAAsB,CAExJ,MAAMtgB,EAAYlF,EAAOqlB,GACnBI,EAAYnkB,EAAM8jB,GAElBJ,EAAMxW,GAAOuW,GAAgB7f,CAAS,EAAI8e,GAAWwB,GACrDE,EAAOpZ,GAAO0Y,GACdW,EAASvZ,GAAO4Y,GAChBY,EAAStkB,EAAMukB,GAAgBV,EAAQM,EAAWE,EAAQL,EAAoBC,EAAqBC,EAAkB,EAAC,MAAK,EAEjI,OAAAzkB,GAAI2kB,EAAK,SAAU,CAAK,EAAE,IAAM,CAE/B,MAAMI,EAASxkB,EAAMukB,GAAgBV,EAAQM,EAAWE,EAAO,IAAK,CAAK,EAAEL,EAAoBC,EAAqBC,CAAc,CAAI,EAAC,MAAK,EAE5II,EAAO,OAAQrX,GAAKqX,EAAQE,EAAQJ,CAAI,EAE1C,GAEQE,CAER,GAEMC,GAAiB7nB,EAAO,CAAE,CAAEmnB,EAAQY,EAAqBC,EAAkBV,EAAoBC,EAAqBC,KAAsB,CAE/I,MAAMG,EAAS3lB,EAAOgmB,CAAkB,EAAC,MAAK,EACxCzrC,EAAY+mB,EAAMykB,GAClBlB,EAAO7kB,EAAO2kB,GAASpqC,CAAW,CAAA,EAAG,QACrC0rC,EAAYjmB,EAAOyN,GAAKgX,GAAmB,IAAKkB,CAAM,EAAI,CAAG,GAAK,QACxEA,EAAO,OAAQlY,GAAKkY,EAAQlB,EAAoB,CAAA,EAChD,MAAMyB,EAAWlmB,EAAO+L,GAAM4Z,CAAQ,CAAA,EAAG,QACnCvd,EAAKlH,EAAM4jB,GAAOvqC,EAAWsqC,CAAM,EAAC,IAAKqB,EAAS,IAAK,CAAK,CAAA,EAAG,IAAK,CAAK,CAAA,EAAG,QAElF,OAAAnlB,GAAI8jB,EAAK,YAAa,CAAK,EAAE,IAAM,CAElCzc,EAAG,EAAE,UAAW8d,GAChBrB,EAAK,UAAW,EAElB,GAECzc,EAAG,EAAE,UAAWyc,EAAK,IAAKqB,CAAQ,GAClC9d,EAAG,EAAE,UAAW6d,EAAU,IAAK3c,EAAK,EAAKob,EAAoB,CAAA,GAC7Dtc,EAAG,EAAE,UAAWkB,EAAK,EAAKyC,GAAMyZ,GAAiB,IAAKU,CAAQ,CAAI,CAAA,EAClE9d,EAAG,EAAE,UAAWkd,GAChBld,EAAG,EAAE,UAAWmd,GAETJ,EAAO,GAAI/c,CAAI,EAAC,KAAMlH,EAAM,EAAEA,EAAI,EAE1C,GAEMilB,GAAYnoB,EAAO,CAAE,CAAE,OAAAmnB,EAAQ,OAAAQ,EAAQ,gBAAAS,EAAiB,MAAAC,EAAO,KAAAC,EAAM,mBAAAhB,EAAoB,oBAAAC,EAAqB,eAAAC,CAAc,IAAQ,CAEzI,MAAMe,EAAW/Z,GAAK6Z,GAGhBG,EAAkBJ,EAAgB,IAAKG,CAAU,EACrD,IAAKD,EAAK,MAAOF,CAAe,EAAG,IAAK7Z,GAAK8Z,CAAK,EAAM,EACxD,IAAKC,EAAK,IAAKA,EAAK,IAAKF,GAAkB,IAAKG,EAAS,SAAU,CAAA,CAAI,CAAA,EAEzE,OAAOV,GAAgBV,EAAQqB,EAAiBb,EAAQL,EAAoBC,EAAqBC,EAElG,GAEoBxnB,EAAO,CAAE,CAAE,EAAG,YAAAyoB,EAAa,SAAAC,EAAU,gBAAAN,EAAiB,QAAAO,EAAS,QAAAC,EAAS,OAAAC,EAAQ,OAAAlB,EAAQ,OAAAR,EAAQ,mBAAAG,EAAoB,oBAAAC,EAAqB,eAAAC,CAAc,IAAQ,CAElL,MAAMc,EAAOhlB,EAAMwiB,GAAM2C,EAAaC,EAAU3Y,GAAO2Y,EAAUN,CAAe,EAAM,EAAC,MAAK,EAE5FrlB,GAAI0K,GAAK6a,EAAK,OAAQhlB,EAAM,CAAG,CAAI,CAAA,EAAI,IAAM,CAE5CglB,EAAK,OAAQhlB,EAAM8kB,EAAgB,EAAG,EAAKA,EAAgB,EAAE,OAAQ,CAAA,EAEvE,GAECE,EAAK,OAAQjb,GAAWib,CAAM,CAAA,EAE9B,MAAMQ,EAAexlB,IAAO,QAC5B,OAAAwlB,EAAa,UAAWH,EAAQ,QAAS7mB,GAAK,EAAK,EAAC,IAAKqmB,GAAW,CAAE,MAAO,EAAK,KAAAG,EAAM,gBAAAF,EAAiB,OAAAT,EAAQ,OAAAR,EAAQ,mBAAAG,EAAoB,oBAAAC,EAAqB,eAAAC,EAAkB,CAAA,GAEpLzI,GAAM,CAAE,MAAOjd,GAAK,CAAC,EAAI,IAAK,CAAG,EAAE,CAAE,CAAE,EAAAvf,KAAS,CAE/CwgB,GAAIxgB,EAAE,iBAAkBqmC,CAAS,EAAE,IAAM,CAExC5J,IAEH,GAEE,MAAMqJ,EAAQrmB,EAAO6mB,EAAO,IAAK7mB,EAAOzf,CAAG,CAAA,GAAK,QAChDumC,EAAa,UAAWH,EAAQ,QAASpmC,GAAI,IAAK4lC,GAAW,CAAE,MAAOE,EAAM,IAAK,IAAS,KAAAC,EAAM,gBAAAF,EAAiB,OAAAT,EAAQ,OAAAR,EAAQ,mBAAAG,EAAoB,oBAAAC,EAAqB,eAAAC,EAAkB,CAAA,GAC5LsB,EAAa,UAAWH,EAAQ,QAASpmC,GAAI,IAAK4lC,GAAW,CAAE,MAAAE,EAAO,KAAAC,EAAM,gBAAAF,EAAiB,OAAAT,EAAQ,OAAAR,EAAQ,mBAAAG,EAAoB,oBAAAC,EAAqB,eAAAC,CAAc,CAAI,CAAA,EAE1K,GAEQ9jB,EAAMolB,EAAc,EAE5B,CAAC,ECtRD,IAAIC,GAAa,KAEjB,MAAMC,GAAS,IAAI,QAEnB,SAASC,GAAqBC,EAAc,CAE3C,MAAMC,EAAS,KAAK,KAAMD,CAAW,EAAK,EAEpCE,EAAc,EAAMF,EAI1B,MAAO,CAAE,WAFU,GAAQ,EAAI,KAAK,IAAK,KAAK,IAAK,EAAGC,CAAM,EAAI,EAAI,EAAI,GAEnD,YAAAC,EAAa,OAAAD,EAEnC,CAEA,SAASE,GAAsB/W,EAAU,CAExC,IAAIgX,EAAeN,GAAO,IAAK1W,CAAO,EAItC,IAFqBgX,IAAiB,OAAYA,EAAa,aAAe,MAExDhX,EAAQ,aAAe,CAE5C,GAAKA,EAAQ,cAAgB,CAE5B,GAAKA,EAAQ,OAAO,KAAK,KAAQA,GAAaA,IAAY,QAEzD,MAAM,IAAI,MAAO,oFAIlBgX,EAAeP,GAAW,YAAazW,EAASgX,CAAY,CAE/D,KAAS,CAEN,GAAKhX,EAAQ,QAAU,OAEtB,MAAM,IAAI,MAAO,8EAIlBgX,EAAeP,GAAW,oBAAqBzW,EAASgX,CAAY,CAEpE,CAEDA,EAAa,aAAehX,EAAQ,aAEpC0W,GAAO,IAAK1W,EAASgX,EAErB,CAED,OAAOA,EAAa,OAErB,CAEA,MAAMC,WAAkB3sB,CAAS,CAEhC,YAAavd,EAAOszB,EAAS,KAAMpI,EAAY,KAAO,CAErD,MAAO,MAAM,EAEb,KAAK,OAASlrB,EACd,KAAK,OAAS,KAEd,KAAK,OAASszB,EACd,KAAK,UAAYpI,EAEjB,KAAK,WAAa,KAClB,KAAK,SAAW+H,GAAS,MACzB,KAAK,OAASrI,EAAS,GACvB,KAAK,QAAUA,EAAS,GACxB,KAAK,QAAUA,EAAS,GAExB,KAAK,iBAAmBpR,EAAe,MAEvC,CAED,IAAI,MAAOxZ,EAAQ,CAElB,KAAK,OAASA,EACd,KAAK,OAAS,IAEd,CAED,IAAI,OAAQ,CAEX,OAAO,KAAK,MAEZ,CAED,kBAAmBizB,EAAU,CAE5B,MAAMkX,EAAaP,GAAqB3W,EAAQ,MAAM,MAAM,EAE5D,KAAK,SAAS,MAAQA,EACtB,KAAK,OAAO,MAAQkX,EAAW,WAC/B,KAAK,QAAQ,MAAQA,EAAW,YAChC,KAAK,QAAQ,MAAQA,EAAW,MAEhC,CAED,cAAe,CAEd,IAAIC,EAAQ,KAAK,OAEjB,MAAMC,EAAeD,EAAQA,EAAM,aAAe,GAC5CnX,EAAU,KAAK,OAEhBoX,IAAiBpX,EAAQ,eAExBA,EAAQ,iBAAmB,GAE/BmX,EAAQnX,EAIRmX,EAAQJ,GAAsB/W,GAI/B,KAAK,OAASmX,EAEd,KAAK,kBAAmBA,GAIzB,CAED,MAAOvuB,EAAU,CAEX6tB,KAAe,OAEnBA,GAAa7tB,EAAQ,wBAMtB,KAAK,aAAcA,GAInB,IAAIyX,EAAS,KAAK,OAEbA,IAAW,MAAQzX,EAAQ,QAAQ,QAEvCyX,EAASzX,EAAQ,QAAQ,MAAO,IAAI,GAMrC,MAAMoX,EAAU,KAAK,MAEhBpX,EAAQ,SAAS,mBAAqByuB,IAAyBrX,EAAQ,iBAAmB,IAAQA,EAAQ,wBAA0B,KAExIK,EAASrP,EAAMqP,EAAO,EAAE,SAAUA,EAAO,KAM1C,IAAIpI,EAAY,KAAK,UAErB,OAAKA,IAAc,MAAQrP,EAAQ,QAAQ,kBAE1CqP,EAAYrP,EAAQ,QAAQ,gBAAiB,IAAI,GAM3CgsB,GAAe,KAAK,SAAUvU,EAAQpI,EAAW,KAAK,OAAQ,KAAK,QAAS,KAAK,OAAO,CAE/F,CAEF,CAEO,MAAMqf,GAAennB,EAAW8mB,IAEvC7sB,EAAc,YAAa6sB,EAAW,ECjLtC,MAAMM,GAAe,IAAI,QAEzB,MAAMC,WAAwBtI,EAAa,CAE1C,YAAauI,EAAU,KAAO,CAE7B,QAEA,KAAK,QAAUA,CAEf,CAED,MAAO7uB,EAAU,CAEhB,IAAI6uB,EAAU,KAAK,QAEnB,GAAKA,EAAQ,cAAgB,CAE5B,IAAIC,EAAeH,GAAa,IAAKE,EAAQ,KAAK,EAE7CC,IAAiB,SAErBA,EAAeJ,GAAcG,EAAQ,OAErCF,GAAa,IAAKE,EAAQ,MAAOC,CAAY,GAI9CD,EAAUC,CAEV,CAID,KAAM,CAAE,SAAAnV,CAAU,EAAG3Z,EAGf+uB,EADSpV,EAAS,OACGH,GAAW,kBAAmB,QAASxZ,EAAQ,QAAU,EAAGwZ,GAAW,uBAAwB,QAASxZ,EAAQ,KAAK,EAG1IgvB,EADgBrV,EAAS,gBAAkB,IAAQA,EAAS,WAAa,EACpCsQ,GAA4B9O,GAEjE8T,EAAW9jB,GAAS0jB,EAASK,GAAuBljB,GAAWgjB,EAAsB,EAAC,IAAKD,GAC3FI,EAAahkB,GAAS0jB,EAASO,GAAyBhU,EAAwB,CAAA,EAAG,IAAK,KAAK,EAAE,EAAG,IAAK2T,CAAS,EAEhHM,EAAkBhuB,GAAO4tB,GACzBK,EAAoBjuB,GAAO8tB,GAIjCnvB,EAAQ,QAAQ,SAAS,UAAWqvB,CAAe,EAEnDrvB,EAAQ,QAAQ,cAAc,UAAWsvB,CAAiB,EAI1D,MAAMC,EAAoBvvB,EAAQ,QAAQ,cAAc,kBAExD,GAAKuvB,EAAoB,CAExB,MAAMC,EAA2BrkB,GAAS0jB,EAASK,GAAuB/iB,GAAoBkP,GAAkC,EAAC,IAAK0T,GAChIU,EAA2BpuB,GAAOmuB,GAExCD,EAAkB,UAAWE,EAE7B,CAED,CAEF,CAEA,MAAMP,GAAwB,CAAEtT,EAAe8T,IAAoB,CAElE,IAAIC,EAAa,KAEjB,MAAO,CACN,MAAO,KAEDA,IAAe,OAEnBA,EAAa1Q,EAAsB,OAAQ,EAAC,QAASyQ,CAAc,EAGnEC,EAAa/T,EAAc,IAAKA,CAAe,EAAC,IAAK+T,EAAYD,GAAiB,YAElFC,EAAaA,EAAW,mBAAoBxV,KAItCwV,GAGR,gBAAiB,IAET/T,CAGV,CAEA,EAEMwT,GAA4BQ,IAE1B,CACN,MAAO,IAECA,EAGR,gBAAiB,IAET9oB,EAAO,EAGjB,GAMAtF,EAAc,kBAAmBotB,EAAiB,EClIlD,MAAMiB,WAAuBvJ,EAAa,CAEzC,YAAaloB,EAAO,CAEnB,QAEA,KAAK,KAAOA,CAEZ,CAED,MAAO4B,EAAU,CAEhBA,EAAQ,QAAQ,WAAW,UAAW,KAAK,IAAI,CAE/C,CAEF,CAIAwB,EAAc,iBAAkBquB,EAAgB,EChBhD,IAAIC,GAAYC,GAEhB,MAAMC,UAAqBrwB,CAAK,CAE/B,YAAa0F,EAAQ,CAEpB,QAEA,KAAK,MAAQA,EAEb,KAAK,eAAiB,EAEtB,CAED,aAAc,CAEb,OAAK,KAAK,QAAU2qB,EAAa,SAAkB,OACzC,KAAK,QAAUA,EAAa,WAAoB,OAC9C,MAEZ,CAED,eAAgB,CAEf,IAAIjwB,EAAapC,EAAe,KAEhC,OAAK,KAAK,QAAUqyB,EAAa,YAAc,KAAK,QAAUA,EAAa,YAE1EjwB,EAAapC,EAAe,QAI7B,KAAK,WAAaoC,EAEXA,CAEP,CAED,OAAQ,CAAE,SAAA2nB,GAAa,CAEjB,KAAK,QAAUsI,EAAa,SAEhCtI,EAAS,YAAaqI,IAItBrI,EAAS,qBAAsBoI,GAIhC,CAED,OAAqB,CAEpB,MAAMzqB,EAAQ,KAAK,MAEnB,IAAIviB,EAAS,KAEb,GAAKuiB,IAAU2qB,EAAa,WAE3BltC,EAASisB,EAAS+gB,KAAgBA,GAAa,IAAI/wB,aAExCsG,IAAU2qB,EAAa,SAElCltC,EAASisB,EAASghB,KAAoBA,GAAiB,IAAI9wB,SAErD,CAENnc,EAASmtC,GAAmB,IAAKC,IAEjC,IAAIC,EAAOrtC,EAAO,EACdstC,EAAOttC,EAAO,EAEb,UAAU,KAAMuiB,CAAK,IAAK+qB,EAAOA,EAAK,YACtC,SAAS,KAAM/qB,CAAK,IAAK8qB,EAAOA,EAAK,YAE1CrtC,EAASklB,EAAMmoB,EAAMC,EAErB,CAED,OAAOttC,CAEP,CAED,SAAUkd,EAAU,CAEnB,GAAK,KAAK,QAAUgwB,EAAa,WAAa,CAE7C,IAAIK,EAAQrwB,EAAQ,eAEpB,GAAKA,EAAQ,UAAY,CAIxB,MAAM8vB,EAAa9vB,EAAQ,kBAAmBkwB,EAAoB,EAAC,WAAW,MAAOlwB,GAErFqwB,EAAQ,GAAIrwB,EAAQ,QAAS,MAAM,CAAI,KAAKqwB,CAAO,OAAOP,CAAY,QAAQO,CAAO,OAAOA,CAAO,MAEnG,CAED,OAAOA,CAEP,CAED,OAAO,MAAM,SAAUrwB,EAEvB,CAEF,CAEAgwB,EAAa,WAAa,aAC1BA,EAAa,WAAa,aAC1BA,EAAa,SAAW,WACxBA,EAAa,SAAW,UACxBA,EAAa,YAAc,aAC3BA,EAAa,UAAY,WACzBA,EAAa,aAAe,cAIrB,MAAMC,GAAqBzoB,EAAewoB,EAAcA,EAAa,UAAU,EACzEE,GAAqB1oB,EAAewoB,EAAcA,EAAa,UAAU,EACzEM,GAAW9oB,EAAewoB,EAAcA,EAAa,QAAQ,EAC7DO,GAAkB/oB,EAAewoB,EAAcA,EAAa,QAAQ,EAC/CxoB,EAAewoB,EAAcA,EAAa,WAAc,EAC1DxoB,EAAewoB,EAAcA,EAAa,SAAY,EACnDxoB,EAAewoB,EAAcA,EAAa,YAAe,EAE5FxuB,EAAc,eAAgBwuB,CAAc,EChI5C,MAAMQ,GAAQ,IAAIzxB,GAElB,MAAM0xB,WAA4BjZ,EAAY,CAE7C,YAAaC,EAAS8Y,GAAiBlhB,EAAY,KAAMqhB,EAAqB,KAAO,CAE/EA,IAAuB,OAE3BA,EAAqB,IAAIC,GACzBD,EAAmB,UAAYE,IAIhC,MAAOF,EAAoBjZ,EAAQpI,GAEnC,KAAK,gBAAkB,GAEvB,KAAK,oBAAsB,GAE3B,KAAK,iBAAmB1R,EAAe,KAEvC,CAED,aAAcgR,EAAQ,CAErB,MAAM+Y,EAAW/Y,EAAM,SACvB+Y,EAAS,qBAAsB8I,IAI/B,MAAME,EAAqB,KAAK,OAE3BA,EAAmB,MAAM,QAAUF,GAAM,OAASE,EAAmB,MAAM,SAAWF,GAAM,UAEhGE,EAAmB,MAAM,MAAQF,GAAM,MACvCE,EAAmB,MAAM,OAASF,GAAM,OACxCE,EAAmB,YAAc,IAMlC,MAAMG,EAAyBH,EAAmB,gBAClDA,EAAmB,gBAAkB,KAAK,gBAE1ChJ,EAAS,yBAA0BgJ,GAEnCA,EAAmB,gBAAkBG,CAErC,CAED,OAAQ,CAEP,MAAMC,EAAsB,IAAI,KAAK,YAAa,KAAK,OAAQ,KAAK,UAAW,KAAK,OACpF,OAAAA,EAAoB,gBAAkB,KAAK,gBAEpCA,CAEP,CAEF,CAIO,MAAMC,GAAkBxpB,EAAWkpB,IAC7BO,GAAqBzpB,EAAWkpB,GAAqB,KAAM,KAAM,CAAE,gBAAiB,EAAI,GAErG1sB,EAAgB,kBAAmBgtB,IACnChtB,EAAgB,qBAAsBitB,IAEtCxvB,EAAc,sBAAuBivB,EAAqB,ECvE1D,IAAIQ,GAAoB,KAExB,MAAMC,WAAiCT,EAAoB,CAE1D,YAAahZ,EAAS8Y,GAAiBlhB,EAAY,KAAO,CAEpD4hB,KAAsB,OAE1BA,GAAoB,IAAInK,IAIzB,MAAOrP,EAAQpI,EAAW4hB,GAE1B,CAEF,CAIO,MAAME,GAAuB5pB,EAAW2pB,IAE/CntB,EAAgB,uBAAwBotB,IAExC3vB,EAAc,2BAA4B0vB,EAA0B,ECxBpE,MAAME,WAA0BzxB,CAAK,CAEpC,YAAa0F,EAAOgsB,EAAY,KAAO,CAEtC,MAAO,OAAO,EAEd,KAAK,MAAQhsB,EACb,KAAK,UAAYgsB,EAEjB,KAAK,oBAAsB,EAE3B,CAED,SAAUrxB,EAAU,CAEnB,KAAM,CAAE,MAAAqF,CAAO,EAAG,KAElB,OAAKA,IAAU+rB,GAAkB,MAEzBpxB,EAAQ,eAIT,MAAM,SAAUA,EAEvB,CAED,MAAO,CAAE,OAAA+Z,GAAW,CAEnB,KAAM,CAAE,MAAA1U,CAAO,EAAG,KACZ+R,EAAU,KAAK,UAErB,IAAIhZ,EAAO,KAEX,GAAKiH,IAAU+rB,GAAkB,MAE3Bha,IAAY,KAEfhZ,EAAOkzB,GAAS,EAAG,OAAQla,CAAO,EAI9B2C,EAAO,oBAEX3b,EAAOmzB,GAAyBvS,GAAa,EAAGlF,GAAYE,EAAS,EAIrE5b,EAAOozB,GAA0BxS,GAAa,EAAGlF,GAAYE,EAAS,UAM7D3U,IAAU+rB,GAAkB,aAEvC,GAAKha,IAAY,KAEhB,GAAK2C,EAAO,oBAAsB,CAEjC,MAAM0X,EAAQC,GAAyBta,EAAS0C,GAAYE,EAAS,EAErE5b,EAAOozB,GAA0BC,EAAO3X,GAAYE,EAAS,CAElE,MAEK5b,EAAOgZ,OAMRhZ,EAAOozB,GAA0BxS,GAAa,EAAGlF,GAAYE,EAAS,EAMxE,OAAO5b,CAEP,CAEF,CAKO,MAAMozB,GAA2B,CAAEC,EAAOE,EAAMC,IAASH,EAAM,IAAKE,CAAI,EAAG,IAAKA,EAAK,IAAKC,CAAK,CAAA,EAQzFL,GAA0B,CAAEE,EAAOE,EAAMC,IAASD,EAAK,IAAKF,GAAQ,IAAKG,GAAM,IAAKA,EAAI,IAAKD,CAAI,EAAG,IAAKF,CAAK,GAG9GC,GAA0B,CAAErN,EAAOsN,EAAMC,IAASD,EAAK,IAAKC,GAAM,IAAKA,EAAI,IAAKD,CAAI,EAAG,IAAKtN,CAAK,EAAG,IAAKuN,CAAG,GAEzHR,GAAkB,MAAQ,QAC1BA,GAAkB,aAAe,cAIjC,MAAME,GAAY/pB,EAAW6pB,GAAmBA,GAAkB,KAAK,EAE1D/M,GAAQ7c,EAAe4pB,GAAmBA,GAAkB,KAAK,EACjES,GAActqB,EAAW6pB,GAAmBA,GAAkB,YAAY,EACpDS,GAAaV,GAAoB,CAAK,EAEzE9M,GAAM,OAAWlgC,GAAWmtC,GAAWntC,CAAK,EAE5Cqd,EAAc,oBAAqB4vB,EAAmB,EC7GtD,MAAMU,WAAqBnyB,CAAK,CAE/B,YAAa0F,EAAQysB,GAAa,QAAU,CAE3C,QAEA,KAAK,MAAQzsB,CAEb,CAED,MAAOrF,EAAU,CAEhB,MAAM,MAAOA,GAEb,MAAM+xB,EAAkB/xB,EAAQ,gBAC1B,CAAE,sBAAAgyB,EAAuB,mBAAAC,EAAoB,oBAAAC,CAAmB,EAAKH,EAErEI,EAAoBD,EAAsBD,EAC1CG,EAAyBJ,EAAwBG,EAAoBF,EAAqBE,EAEhG,OAAK,KAAK,QAAUL,GAAa,kBAEzB,KAAK,qBAAsBC,EAAgB,OAAQI,EAAmBC,GAItE,KAAK,aAAcL,EAAgB,OAAQI,EAAmBC,EAItE,CAED,qBAAsBC,EAAQF,EAAmBC,EAAyB,CAEzE,OAAOttB,EAAO,IAAM,CAEnB,MAAMwtB,EAAiBpZ,GAAUmZ,GAE3BE,EAAkBt0B,GAAU,QAAS,iBAAiB,EACtDu0B,EAAmBv0B,GAAU,QAAS,oBAAoB,EAE1Dw0B,EAAcx0B,GAAU,QAAS,aAAa,EAEpDw0B,EAAY,OAAQ,GAEpB,IAAIC,EAeJ,GAbA7O,GAAMuO,EAAwB,CAAE,CAAE,EAAA/qC,KAAS,CAE1CqrC,EAAQJ,EAAe,QAASjrC,GAEhCkrC,EAAgB,OAAQvT,GAAa,IAAK0T,EAAM,KAAM,OAAQ,EAAC,IAAKA,EAAM,CAAG,CAAA,EAC7EF,EAAiB,OAAQD,EAAgB,OAAQ,EAAC,IAAK,CAAG,GAE1DE,EAAY,UAAW9c,GAAY6c,EAAiB,OAAM,EAAIA,EAAkBD,CAAe,GAE/FE,EAAY,MAAO,CAAK,EAAC,QAAO,CAEpC,GAEQL,EAAyBD,EAAoB,CAEjD,MAAMQ,EAAmB10B,GAAU,QAAS,kBAAkB,EAE9D00B,EAAiB,OAAQ,GAEzB9O,GAAM,CAAE,MAAOuO,EAAwB,IAAKD,GAAqB,CAAE,CAAE,EAAA9qC,KAAS,CAE7EqrC,EAAQJ,EAAe,QAASjrC,GAEhCkrC,EAAgB,OAAQvT,GAAa,IAAK0T,EAAM,KAAM,OAAQ,EAAC,IAAKA,EAAM,CAAG,CAAA,EAC7EF,EAAiB,OAAQD,EAAgB,OAAQ,EAAC,IAAK,CAAG,GAE1DI,EAAiB,UAAWhd,GAAY6c,EAAiB,SAAUA,EAAkBD,CAAe,EAAG,SAAQ,EAEpH,GAEIE,EAAY,UAAWE,EAAiB,SAAU,CAAA,CAElD,CAED5mB,EAAa,EAAE,UAAW0mB,GAE1B1mB,EAAa,EAAE,MAAO,CAAK,EAAC,QAAO,CAEnC,CAAA,GAED,CAED,aAAcsmB,EAAQF,EAAmBC,EAAyB,CAEjE,OAAOttB,EAAO,IAAM,CAEnB,MAAMwtB,EAAiBpZ,GAAUmZ,GAEjC,IAAIK,EASJ,GAPA7O,GAAMuO,EAAwB,CAAE,CAAE,KAAS,CAE1CM,EAAQJ,EAAe,QAAS,GAChCtT,GAAa,IAAK0T,EAAM,GAAK,EAAC,YAAaA,EAAM,GAAI,SAEzD,GAEQN,EAAyBD,EAAoB,CAEjD,MAAMS,EAAU30B,GAAU,OAAQ,SAAS,EAE3C20B,EAAQ,OAAQ,IAEhB/O,GAAM,CAAE,MAAOuO,EAAwB,IAAKD,GAAqB,CAAE,CAAE,EAAA9qC,KAAS,CAE7EqrC,EAAQJ,EAAe,QAASjrC,GAChCurC,EAAQ,OAAQ5T,GAAa,IAAK0T,EAAM,GAAG,EAAG,YAAaA,EAAM,CAAC,EAAG,IAAKE,CAAS,CAAA,CAExF,GAEIA,EAAQ,QAAO,CAEf,CAED,CAAA,GAED,CAEF,CAEAd,GAAa,kBAAoB,kBACjCA,GAAa,QAAU,UAIhB,MAAMe,GAAW,IAAMruB,EAAY,IAAIstB,EAAc,EAE/CgB,GAAgB,IAAMtuB,EAAY,IAAIstB,GAAcA,GAAa,iBAAiB,CAAI,EC5InG,MAAMiB,WAAwBpzB,CAAK,CAElC,aAAc,CAEb,MAAO,MAAM,EAEb,KAAK,kBAAoB,EAEzB,CAED,SAAUK,EAAU,CAEnB,KAAM,CAAE,SAAA0nB,EAAU,SAAA/N,CAAU,EAAG3Z,EAE/B,OAAK0nB,EAAS,mBAAqB+G,IAE7B9U,EAAS,OAASqZ,GAEf,QAMFhzB,EAAQ,gBAEf,CAEF,CAIO,MAAMizB,GAAczrB,EAAeurB,IAC7BG,GAAgBpsB,EAAOmsB,IAAc,IAAK,GAAM,IAAK,GAElEzxB,EAAc,kBAAmBuxB,EAAiB,ECZlD,MAAMI,GAAgB,IAAI,IAE1B,MAAMC,WAAqBC,EAAS,CAEnC,aAAc,CAEb,QAEA,KAAK,eAAiB,GAEtB,KAAK,KAAO,KAAK,YAAY,KAE7B,KAAK,gBAAkB,GAEvB,KAAK,IAAM,GACX,KAAK,OAAS,GACd,KAAK,QAAU,GAEf,KAAK,WAAa,KAClB,KAAK,QAAU,KACf,KAAK,OAAS,KAEd,KAAK,UAAY,KACjB,KAAK,WAAa,KAClB,KAAK,YAAc,KACnB,KAAK,aAAe,KACpB,KAAK,kBAAoB,KACzB,KAAK,cAAgB,KAErB,KAAK,aAAe,KAEpB,KAAK,UAAY,KACjB,KAAK,WAAa,KAClB,KAAK,mBAAqB,KAE1B,KAAK,WAAa,KAElB,KAAK,aAAe,KACpB,KAAK,WAAa,IAElB,CAED,uBAAwB,CAEvB,OAAO,KAAK,KAAOx1B,GAAa,IAAI,CAEpC,CAED,MAAOmC,EAAU,CAEhB,KAAK,MAAOA,EAEZ,CAED,MAAOA,EAAU,CAIhBA,EAAQ,SAAQ,EAEhBA,EAAQ,MAAM,WAAa,KAAK,YAAc,KAAK,cAAeA,GAElEA,EAAQ,QAAS,SAAUA,EAAQ,YAAa,CAAA,EAIhDA,EAAQ,SAAQ,EAEhB,IAAIszB,EAEJ,MAAMC,EAAe,KAAK,cAAevzB,CAAO,EAIhD,GAFK,KAAK,aAAe,IAAO,KAAK,WAAYA,GAE5C,KAAK,eAAiB,KAAO,CAE5B,KAAK,UAAY,IAAO,KAAK,YAAaA,GAE/C,KAAK,kBAAmBA,GACxB,KAAK,cAAeA,GAEpB,MAAMwoB,EAAoB,KAAK,cAAexoB,CAAO,EAEhDuzB,IAAiB,MAAOvzB,EAAQ,MAAM,IAAKuzB,GAIhD,MAAMC,EAAchrB,EAAMggB,EAAmBzc,EAAa,GAAI,IAAK,GAEnEunB,EAAa,KAAK,YAAatzB,EAASwzB,CAAW,EAInD1wC,GAAO,OAAQwwC,GAIV,KAAK,aAAe,OAAOA,EAAa,KAAK,WAErD,KAAS,CAEN,IAAIG,EAAe,KAAK,aAEnBA,EAAa,qBAAuB,KAExCA,EAAejrB,EAAMirB,IAItBH,EAAa,KAAK,YAAatzB,EAASyzB,CAAY,CAEpD,CAEDzzB,EAAQ,MAAM,WAAaszB,EAE3BtzB,EAAQ,QAAS,WAAYA,EAAQ,YAAa,CAAA,CAElD,CAED,cAAeA,EAAU,CAExB,GAAKA,EAAQ,kBAAoB,KAAO,OAAO,KAE/C,KAAM,CAAE,oBAAAkyB,EAAqB,mBAAAD,GAAuBjyB,EAAQ,gBAE5D,IAAIlJ,EAAS,KAEb,OAAKo7B,GAAuBD,KAEtB,KAAK,gBAGTn7B,EAASg8B,GAAa,EAItB9yB,EAAQ,MAAM,IAAK6yB,GAAU,CAAA,GAMxB/7B,CAEP,CAED,WAAYkJ,EAAU,CAErB,KAAM,CAAE,SAAA0nB,CAAU,EAAG1nB,EAIrB,IAAIkY,EAAY,KAAK,UAEhBA,IAAc,MAAQwP,EAAS,yBAA2B,KAI9DxP,EAFkBmH,GAAqB,EAAC,EAAE,IAAK,CAAC,EAE1B,OAAO,IAAKpF,IAAiB,IAAK,KAIpD/B,IAAc,MAElBmM,GAAM,OAAQnM,CAAW,EAAC,OAAM,CAIjC,CAED,cAAelY,EAAU,CAExB,KAAM,CAAE,OAAAlC,CAAQ,EAAGkC,EACbwkB,EAAW1mB,EAAO,SAkBxB,GAhBAkC,EAAQ,SAAQ,GAIXwkB,EAAS,gBAAgB,UAAYA,EAAS,gBAAgB,QAAUA,EAAS,gBAAgB,QAErGuB,GAAgBjoB,GAAS,SAIrBA,EAAO,gBAAkB,IAE7BglB,GAAmBhlB,GAAS,SAIxB,KAAK,gBAAkB,CAE3B,MAAM41B,EAAkB9Z,GAAmB,kBAAmB,SAAS,EACjE+Z,EAAoB/Z,GAAmB,oBAAqB,OAAO,EACnEga,EAAmBha,GAAmB,mBAAoB,OAAO,EAEvEiF,GAAc,UAAW7D,GAAY,UAAW,EAAC,IAAO0Y,EAAgB,EAAE,IAAKC,CAAmB,EAAC,IAAKC,CAAgB,CAAM,CAAA,CAE9H,CAEI91B,EAAO,eAEX8jB,GAAO9jB,GAAS,SAIVA,EAAO,gBAAkBA,EAAO,eAAe,6BAA+B,IAEpFmjB,GAAUnjB,GAAS,SAIf,KAAK,eAAiB,MAE1B+gB,GAAc,OAAQ,KAAK,cAI5B,MAAMgV,EAAMxU,KAEZ,OAAArf,EAAQ,QAAQ,OAASA,EAAQ,YAAW,EAC5CA,EAAQ,QAAQ,IAAM6zB,EAEfA,CAEP,CAED,kBAAmB,CAAE,OAAA/1B,EAAQ,SAAA0mB,GAAa,CAEzC,IAAIhJ,EAAY,KAAK,UAAYhT,EAAM,KAAK,SAAW,EAAGmU,GAIrD,KAAK,eAAiB,IAAQ6H,EAAS,aAAc,WAEzDhJ,EAAYhT,EAAMgT,EAAU,IAAI,IAAKhR,GAAW,QAAS,MAAQ,CAAA,EAAIgR,EAAU,CAAC,GAM5E1d,EAAO,gBAIX0d,EAFsB1P,GAAiB,OAAQ,gBAAgB,EAErC,IAAK0P,IAMhCzP,EAAa,OAAQyP,GAIrB,MAAMC,EAAc,KAAK,YAAc3U,EAAO,KAAK,WAAa,EAAGgW,GAKnE,GAJA/Q,EAAa,EAAE,OAAQA,EAAa,EAAE,IAAK0P,CAAW,GAIjD,KAAK,gBAAkB,MAAQ,KAAK,UAAY,EAAI,CAExD,MAAMqY,EAAgB,KAAK,gBAAkB,KAAOhtB,EAAO,KAAK,aAAe,EAAG4V,GAElF3Q,EAAa,EAAE,cAAe+nB,CAAe,EAAC,QAAO,CAErD,CAEI,KAAK,cAAgB,IAAS,KAAK,WAAaC,IAAkB,KAAK,kBAAoB,IAE/FhoB,EAAa,EAAE,OAAQ,EAIxB,CAED,eAA6B,CAI5B,CAED,aAAc,CAIb,GAAK,KAAK,cAAgB,GAAO,CAEhC,MAAMioB,EAAahV,GAAa,OAAO,MAAOA,GAAa,KAAI,GAAK,YAEpE7D,GAAsB,OAAQ6Y,EAAW,IAAKd,EAAe,CAAA,CAEhE,KAAS,CAEN,MAAMc,EAAa,KAAK,WAAa5rB,EAAM,KAAK,UAAY,EAAGiV,GAE/DlC,GAAsB,OAAQ6Y,EAAW,IAAKd,EAAe,CAAA,CAE7D,CAED,CAED,WAAYlzB,EAAU,CAErB,IAAI5B,EAAO,KAEX,OAAK,KAAK,QAETA,EAAO,KAAK,QAED,KAAK,OAEhBA,EAAO,KAAK,OAAO,cAAgBioB,GAAa,KAAK,QAAWjP,GAAS,KAAK,MAAM,EAEzEpX,EAAQ,kBAEnB5B,EAAO4B,EAAQ,iBAIT5B,CAEP,CAED,YAAa4B,EAAU,CAEtB,MAAM6uB,EAAU,KAAK,WAAY7uB,CAAO,EAIlCi0B,EAAqB,CAAA,EAc3B,GAZKpF,GAEJoF,EAAmB,KAAM,IAAIrF,GAAiBC,CAAS,CAAA,EAInD7uB,EAAQ,SAAS,UAErBi0B,EAAmB,KAAM,IAAIpE,GAAgBjW,GAAmB,WAAY,SAAW,CAAA,GAInF,KAAK,SAAW,MAAQ5Z,EAAQ,SAAS,MAAQ,CAErD,MAAMupB,EAAS,KAAK,SAAW,KAAO,KAAK,OAASnS,GAASpX,EAAQ,SAAS,KAAK,EAEnFi0B,EAAmB,KAAM,IAAI3K,GAAQC,CAAQ,CAAA,CAE7C,CAED,IAAI2K,EAAU,KAAK,YAAcl0B,EAAQ,WAEzC,OAAKi0B,EAAmB,OAAS,IAEhCC,EAAU9K,GAAY,CAAE,GAAG8K,EAAQ,WAAY,GAAGD,CAAkB,IAI9DC,CAEP,CAED,oBAAkC,CAIjC,CAED,cAAel0B,EAAU,CAExB,KAAM,CAAE,SAAA2Z,CAAU,EAAG3Z,EACf,CAAE,aAAAypB,EAAc,kBAAAC,EAAmB,aAAA5N,CAAY,EAAK,KAMpDsN,EAFS,KAAK,SAAW,IAAQ,KAAK,aAAe,KAE/B,KAAK,YAAappB,CAAS,EAAG,KAE1D,IAAIwoB,EAAoBzc,EAAa,IAErC,GAAKqd,GAAcA,EAAW,WAAa,GAAQ,CAElD,MAAMb,EAAgB,KAAK,mBAAoBvoB,CAAO,EAEtDwoB,EAAoBoB,GAAiBR,EAAYb,EAAekB,EAAcC,CAAiB,CAElG,MAAcD,IAAiB,OAE5BjB,EAAoBpgB,EAAMshB,IAAsB,KAAOrU,GAAKmT,EAAmBiB,EAAcC,GAAsBD,IAMpH,OAAO3N,GAAgBA,EAAa,SAAW,IAAYnC,EAAS,UAAYA,EAAS,SAAS,UAAY,MAE7G6O,EAAoBA,EAAkB,IAAKpgB,EAAM0T,GAA8Be,EAAgB,IAIzF2L,CAEP,CAED,YAAaxoB,EAASK,EAAa,CAIlC,GAAK,KAAK,MAAQ,GAAO,CAExB,MAAM8zB,EAAUn0B,EAAQ,QAEnBm0B,IAAU9zB,EAAamI,EAAM2rB,EAAQ,IAAK9zB,EAAW,IAAK8zB,EAAQ,SAAS,EAAI9zB,EAAW,CAAC,EAEhG,CAED,OAAOA,CAEP,CAED,iBAAkBsZ,EAAW,CAK5B,UAAY1b,KAAY0b,EAAW,CAElC,MAAMx1B,EAAQw1B,EAAU1b,GAEnB,KAAMA,CAAU,IAAK,SAEzB,KAAMA,CAAU,EAAG9Z,EAEdA,GAASA,EAAM,QAAQ,KAAM8Z,GAAa9Z,EAAM,SAItD,CAED,MAAMiwC,EAAc,OAAO,0BAA2Bza,EAAS,YAAY,WAE3E,UAAYx2B,KAAOixC,EAEb,OAAO,yBAA0B,KAAK,YAAY,UAAWjxC,CAAG,IAAO,QACvEixC,EAAajxC,CAAG,EAAG,MAAQ,QAE/B,OAAO,eAAgB,KAAK,YAAY,UAAWA,EAAKixC,EAAajxC,CAAG,EAM1E,CAED,OAAQ8d,EAAO,CAEd,MAAMC,EAAWD,IAAS,QAAa,OAAOA,GAAS,SAElDC,IAEJD,EAAO,CACN,SAAU,CAAE,EACZ,OAAQ,CAAE,EACV,MAAO,CAAE,CACb,GAIE,MAAME,EAAOkyB,GAAS,UAAU,OAAO,KAAM,KAAMpyB,GAC7CN,EAAexC,GAAiB,MAEtCgD,EAAK,WAAa,GAElB,SAAY,CAAE,SAAAlD,EAAU,UAAAC,CAAS,IAAMyC,EAEtCQ,EAAK,WAAYlD,CAAU,EAAGC,EAAU,OAAQ+C,CAAM,EAAC,KAMxD,SAASG,EAAkBC,EAAQ,CAElC,MAAMpe,EAAS,CAAA,EAEf,UAAYE,KAAOke,EAAQ,CAE1B,MAAMF,EAAOE,EAAOle,GACpB,OAAOge,EAAK,SACZle,EAAO,KAAMke,EAEb,CAED,OAAOle,CAEP,CAED,GAAKie,EAAS,CAEb,MAAMI,EAAWF,EAAkBH,EAAK,QAAQ,EAC1CM,EAASH,EAAkBH,EAAK,MAAM,EACtCJ,EAAQO,EAAkBH,EAAK,KAAK,EAErCK,EAAS,OAAS,IAAIH,EAAK,SAAWG,GACtCC,EAAO,OAAS,IAAIJ,EAAK,OAASI,GAClCV,EAAM,OAAS,IAAIM,EAAK,MAAQN,EAErC,CAED,OAAOM,CAEP,CAED,KAAM2I,EAAS,CAEd,YAAK,WAAaA,EAAO,WACzB,KAAK,QAAUA,EAAO,QAEtB,KAAK,UAAYA,EAAO,UACxB,KAAK,WAAaA,EAAO,WACzB,KAAK,YAAcA,EAAO,YAC1B,KAAK,aAAeA,EAAO,aAC3B,KAAK,kBAAoBA,EAAO,kBAChC,KAAK,cAAgBA,EAAO,cAE5B,KAAK,aAAeA,EAAO,aAE3B,KAAK,UAAYA,EAAO,UACxB,KAAK,WAAaA,EAAO,WACzB,KAAK,mBAAqBA,EAAO,mBAEjC,KAAK,WAAaA,EAAO,WAEzB,KAAK,aAAeA,EAAO,aAC3B,KAAK,WAAaA,EAAO,WAElB,MAAM,KAAMA,EAEnB,CAED,OAAO,aAAc6P,EAAW,CAE/B,GAAKA,EAAS,iBAAmB,GAEhC,OAAOA,EAIR,MAAMhb,EAAOgb,EAAS,KAAK,QAAS,WAAY,gBAE1C0a,EAAeC,GAA4B31B,GAEjD,GAAK01B,IAAiB,OAErB,MAAM,IAAI,MAAO,2BAA4B1a,EAAS,IAAI,wBAI3D,UAAYx2B,KAAOw2B,EAElB0a,EAAclxC,CAAG,EAAKw2B,EAAUx2B,CAAG,EAIpC,OAAOkxC,CAEP,CAEF,CAIO,SAASE,GAAiB51B,EAAM01B,EAAe,CAErD,GAAK,OAAOA,GAAiB,YAAc,CAAE11B,EAAO,MAAM,IAAI,MAAO,iBAAkBA,CAAM,iBAAgB,EAC7G,GAAKw0B,GAAc,IAAKx0B,GAAS,CAEhC,QAAQ,KAAM,iCAAkCA,CAAI,EAAG,EACvD,MAEA,CAEDw0B,GAAc,IAAKx0B,EAAM01B,GACzBA,EAAa,KAAO11B,CAErB,CAEO,SAAS21B,GAA4B31B,EAAO,CAElD,MAAM00B,EAAWF,GAAc,IAAKx0B,CAAI,EAExC,GAAK00B,IAAa,OAEjB,OAAO,IAAIA,CAIb,CAEAkB,GAAiB,eAAgBnB,EAAc,EClnB/C,MAAMoB,WAAkB70B,CAAK,CAE5B,YAAaqL,EAAS,KAAO,CAE5B,QAEA,KAAK,MAAQ,GACb,KAAK,WAAa,KAElB,KAAK,OAASA,EAEd,KAAK,aAAe,KAEpB,KAAK,YAAc,EAEnB,CAED,YAAahL,EAAU,CAEtB,OAAO,KAAK,WAAa,KAAK,WAAW,YAAaA,CAAS,EAAG,MAElE,CAED,IAAK5B,EAAO,CAEX,YAAK,MAAM,KAAMA,GAEV,IAEP,CAED,GAAIq2B,EAAU7oC,EAAS,CAEtB,MAAM8oC,EAAa,IAAIptB,GAAY1b,GACnC,YAAK,aAAeg/B,GAAM6J,EAAUC,CAAU,EAEvC,KAAK,IAAK,KAAK,YAAY,CAElC,CAED,OAAQD,EAAU7oC,EAAS,CAE1B,MAAM8oC,EAAa,IAAIptB,GAAY1b,GAC7By+B,EAASO,GAAM6J,EAAUC,CAAU,EAEzC,YAAK,aAAa,SAAWrK,EAC7B,KAAK,aAAeA,EAEb,IAEP,CAED,KAAMz+B,EAAS,CAEd,YAAK,aAAa,SAAW,IAAI0b,GAAY1b,CAAM,EAE5C,IAEP,CAED,MAAOoU,KAAYpB,EAAS,CAE3B,MAAM+1B,EAAgB/sB,KAEtBF,GAAiB,IAAI,EAErB,UAAYtJ,KAAQ,KAAK,MAExBA,EAAK,MAAO4B,EAAS,QAItB,OAAA0H,GAAiBitB,CAAa,EAEvB,KAAK,WAAa,KAAK,WAAW,MAAO30B,EAAS,GAAGpB,CAAM,EAAK,MAAM,MAAOoB,EAAS,GAAGpB,CAAM,CAEtG,CAEF,CAIqB2I,EAAWitB,EAAY,EAE5ChzB,EAAc,YAAagzB,EAAW,ECnFtC,MAAMI,WAAuBlzB,CAAS,CAErC,YAAamzB,EAAU9V,GAAyB,CAE/C,MAAO,MAAM,EAEb,KAAK,QAAU8V,CAEf,CAED,OAAQ,CAEP,MAAMC,EAAM,KAAK,QAEXC,EAAID,EAAI,EAAE,MAAOA,EAAI,GAAI,IAAK,GAAM,KAAK,GAAK,EAAG,EAAG,IAAK,IACzDhmC,EAAIgmC,EAAI,EAAE,MAAO,GAAO,CAAK,EAAC,KAAI,EAAG,IAAK,EAAI,KAAK,EAAE,EAAG,IAAK,IAEnE,OAAO9sB,EAAM+sB,EAAGjmC,EAEhB,CAEF,CAI0ByY,EAAWqtB,EAAiB,EAEtDpzB,EAAc,iBAAkBozB,EAAgB,EC9BhD,MAAMI,WAAuBr1B,CAAK,CAEjC,YAAa+J,EAAQ,CAEpB,QAEA,KAAK,MAAQA,EACb,KAAK,iBAAmB,EAExB,CAED,gBAAiB,CAEhB,OAAO,KAAK,KAEZ,CAEF,CAIAlI,EAAc,iBAAkBwzB,EAAgB,ECnBhD,MAAMC,WAAyBt1B,CAAK,CAEnC,eAAgBu1B,EAAU,CAEzB,QAEA,KAAK,QAAUA,EAEf,KAAK,mBAAqB,EAE1B,CAED,MAAOl1B,EAAU,CAEhB,MAAM,MAAOA,GAEb,MAAMk1B,EAAU,KAAK,QACfxrB,EAAQ,CAAA,EAEd,QAAUriB,EAAI,EAAGA,EAAI6tC,EAAQ,OAAQ7tC,IAEpCqiB,EAAM,KAAMwrB,EAAS7tC,CAAG,EAAC,YAAa2Y,CAAO,GAI9C,KAAK,SAAWA,EAAQ,sBAAuB,IAAIg1B,GAAgBtrB,CAAK,CAAI,EAAC,IAE7E,CAED,SAAU1J,EAASld,EAAS,CAE3B,MAAM+e,EAAe7B,EAAQ,sBACvBk1B,EAAU,KAAK,QAEfC,EAAetzB,IAAiB,GAAKA,EAAe,IAAM,GAEhE,QAAU,EAAI,EAAG,EAAIqzB,EAAQ,OAAQ,IAAO,CAE3C,MAAMvzB,EAAUuzB,EAAS,CAAC,EAAG,MAAOl1B,EAASld,GAE7Ckd,EAAQ,gBAAiB,GAAIm1B,CAAc,IAAI,OAASxzB,CAAS,GAEjE,CAED,OAAOE,CAEP,CAEF,CAI4B0F,EAAW0tB,EAAmB,EAE1DzzB,EAAc,mBAAoByzB,EAAkB,ECvDpD,MAAMG,WAAiBz1B,CAAK,CAE3B,YAAa01B,EAAW,CAEvB,QAEA,KAAK,SAAWA,CAEhB,CAED,OAAqB,CAIpB,MAAM9b,EAAQ,KAAK,SAAS,OAAM,EAAG,IAAK,SAAW,EAAC,IAAK,YACrD+b,EAAO/b,EAAM,WAAYA,EAAM,WAAY,EAAI,EAAC,IAAK,CAAC,CAAI,EAAC,OAAQA,CAAK,EAAG,IAAK,WAGtF,OAFe+b,EAAK,WAAY,EAAE,EAAG,OAAQA,GAE/B,UAAU,IAAK,EAAI,GAAK,GAEtC,CAEF,CAIO,MAAMp1B,GAAOqH,EAAW6tB,IAE/BrxB,EAAgB,OAAQ7D,IAExBsB,EAAc,WAAY4zB,EAAU,EC5B7B,MAAMG,GAAW,CAAEtiC,EAAGqE,IAAOwd,GAAK1E,EAAK,EAAKnd,EAAE,IAAKkd,GAAK,EAAKld,CAAG,CAAA,CAAI,EAAEqE,CAAC,EACjEk+B,GAAO,CAAEviC,EAAGqE,IAAOrE,EAAE,SAAU,EAAG,EAAKsiC,GAAUtiC,EAAE,IAAK,CAAG,EAAIqE,CAAG,EAAC,IAAK,CAAK,EAAG6Y,GAAK,EAAKolB,GAAUnlB,EAAKD,GAAK,EAAKld,CAAC,EAAI,CAAK,EAAEqE,CAAC,EAAG,IAAK,CAAK,CAAA,EAC7Im+B,GAAS,CAAExiC,EAAG5P,EAAGC,IAAOwxB,GAAK3d,GAAK2d,GAAK7hB,EAAG5P,CAAC,EAAI6sB,GAAK4E,GAAK7hB,EAAG5P,CAAG,EAAEyxB,GAAK3E,GAAK,EAAKld,GAAK3P,EAAK,CAAA,EAAI,EAAMD,CAAC,EACrGqyC,GAAO,CAAEziC,EAAGqE,IAAO+b,GAAKf,GAAG,IAAKhb,EAAE,IAAKrE,CAAC,EAAG,IAAK,EAAO,CAAA,EAAG,IAAKqf,GAAG,IAAKhb,EAAE,IAAKrE,GAAI,IAAK,CAAG,CAAI,CAAA,EAG3G8Q,EAAgB,WAAYwxB,IAC5BxxB,EAAgB,OAAQyxB,IACxBzxB,EAAgB,SAAU0xB,IAC1B1xB,EAAgB,OAAQ2xB,EAAM,ECT9B,MAAMC,GAAM7wB,EAAO,CAAE,CAAE7R,KAEfA,EAAE,MAAO,EAAC,IAAK,EAAE,EAAG,OAItB2iC,GAAO9wB,EAAO,CAAE,CAAE+wB,KAEhBztB,EAAMutB,GAAKE,EAAE,EAAE,IAAKF,GAAKE,EAAE,EAAE,IAAK,CAAI,CAAA,EAAM,EAAEF,GAAKE,EAAE,EAAE,IAAKF,GAAKE,EAAE,EAAE,IAAK,CAAE,CAAI,CAAA,CAAI,EAAEF,GAAKE,EAAE,EAAE,IAAKF,GAAKE,EAAE,EAAE,IAAK,CAAI,CAAA,CAAI,CAAA,IAI5HC,GAAahxB,EAAO,CAAE,CAAEixB,EAAaC,EAAK1rC,CAAI,IAAQ,CAE3D,MAAMurC,EAAIztB,EAAM2tB,CAAa,EAAC,MAAK,EAC7BE,EAAInvB,EAAO,GAAK,EAAC,MAAK,EACtBovB,EAAKpvB,EAAO,CAAK,EAAC,MAAK,EACvBqvB,EAAK/tB,EAAMytB,CAAG,EAAC,MAAK,EAE1B,OAAAhS,GAAM,CAAE,MAAO/c,EAAO,CAAG,EAAI,IAAKA,EAAO,CAAG,EAAI,KAAM,QAAS,UAAW,IAAM,EAAE,IAAM,CAEvF,MAAMsvB,EAAKhuB,EAAMwtB,GAAMO,EAAG,IAAK,CAAK,CAAA,GAAK,QACzCN,EAAE,UAAWO,EAAG,IAAK9rC,EAAK,IAAKwc,EAAO,EAAK,EAAC,IAAKkvB,CAAK,CAAA,CAAI,CAAA,EAC1DG,EAAG,UAAW,KACdF,EAAE,UAAW,KACbJ,EAAE,UAAW,KAEb,MAAM/f,EAAIhP,EAAO6uB,GAAKE,EAAE,EAAE,IAAKF,GAAKE,EAAE,EAAE,IAAKF,GAAKE,EAAE,CAAC,CAAI,CAAA,EAAM,CAAA,EAAG,QAClEK,EAAG,UAAWpgB,EAAE,IAAKmgB,CAAG,CAAA,EACxBE,EAAG,UAAW,IAEhB,GAEQD,CAER,GAIAP,GAAI,UAAW,CACd,KAAM,MACN,KAAM,QACN,OAAQ,CACP,CAAE,KAAM,IAAK,KAAM,OAAS,CAC5B,CACF,GAEAC,GAAK,UAAW,CACf,KAAM,OACN,KAAM,OACN,OAAQ,CACP,CAAE,KAAM,IAAK,KAAM,MAAQ,CAC3B,CACF,GAEAE,GAAW,UAAW,CACrB,KAAM,aACN,KAAM,QACN,OAAQ,CACP,CAAE,KAAM,IAAK,KAAM,MAAQ,EAC3B,CAAE,KAAM,MAAO,KAAM,OAAS,EAC9B,CAAE,KAAM,OAAQ,KAAM,OAAS,CAC/B,CACF,CAAG,EC/DH,IAAIO,GAEJ,MAAMC,WAAoBnM,EAAS,CAElC,YAAaC,EAAW,CAEvBiM,GAAoBA,IAAqBnf,GAAY,WAErD,MAAOkT,EAAUiM,GAEjB,CAEF,CAIO,MAAME,GAAgBhvB,EAAW+uB,IAC3BE,GAAYpM,GAAcmM,GAAenM,CAAU,EAAC,OAAM,EAGvErmB,EAAgB,UAAWyyB,IAE3Bh1B,EAAc,cAAe80B,EAAa,ECxB1C,MAAMG,WAAgC92B,CAAK,CAE1C,YAAa+2B,EAAgB,MAAOC,EAAkB,CAErD,QAEA,KAAK,cAAgBD,EACrB,KAAK,gBAAkBC,EAEvB,KAAK,iBAAmB,KAExB,KAAK,OAAS,EAEd,CAED,aAAc,CAEb,OAAO,KAAK,cAAe,CAAG,EAAC,WAAW,OAAO,IAEjD,CAED,MAAO32B,EAAU,CAEhB,MAAMpB,EAAS,KAAK,gBAEpB,IAAIg4B,EAAkB,KAAK,iBAE3B,GAAKA,IAAoB,KAAO,CAE/B,IAAIC,EAAc,KACdC,EAAiB,GAErB,UAAYhxB,KAAgB,KAAK,cAAgB,CAGhD,MAAMG,EADaH,EAAa,WACN,OAE1B,GAAKG,IAAW,KAEf,MAAM,IAAI,MAAO,2DAIlB,MAAM7B,EAAS6B,EAAO,OAEtB,GAAKrH,EAAO,SAAWwF,EAAO,OAAS,CAEtC,IAAI2yB,EAAQ,EAEZ,QAAU1vC,EAAI,EAAGA,EAAIuX,EAAO,OAAQvX,IAAO,CAE1C,MAAMgW,EAAQuB,EAAQvX,GAChBqb,EAAQ0B,EAAQ/c,GAEjBgW,EAAM,YAAa2C,CAAO,IAAO0C,EAAM,KAE3Cq0B,IAIAA,EAAQ,CAIT,CAEIA,EAAQD,IAEZD,EAAc/wB,EACdgxB,EAAiBC,EAIlB,CAED,CAED,KAAK,iBAAmBH,EAAkBC,EAAa,GAAGj4B,CAAM,CAEhE,CAED,OAAOg4B,CAEP,CAEF,CAI0BrvB,EAAWkvB,EAA0B,EAI/Dj1B,EAAc,0BAA2Bi1B,EAAyB,EC1FlE,MAAMO,WAAqBt1B,CAAS,CAEnC,aAAc,CAEb,MAAO,MAAM,CAEb,CAED,OAAQ,CAEP,MAAMzO,EAAImV,EAAM6W,EAAsB,EAAG,EAAGA,EAAsB,EAAE,QAAU,EAAC,UAAS,EAClFv2B,EAAIu2B,EAAsB,MAAOhsB,CAAC,EAExC,OAAO+U,EAAM/U,EAAE,IAAKkoB,EAAqB,EAAIzyB,EAAE,IAAKyyB,EAAuB,CAAA,EAAG,IAAK,IAAO,EAAC,IAAK,EAAG,CAEnG,CAEF,CAIO,MAAM8b,GAAWzvB,EAAewvB,IAEvCx1B,EAAc,eAAgBw1B,EAAc,ECxB5C,MAAME,WAAkB1oB,EAAY,CAEnC,YAAanJ,EAAQ6xB,GAAU,MAAOC,EAAQ,EAAGhzC,EAAQ,EAAI,CAE5D,MAAOA,CAAK,EAEZ,KAAK,MAAQkhB,EACb,KAAK,MAAQ8xB,EAEb,KAAK,WAAax5B,EAAe,KAEjC,CAiBD,OAAQgR,EAAQ,CAEf,MAAMtJ,EAAQ,KAAK,MACb8xB,EAAQ,KAAK,MAEd9xB,IAAU6xB,GAAU,MAExB,KAAK,OAASvoB,EAAM,UAAYwoB,EAErB9xB,IAAU6xB,GAAU,MAE/B,KAAK,MAAQvoB,EAAM,UAAYwoB,EAEpB9xB,IAAU6xB,GAAU,MAE/B,KAAK,MAAQvoB,EAAM,QAMnB,KAAK,MAAQA,EAAM,KAAOwoB,CAI3B,CAED,UAAWh2B,EAAO,CAEjB,MAAM,UAAWA,GAEjBA,EAAK,MAAQ,KAAK,MAClBA,EAAK,MAAQ,KAAK,KAElB,CAED,YAAaA,EAAO,CAEnB,MAAM,YAAaA,GAEnB,KAAK,MAAQA,EAAK,MAClB,KAAK,MAAQA,EAAK,KAElB,CAEF,CAEA+1B,GAAU,MAAQ,QAClBA,GAAU,OAAS,SACnBA,GAAU,MAAQ,QAClBA,GAAU,MAAQ,QAKX,MAAME,GAAa,CAAEC,EAAWlzC,EAAQ,IAAOqgB,EAAY,IAAI0yB,GAAWA,GAAU,MAAOG,EAAWlzC,CAAO,CAAA,EAG7FqjB,EAAe0vB,GAAWA,GAAU,KAAK,EAAG,OAAS,EAE5E11B,EAAc,YAAa01B,EAAW,ECzFtC,MAAMI,WAAgB33B,CAAK,CAE1B,YAAa/T,EAAS0rC,GAAQ,KAAMC,EAAWH,GAAU,EAAK,CAE7D,QAEA,KAAK,OAASxrC,EACd,KAAK,SAAW2rC,CAEhB,CAED,YAAav3B,EAAU,CAEtB,OAAO,KAAK,SAAS,YAAaA,CAAO,CAEzC,CAED,OAAQ,CAEP,MAAMpU,EAAS,KAAK,OACd2rC,EAAW/yB,EAAY,KAAK,QAAQ,EAE1C,IAAInE,EAAa,KAEjB,OAAKzU,IAAW0rC,GAAQ,KAEvBj3B,EAAak3B,EAAS,IAAK,GAAI,EAAG,IAAK,KAAK,GAAK,CAAC,EAAG,IAAK,EAAC,IAAK,EAAG,EAAG,IAAK,IAEhE3rC,IAAW0rC,GAAQ,OAE9Bj3B,EAAak3B,EAAS,MAAO,EAAC,MAAK,EAExB3rC,IAAW0rC,GAAQ,SAE9Bj3B,EAAak3B,EAAS,IAAK,EAAG,EAAG,MAAO,EAAC,IAAK,CAAG,EAAC,IAAK,CAAG,EAAC,IAAG,EAEnD3rC,IAAW0rC,GAAQ,WAE9Bj3B,EAAak3B,EAAS,SAIhBl3B,CAEP,CAED,UAAWc,EAAO,CAEjB,MAAM,UAAWA,GAEjBA,EAAK,OAAS,KAAK,MAEnB,CAED,YAAaA,EAAO,CAEnB,MAAM,YAAaA,GAEnB,KAAK,OAASA,EAAK,MAEnB,CAEF,CAEAm2B,GAAQ,KAAO,OACfA,GAAQ,OAAS,SACjBA,GAAQ,SAAW,WACnBA,GAAQ,SAAW,WAII/vB,EAAW+vB,GAASA,GAAQ,IAAO,EACjC/vB,EAAW+vB,GAASA,GAAQ,MAAS,EACnC/vB,EAAW+vB,GAASA,GAAQ,QAAW,EACvC/vB,EAAW+vB,GAASA,GAAQ,QAAW,EAElE91B,EAAc,UAAW81B,EAAS,EC5ElC,MAAME,WAAoB91B,CAAS,CAElC,YAAa2D,EAAOjH,EAAO,CAE1B,QAEA,KAAK,MAAQiH,EACb,KAAK,KAAOjH,CAEZ,CAED,YAAa4B,EAAU,CAEtB,OAAO,KAAK,KAAK,YAAaA,CAAO,CAErC,CAED,OAAQ,CAEP,KAAM,CAAE,MAAAqF,EAAO,KAAAjH,CAAM,EAAG,KAExB,IAAItH,EAAS,KAEb,OAAKuO,IAAUmyB,GAAY,mBAE1B1gC,EAASsH,EAAK,IAAK,EAAG,EAAG,IAAK,IAEnBiH,IAAUmyB,GAAY,qBAEjC1gC,EAASsH,EAAK,IAAK,CAAG,EAAG,IAAK,IAIxBtH,CAEP,CAEF,CAEA0gC,GAAY,mBAAqB,mBACjCA,GAAY,mBAAqB,mBAI1B,MAAMC,GAAmBlwB,EAAWiwB,GAAaA,GAAY,kBAAkB,EACzEE,GAAmBnwB,EAAWiwB,GAAaA,GAAY,kBAAkB,EAEtFzzB,EAAgB,mBAAoB0zB,IACpC1zB,EAAgB,mBAAoB2zB,IAEpCl2B,EAAc,cAAeg2B,EAAa,ECnD1C,MAAMG,WAAkBh4B,CAAK,CAE5B,YAAavB,EAAMw5B,EAAWC,EAAYC,EAAahxB,EAAO,GAAKixB,EAAcjxB,EAAO,CAAC,EAAK,CAE7F,QAEA,KAAK,KAAO1I,EACZ,KAAK,UAAYw5B,EACjB,KAAK,WAAaC,EAClB,KAAK,WAAaC,EAClB,KAAK,YAAcC,EAEnB,KAAK,QAAU,EAEf,CAED,OAAQ,CAEP,KAAM,CAAE,KAAA35B,EAAM,UAAAw5B,EAAW,WAAAC,EAAY,WAAAC,EAAY,YAAAC,EAAa,QAAAC,CAAS,EAAG,KAE1E,IAAIliB,EAAI1X,EAAK,IAAKw5B,CAAS,EAAG,IAAKC,EAAW,IAAKD,CAAS,GAE5D,OAAKI,IAAY,KAAOliB,EAAIA,EAAE,MAAK,GAE5BA,EAAE,IAAKiiB,EAAY,IAAKD,EAAc,EAAC,IAAKA,EAEnD,CAEF,CAIO,MAAMG,GAAQ1wB,EAAWowB,GAAW,KAAM,KAAM,CAAE,QAAS,EAAK,GAC1DO,GAAa3wB,EAAWowB,IAErC5zB,EAAgB,QAASk0B,IACzBl0B,EAAgB,aAAcm0B,IAE9B12B,EAAc,YAAam2B,EAAW,ECrCtC,MAAMQ,WAAqBz2B,CAAS,CAEnC,YAAa+V,EAAQ2gB,EAAcC,EAAarwB,EAAM,EAAG,EAAK,CAE7D,MAAO,MAAM,EAEb,KAAK,OAASyP,EACd,KAAK,aAAe2gB,EACpB,KAAK,WAAaC,CAElB,CAED,OAAQ,CAEP,KAAM,CAAE,OAAA5gB,EAAQ,aAAA2gB,EAAc,WAAAC,CAAU,EAAK,KAI7C,OAFe5gB,EAAO,IAAK4gB,CAAU,EAEvB,OAAQD,CAAc,EAAC,IAAKC,CAAU,CAEpD,CAEF,CAIO,MAAMC,GAAW/wB,EAAW4wB,IAEnCp0B,EAAgB,WAAYu0B,IAE5B92B,EAAc,eAAgB22B,EAAc,ECvB5C,MAAMI,WAAmB72B,CAAS,CAEjC,YAAayd,EAAciZ,EAAe,CAEzC,QAEA,KAAK,aAAejZ,EACpB,KAAK,aAAeiZ,CAEpB,CAED,YAAap4B,EAAU,CAEtB,OAAO,KAAK,aAAa,YAAaA,CAAO,CAE7C,CAED,MAAOA,EAAU,CAEhB,KAAM,CAAE,aAAAo4B,EAAc,aAAAjZ,CAAc,EAAG,KAIvC,GAFiB,KAAK,YAAanf,CAAO,IAExB,OAAS,CAE1B,MAAMw4B,EAAWJ,EAAa,MACxBK,EAAWL,EAAa,MAO9B,OALuBxvB,GACtB4vB,EAAUC,EACVA,EAAS,OAAM,EAAID,CACvB,EAEyB,IAAKrZ,EAE9B,KAAS,CAEN,MAAMuZ,EAAWN,EACXO,EAAkBvvB,GAAMZ,EAAM,EAAK,EAAK,EAAK,GAAOA,EAAM,EAAK8K,GAAKolB,EAAS,CAAC,EAAIrlB,GAAKqlB,EAAS,CAAC,EAAG,OAAM,EAAI,CAAK,EAAElwB,EAAM,EAAK6K,GAAKqlB,EAAS,CAAC,EAAIplB,GAAKolB,EAAS,CAAC,EAAI,CAAK,EAAElwB,EAAM,EAAK,EAAK,EAAK,CAAG,GACrMowB,EAAkBxvB,GAAMZ,EAAM8K,GAAKolB,EAAS,CAAG,EAAE,EAAKrlB,GAAKqlB,EAAS,CAAG,EAAE,CAAK,EAAElwB,EAAM,EAAK,EAAK,EAAK,CAAG,EAAIA,EAAM6K,GAAKqlB,EAAS,CAAC,EAAG,SAAU,EAAKplB,GAAKolB,EAAS,CAAC,EAAI,CAAK,EAAElwB,EAAM,EAAK,EAAK,EAAK,CAAG,GACrMqwB,EAAkBzvB,GAAMZ,EAAM8K,GAAKolB,EAAS,CAAG,EAAErlB,GAAKqlB,EAAS,CAAG,EAAC,OAAM,EAAI,EAAK,CAAG,EAAIlwB,EAAM6K,GAAKqlB,EAAS,CAAG,EAAEplB,GAAKolB,EAAS,CAAG,EAAE,EAAK,CAAK,EAAElwB,EAAM,EAAK,EAAK,EAAK,CAAK,EAAEA,EAAM,EAAK,EAAK,EAAK,CAAG,GAE3M,OAAOmwB,EAAgB,IAAKC,CAAiB,EAAC,IAAKC,CAAe,EAAG,IAAKrwB,EAAM2W,EAAc,CAAK,CAAA,EAAG,GAEtG,CAED,CAEF,CAIO,MAAM2Z,GAASvxB,EAAWgxB,IAEjCx0B,EAAgB,SAAU+0B,IAE1Bt3B,EAAc,aAAc+2B,EAAY,EC/DxC,MAAMQ,WAA0Bp5B,CAAK,CAEpC,YAAaq5B,EAAWvhB,EAASvI,GAAI,EAAE+pB,EAAYnyB,EAAO,GAAM,CAE/D,MAAO,MAAM,EAEb,KAAK,UAAYkyB,EACjB,KAAK,OAASvhB,EACd,KAAK,UAAYwhB,CAEjB,CAED,OAAQ,CAEP,KAAM,CAAE,UAAAA,EAAW,OAAAxhB,EAAQ,UAAAuhB,CAAS,EAAK,KAEnC,CAAE,MAAA32C,EAAO,OAAAi1B,CAAQ,EAAG0hB,EAEpBE,EAAWD,EAAU,IAAK52C,EAAM,IAAKi1B,CAAM,GAAK,QAEhD6hB,EAASD,EAAS,IAAK72C,CAAK,EAC5B+2C,EAAM9hB,EAAO,IAAK4hB,EAAS,IAAK,CAAG,EAAC,IAAK72C,GAAQ,KAAM,CAAA,EAEvD80C,EAAQ6B,EAAU,aAClBK,EAAgBrxB,EAAMmxB,EAAQC,CAAG,EAEvC,OAAO3hB,EAAO,IAAK4hB,CAAe,EAAC,IAAKlC,CAAK,CAE7C,CAEF,CAI6B5vB,EAAWwxB,EAAoB,EAE5Dv3B,EAAc,oBAAqBu3B,EAAmB,ECpCtD,MAAMO,WAAgCx3B,EAAiB,CAEtD,YAAay3B,EAAmBx3B,EAAY,CAE3C,MAAOw3B,EAAmBx3B,GAE1B,KAAK,0BAA4B,EAEjC,CAED,IAAI,kBAAmB5d,EAAQ,CAE9B,KAAK,KAAOA,CAEZ,CAED,IAAI,mBAAoB,CAEvB,OAAO,KAAK,IAEZ,CAED,MAAO6b,EAAU,CAEhB,OAAKA,EAAQ,YAAa,eAAe,IAAO,IAE1C,CAAE,KAAK,KAAK,eAAiB,KAAK,KAAK,eAAiB,IAE5DA,EAAQ,SAAU,KAAK,MAMlB,MAAM,MAAOA,EAEpB,CAED,SAAUA,EAASld,EAAS,CAE3B,IAAI6e,EAEJ,MAAM63B,EAAkBx5B,EAAQ,QAAQ,OAIxC,GAAKA,EAAQ,YAAa,eAAe,IAAO,GAAQ,CAEvD,KAAM,CAAE,KAAA5B,CAAM,EAAG,KAEZ,CAAEA,EAAK,eAAiB,KAAK,KAAK,eAAiB,IAAQo7B,IAAoB,GAEnF73B,EAAU3B,EAAQ,YAAa,MAI/B2B,EAAUvD,EAAK,MAAO4B,EAI1B,MAEG2B,EAAU,MAAM,SAAU3B,GAI3B,GAAKw5B,IAAoB,GAAO,CAE/B,MAAM76B,EAAO,KAAK,YAAaqB,CAAO,EAEtC2B,EAAU3B,EAAQ,OAAQ2B,EAAShD,EAAM7b,CAAM,CAE/C,CAED,OAAO6e,CAEP,CAEF,CAIO,MAAM83B,GAAiBlyB,EAAW+xB,IAEzCv1B,EAAgB,iBAAkB01B,IAElCj4B,EAAc,0BAA2B83B,EAAyB,ECnFlE,MAAMI,WAA8B/5B,CAAK,CAExC,YAAag6B,EAAcC,EAAe,KAAMC,EAAe,KAAMC,EAAYhzB,EAAO,CAAC,EAAIqY,EAAeN,GAAemV,EAAahZ,GAAc,CAErJ,MAAO,MAAM,EAEb,KAAK,aAAe2e,EACpB,KAAK,aAAeC,EACpB,KAAK,aAAeC,EAEpB,KAAK,UAAYC,EAEjB,KAAK,aAAe3a,EACpB,KAAK,WAAa6U,CAElB,CAED,OAAQ,CAEP,KAAM,CAAE,aAAA2F,EAAc,aAAAC,EAAc,aAAAC,EAAc,UAAAC,EAAW,aAAA3a,EAAc,WAAA6U,CAAY,EAAG,KAK1F,IAAI+F,EAAK/F,EAAW,IAAK,EAAC,UAAS,EACnC+F,EAAKA,EAAG,IAAKA,EAAG,IAAK3xB,EAAM,CAAK,CAAA,GAGhC,MAAM4xB,EAAK7a,EAAa,GAAG,IAAK2a,CAAS,EACnCG,EAAK9a,EAAa,GAAG,IAAK2a,CAAS,EACnCI,EAAK/a,EAAa,GAAG,IAAK2a,CAAS,EAGnCK,EAAWR,EAAa,MACxBS,EAAWR,IAAiB,KAAOA,EAAa,MAAQO,EACxDE,EAAWR,IAAiB,KAAOA,EAAa,MAAQM,EAExDG,EAAKljB,GAAS+iB,EAAUH,CAAI,EAAC,IAAKD,EAAG,GACrCQ,EAAKnjB,GAASgjB,EAAUH,CAAI,EAAC,IAAKF,EAAG,GACrCS,EAAKpjB,GAASijB,EAAUH,CAAI,EAAC,IAAKH,EAAG,GAE3C,OAAO7pB,GAAKoqB,EAAIC,EAAIC,CAAE,CAEtB,CAEF,CAIO,MAAMC,GAAoBlzB,EAAWmyB,IAC/BgB,GAAmB,IAAK97B,IAAY67B,GAAmB,GAAG77B,CAAM,EAE7EmF,EAAgB,mBAAoB22B,IAEpCl5B,EAAc,wBAAyBk4B,EAAuB,ECvDtC,IAAIiB,GACZ,IAAI37B,GACY,IAAIA,GACP,IAAIA,GACT,IAAIG,GACJ,IAAIH,GAAS,EAAG,EAAG,EAAM,EAC/B,IAAIC,GAER,IAAID,GACF,IAAIA,GACT,IAAIC,GAED,IAAIF,GAEC,IAAI67B,GACJ5yB,EAAMuoB,GAAgB,EAAE,SAAU,EAAEA,GAAgB,CAAC,EChBxE,MAAMsK,WAAwBxwB,EAAc,CAE3C,YAAalK,EAAQ,EAAI,CAExB,MAAO,KAAM,QAEb,KAAK,kBAAoB,GAEzB,KAAK,MAAQA,CAEb,CAED,kBAAgC,CAE/B,MAAMA,EAAQ,KAAK,MAEnB,MAAO,SAAYA,EAAQ,EAAIA,EAAQ,GAEvC,CAED,SAAUH,EAAU,CAEnB,MAAMsK,EAAgB,KAAK,iBAAkBtK,CAAO,EAC9C86B,EAAoB96B,EAAQ,qBAAsBsK,CAAa,EAErE,IAAIxT,EAEJ,OAAKgkC,IAAsB,GAE1BhkC,EAAS,MAAM,SAAUkJ,GAKzBlJ,EAASkJ,EAAQ,cAAe,KAAK,SAAU,IAAIf,GAAS,EAAG,EAAG,EAAG,CAAG,CAAA,EAIlEnI,CAEP,CAED,UAAWqK,EAAO,CAEjB,MAAM,UAAWA,GAEjBA,EAAK,MAAQ,KAAK,KAElB,CAED,YAAaA,EAAO,CAEnB,MAAM,YAAaA,GAEnB,KAAK,MAAQA,EAAK,KAElB,CAEF,CAMAK,EAAc,kBAAmBq5B,EAAiB,ECjElD,MAAME,WAA8B1hB,EAAc,CAEjD,YAAapb,EAAU6T,EAAW4V,EAAW,KAAO,CAEnD,MAAOzpB,EAAU6T,EAAW4V,GAE5B,KAAK,SAAWA,CAEhB,CAED,gBAAiBnO,EAAQ,CAExB,YAAK,UAAY,KAAK,WAAa,KAAO,KAAK,SAAWA,EAAM,SAEzD,KAAK,SAEZ,CAEF,CAIO,MAAMyhB,GAAoB,CAAEnsC,EAAM8P,EAAM+oB,IAAcljB,EAAY,IAAIu2B,GAAuBlsC,EAAM8P,EAAM+oB,CAAU,CAAA,EAE1HlmB,EAAc,wBAAyBu5B,EAAuB,ECnB9D,MAAME,GAAK,EAAM,EAEXC,GAAO73C,GAAO+sB,EAAK6qB,GAAI7qB,EAAK/sB,EAAG+sB,EAAK/sB,EAAGA,EAAE,OAAM,EAAG,IAAK,CAAK,CAAA,EAAG,IAAK,CAAG,GAAK,IAAK,CAAG,GAEpF83C,GAAO93C,GAAO+sB,EAAK6qB,GAAI7qB,EAAK/sB,EAAG+sB,EAAK/sB,EAAG+sB,EAAK,EAAK/sB,CAAC,EAAG,IAAK,CAAG,CAAI,CAAA,EAAG,IAAK,CAAG,GAE5E+3C,GAAO/3C,GAAO+sB,EAAK6qB,GAAI7qB,EAAK/sB,EAAG+sB,EAAK/sB,EAAG+sB,EAAK,GAAO/sB,GAAI,IAAK,CAAG,GAAK,IAAK,CAAG,GAAK,IAAK,CAAG,GAEzFg4C,GAAOh4C,GAAO+sB,EAAK6qB,GAAInmB,GAAKzxB,EAAG,CAAC,GAEhCi4C,GAAOj4C,GAAO63C,GAAI73C,CAAG,EAAC,IAAK83C,GAAI93C,CAAC,GAEhCk4C,GAAOl4C,GAAO+3C,GAAI/3C,CAAG,EAAC,IAAKg4C,GAAIh4C,CAAC,GAGhCm4C,GAAOn4C,GAAO6sB,GAAK,GAAOirB,GAAI93C,CAAG,EAAC,IAAK63C,GAAI73C,CAAC,EAAG,IAAK83C,GAAI93C,CAAC,CAAI,CAAA,GAE7Do4C,GAAOp4C,GAAO6sB,GAAK,EAAKmrB,GAAIh4C,GAAI,IAAK+3C,GAAI/3C,CAAG,EAAC,IAAKg4C,GAAIh4C,CAAC,CAAI,CAAA,GAE3Dq4C,GAAU,CAAEtsB,EAAausB,EAAWC,IAAS,CAElD,MAAM1sB,EAAKE,EAAY,OACjBysB,EAAWzrB,EAAKlB,EAAIysB,EAAU,IAAK,IAAK,IAExCG,EAAM5oB,GAAO2oB,GACbE,EAAM3oB,GAAOyoB,GAEbG,EAAMV,GAAIS,EAAI,CAAC,EACfE,EAAMV,GAAIQ,EAAI,CAAC,EACfG,EAAMV,GAAIO,EAAI,CAAC,EACfI,EAAMV,GAAIM,EAAI,CAAC,EACfK,EAAMZ,GAAIO,EAAI,CAAC,EACfM,EAAMZ,GAAIM,EAAI,CAAC,EAEfO,EAAKt0B,EAAM8zB,EAAI,EAAE,IAAKI,CAAK,EAAEJ,EAAI,EAAE,IAAKM,CAAG,CAAI,EAAC,IAAK,EAAK,EAAC,IAAKT,EAAU,IAC1EY,EAAKv0B,EAAM8zB,EAAI,EAAE,IAAKK,CAAK,EAAEL,EAAI,EAAE,IAAKM,CAAG,CAAI,EAAC,IAAK,EAAK,EAAC,IAAKT,EAAU,IAC1Ea,EAAKx0B,EAAM8zB,EAAI,EAAE,IAAKI,CAAK,EAAEJ,EAAI,EAAE,IAAKO,CAAG,CAAI,EAAC,IAAK,EAAK,EAAC,IAAKV,EAAU,IAC1Ec,EAAKz0B,EAAM8zB,EAAI,EAAE,IAAKK,CAAK,EAAEL,EAAI,EAAE,IAAKO,CAAG,CAAI,EAAC,IAAK,EAAK,EAAC,IAAKV,EAAU,IAE1Et4C,EAAIi4C,GAAIS,EAAI,CAAC,EAAG,IAAK7rB,GAAK8rB,EAAI,IAAK5sB,EAAY,GAAIktB,CAAE,EAAG,MAAOV,CAAK,CAAA,EAAIK,EAAI,IAAK7sB,EAAY,GAAImtB,CAAI,EAAC,MAAOX,CAAK,CAAA,CAAI,CAAA,EACtHt4C,EAAIi4C,GAAIQ,EAAI,CAAC,EAAG,IAAK7rB,GAAK8rB,EAAI,IAAK5sB,EAAY,GAAIotB,CAAE,EAAG,MAAOZ,CAAK,CAAA,EAAIK,EAAI,IAAK7sB,EAAY,GAAIqtB,CAAI,EAAC,MAAOb,CAAK,CAAA,CAAI,CAAA,EAE5H,OAAOv4C,EAAE,IAAKC,EAEf,EAEMo5C,GAAuB,CAAEttB,EAAautB,IAAa,CAExD,MAAMC,EAAW50B,EAAMoH,EAAY,KAAMxI,GAAK+1B,CAAS,CAAA,GACjDE,EAAW70B,EAAMoH,EAAY,KAAMxI,GAAK+1B,EAAQ,IAAK,EAAO,CAAA,GAC5DG,EAAc3lC,GAAK,EAAKylC,CAAQ,EAChCG,EAAc5lC,GAAK,EAAK0lC,CAAQ,EAChCG,EAAUtB,GAAStsB,EAAa5G,EAAMs0B,EAAaF,GAAY1pB,GAAOypB,CAAO,GAC7EM,EAAUvB,GAAStsB,EAAa5G,EAAMu0B,EAAaF,GAAY1pB,GAAMwpB,CAAO,GAElF,OAAOvpB,GAAOupB,CAAS,EAAC,IAAKK,EAASC,CAAO,CAE9C,EAEA,MAAMC,WAA2Bx7B,CAAS,CAEzC,YAAa0N,EAAa+tB,EAAWr2B,EAAO,CAAC,EAAK,CAEjD,MAAO,MAAM,EAEb,KAAK,YAAcsI,EACnB,KAAK,SAAW+tB,CAEhB,CAED,OAAQ,CAEP,OAAOT,GAAsB,KAAK,YAAa,KAAK,QAAQ,CAE5D,CAEF,CAIO,MAAMU,GAAiB71B,EAAW21B,IAEzCn5B,EAAgB,UAAWq5B,IAE3B57B,EAAc,qBAAsB07B,EAAoB,EC1FxD,MAAMG,WAAoB19B,CAAK,CAE9B,aAAc,CAEb,MAAO,MAAM,EAEb,KAAK,cAAgB,EAErB,CAED,UAAwB,CAEvB,MAAO,gDAEP,CAEF,CAIuB6H,EAAe61B,EAAc,EAEpD77B,EAAc,cAAe67B,EAAa,ECpB1C,MAAMC,WAAkB39B,CAAK,CAE5B,YAAa0F,EAAQi4B,GAAU,sBAAuB3V,EAAQ,KAAO,CAEpE,QAEA,KAAK,MAAQtiB,EACb,KAAK,MAAQsiB,CAEb,CAED,MAAO3nB,EAAU,CAEhB,MAAMqF,EAAQ,KAAK,MACbsiB,EAAQ,KAAK,QAAU,KAAO,KAAK,MAAQ3nB,EAAQ,MAEzD,IAAIld,EAEJ,OAAKuiB,IAAUi4B,GAAU,sBAExBx6C,EAAS02B,GAAW,uBAAwB,QAASmO,CAAK,EAE/CtiB,IAAUi4B,GAAU,qBAE/Bx6C,EAAS02B,GAAW,sBAAuB,QAASmO,CAAK,EAIzD,QAAQ,MAAO,kCAAmCtiB,GAI5CviB,CAEP,CAEF,CAEAw6C,GAAU,sBAAwB,uBAClCA,GAAU,qBAAuB,sBAIG91B,EAAe81B,GAAWA,GAAU,qBAAwB,EAC7D91B,EAAe81B,GAAWA,GAAU,oBAAuB,EAE9F97B,EAAc,YAAa87B,EAAW,ECsN/B,MAAMC,GAAuB,CACnC,QAAS,UACT,QAAS,UACT,gBAAiB,mBAClB,EAEaC,GAA0B,CACtC,UAAW,aACX,SAAU,YACV,UAAW,YACZ,EC3QA,MAAMC,WAA0BjlB,EAAW,CAE1C,YAAar0B,EAAOs0B,EAAYC,EAAc,EAAI,CAEjD,MAAOv0B,EAAOs0B,EAAYC,GAE1B,KAAK,oBAAsB,GAE3B,KAAK,OAAS6kB,GAAqB,QAEnC,KAAK,aAAe,GACpB,KAAK,YAAc7kB,EAEnB,KAAK,WAAa,KAClB,KAAK,SAAW,KAEhB,KAAK,OAAS,GAETv0B,EAAM,2BAA6B,IAAQA,EAAM,oCAAsC,KAItFA,EAAM,2BAA6BA,EAAM,kCAAoC,GAC7EA,EAAM,yBAA2B,GAIvC,CAED,QAAS6b,EAAU,CAElB,GAAK,KAAK,cAAgB,EAAI,CAE7B,IAAI0f,EAAa1f,EAAQ,YAAY,QAAS,KAAK,OAEnD,OAAK0f,IAAe,SAEnBA,EAAa,CACZ,KAAM,IACX,EAEI1f,EAAQ,YAAY,QAAS,KAAK,MAAO0f,CAAU,GAI7CA,EAAW,KAAK,IAEvB,CAED,OAAO,KAAK,IAEZ,CAED,cAA4B,CAE3B,MAAO,eAEP,CAED,QAAS3d,EAAY,CAEpB,OAAO03B,GAAgB,KAAM13B,EAE7B,CAED,gBAAiB5d,EAAQ,CAExB,YAAK,aAAeA,EAEb,IAEP,CAED,UAAWA,EAAQ,CAElB,YAAK,OAASA,EAEP,IAEP,CAED,YAAa,CAEZ,OAAO,KAAK,UAAWo5C,GAAqB,eAAe,CAE3D,CAED,SAAUv9B,EAAU,CAEnB,GAAKA,EAAQ,YAAa,iBAEzB,OAAO,MAAM,SAAUA,GAIxB,MAAMH,EAAW,KAAK,YAAaG,CAAO,EAErC,KAAK,aAAe,OAExB,KAAK,WAAa8f,GAAiB,KAAK,KAAK,EAC7C,KAAK,SAAW1V,GAAS,KAAK,UAAU,GAKzC,MAAMtnB,EAAS,KAAK,SAAS,MAAOkd,EAASH,GAE7C,OAAAG,EAAQ,kBAAmBld,EAAQ,KAAK,UAAU,EAE3CA,CAEP,CAEF,CAQA0e,EAAc,oBAAqBi8B,EAAmB,EC5HtD,MAAMC,WAA2BlmB,EAAY,CAE5C,YAAarzB,EAAOszB,EAAQkmB,EAAY,KAAO,CAE9C,MAAOx5C,EAAOszB,GAEd,KAAK,UAAYkmB,EAEjB,KAAK,qBAAuB,GAE5B,KAAK,OAASH,GAAwB,SAEtC,CAED,cAA4B,CAE3B,MAAO,gBAEP,CAED,MAAOx9B,EAAU,CAEhB,MAAM,MAAOA,GAEb,MAAMQ,EAAaR,EAAQ,kBAAmB,IAAI,EAClDQ,EAAW,UAAY,KAAK,SAE5B,CAED,UAAWrc,EAAQ,CAElB,YAAK,OAASA,EACP,IAEP,CAED,SAAU6b,EAASld,EAAS,CAE3B,IAAI6e,EAEJ,OAAK,KAAK,YAAc,KAEvBA,EAAU,KAAK,cAAe3B,GAI9B2B,EAAU,MAAM,SAAU3B,EAASld,CAAM,EAInC6e,CAEP,CAED,YAAa,CAEZ,OAAO,KAAK,UAAW67B,GAAwB,QAAQ,CAEvD,CAED,aAAc,CAEb,OAAO,KAAK,UAAWA,GAAwB,SAAS,CAExD,CAED,cAAex9B,EAAU,CAExB,MAAMQ,EAAaR,EAAQ,kBAAmB,IAAI,EAE5C,CAAE,OAAAyX,EAAQ,UAAAkmB,CAAW,EAAGn9B,EAExB8O,EAAkB,MAAM,SAAUtP,EAAS,UAAU,EACrD4X,EAAYH,EAAO,MAAOzX,EAAS,OAAO,EAC1C49B,EAAeD,EAAU,MAAO39B,EAAS,MAAM,EAE/C2B,EAAU3B,EAAQ,qBAAsBA,EAASsP,EAAiBsI,EAAWgmB,GAEnF59B,EAAQ,gBAAiB2B,EAEzB,CAEF,CAI8B4F,EAAWm2B,EAAqB,EAY9Dl8B,EAAc,qBAAsBk8B,EAAoB,ECnGxD,MAAMG,GAAS/4B,EAAO,CAAE,CAAE,QAAAsS,EAAS,GAAAlI,CAAE,IAAQ,CAI5C,MAAM4uB,EAAM11B,IAAO,OAEnB,OAAAP,GAAIqH,EAAG,EAAE,SAAU,IAAS,EAAE,IAAM,CAEnC4uB,EAAI,OAAQ11B,EAAM,EAAG,EAAG,CAAC,EAE3B,CAAI,EAAC,OAAQ8G,EAAG,EAAE,SAAU,IAAO,EAAI,IAAM,CAE3C4uB,EAAI,OAAQ11B,EAAM,EAAG,EAAG,CAAC,EAE3B,CAAI,EAAC,OAAQ8G,EAAG,EAAE,SAAU,IAAO,EAAI,IAAM,CAE3C4uB,EAAI,OAAQ11B,EAAM,EAAG,EAAG,CAAC,EAE3B,CAAI,EAAC,OAAQ8G,EAAG,EAAE,YAAa,EAAI,IAAO,EAAI,IAAM,CAElD4uB,EAAI,OAAQ11B,EAAM,GAAK,EAAG,CAAC,EAE7B,CAAI,EAAC,OAAQ8G,EAAG,EAAE,YAAa,EAAI,IAAO,EAAI,IAAM,CAElD4uB,EAAI,OAAQ11B,EAAM,EAAG,GAAK,CAAC,EAE7B,CAAI,EAAC,OAAQ8G,EAAG,EAAE,YAAa,EAAI,IAAO,EAAI,IAAM,CAElD4uB,EAAI,OAAQ11B,EAAM,EAAG,EAAG,EAAG,EAE7B,CAAI,EAAC,KAAM,IAAM,CAIf,MAAMnV,EAAImkB,EAAQ,GAAIlI,EAAG,IAAK9G,EAAM,KAAQ,EAAK,CAAG,CAAI,CAAA,EAAG,EAAE,IAAKgP,EAAQ,GAAIlI,EAAG,IAAK9G,EAAM,IAAM,EAAK,CAAG,EAAM,EAAC,CAAC,EAC5G1f,EAAI0uB,EAAQ,GAAIlI,EAAG,IAAK9G,EAAM,EAAK,KAAQ,CAAG,CAAI,CAAA,EAAG,EAAE,IAAKgP,EAAQ,GAAIlI,EAAG,IAAK9G,EAAM,EAAK,IAAM,CAAG,EAAM,EAAC,CAAC,EAC5G6tB,EAAI7e,EAAQ,GAAIlI,EAAG,IAAK9G,EAAM,EAAK,EAAK,IAAM,CAAI,CAAA,EAAG,EAAE,IAAKgP,EAAQ,GAAIlI,EAAG,IAAK9G,EAAM,EAAK,EAAK,GAAI,EAAM,EAAC,CAAC,EAElH01B,EAAI,OAAQ11B,EAAMnV,EAAGvK,EAAGutC,CAAC,EAE3B,GAEQ6H,EAAI,WAEZ,GAGA,MAAMC,WAAsBvmB,EAAY,CAEvC,YAAarzB,EAAOszB,EAAS,KAAMpI,EAAY,KAAO,CAErD,MAAOlrB,EAAOszB,EAAQpI,GAEtB,KAAK,gBAAkB,EAEvB,CAED,cAA4B,CAE3B,MAAO,WAEP,CAED,cAAe,CAEd,OAAOjH,EAAM,GAAK,GAAK,EAAG,CAE1B,CAED,iBAAoC,CAAG,CAEvC,QAASpI,EAASyX,EAAS,CAE1B,OAAOA,CAEP,CAED,WAAYzX,EAASyX,EAAS,CAE7B,OAAOA,EAAO,MAAOzX,EAAS,MAAM,CAEpC,CAED,OAAQyX,EAAS,CAEhB,OAAOomB,GAAQ,CAAE,QAAS,KAAM,GAAIpmB,CAAM,EAE1C,CAEF,CAIO,MAAMumB,GAAYz2B,EAAWw2B,IAEpCv8B,EAAc,gBAAiBu8B,EAAe,EC/F9C,MAAME,WAAqB5kB,EAAc,CAExC,YAAapb,EAAU6T,EAAWosB,EAAW,KAAO,CAEnD,MAAOjgC,EAAU6T,EAAWosB,GAE5B,KAAK,SAAWA,CAEhB,CAED,OAAQvvB,EAAQ,CAEf,KAAK,UAAY,KAAK,WAAa,KAAO,KAAK,SAAWA,EAAM,OAAO,SAEvE,MAAM,OAAQA,EAEd,CAEF,CAMAnN,EAAc,eAAgBy8B,EAAc,ECvBrC,MAAME,GAAWr5B,EAAO,CAAE,CAAE,KAAAs5B,EAAM,MAAAC,CAAK,IAAQ,CAErD,MAAM52B,EAAOtP,GAAOkmC,EAAOlmC,CAAC,EAAG,SAAUka,EAAS,EAAC,KAAMgsB,EAAOlmC,CAAG,EAAEimC,EAAMjmC,GAAI,WAAW,IAAKkmC,EAAOlmC,EAAK,EAAC,SAAU,EAAC,IAAK,CAAG,CAAA,EAE/H,OAAOiQ,EAAMX,EAAI,KAAOA,EAAI,KAAOA,EAAI,GAAG,EAE3C,CAAC,EAAG,UAAW,CACd,KAAM,YACN,KAAM,OACN,OAAQ,CACP,CAAE,KAAM,OAAQ,KAAM,MAAQ,EAC9B,CAAE,KAAM,QAAS,KAAM,MAAQ,CAC/B,CACF,GAEa62B,GAAYx5B,EAAO,CAAE,CAAE,KAAAs5B,EAAM,MAAAC,CAAK,IAAQ,CAEtD,MAAM52B,EAAOtP,GAAOkmC,EAAOlmC,CAAC,EAAG,MAAO,CAAK,EAAC,KAAMkmC,EAAOlmC,CAAC,EAAIimC,EAAMjmC,CAAG,EAAC,IAAKkmC,EAAOlmC,CAAC,EAAG,SAAQ,GAAK,IAAK,CAAC,GAE3G,OAAOiQ,EAAMX,EAAI,KAAOA,EAAI,KAAOA,EAAI,GAAG,EAE3C,CAAC,EAAG,UAAW,CACd,KAAM,aACN,KAAM,OACN,OAAQ,CACP,CAAE,KAAM,OAAQ,KAAM,MAAQ,EAC9B,CAAE,KAAM,QAAS,KAAM,MAAQ,CAC/B,CACF,GAEa82B,GAAaz5B,EAAO,CAAE,CAAE,KAAAs5B,EAAM,MAAAC,CAAK,IAAQ,CAEvD,MAAM52B,EAAOtP,GAAOimC,EAAMjmC,CAAG,EAAC,SAAQ,EAAG,IAAKkmC,EAAOlmC,CAAG,EAAC,SAAQ,CAAI,EAAC,SAAQ,EAE9E,OAAOiQ,EAAMX,EAAI,KAAOA,EAAI,KAAOA,EAAI,GAAG,EAE3C,CAAC,EAAG,UAAW,CACd,KAAM,cACN,KAAM,OACN,OAAQ,CACP,CAAE,KAAM,OAAQ,KAAM,MAAQ,EAC9B,CAAE,KAAM,QAAS,KAAM,MAAQ,CAC/B,CACF,GAEa+2B,GAAc15B,EAAO,CAAE,CAAE,KAAAs5B,EAAM,MAAAC,CAAK,IAAQ,CAExD,MAAM52B,EAAOtP,GAAOimC,EAAMjmC,CAAC,EAAG,SAAU,EAAG,EAAG,KAAMimC,EAAMjmC,CAAG,EAAC,IAAKkmC,EAAOlmC,CAAG,EAAE,CAAG,EAAIimC,EAAMjmC,CAAG,EAAC,SAAQ,EAAG,IAAKkmC,EAAOlmC,CAAC,EAAG,SAAU,CAAA,EAAG,SAAU,CAAA,EAGlJ,OAAOiQ,EAAMX,EAAI,KAAOA,EAAI,KAAOA,EAAI,GAAG,EAE3C,CAAC,EAAG,UAAW,CACd,KAAM,eACN,KAAM,OACN,OAAQ,CACP,CAAE,KAAM,OAAQ,KAAM,MAAQ,EAC9B,CAAE,KAAM,QAAS,KAAM,MAAQ,CAC/B,CACF,GAEA,MAAMg3B,WAAsB/8B,CAAS,CAEpC,YAAag9B,EAAWC,EAAUC,EAAY,CAE7C,QAEA,KAAK,UAAYF,EAEjB,KAAK,SAAWC,EAChB,KAAK,UAAYC,CAEjB,CAED,OAAQ,CAEP,KAAM,CAAE,UAAAF,EAAW,SAAAC,EAAU,UAAAC,CAAS,EAAK,KACrChgC,EAAS,CAAE,KAAM+/B,EAAU,MAAOC,CAAS,EAEjD,IAAIv+B,EAAa,KAEjB,OAAKq+B,IAAcD,GAAc,KAEhCp+B,EAAa89B,GAAUv/B,GAEZ8/B,IAAcD,GAAc,MAEvCp+B,EAAai+B,GAAW1/B,GAEb8/B,IAAcD,GAAc,OAEvCp+B,EAAak+B,GAAY3/B,GAEd8/B,IAAcD,GAAc,UAEvCp+B,EAAam+B,GAAa5/B,IAIpByB,CAEP,CAEF,CAEAo+B,GAAc,KAAO,OACrBA,GAAc,MAAQ,QACtBA,GAAc,OAAS,SACvBA,GAAc,QAAU,UAIjB,MAAMI,GAAOt3B,EAAWk3B,GAAeA,GAAc,IAAI,EACnDK,GAAQv3B,EAAWk3B,GAAeA,GAAc,KAAK,EACrDM,GAAUx3B,EAAWk3B,GAAeA,GAAc,OAAO,EACzDO,GAASz3B,EAAWk3B,GAAeA,GAAc,MAAM,EAEpE16B,EAAgB,OAAQ86B,IACxB96B,EAAgB,QAAS+6B,IACzB/6B,EAAgB,UAAWg7B,IAC3Bh7B,EAAgB,SAAUi7B,IAE1Bx9B,EAAc,gBAAiBi9B,EAAe,ECpH9C,MAAMQ,GAAYn6B,EAAO,CAAE,CAAE,YAAAsK,EAAa,UAAA8vB,CAAS,IAAQ,CAG1D,MAAMC,EAAkBxxC,GAAcyhB,EAAY,QAAQ,QAAS,CAAE,MAASgwB,GAAazxC,EAAUyxC,EAAQ,QAAUlwB,GAAI,CAAA,EAAI,eAAgB,EAAI,GAE7ImwB,EAAMv4B,EAAOq4B,EAAiB1nB,GAAYA,CAAM,GAEtD,OAAOzP,EACNlB,EAAOq4B,EAAiB1nB,GAAYA,EAAO,IAAKA,EAAO,MAAQ,CAAA,GAAK,IAAK4nB,CAAK,EAC9Ev4B,EAAOq4B,EAAiB1nB,GAAYA,EAAO,IAAKA,EAAO,MAAQ,CAAA,GAAK,IAAK4nB,CAAK,CAChF,EAAG,IAAKH,EAER,GAIMI,GAAmBx6B,EAASV,GAAY,CAE7C,KAAM,CAAE,SAAAm7B,EAAU,UAAAC,EAAW,MAAAC,CAAK,EAAKr7B,EAGjCs7B,EAAUH,EAAS,KAAM,EAAC,UAAS,EACnCI,EAAUJ,EAAS,KAAM,EAAC,UAAS,EACnCK,EAAKJ,EAELK,EAAKF,EAAQ,MAAOC,CAAE,EACtBE,EAAKF,EAAG,MAAOF,CAAO,EAEtBK,EAAOL,EAAQ,IAAKG,CAAE,EAAG,IAAK3M,IAE9B8M,EAAQD,EAAK,KAAM,EAAC,IAAKN,EAAM,EAAE,IAAKI,CAAI,EAAC,IAAKJ,EAAM,EAAE,IAAKK,CAAI,CAAA,GAEvE,OAAOC,EAAK,IAAK,EAAC,IAAKP,CAAW,EAAC,IAAKQ,GAAQ,WAEjD,GAEA,MAAMC,WAAoBv+B,CAAS,CAElC,YAAa0N,EAAa0qB,EAAY,KAAO,CAE5C,MAAO,MAAM,EAEb,KAAK,YAAc1qB,EACnB,KAAK,UAAY0qB,CAEjB,CAED,OAAQ,CAEP,MAAMoF,EAAY,KAAK,YAAc,KAAO,KAAK,UAAY,EACvDO,EAAQR,GAAW,CAAE,YAAa,KAAK,YAAa,UAAAC,CAAS,GAEnE,OAAOI,GAAkB,CACxB,SAAUtgB,GACV,UAAW/D,GACX,MAAAwkB,CACH,EAEE,CAEF,CAIO,MAAMS,GAAU34B,EAAW04B,IAElCl8B,EAAgB,UAAWm8B,IAE3B1+B,EAAc,cAAey+B,EAAa,ECzE1C,MAAME,GAAiBr7B,EAAO,CAAE,CAAE,MAAAiD,EAAO,WAAAq4B,CAAU,IAE3CA,EAAW,IAAKC,GAAWt4B,EAAM,KAAOA,EAAM,MAIhDu4B,GAAex7B,EAAO,CAAE,CAAE,MAAAiD,EAAO,WAAAq4B,CAAU,IAAQ,CAExD,MAAMG,EAAUrwB,GAAKnI,EAAM,EAAGA,EAAM,EAAGA,EAAM,CAAC,EAAG,IAAK,CAAG,EAEnDy4B,EAAKz4B,EAAM,EAAE,IAAKA,EAAM,EAAE,IAAKA,EAAM,CAAC,GACtC04B,EAAMD,EAAG,IAAKD,CAAS,EAAC,IAAKH,GAAa,IAAK,IAErD,OAAO/qB,GAAKtN,EAAM,IAAKy4B,EAAIC,CAAG,CAE/B,GAEMC,GAAU57B,EAAO,CAAE,CAAE,MAAAiD,EAAO,WAAAq4B,CAAU,IAAQ,CAEnD,MAAM9oC,EAAI8Q,EAAM,OAAS,OAAS,MAAO,EAEnCowB,EAAW4H,EAAW,MAE5B,OAAOh4B,EAAML,EAAM,IAAI,IAAKywB,CAAQ,EAAG,IAAKlhC,EAAE,MAAOyQ,EAAM,GAAG,EAAG,IAAKq4B,EAAW,KAAO,EAAC,IAAK9oC,EAAE,IAAKsd,GAAKtd,EAAGyQ,EAAM,GAAG,EAAG,IAAKywB,EAAS,SAAU,CAAA,CAAI,CAAA,CAAI,CAAA,CAE1J,GAEA,MAAMmI,WAA4Bj/B,CAAS,CAE1C,YAAa9V,EAAQ4vB,EAAWolB,EAAiB95B,EAAO,CAAC,EAAK,CAE7D,MAAO,MAAM,EAEb,KAAK,OAASlb,EAEd,KAAK,UAAY4vB,EACjB,KAAK,eAAiBolB,CAEtB,CAED,OAAQ,CAEP,KAAM,CAAE,OAAAh1C,EAAQ,UAAA4vB,EAAW,eAAAolB,CAAc,EAAK,KAExCC,EAAa,CAAE,MAAOrlB,EAAW,WAAYolB,CAAc,EAEjE,IAAIvgC,EAAa,KAEjB,OAAKzU,IAAW+0C,GAAoB,WAEnCtgC,EAAa8/B,GAAgBU,GAElBj1C,IAAW+0C,GAAoB,SAE1CtgC,EAAaigC,GAAcO,GAEhBj1C,IAAW+0C,GAAoB,IAE1CtgC,EAAaqgC,GAASG,GAItB,QAAQ,MAAO,GAAI,KAAK,iBAAmB,KAAK,0BAI1CxgC,CAEP,CAEF,CAEAsgC,GAAoB,WAAa,aACjCA,GAAoB,SAAW,WAC/BA,GAAoB,IAAM,MAInB,MAAMG,GAAav5B,EAAWo5B,GAAqBA,GAAoB,UAAU,EAC3EI,GAAWx5B,EAAWo5B,GAAqBA,GAAoB,QAAQ,EACvEK,GAAMz5B,EAAWo5B,GAAqBA,GAAoB,GAAG,EAE7DM,GAAa74B,EAAM,MAAQ,MAAQ,KAAM,EACzCi4B,GAAY,CAAEt4B,EAAOm5B,EAAOD,KAAgBrsB,GAAK7M,EAAOm5B,GAExDC,GAAY,CAAEp5B,EAAOo5B,IAAe9rB,GAAKjN,EAAM,GAAOL,EAAOs4B,GAAWt4B,CAAO,EAAC,IAAKo5B,CAAW,EAAC,IAAK,CAAC,GAEpHp9B,EAAgB,aAAc+8B,IAC9B/8B,EAAgB,WAAYg9B,IAC5Bh9B,EAAgB,MAAOi9B,IACvBj9B,EAAgB,YAAao9B,IAE7B3/B,EAAc,sBAAuBm/B,EAAqB,ECjF1D,MAAMS,GAAoBt8B,EAASV,GAAY,CAE9C,KAAM,CAAE,QAAAi9B,EAAS,UAAA7B,EAAW,KAAA8B,EAAM,GAAApyB,CAAE,EAAK9K,EAEnCm9B,EAAKF,EAAQ,OACbG,EAAKH,EAAQ,OACbI,EAAMvyB,EAAG,OACTwyB,EAAMxyB,EAAG,OAETyyB,EAAInC,EAEJoC,EAASJ,EAAG,MAAOG,CAAC,EACpBE,EAASF,EAAE,MAAOJ,CAAE,EAEpBO,EAAIF,EAAO,IAAKH,EAAI,CAAC,EAAG,IAAKI,EAAO,IAAKH,EAAI,CAAG,CAAA,EAChDK,EAAIH,EAAO,IAAKH,EAAI,CAAC,EAAG,IAAKI,EAAO,IAAKH,EAAI,CAAG,CAAA,EAEhDM,EAAMF,EAAE,IAAKA,CAAC,EAAG,IAAKC,EAAE,IAAKA,CAAC,GAC9B5K,EAAQjE,GAAc,IAAK8O,EAAI,YAAa,CAAA,EAElD,OAAO9xB,GAAK4xB,EAAE,IAAKR,EAAK,EAAGnK,CAAK,EAAI4K,EAAE,IAAKT,EAAK,EAAGnK,CAAO,EAAEwK,EAAE,IAAKL,EAAK,CAAC,GAAK,WAE/E,GAEA,MAAMW,WAAsBvgC,CAAS,CAEpC,YAAatD,EAAM07B,EAAY,KAAO,CAErC,MAAO,MAAM,EAEb,KAAK,KAAO17B,EACZ,KAAK,UAAY07B,EAEjB,KAAK,cAAgBoI,EAErB,CAED,MAAOliC,EAAU,CAEhB,KAAM,CAAE,cAAAmiC,EAAe,UAAArI,CAAW,EAAG,KAErC,IAAIsI,EAAY,KAAK,KAAK,IAAK,GAAM,IAAK,GAErCtI,IAAc,OAElBsI,EAAYh6B,EAAMg6B,EAAU,GAAG,IAAKtI,CAAW,EAAEsI,EAAU,IAI5D,IAAI/hC,EAAa,KAEjB,OAAK8hC,IAAkBE,GAEtBhiC,EAAaua,GAAkB,IAAKwnB,CAAW,EAAC,UAAS,EAE9CD,IAAkBD,KAEbliC,EAAQ,qBAAsB,SAAS,IAEtC,GAEhBK,EAAa2pB,GAAc,IAAKoY,CAAW,EAAC,UAAS,EAIrD/hC,EAAa+gC,GAAmB,CAC/B,QAASpiB,GACT,UAAW/D,GACX,KAAMmnB,EACN,GAAIlzB,GAAI,CACb,IAMS7O,CAEP,CAEF,CAIO,MAAM+hC,GAAY76B,EAAW06B,IAEpCl+B,EAAgB,YAAaq+B,IAE7B5gC,EAAc,gBAAiBygC,EAAe,ECrG9C,MAAMK,WAAsB5gC,CAAS,CAEpC,YAAayB,EAAYo/B,EAAY,CAEpC,QAEA,KAAK,WAAap/B,EAClB,KAAK,UAAYo/B,CAEjB,CAED,OAAQ,CAEP,KAAM,CAAE,WAAAp/B,EAAY,UAAAo/B,CAAW,EAAG,KAElC,OAAOp/B,EAAW,IAAKo/B,CAAS,EAAG,QAAQ,IAAKA,EAEhD,CAEF,CAIO,MAAMC,GAAYj7B,EAAW+6B,IAEpCv+B,EAAgB,YAAay+B,IAE7BhhC,EAAc,gBAAiB8gC,EAAe,ECpB9C,MAAMG,GAAwB39B,EAAO,CAAE,CAAE,MAAAiD,EAAO,SAAA26B,CAAQ,IAEhD36B,EAAM,IAAK26B,CAAU,EAAC,MAAK,GAK7BC,GAA0B79B,EAAO,CAAE,CAAE,MAAAiD,EAAO,SAAA26B,CAAQ,KAEzD36B,EAAQA,EAAM,IAAK26B,GAEZ36B,EAAM,IAAKA,EAAM,IAAK,CAAK,CAAA,EAAG,UAKhC66B,GAAiC99B,EAAO,CAAE,CAAE,MAAAiD,EAAO,SAAA26B,CAAQ,IAAQ,CAGxE36B,EAAQA,EAAM,IAAK26B,GACnB36B,EAAQA,EAAM,IAAK,IAAK,EAAG,IAAK,GAEhC,MAAM1kB,EAAI0kB,EAAM,IAAKA,EAAM,IAAK,KAAM,IAAK,EAAG,GACxCzkB,EAAIykB,EAAM,IAAKA,EAAM,IAAK,KAAM,IAAK,GAAK,CAAA,EAAG,IAAK,GAAI,EAE5D,OAAO1kB,EAAE,IAAKC,CAAG,EAAC,IAAK,GAAG,CAE3B,GAGMu/C,GAAe/9B,EAAO,CAAE,CAAE,MAAAiD,KAAa,CAE5C,MAAM1kB,EAAI0kB,EAAM,IAAKA,EAAM,IAAK,SAAa,EAAC,IAAK,UAC7CzkB,EAAIykB,EAAM,IAAKA,EAAM,IAAK,SAAY,IAAK,OAAU,CAAA,EAAG,IAAK,OAAQ,EAE3E,OAAO1kB,EAAE,IAAKC,EAEf,GAGMw/C,GAA4Bh+B,EAAO,CAAE,CAAE,MAAAiD,EAAO,SAAA26B,CAAQ,IAAQ,CAGnE,MAAMK,EAAe/5B,GACpB,OAAS,OAAS,OAClB,KAAS,OAAS,OAClB,MAAS,OAAS,MACpB,EAGOg6B,EAAgBh6B,GACrB,QAAS,QAAW,QACpB,QAAW,QAAS,QACpB,QAAW,QAAW,OACxB,EAEC,OAAAjB,EAAQA,EAAM,IAAK26B,CAAQ,EAAG,IAAK,IAEnC36B,EAAQg7B,EAAa,IAAKh7B,GAG1BA,EAAQ86B,GAAc,CAAE,MAAA96B,CAAK,GAE7BA,EAAQi7B,EAAc,IAAKj7B,GAGpBA,EAAM,OAEd,GAIMk7B,GAAgCj6B,GAAMZ,EAAM,OAAQ,OAAU,MAAU,EAAEA,EAAM,OAAU,OAAQ,MAAQ,EAAIA,EAAM,OAAU,OAAU,MAAM,GAC9I86B,GAAgCl6B,GAAMZ,EAAM,MAAQ,MAAQ,KAAM,EAAIA,EAAM,MAAQ,MAAQ,IAAM,EAAIA,EAAM,MAAQ,MAAQ,KAAM,GAElI+6B,GAA2Br+B,EAAO,CAAE,CAAEs+B,KAAmB,CAE9D,MAAMnwC,EAAImV,EAAMg7B,CAAa,EAAC,MAAK,EAC7BC,EAAKj7B,EAAMnV,EAAE,IAAKA,CAAG,CAAA,EAAG,QACxBqwC,EAAKl7B,EAAMi7B,EAAG,IAAKA,CAAI,CAAA,EAAG,QAEhC,OAAOv8B,EAAO,IAAI,EAAG,IAAKw8B,EAAG,IAAKD,EAAM,EAAC,IAAKjzB,EAAK,MAAOkzB,EAAG,IAAKrwC,CAAG,CAAA,CAAI,EAAC,IAAKmd,EAAK,MAAOkzB,CAAI,EAAC,IAAKlzB,EAAK,MAAOizB,EAAG,IAAKpwC,CAAC,EAAM,EAAC,IAAKmd,EAAK,MAAQizB,CAAE,EAAG,IAAKjzB,EAAK,MAAQnd,CAAG,EAAC,IAAK,OAAW,CAAA,EAE/L,GAEMswC,GAAqBz+B,EAAO,CAAE,CAAE,MAAAiD,EAAO,SAAA26B,CAAQ,IAAQ,CAE5D,MAAMc,EAAYp7B,EAAML,CAAO,EAAC,MAAK,EAC/B07B,EAAiBz6B,GAAMZ,EAAM,iBAAmB,iBAAmB,eAAgB,EAAIA,EAAM,kBAAoB,iBAAmB,iBAAkB,EAAIA,EAAM,kBAAoB,iBAAmB,gBAAiB,GACxNs7B,EAAkB16B,GAAMZ,EAAM,mBAAoB,mBAAsB,mBAAuB,EAAEA,EAAM,oBAAuB,kBAAmB,mBAAqB,EAAIA,EAAM,qBAAwB,qBAAwB,kBAAkB,GAClPu7B,EAAW78B,EAAO,WAClB88B,EAAW98B,EAAO,UACxB,OAAA08B,EAAU,UAAWd,GACrBc,EAAU,OAAQN,GAA8B,IAAKM,CAAW,CAAA,EAChEA,EAAU,OAAQC,EAAe,IAAKD,CAAW,CAAA,EACjDA,EAAU,OAAQjvB,GAAKivB,EAAW,KAAO,CAAA,EACzCA,EAAU,OAAQzwB,GAAMywB,CAAW,CAAA,EACnCA,EAAU,OAAQA,EAAU,IAAKG,CAAQ,EAAG,IAAKC,EAAS,IAAKD,CAAQ,CAAI,CAAA,EAC3EH,EAAU,OAAQluB,GAAOkuB,EAAW,EAAK,CAAG,GAC5CA,EAAU,OAAQL,GAA0BK,CAAW,CAAA,EACvDA,EAAU,OAAQE,EAAgB,IAAKF,CAAW,CAAA,EAClDA,EAAU,OAAQ1uB,GAAKP,GAAKnM,EAAM,GAAOo7B,GAAap7B,EAAM,GAAG,CAAI,CAAA,EACnEo7B,EAAU,OAAQP,GAA8B,IAAKO,CAAW,CAAA,EAChEA,EAAU,OAAQluB,GAAOkuB,EAAW,EAAK,CAAG,GAErCA,CAER,GAIMK,GAAyB/+B,EAAO,CAAE,CAAE,MAAAiD,EAAO,SAAA26B,CAAQ,IAAQ,CAEhE,MAAMoB,EAAmBh9B,EAAO,GAAU,EACpCi9B,EAAej9B,EAAO,KAE5BiB,EAAQA,EAAM,IAAK26B,GAEnB,MAAMzvC,EAAIqhB,GAAKvM,EAAM,EAAGuM,GAAKvM,EAAM,EAAGA,EAAM,CAAC,GACvC7P,EAAS0yB,GAAM33B,EAAE,SAAU,GAAM,EAAEA,EAAE,IAAKmd,EAAK,KAAMnd,EAAE,IAAKA,CAAC,CAAI,CAAA,EAAI,KAE3E8U,EAAM,UAAW7P,GAEjB,MAAM8rC,EAAOzvB,GAAKxM,EAAM,EAAGwM,GAAKxM,EAAM,EAAGA,EAAM,CAAC,GAEhDF,GAAIm8B,EAAK,SAAUF,CAAkB,EAAE,IAE/B/7B,GAIR,MAAMnf,EAAIunB,GAAK,EAAG2zB,CAAgB,EAC5BG,EAAU9zB,GAAK,EAAGvnB,EAAE,IAAKA,CAAG,EAAC,IAAKo7C,EAAK,IAAKp7C,EAAE,IAAKk7C,CAAgB,CAAI,CAAA,GAC7E/7B,EAAM,UAAWk8B,EAAQ,IAAKD,CAAM,CAAA,EACpC,MAAM1rC,EAAI6X,GAAK,EAAGhZ,GAAK,EAAG4sC,EAAa,IAAKC,EAAK,IAAKC,CAAS,CAAA,EAAG,IAAK,CAAG,CAAA,GAE1E,OAAO5uB,GAAKtN,EAAOK,EAAM67B,CAAS,EAAE3rC,CAAC,CAEtC,CAAC,EAAG,UAAW,CACd,KAAM,qBACN,KAAM,OACN,OAAQ,CACP,CAAE,KAAM,QAAS,KAAM,MAAQ,EAC/B,CAAE,KAAM,WAAY,KAAM,OAAS,CACnC,CACF,GAEM4rC,GAAiB,CACtB,CAAEC,EAAiB,EAAI1B,GACvB,CAAE2B,EAAmB,EAAIzB,GACzB,CAAE0B,EAAiB,EAAIzB,GACvB,CAAE0B,EAAqB,EAAIxB,GAC3B,CAAEyB,EAAc,EAAIhB,GACpB,CAAEiB,EAAkB,EAAIX,EACzB,EAEA,MAAMY,WAAwB/iC,CAAS,CAEtC,YAAagjC,EAAc1c,GAAe2c,EAAeC,GAAqBppB,EAAY,KAAO,CAEhG,MAAO,MAAM,EAEb,KAAK,YAAckpB,EAEnB,KAAK,aAAeC,EACpB,KAAK,UAAYnpB,CAEjB,CAED,aAAc,CAEb,IAAIxd,EAAW,MAAM,cACrB,OAAAA,EAAW,gBAAkB,KAAK,YAAc,UAAYA,EAAW,IAEhEA,CAEP,CAED,MAAOgC,EAAU,CAEhB,MAAMwb,EAAY,KAAK,WAAaxb,EAAQ,QAAQ,MAC9C0kC,EAAc,KAAK,YAEzB,GAAKA,IAAgB1c,GAAgB,OAAOxM,EAE5C,MAAMqpB,EAAoB,CAAE,SAAU,KAAK,aAAc,MAAOrpB,GAC1DspB,EAAkBZ,GAAgBQ,GAExC,IAAIrkC,EAAa,KAEjB,OAAKykC,EAEJzkC,EAAaykC,EAAiBD,IAI9B,QAAQ,MAAO,2DAA4DH,GAE3ErkC,EAAamb,GAIPnb,CAEP,CAEF,CAIO,MAAMqkC,GAAc,CAAEK,EAASrC,EAAU36B,IAAWvD,EAAY,IAAIigC,GAAiBM,EAASvgC,EAAYk+B,CAAU,EAAEl+B,EAAYuD,CAAK,CAAI,CAAA,EACrI68B,GAAsB5J,GAAmB,sBAAuB,SAE7Ej3B,EAAgB,cAAe,CAAEgE,EAAOg9B,EAASrC,IAAcgC,GAAaK,EAASrC,EAAU36B,CAAK,GAEpGvG,EAAc,kBAAmBijC,EAAiB,EC5NlD,IAAIO,GAAqB,KAEzB,MAAMC,WAAkCxU,EAAoB,CAE3D,YAAahZ,EAAS8Y,GAAiBlhB,EAAY,KAAO,CAEpD21B,KAAuB,OAE3BA,GAAqB,IAAIrU,IAI1B,MAAOlZ,EAAQpI,EAAW21B,GAE1B,CAED,iBAAkB,CAEjB,OAAO,IAEP,CAEF,CAIO,MAAME,GAAwB39B,EAAW09B,IAEhDlhC,EAAgB,wBAAyBmhC,IAEzC1jC,EAAc,4BAA6ByjC,EAA2B,EC3BtE,MAAMzU,GAAQ,IAAIzxB,GAElB,MAAMomC,WAAwB3tB,EAAY,CAEzC,YAAa4tB,EAAUhuB,EAAU,CAEhC,MAAOA,CAAO,EAEd,KAAK,SAAWguB,EAEhB,KAAK,gBAAiB,GAEtB,CAED,MAAOplC,EAAU,CAEhB,YAAK,SAAS,MAAOA,GAEd,MAAM,MAAOA,EAEpB,CAED,OAAQ,CAEP,OAAO,IAAI,KAAK,YAAa,KAAK,SAAU,KAAK,MAEjD,CAEF,CAEA,MAAMqlC,WAAiB3jC,CAAS,CAE/B,YAAa2D,EAAOsiB,EAAO5N,EAAS,CAEnC,MAAO,MAAM,EAEb,KAAK,MAAQ1U,EACb,KAAK,MAAQsiB,EACb,KAAK,OAAS5N,EAEd,KAAK,YAAc,EACnB,KAAK,OAAS,EACd,KAAK,QAAU,EAEf,MAAM8M,EAAe,IAAIC,GACzBD,EAAa,sBAAwB,GAErCA,EAAa,KAAO,sBAEpB,MAAMye,EAAe,IAAI1K,GAAc,KAAK,OAAS,KAAK,YAAa,KAAK,QAAU,KAAK,YAAa,CAAE,KAAM2K,EAAe,CAAA,EAC/HD,EAAa,QAAQ,KAAO,iBAC5BA,EAAa,aAAeze,EAE5B,KAAK,aAAeye,EAEpB,KAAK,iBAAmB3nC,EAAe,MAEvC,KAAK,aAAe6G,EAAY,IAAI2gC,GAAiB,KAAMG,EAAa,OAAO,GAC/E,KAAK,kBAAoB9gC,EAAY,IAAI2gC,GAAiB,KAAMte,CAAY,GAE5E,KAAK,iBAAmB,KACxB,KAAK,WAAa,KAClB,KAAK,YAAc9X,EAAS,GAC5B,KAAK,WAAaA,EAAS,GAE3B,KAAK,WAAa,EAElB,CAED,UAAW,CAEV,MAAO,EAEP,CAED,gBAAiB,CAEhB,OAAO,KAAK,YAEZ,CAED,qBAAsB,CAErB,OAAO,KAAK,iBAEZ,CAED,cAAe,CAEd,GAAK,KAAK,aAAe,KAAO,CAE/B,MAAM+K,EAAa,KAAK,YAClBE,EAAY,KAAK,WAEvB,KAAK,WAAa0X,GAAyB,KAAK,kBAAmB5X,EAAYE,EAE/E,CAED,OAAO,KAAK,UAEZ,CAED,oBAAqB,CAEpB,GAAK,KAAK,mBAAqB,KAAO,CAErC,MAAMF,EAAa,KAAK,YAClBE,EAAY,KAAK,WAIvB,KAAK,iBAAmBwX,GAA0B,KAAK,eAAgB1X,EAAYE,EAEnF,CAED,OAAO,KAAK,gBAEZ,CAED,OAAQ,CAEP,OAAO,KAAK,QAAUqrB,GAAS,MAAQ,KAAK,eAAgB,EAAG,KAAK,oBAEpE,CAED,aAAc12B,EAAQ,CAErB,KAAM,CAAE,SAAA+Y,CAAU,EAAG/Y,EACf,CAAE,MAAAgZ,EAAO,OAAA5N,CAAQ,EAAG,KAE1B,KAAK,YAAc2N,EAAS,gBAE5B,MAAMnmC,EAAOmmC,EAAS,QAAS8I,EAAK,EAEpC,KAAK,QAASjvC,EAAK,MAAOA,EAAK,MAAM,EAErC,MAAMsmC,EAAqBH,EAAS,YAC9B8d,EAAyB9d,EAAS,gBAClCI,EAAsBJ,EAAS,kBAErC,KAAK,YAAY,MAAQ3N,EAAO,KAChC,KAAK,WAAW,MAAQA,EAAO,IAE/B2N,EAAS,YAAcM,GACvBN,EAAS,gBAAkB,KAC3BA,EAAS,gBAAiB,KAAK,cAE/BA,EAAS,OAAQC,EAAO5N,GAExB2N,EAAS,YAAcG,EACvBH,EAAS,gBAAkB8d,EAC3B9d,EAAS,gBAAiBI,EAE1B,CAED,QAASzlC,EAAOi1B,EAAS,CAExB,KAAK,OAASj1B,EACd,KAAK,QAAUi1B,EAEf,MAAMmuB,EAAiB,KAAK,OAAS,KAAK,YACpCC,EAAkB,KAAK,QAAU,KAAK,YAE5C,KAAK,aAAa,QAASD,EAAgBC,CAAe,CAE1D,CAED,cAAeC,EAAa,CAE3B,KAAK,YAAcA,EAEnB,KAAK,QAAS,KAAK,OAAQ,KAAK,OAAO,CAEvC,CAED,SAAU,CAET,KAAK,aAAa,SAElB,CAGF,CAEAN,GAAS,MAAQ,QACjBA,GAAS,MAAQ,QAKV,MAAMO,GAAc,CAAEC,EAAMzuB,IAAa5S,EAAY,IAAI2gC,GAAiBU,EAAMzuB,CAAO,GAG9F5V,EAAc,WAAY6jC,EAAU,ECtMpC,MAAMS,GAAU,IAAIC,GAAoB,GAAK,EAAG,EAAG,GAAK,EAAG,GAI3D,MAAMC,WAAqBC,EAAe,CAEzC,YAAaC,EAAQ,GAAQ,CAE5B,QAEA,MAAMh3B,EAAKg3B,IAAU,GAAQ,CAAE,EAAG,GAAK,EAAG,EAAG,EAAG,CAAG,EAAG,CAAE,EAAG,EAAG,EAAG,EAAG,EAAG,GAEvE,KAAK,aAAc,WAAY,IAAIC,GAAwB,CAAE,GAAK,EAAG,EAAG,GAAK,GAAK,EAAG,EAAG,GAAK,CAAG,EAAE,CAAC,GACnG,KAAK,aAAc,KAAM,IAAIA,GAAwBj3B,EAAI,CAAC,EAE1D,CAEF,CAEA,MAAMk3B,GAAY,IAAIJ,GAEtB,MAAMK,WAAiBC,EAAK,CAE3B,YAAa3sB,EAAW,KAAO,CAE9B,MAAOysB,GAAWzsB,GAElB,KAAK,OAASmsB,EAEd,CAED,YAAape,EAAW,CAEvB,OAAOA,EAAS,YAAa,KAAMoe,EAAO,CAE1C,CAED,OAAQpe,EAAW,CAElBA,EAAS,OAAQ,KAAMoe,GAEvB,CAEF,CClCA,MAAMS,GAAY,IAAIF,GAChBG,GAAY,IAAIH,GAEtB,MAAMI,WAAyB/kC,CAAS,CAEvC,YAAa0N,EAAas3B,EAAQ,EAAI,CAErC,MAAO,MAAM,EAEb,KAAK,YAAct3B,EACnB,KAAK,MAAQs3B,EAEb,KAAK,cAAgB1+B,EAAM,GAE3B,KAAK,SAAW+G,EAAS,IAAIhQ,EAAS,EACtC,KAAK,eAAiBgQ,EAAS,IAAIhQ,EAAS,EAE5C,KAAK,cAAgB,IAAI67B,GACzB,KAAK,cAAc,QAAQ,KAAO,8BAClC,KAAK,YAAc,IAAIA,GACvB,KAAK,YAAY,QAAQ,KAAO,4BAEhC,KAAK,aAAegL,GAAa,KAAM,KAAK,YAAY,SAExD,KAAK,iBAAmBjoC,EAAe,OAEvC,KAAK,WAAa,IAAIoB,GAAS,EAAG,CAAC,CAEnC,CAED,QAAS1c,EAAOi1B,EAAS,CAExBj1B,EAAQ,KAAK,IAAK,KAAK,MAAOA,EAAQ,KAAK,WAAW,CAAG,EAAE,CAAC,EAC5Di1B,EAAS,KAAK,IAAK,KAAK,MAAOA,EAAS,KAAK,WAAW,CAAG,EAAE,CAAC,EAE9D,KAAK,SAAS,MAAM,IAAK,EAAIj1B,EAAO,EAAIi1B,GACxC,KAAK,cAAc,QAASj1B,EAAOi1B,CAAM,EACzC,KAAK,YAAY,QAASj1B,EAAOi1B,CAAM,CAEvC,CAED,aAAc3I,EAAQ,CAErB,KAAM,CAAE,SAAA+Y,CAAU,EAAG/Y,EAEfS,EAAc,KAAK,YACnBu3B,EAAMv3B,EAAY,MAElB0Y,EAAsBJ,EAAS,kBAC/Bkf,EAAiBx3B,EAAY,MAEnCm3B,GAAU,SAAW,KAAK,UAC1BC,GAAU,SAAW,KAAK,UAE1B,KAAK,QAASG,EAAI,MAAM,MAAOA,EAAI,MAAM,QAEzC,MAAME,EAAcF,EAAI,KAExB,KAAK,cAAc,QAAQ,KAAOE,EAClC,KAAK,YAAY,QAAQ,KAAOA,EAIhCnf,EAAS,gBAAiB,KAAK,eAE/B,KAAK,eAAe,MAAM,IAAK,EAAG,CAAC,EAEnC6e,GAAU,OAAQ7e,GAIlBtY,EAAY,MAAQ,KAAK,cAAc,QACvCsY,EAAS,gBAAiB,KAAK,aAE/B,KAAK,eAAe,MAAM,IAAK,EAAG,CAAC,EAEnC8e,GAAU,OAAQ9e,GAIlBA,EAAS,gBAAiBI,GAC1B1Y,EAAY,MAAQw3B,CAEpB,CAED,gBAAiB,CAEhB,OAAO,KAAK,YAEZ,CAED,MAAO5mC,EAAU,CAEhB,MAAMoP,EAAc,KAAK,YAEzB,GAAKA,EAAY,gBAAkB,GAElC,eAAQ,MAAO,4CAER5G,EAAI,EAMZ,MAAMiP,EAASrI,EAAY,QAAUF,GAAE,EAEjCiwB,EAAkBjwB,GAAQE,EAAY,MAAK,EAAG,QAAS,CAAE,MAAO,IAAMF,EAAI,eAAgB,EAAM,CAAA,EAEhG43B,EAAOhiC,EAAO,IAAM,CAEzB,MAAMiiC,EAAa,EAAM,EAAI,KAAK,MAC5BC,EAAuB,KAAK,iBAAkBD,CAAU,EAExDE,EAAU,KAAK,SACf5lD,EAAY2mB,EAAM,KAAK,aAAe,EAAC,IAAK,KAAK,gBAEjDk/B,EAAYpgC,EAAOkgC,EAAsB,CAAG,CAAA,EAAG,QAC/CG,EAAa3+B,EAAM22B,EAAe1nB,CAAM,EAAG,IAAKyvB,CAAS,GAAK,QAEpE,QAAU7/C,EAAI,EAAGA,EAAI0/C,EAAY1/C,IAAO,CAEvC,MAAM,EAAIyf,EAAOzf,GACX+/C,EAAItgC,EAAOkgC,EAAsB3/C,CAAG,CAAA,EAEpCggD,EAAWr/B,EAAM3mB,EAAU,IAAK4lD,EAAQ,IAAK,CAAG,CAAA,GAAK,QAErDK,EAAU9+B,EAAM22B,EAAe1nB,EAAO,IAAK4vB,CAAU,CAAA,GACrDE,EAAU/+B,EAAM22B,EAAe1nB,EAAO,IAAK4vB,CAAU,CAAA,GAE3DF,EAAW,UAAWG,EAAQ,IAAKC,CAAO,EAAG,IAAKH,CAAC,GACnDF,EAAU,UAAW92B,EAAK,EAAKg3B,CAAG,CAAA,CAElC,CAED,OAAOD,EAAW,IAAKD,EAE1B,GAIQvtB,EAAW,KAAK,YAAe,KAAK,UAAY3Z,EAAQ,mBAAkB,GAChF2Z,EAAS,aAAemtB,IAIxB,MAAMtmC,EAAaR,EAAQ,kBAAmB,IAAI,EAClD,OAAAQ,EAAW,YAAc4O,EAIlB,KAAK,YAEZ,CAED,iBAAkBo4B,EAAe,CAEhC,MAAMC,EAAe,CAAA,EAErB,QAAUpgD,EAAI,EAAGA,EAAImgD,EAAcngD,IAElCogD,EAAa,KAAM,OAAU,KAAK,IAAK,IAAQpgD,EAAIA,GAAMmgD,EAAeA,EAAgB,EAAGA,CAAY,EAIxG,OAAOC,CAEP,CAEF,CAEO,MAAMC,GAAe,CAAEtpC,EAAMsoC,IAAWliC,EAAY,IAAIiiC,GAAkBjiC,EAAYpG,CAAI,EAAIsoC,CAAK,GAE1G3iC,EAAgB,eAAgB2jC,EAAc,EC9K9C,MAAMlX,GAAQ,IAAIzxB,GAEZ4oC,GAAe,IAAItB,GAEzB,MAAMuB,WAAuBlmC,CAAS,CAErC,YAAa0N,EAAay4B,EAAO,IAAO,CAEvC,MAAOz4B,CAAW,EAElB,KAAK,YAAcA,EACnB,KAAK,eAAiBgI,KACtB,KAAK,KAAOrI,EAAS84B,GAErB,KAAK,QAAU,IAAIjN,GACnB,KAAK,QAAQ,QAAQ,KAAO,sBAE5B,KAAK,OAAS,IAAIA,GAClB,KAAK,OAAO,QAAQ,KAAO,qBAE3B,KAAK,aAAegL,GAAa,KAAM,KAAK,QAAQ,SAEpD,KAAK,iBAAmBjoC,EAAe,MAEvC,CAED,gBAAiB,CAEhB,OAAO,KAAK,YAEZ,CAED,QAAStb,EAAOi1B,EAAS,CAExB,KAAK,QAAQ,QAASj1B,EAAOi1B,CAAM,EACnC,KAAK,OAAO,QAASj1B,EAAOi1B,CAAM,CAElC,CAED,aAAc3I,EAAQ,CAErB,KAAM,CAAE,SAAA+Y,CAAU,EAAG/Y,EAEfS,EAAc,KAAK,YAGnBy3B,EAFMz3B,EAAY,MAEA,KAExB,KAAK,QAAQ,QAAQ,KAAOy3B,EAC5B,KAAK,OAAO,QAAQ,KAAOA,EAE3Bnf,EAAS,qBAAsB8I,IAE/B,KAAK,QAASA,GAAM,EAAGA,GAAM,CAAC,EAG9B,MAAM3I,EAAqBH,EAAS,YAC9B8d,EAAyB9d,EAAS,gBAClCI,EAAsBJ,EAAS,kBAC/Bkf,EAAiBx3B,EAAY,MAEnC,KAAK,eAAe,MAAQ,KAAK,OAAO,QAGxCsY,EAAS,YAAcM,GACvBN,EAAS,gBAAkB,KAC3BA,EAAS,gBAAiB,KAAK,SAC/BigB,GAAa,OAAQjgB,GAGrB,MAAM9b,EAAO,KAAK,OAClB,KAAK,OAAS,KAAK,QACnB,KAAK,QAAUA,EAGf8b,EAAS,YAAcG,EACvBH,EAAS,gBAAkB8d,EAC3B9d,EAAS,gBAAiBI,GAC1B1Y,EAAY,MAAQw3B,CAEpB,CAED,MAAO5mC,EAAU,CAEhB,MAAMoP,EAAc,KAAK,YACnB04B,EAAiB,KAAK,eAE5B,GAAK14B,EAAY,gBAAkB,GAElC,eAAQ,MAAO,0CAER5G,EAAI,EAMZ,MAAMiP,EAASrI,EAAY,QAAUF,GAAE,EAEvC44B,EAAe,OAASrwB,EAExB,MAAM0nB,EAAkBjwB,GAAQE,EAAY,MAAK,EAAG,QAAS,CAAE,MAAO,IAAMF,EAAI,eAAgB,EAAM,CAAA,EAEhG64B,EAAUjjC,EAAO,CAAE,CAAEs+B,EAAa4E,CAAW,IAAQ,CAE1D,MAAMt/C,EAAIoe,EAAOkhC,CAAa,EAAC,MAAK,EAC9B/0C,EAAIuV,EAAM46B,CAAa,EAAC,MAAK,EAEnC,OAAO7uB,GAAKZ,GAAM1gB,EAAE,IAAKvK,CAAG,CAAA,EAAI,EAEnC,GAEQu/C,EAAWnjC,EAAO,IAAM,CAE7B,MAAMojC,EAAW1/B,EAAMs/B,GACjBK,EAAW3/B,EAAM22B,EAAe1nB,CAAQ,CAAA,EAE9C,OAAAywB,EAAS,UAAW,KAAK,KAAK,IAAKH,EAASG,EAAU,EAAK,CAAA,GACpD3zB,GAAK4zB,EAAUD,EAEzB,GAIQE,EAAmB,KAAK,oBAAuB,KAAK,kBAAoBpoC,EAAQ,mBAAkB,GACxGooC,EAAiB,aAAeH,IAEhCN,GAAa,SAAWS,EAIxB,MAAM5nC,EAAaR,EAAQ,kBAAmB,IAAI,EAClD,OAAAQ,EAAW,YAAc4O,EAIlB,KAAK,YAEZ,CAEF,CAEO,MAAMi5B,GAAa,CAAEjqC,EAAMypC,IAAUrjC,EAAY,IAAIojC,GAAgBpjC,EAAYpG,CAAI,EAAIypC,CAAI,GAEpG9jC,EAAgB,aAAcskC,EAAY,ECjJ1C,MAAMC,GAAW,IAAIjC,GAErB,MAAMkC,WAAuB7mC,CAAS,CAErC,YAAa0N,EAAao5B,EAAc1O,EAAWpM,EAAU,CAE5D,MAAO,MAAM,EAEb,KAAK,YAActe,EACnB,KAAK,aAAeo5B,EACpB,KAAK,UAAY1O,EACjB,KAAK,UAAY1xB,EAAM,GAAK,EAAK,CAAG,EACpC,KAAK,QAAUslB,EACf,KAAK,WAAa,IAAI3uB,GAAS,EAAG,CAAC,EAEnC,KAAK,cAAgB,IAAI67B,GACzB,KAAK,cAAc,QAAQ,KAAO,aAElC,KAAK,SAAW7rB,EAAS,IAAIhQ,EAAS,EAEtC,KAAK,aAAe6mC,GAAa,KAAM,KAAK,cAAc,SAE1D,KAAK,iBAAmBjoC,EAAe,MAEvC,CAED,gBAAiB,CAEhB,OAAO,KAAK,YAEZ,CAED,QAAStb,EAAOi1B,EAAS,CAExB,KAAK,SAAS,MAAM,IAAK,EAAIj1B,EAAO,EAAIi1B,GAExCj1B,EAAQ,KAAK,IAAK,KAAK,MAAOA,EAAQ,KAAK,WAAW,CAAG,EAAE,CAAC,EAC5Di1B,EAAS,KAAK,IAAK,KAAK,MAAOA,EAAS,KAAK,WAAW,CAAG,EAAE,CAAC,EAE9D,KAAK,cAAc,QAASj1B,EAAOi1B,CAAM,CAEzC,CAED,aAAc3I,EAAQ,CAErB,KAAM,CAAE,SAAA+Y,CAAU,EAAG/Y,EAEfS,EAAc,KAAK,YACnBu3B,EAAMv3B,EAAY,MAExB,KAAK,cAAc,QAAQ,KAAOu3B,EAAI,KAEtC,MAAM7e,EAAsBJ,EAAS,kBAC/Bkf,EAAiBx3B,EAAY,MAEnCk5B,GAAS,SAAW,KAAK,UAEzB,KAAK,QAAS3B,EAAI,MAAM,MAAOA,EAAI,MAAM,QAIzCjf,EAAS,gBAAiB,KAAK,eAE/B4gB,GAAS,OAAQ5gB,GAIjBA,EAAS,gBAAiBI,GAC1B1Y,EAAY,MAAQw3B,CAEpB,CAED,MAAO5mC,EAAU,CAEhB,MAAMoP,EAAc,KAAK,YAEzB,GAAKA,EAAY,gBAAkB,GAElC,eAAQ,MAAO,wCAER5G,EAAI,EAMZ,MAAMiP,EAASrI,EAAY,QAAUF,GAAE,EAEjCiwB,EAAkBjwB,GAAQE,EAAY,MAAK,EAAG,QAAS,CAAE,MAAO,IAAMF,EAAI,eAAgB,EAAM,CAAA,EAEhGu5B,EAAW3jC,EAAO,IAAM,CAE7B,MAAM4oB,EAAU,KAAK,QACfgb,EAAc,KAAK,MAAOhb,EAAU,CAAC,EAErCib,EAAQvgC,EAAM,CAAG,EAAC,MAAK,EAE7B,OAAAyb,GAAM,CAAE,MAAO,CAAE6kB,EAAa,IAAKA,CAAa,EAAE,CAAE,CAAE,EAAArhD,KAAS,CAE9D,MAAMuhD,EAAW9hC,EAAOzf,GAAI,IAAK,EAAC,IAAKqhD,GAAc,WAE/Cx5B,EAAKlH,EAAMyP,EAAO,EAAE,IAAK,KAAK,SAAS,EAAE,IAAKpwB,CAAC,EAAG,IAAK,KAAK,SAAS,GAAMowB,EAAO,GAClF1P,EAAQo3B,EAAejwB,GACvB22B,EAAO1E,GAAWp5B,EAAO,KAAK,cAAe,IAAK6gC,GAExDD,EAAM,UAAW9C,EAErB,GAEU8C,EAAM,IAAK,KAAK,SAAS,CAEnC,GAIQhvB,EAAW,KAAK,YAAe,KAAK,UAAY3Z,EAAQ,mBAAkB,GAChF2Z,EAAS,aAAe8uB,IAIxB,MAAMjoC,EAAaR,EAAQ,kBAAmB,IAAI,EAClD,OAAAQ,EAAW,YAAc4O,EAIlB,KAAK,YAEZ,CAEF,CAEO,MAAMy5B,GAAa,CAAEzqC,EAAM+iC,EAAY,GAAIhK,EAAQ,EAAGzJ,EAAU,KAAQlpB,EAAY,IAAI+jC,GAAgB/jC,EAAYpG,GAAQoG,EAAY28B,CAAS,EAAI38B,EAAY2yB,CAAK,EAAIzJ,CAAO,GAExL3pB,EAAgB,aAAc8kC,EAAY,ECvI1C,MAAMC,WAA0BpnC,CAAS,CAExC,YAAa0N,EAAc,CAE1B,QAEA,KAAK,YAAcA,EAEnB,KAAK,iBAAmBzR,EAAe,OAEvC,KAAK,SAAWoR,EAAS,IAAIhQ,EAAS,CAEtC,CAED,cAAe,CAEd,MAAM4nC,EAAM,KAAK,YAAY,MAE7B,KAAK,SAAS,MAAM,IAAK,EAAIA,EAAI,MAAM,MAAO,EAAIA,EAAI,MAAM,MAAM,CAElE,CAED,OAAQ,CAEP,KAAM,CAAE,YAAAv3B,CAAa,EAAG,KAElBqI,EAASrI,EAAY,QAAUF,GAAE,EAEjCiwB,EAAkBjwB,GAAQ,KAAK,YAAY,MAAO,EAAC,QAAS,CAAE,MAAO,IAAMA,EAAI,eAAgB,EAAM,CAAA,EAwE3G,OAtEcpK,EAAO,IAAM,CAI1B,MAAMikC,EAAQ,KAAK,SAIbC,EAAKhgC,GAAM,GAAK,GAAK,GAAK,EAAG,EAAG,EAAG,EAAG,EAAG,CAAC,EAC1CigC,EAAKjgC,GAAM,GAAK,EAAG,EAAG,GAAK,EAAG,EAAG,GAAK,EAAG,CAAC,EAM1CkgC,EAAQ7I,GAAWlB,EAAe1nB,EAAO,IAAKsxB,EAAM,IAAK/gC,EAAM,GAAK,EAAK,CAAA,CAAI,CAAA,EAAG,KAChFmhC,EAAQ9I,GAAWlB,EAAe1nB,EAAO,IAAKsxB,EAAM,IAAK/gC,EAAM,GAAK,CAAC,CAAI,CAAA,CAAI,EAAC,GAAG,EACjFohC,EAAQ/I,GAAWlB,EAAe1nB,EAAO,IAAKsxB,EAAM,IAAK/gC,EAAM,GAAK,CAAC,CAAI,CAAA,CAAI,EAAC,GAAG,EAIjFqhC,EAAQhJ,GAAWlB,EAAe1nB,EAAO,IAAKsxB,EAAM,IAAK/gC,EAAM,EAAG,EAAG,CAAI,CAAA,CAAI,EAAC,GAAG,EACjFshC,EAAQjJ,GAAWlB,EAAe1nB,EAAO,IAAKsxB,EAAM,IAAK/gC,EAAM,EAAG,CAAC,CAAI,CAAA,CAAI,EAAC,GAAG,EAC/EuhC,EAAQlJ,GAAWlB,EAAe1nB,EAAO,IAAKsxB,EAAM,IAAK/gC,EAAM,EAAG,CAAC,CAAI,CAAA,CAAI,EAAC,GAAG,EAI/EwhC,EAAQnJ,GAAWlB,EAAe1nB,EAAO,IAAKsxB,EAAM,IAAK/gC,EAAM,EAAG,EAAG,CAAI,CAAA,CAAI,EAAC,GAAG,EACjFyhC,EAAQpJ,GAAWlB,EAAe1nB,EAAO,IAAKsxB,EAAM,IAAK/gC,EAAM,EAAG,CAAC,CAAI,CAAA,CAAI,EAAC,GAAG,EAC/E0hC,EAAQrJ,GAAWlB,EAAe1nB,EAAO,IAAKsxB,EAAM,IAAK/gC,EAAM,EAAG,CAAC,CAAI,CAAA,CAAI,EAAC,GAAG,EAI/E2hC,EAAUz5B,GACf84B,EAAI,CAAG,EAAE,CAAC,EAAG,IAAKE,CAAO,EACzBF,EAAI,CAAG,EAAE,CAAC,EAAG,IAAKK,CAAO,EACzBL,EAAI,CAAG,EAAE,CAAC,EAAG,IAAKQ,CAAO,EACzBR,EAAI,CAAG,EAAE,CAAC,EAAG,IAAKG,CAAO,EACzBH,EAAI,CAAG,EAAE,CAAC,EAAG,IAAKM,CAAO,EACzBN,EAAI,CAAG,EAAE,CAAC,EAAG,IAAKS,CAAO,EACzBT,EAAI,CAAG,EAAE,CAAC,EAAG,IAAKI,CAAO,EACzBJ,EAAI,CAAG,EAAE,CAAC,EAAG,IAAKO,CAAO,EACzBP,EAAI,CAAG,EAAE,CAAC,EAAG,IAAKU,CAAO,CAC7B,EAKSE,EAAU15B,GACf+4B,EAAI,CAAG,EAAE,CAAC,EAAG,IAAKC,CAAO,EACzBD,EAAI,CAAG,EAAE,CAAC,EAAG,IAAKI,CAAO,EACzBJ,EAAI,CAAG,EAAE,CAAC,EAAG,IAAKO,CAAO,EACzBP,EAAI,CAAG,EAAE,CAAC,EAAG,IAAKE,CAAO,EACzBF,EAAI,CAAG,EAAE,CAAC,EAAG,IAAKK,CAAO,EACzBL,EAAI,CAAG,EAAE,CAAC,EAAG,IAAKQ,CAAO,EACzBR,EAAI,CAAG,EAAE,CAAC,EAAG,IAAKG,CAAO,EACzBH,EAAI,CAAG,EAAE,CAAC,EAAG,IAAKM,CAAO,EACzBN,EAAI,CAAG,EAAE,CAAC,EAAG,IAAKS,CAAO,CAC7B,EAISG,EAAIF,EAAQ,IAAKA,CAAO,EAAG,IAAKC,EAAQ,IAAKA,EAAW,EAAC,KAAI,EAEnE,OAAOphC,EAAMJ,EAAMyhC,CAAG,EAAE,CAAC,CAE5B,IAME,CAEF,CAEO,MAAMC,GAAU1rC,GAAUoG,EAAY,IAAIskC,GAAmBtkC,EAAYpG,CAAM,CAAA,GAEtF2F,EAAgB,QAAS+lC,EAAO,EC9GhC,MAAMC,WAAyBroC,CAAS,CAEvC,YAAa0N,EAAa46B,EAAWC,EAAQ,EAAGC,EAAW,KAAOC,EAAU,EAAI,CAE/E,QAEA,KAAK,YAAc/6B,EACnB,KAAK,UAAY46B,EAEjB,KAAK,MAAQj7B,EAASk7B,GACtB,KAAK,SAAWl7B,EAASm7B,GACzB,KAAK,QAAUn7B,EAASo7B,GACxB,KAAK,QAAUp7B,EAAS,GAExB,KAAK,iBAAmBpR,EAAe,MAEvC,CAED,cAAe,CAEd,MAAMgpC,EAAM,KAAK,YAAY,MAE7B,KAAK,QAAQ,MAAQA,EAAI,MAAM,MAAQA,EAAI,MAAM,MAEjD,CAED,OAAQ,CAEP,KAAM,CAAE,YAAAv3B,CAAa,EAAG,KAElBqI,EAASrI,EAAY,QAAUF,GAAE,EAEjCiwB,EAAkBjwB,GAAQ,KAAK,YAAY,GAAIA,GAqErD,OAnEYpK,EAAO,IAAM,CAExB,MAAMslC,EAAgBpiC,EAAM,EAAK,KAAK,OAAO,EAEvC1C,EAAS,KAAK,MAAM,IAAK,KAAK,WAE9B+kC,EAAUriC,EAAMsN,GAAOhQ,EAAO,IAAK,KAAK,QAAU,EAAE,KAAK,QAAQ,OAAM,EAAI,KAAK,OAAS,CAAA,EAEzFglC,EAAWD,EAAQ,IAAK,EAAG,EAC3BE,EAAWF,EAAQ,IAAK,EAAG,EAC3BG,EAAWH,EAAQ,IAAK,EAAG,EAEjC,IAAII,EAAMjiC,EAAM,GAEhB,OAAAiiC,EAAMA,EAAI,IAAKtL,EAAe1nB,CAAQ,CAAA,EAEtCgzB,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,EAAK,EAAK,EAAC,IAAKoiC,CAAe,EAAC,IAAKC,CAAO,CAAI,CAAA,GAChGI,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,IAAM,GAAM,EAAC,IAAKoiC,CAAe,EAAC,IAAKC,CAAO,CAAI,CAAA,GAClGI,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,IAAM,GAAM,EAAC,IAAKoiC,CAAe,EAAC,IAAKC,CAAO,CAAI,CAAA,GAClGI,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,KAAQ,GAAM,EAAC,IAAKoiC,CAAe,EAAC,IAAKC,CAAO,CAAI,CAAA,GACpGI,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,GAAM,CAAK,EAAC,IAAKoiC,CAAe,EAAC,IAAKC,CAAO,CAAI,CAAA,GACjGI,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,IAAM,IAAQ,EAAC,IAAKoiC,CAAe,EAAC,IAAKC,CAAO,CAAI,CAAA,GACpGI,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,IAAM,IAAQ,EAAC,IAAKoiC,CAAe,EAAC,IAAKC,CAAO,CAAI,CAAA,GACpGI,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,KAAQ,IAAM,EAAG,IAAKoiC,CAAa,EAAG,IAAKC,CAAO,CAAI,CAAA,GACtGI,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,EAAK,GAAO,EAAC,IAAKoiC,CAAe,EAAC,IAAKC,CAAO,CAAI,CAAA,GAClGI,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,KAAQ,GAAM,EAAC,IAAKoiC,CAAe,EAAC,IAAKC,CAAO,CAAI,CAAA,GACpGI,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,KAAQ,GAAM,EAAC,IAAKoiC,CAAe,EAAC,IAAKC,CAAO,CAAI,CAAA,GACpGI,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,IAAM,GAAM,EAAC,IAAKoiC,CAAe,EAAC,IAAKC,CAAO,CAAI,CAAA,GAClGI,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,IAAO,CAAK,EAAC,IAAKoiC,CAAe,EAAC,IAAKC,CAAO,CAAI,CAAA,GAClGI,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,KAAQ,IAAM,EAAG,IAAKoiC,CAAa,EAAG,IAAKC,CAAO,CAAI,CAAA,GACtGI,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,KAAQ,IAAM,EAAG,IAAKoiC,CAAa,EAAG,IAAKC,CAAO,CAAI,CAAA,GACtGI,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,IAAM,IAAQ,EAAC,IAAKoiC,CAAe,EAAC,IAAKC,CAAO,CAAI,CAAA,GACpGI,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,IAAM,GAAM,EAAC,IAAKoiC,CAAe,EAAC,IAAKE,CAAQ,CAAI,CAAA,GACnGG,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,KAAQ,GAAM,EAAC,IAAKoiC,CAAe,EAAC,IAAKE,CAAQ,CAAI,CAAA,GACrGG,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,IAAM,IAAQ,EAAC,IAAKoiC,CAAe,EAAC,IAAKE,CAAQ,CAAI,CAAA,GACrGG,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,KAAQ,IAAM,EAAG,IAAKoiC,CAAa,EAAG,IAAKE,CAAQ,CAAI,CAAA,GACvGG,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,KAAQ,GAAM,EAAC,IAAKoiC,CAAe,EAAC,IAAKE,CAAQ,CAAI,CAAA,GACrGG,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,IAAM,GAAM,EAAC,IAAKoiC,CAAe,EAAC,IAAKE,CAAQ,CAAI,CAAA,GACnGG,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,KAAQ,IAAM,EAAG,IAAKoiC,CAAa,EAAG,IAAKE,CAAQ,CAAI,CAAA,GACvGG,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,IAAM,IAAQ,EAAC,IAAKoiC,CAAe,EAAC,IAAKE,CAAQ,CAAI,CAAA,GACrGG,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,IAAM,GAAM,EAAC,IAAKoiC,CAAe,EAAC,IAAKG,CAAQ,CAAI,CAAA,GACnGE,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,GAAM,CAAK,EAAC,IAAKoiC,CAAe,EAAC,IAAKG,CAAQ,CAAI,CAAA,GAClGE,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,IAAM,IAAQ,EAAC,IAAKoiC,CAAe,EAAC,IAAKG,CAAQ,CAAI,CAAA,GACrGE,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,EAAK,GAAO,EAAC,IAAKoiC,CAAe,EAAC,IAAKG,CAAQ,CAAI,CAAA,GACnGE,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,KAAQ,GAAM,EAAC,IAAKoiC,CAAe,EAAC,IAAKG,CAAQ,CAAI,CAAA,GACrGE,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,IAAO,CAAK,EAAC,IAAKoiC,CAAe,EAAC,IAAKG,CAAQ,CAAI,CAAA,GACnGE,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,KAAQ,IAAM,EAAG,IAAKoiC,CAAa,EAAG,IAAKG,CAAQ,CAAI,CAAA,GACvGE,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,EAAK,EAAK,EAAC,IAAKoiC,CAAe,EAAC,IAAKG,CAAQ,CAAI,CAAA,GACjGE,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,IAAM,GAAM,EAAC,IAAKoiC,CAAe,EAAC,IAAKI,CAAQ,CAAI,CAAA,GACnGC,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,GAAK,CAAK,EAAC,IAAKoiC,CAAe,EAAC,IAAKI,CAAQ,CAAI,CAAA,GACjGC,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,IAAM,IAAQ,EAAC,IAAKoiC,CAAe,EAAC,IAAKI,CAAQ,CAAI,CAAA,GACrGC,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,EAAK,GAAO,EAAC,IAAKoiC,CAAe,EAAC,IAAKI,CAAQ,CAAI,CAAA,GACnGC,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,KAAQ,GAAM,EAAC,IAAKoiC,CAAe,EAAC,IAAKI,CAAQ,CAAI,CAAA,GACrGC,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,IAAO,CAAK,EAAC,IAAKoiC,CAAe,EAAC,IAAKI,CAAQ,CAAI,CAAA,GACnGC,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,KAAQ,IAAM,EAAG,IAAKoiC,CAAa,EAAG,IAAKI,CAAQ,CAAI,CAAA,GACvGC,EAAMA,EAAI,IAAKtL,EAAe1nB,EAAO,IAAKzP,EAAM,EAAK,EAAK,EAAC,IAAKoiC,CAAe,EAAC,IAAKI,CAAQ,CAAI,CAAA,GAEjGC,EAAMA,EAAI,IAAK,IACfA,EAAI,EAAI,EAEDjiC,EAAMiiC,EAGhB,IAME,CAEF,CAEO,MAAMC,GAAM,CAAEtsC,EAAM4rC,EAAWC,EAAOU,EAASR,IAAa3lC,EAAY,IAAIulC,GAAkBvlC,EAAYpG,CAAI,EAAIoG,EAAYwlC,CAAS,EAAIC,EAAOU,EAASR,CAAO,GAEzKpmC,EAAgB,MAAO2mC,EAAK,ECzG5B,MAAMpC,GAAW,IAAIjC,GAErB,MAAMuE,WAAsBlpC,CAAS,CAEpC,YAAa8Z,EAAWqvB,EAAS,IAAI9rC,GAAS,GAAK,EAAG,EAAI+rC,EAAQ,KAAM3T,EAAQ,EAAI,CAEnF,MAAO,MAAM,EAEb,KAAK,UAAY3b,EACjB,KAAK,OAASzM,EAAS87B,GACvB,KAAK,MAAQ97B,EAAS+7B,GACtB,KAAK,MAAQ/7B,EAASooB,GAEtB,KAAK,cAAgB,IAAIyD,GACzB,KAAK,cAAc,QAAQ,KAAO,YAElC,KAAK,MAAQ7rB,EAAS,IAAIhQ,EAAS,EAEnC,KAAK,aAAe6mC,GAAa,KAAM,KAAK,cAAc,SAE1D,KAAK,iBAAmBjoC,EAAe,MAEvC,CAED,gBAAiB,CAEhB,OAAO,KAAK,YAEZ,CAED,QAAStb,EAAOi1B,EAAS,CAExB,KAAK,MAAM,MAAM,IAAKj1B,EAAOi1B,CAAM,EACnC,KAAK,cAAc,QAASj1B,EAAOi1B,CAAM,CAEzC,CAED,aAAc3I,EAAQ,CAErB,KAAM,CAAE,SAAA+Y,CAAU,EAAG/Y,EAEf6M,EAAY,KAAK,UACjBmrB,EAAMnrB,EAAU,MAEtB,KAAK,cAAc,QAAQ,KAAOmrB,EAAI,KAEtC,MAAM7e,EAAsBJ,EAAS,kBAC/Bkf,EAAiBprB,EAAU,MAEjC8sB,GAAS,SAAW,KAAK,UAEzB,KAAK,QAAS3B,EAAI,MAAM,MAAOA,EAAI,MAAM,QAIzCjf,EAAS,gBAAiB,KAAK,eAE/B4gB,GAAS,OAAQ5gB,GAIjBA,EAAS,gBAAiBI,GAC1BtM,EAAU,MAAQorB,CAElB,CAED,MAAO5mC,EAAU,CAEhB,MAAMwb,EAAY,KAAK,UAEjBuvB,EAAUjmC,EAAO,IAAM,CAE5B,MAAMle,EAAIysB,GAAK,KAAK,KAAK,EACnB,EAAIC,GAAK,KAAK,KAAK,EAEnB03B,EAAM97B,GAAI,EAAC,IAAK,KAAK,KAAK,EAAG,IAAK,KAAK,QACvC+7B,EAAQjjC,EAAM,EAAE,IAAKgjC,EAAI,GAAI,IAAKpkD,EAAE,IAAKokD,EAAI,CAAG,CAAA,EAAIpkD,EAAE,IAAKokD,EAAI,CAAC,EAAG,IAAK,EAAE,IAAKA,EAAI,CAAG,CAAA,CAAI,EAAC,IAAK,KAAK,KAAK,EAEhH,OAAO33B,GAAK43B,EAAM,CAAC,EAAG,IAAK53B,GAAK43B,EAAM,CAAG,CAAA,EAAG,IAAK,CAAC,CAErD,GAEQC,EAAYpmC,EAAO,IAAM,CAE9B,MAAMiD,EAAQyT,EAER+kB,EAAUrwB,GAAKnI,EAAM,EAAGA,EAAM,EAAGA,EAAM,CAAC,EAAG,IAAK,CAAC,EAEvD,OAAOS,EAAMJ,EAAMm4B,EAAQ,IAAK,EAAI,EAAC,IAAK,CAAC,EAAG,IAAKwK,EAAS,CAAA,CAAI,EAAEhjC,EAAM,CAAC,CAE5E,GAIQ4R,EAAW,KAAK,YAAe,KAAK,UAAY3Z,EAAQ,mBAAkB,GAChF2Z,EAAS,aAAeuxB,IAIxB,MAAM1qC,EAAaR,EAAQ,kBAAmB,IAAI,EAClD,OAAAQ,EAAW,YAAcgb,EAIlB,KAAK,YAEZ,CAEF,CAEO,MAAM0vB,GAAY,CAAE9sC,EAAMysC,EAAQC,EAAO3T,IAAW3yB,EAAY,IAAIomC,GAAepmC,EAAYpG,CAAI,EAAIysC,EAAQC,EAAO3T,CAAO,CAAA,EAEpIpzB,EAAgB,YAAamnC,EAAW,ECpHxC,MAAMC,WAAqBzpC,CAAS,CAEnC,YAAa0N,EAAag8B,EAAS,KAAON,EAAQ,EAAI,CAErD,MAAO,MAAM,EAEb,KAAK,YAAc17B,EACnB,KAAK,OAASL,EAASq8B,GACvB,KAAK,MAAQr8B,EAAS+7B,GAEtB,KAAK,iBAAmBntC,EAAe,MAEvC,CAED,cAAe,CAEd,CAED,OAAQ,CAEP,KAAM,CAAE,YAAAyR,CAAa,EAAG,KAElBqI,EAASrI,EAAY,QAAUF,GAAE,EAEjCiwB,EAAkBjwB,GAAQ,KAAK,YAAY,GAAIA,GAarD,OAXiBpK,EAAO,IAAM,CAE7B,MAAM5M,EAAS8P,EAAMsL,GAAK,KAAK,KAAK,EAAID,GAAK,KAAK,KAAK,CAAI,EAAC,IAAK,KAAK,MAAM,EACtEg4B,EAAKlM,EAAe1nB,EAAO,IAAKvf,CAAQ,CAAA,EACxCozC,EAAMnM,EAAe1nB,GACrB8zB,EAAKpM,EAAe1nB,EAAO,IAAKvf,CAAQ,CAAA,EAE9C,OAAOsQ,EAAM6iC,EAAG,EAAGC,EAAI,EAAGC,EAAG,EAAGD,EAAI,EAEvC,GAEiB,CAEf,CAEF,CAEO,MAAME,GAAW,CAAEptC,EAAMgtC,EAAQN,IAAWtmC,EAAY,IAAI2mC,GAAc3mC,EAAYpG,CAAM,EAAEgtC,EAAQN,CAAO,CAAA,EAEpH/mC,EAAgB,WAAYynC,EAAU,EChDtC,MAAMC,WAAyB/pC,CAAS,CAEvC,YAAaoE,EAAe,KAAM4lC,EAAa,CAAA,EAAK,CAEnD,QAEA,KAAK,aAAe5lC,EACpB,KAAK,WAAa4lC,CAElB,CAED,cAAeA,EAAa,CAE3B,YAAK,WAAaA,EAEX,IAEP,CAED,eAAgB,CAEf,OAAO,KAAK,UAEZ,CAED,YAAa1rC,EAAU,CAEtB,OAAO,KAAK,aAAa,YAAaA,CAAO,CAE7C,CAED,SAAUA,EAAU,CAEnB,MAAMpB,EAAS,CAAA,EAETkH,EAAe,KAAK,aAEpB1B,EAAS0B,EAAa,UAAW9F,CAAO,EACxC0rC,EAAa,KAAK,WAExB,GAAK,MAAM,QAASA,GAEnB,QAAUrkD,EAAI,EAAGA,EAAIqkD,EAAW,OAAQrkD,IAAO,CAE9C,MAAMskD,EAAYvnC,EAAQ/c,GACpB+W,EAAOstC,EAAYrkD,GAEzBuX,EAAO,KAAMR,EAAK,MAAO4B,EAAS2rC,EAAU,IAAI,EAEhD,KAID,WAAYA,KAAavnC,EAAS,CAEjC,MAAMhG,EAAOstC,EAAYC,EAAU,IAAI,EAEvC,GAAKvtC,IAAS,OAEbQ,EAAO,KAAMR,EAAK,MAAO4B,EAAS2rC,EAAU,IAAI,OAIhD,OAAM,IAAI,MAAO,4BAA4BA,EAAU,IAAI,+BAI5D,CAMF,MAAO,GAFc7lC,EAAa,MAAO9F,EAAS,UAAU,CAEtC,KAAKpB,EAAO,KAAM,IAAI,CAAE,IAE9C,CAEF,CAIO,MAAMgtC,GAAO,CAAEC,KAASjtC,KAE9BA,EAASA,EAAO,OAAS,GAAOA,EAAQ,CAAC,GAAMA,EAAQ,CAAC,EAAG,SAAW,GAAS6G,GAAW7G,CAAM,EAAKyF,GAAazF,EAAQ,CAAC,GAEpH4F,EAAY,IAAIinC,GAAkBjnC,EAAYqnC,CAAM,EAAEjtC,CAAM,IAIpEmF,EAAgB,OAAQ6nC,IAExBpqC,EAAc,mBAAoBiqC,EAAkB,EC1FpD,MAAMK,WAA4BnsC,CAAK,CAEtC,YAAaxb,EAAQ,KAAO,CAE3B,QAEA,KAAK,OAASA,EACd,KAAK,OAAS,KAEd,KAAK,UAAY,KACjB,KAAK,UAAY,KAEjB,KAAK,OAAS,IAAIyb,GAElB,KAAK,sBAAwB,EAE7B,CAED,IAAI,wBAAyB,CAE5B,OAAO,KAAK,aAAe,IAE3B,CAED,IAAI,MAAOle,EAAM,CAEX,KAAK,SAAWA,IAEhB,KAAK,QAAU,KAAK,YAAc,OAAS,KAAK,MAAM,iBAAiB,cAE3E,IAAI,gBAAiB,KAAK,QAE1B,KAAK,OAAS,MAIf,KAAK,OAASA,EAEd,KAAK,OAAO,cAAe,CAAE,KAAM,QAAU,CAAA,EAE7C,KAAK,QAAO,EAEZ,CAED,IAAI,OAAQ,CAEX,OAAO,KAAK,MAEZ,CAED,SAAU,CAET,KAAK,OAAO,cAAe,CAAE,KAAM,SAAW,CAAA,CAE9C,CAED,UAAW,CAEV,MAAMyC,EAAQ,KAAK,MAEnB,GAAKA,GAAS,KAAK,SAAW,MAAQ,KAAK,YAAc,OAASA,EAAM,iBAAiB,YAExF,KAAK,OAAS,IAAI,gBAAiB,IAAI,KAAM,CAAEA,EAAM,KAAO,CAAA,WAEjDA,GAASA,EAAM,QAAU,MAAQA,EAAM,QAAU,UACxD,KAAK,YAAc,OAAS,KAAK,YAAc,WAAc,OAAOA,EAAM,OAAU,UACtF,KAAK,YAAc,UAAY,OAAOA,EAAM,OAAU,UACtD,KAAK,YAAc,WAAaA,EAAM,MAAM,WAC5C,KAAK,YAAc,WAAaA,EAAM,MAAM,WAC5C,KAAK,YAAc,WAAaA,EAAM,MAAM,WAC5C,KAAK,YAAc,SAAWA,EAAM,MAAM,SAC1C,KAAK,YAAc,WAAaA,EAAM,MAAM,WAC5C,KAAK,YAAc,WAAaA,EAAM,MAAM,WAG9C,OAAOA,EAAM,MAId,OAAO,KAAK,QAAUA,CAEtB,CAED,YAAa6b,EAAU,CAEtB,OAAO,KAAK,OAAS,KAAK,MAAM,OAAS,KAAK,MAAM,YAAaA,CAAO,EAAK,OAE7E,CAED,OAAQ,CAEP,OAAO,KAAK,OAAS,KAAK,MAAM,OAAS,KAAK,MAAQ8G,GAEtD,CAED,UAAW3F,EAAO,CAEjB,MAAM,UAAWA,GAEZ,KAAK,QAAU,KAEd,KAAK,YAAc,cAEvBA,EAAK,MAAQ9B,GAAqB,KAAK,KAAK,EAI5C8B,EAAK,MAAQ,KAAK,MAAQ,KAAK,MAAM,OAAQA,EAAK,MAAO,KAAO,KAMjEA,EAAK,MAAQ,KAIdA,EAAK,UAAY,KAAK,UACtBA,EAAK,WAAa,KAAK,UAEvB,CAED,YAAaA,EAAO,CAEnB,MAAM,YAAaA,GAEnB,IAAIhd,EAAQ,KAEPgd,EAAK,QAAU,OAEdA,EAAK,YAAc,cAEvBhd,EAAQib,GAAqB+B,EAAK,OAEvBA,EAAK,YAAc,UAE9Bhd,EAAQgd,EAAK,KAAK,SAAUA,EAAK,KAAK,EAItChd,EAAQgd,EAAK,KAAK,MAAOA,EAAK,KAAO,GAAI,MAM3C,KAAK,MAAQhd,EAEb,KAAK,UAAYgd,EAAK,UACtB,KAAK,WAAaA,EAAK,UAEvB,CAEF,CAIO,MAAM4qC,GAAkBxkC,EAAWukC,IAE1C/nC,EAAgB,kBAAmBgoC,IAEnCvqC,EAAc,sBAAuBsqC,EAAqB,EClK1D,MAAME,WAAkB,GAAI,CAE3B,IAAK7oD,EAAKwK,EAAW,QAASiR,EAAS,CAEtC,GAAK,KAAK,IAAKzb,CAAG,EAAK,OAAO,MAAM,IAAKA,GAEzC,GAAKwK,IAAa,KAAO,CAExB,MAAMxJ,EAAQwJ,EAAU,GAAGiR,GAC3B,YAAK,IAAKzb,EAAKgB,GACRA,CAEP,CAED,CAEF,CAEA,MAAM8nD,EAAW,CAEhB,YAAaC,EAAiB,CAE7B,KAAK,eAAiBA,CAEtB,CAED,IAAI,YAAa,CAEhB,OAAO,KAAK,eAAe,UAE3B,CAED,IAAI,QAAS,CAEZ,OAAO,KAAK,eAAe,WAE3B,CAED,eAAgBz/C,EAAK,CAEpB,OAAO,KAAK,eAAe,eAAgBA,CAAE,CAE7C,CAED,IAAKoC,EAAO,CAEX,MAAMwO,EAAQ,KAAK,WAAYxO,CAAI,EAGnC,OAFcwO,EAAQA,EAAM,SAAQ,EAAK,IAIzC,CAEF,CAEO,MAAM8uC,GAAS,IAAIH,GAE1B,MAAMI,WAAuBzsC,CAAK,CAEjC,YAAa0sC,EAAW,KAAMX,EAAa,CAAA,EAAK,CAE/C,QAEA,KAAK,SAAWW,EAChB,KAAK,WAAaX,EAElB,KAAK,OAAS,IAAIM,GAClB,KAAK,QAAUD,KACf,KAAK,SAAW,GAChB,KAAK,QAAU,KAAK,OACpB,KAAK,QAAU,KACf,KAAK,QAAU,KACf,KAAK,OAAS,KACd,KAAK,mBAAqB,GAE1B,KAAK,UAAY,KAAK,UAAU,KAAM,IAAI,EAE1C,KAAK,iBAAmB,EAExB,CAED,IAAI,QAAS,CAEZ,OAAO,KAAK,SAAW,KAAK,SAAS,KAAO,EAE5C,CAED,SAAUl9C,EAAM1K,EAAQ,CAEvB,OAAO,KAAK,OAAO,IAAK0K,EAAM1K,CAAK,CAEnC,CAED,SAAU0K,EAAO,CAEhB,OAAO,KAAK,OAAO,IAAKA,CAAI,CAE5B,CAED,WAAY,CAEX,KAAK,SAAQ,CAEb,CAED,eAAgBpC,EAAK,CAEpB,UAAY+c,KAAW,KAAK,YAE3B,GAAKA,EAAQ,YAAeA,EAAQ,KAAO/c,GAAM+c,EAAQ,OAAS/c,GAEjE,OAAO+c,CAMT,CAED,gBAAiB/c,EAAK,CAErB,UAAY+c,KAAW,KAAK,YAE3B,GAAKA,EAAQ,aAAgBA,EAAQ,KAAO/c,GAAM+c,EAAQ,OAAS/c,GAElE,OAAO+c,CAMT,CAED,UAAW3a,EAAM1K,EAAQ,CAExB,MAAMmoD,EAAU,KAAK,SAErB,OAAKA,EAASz9C,CAAM,IAAK,OAExBy9C,EAASz9C,CAAI,EAAKk9C,GAAiB5nD,CAAK,EAIxCmoD,EAASz9C,CAAI,EAAG,MAAQ1K,EAIlB,IAEP,CAED,UAAW0K,EAAO,CAEjB,OAAO,KAAK,SAAUA,EAEtB,CAED,aAAcA,EAAO,CAEpB,OAAO,KAAK,WAAYA,EAExB,CAED,aAAcA,EAAM1K,EAAQ,CAE3B,MAAMunD,EAAa,KAAK,WAExB,OAAKvnD,GAASA,EAAM,kBAEnB,KAAK,gBAAiB0K,GAEtB68C,EAAY78C,CAAM,EAAG1K,EACrBunD,EAAY78C,GAAO,mBAAmB,OAAO,iBAAkB,UAAW,KAAK,YAEpE1K,GAASA,EAAM,uBAE1B,KAAK,gBAAiB0K,GAEtB68C,EAAY78C,CAAM,EAAG1K,EACrBunD,EAAY78C,CAAI,EAAG,OAAO,iBAAkB,UAAW,KAAK,YAEjD68C,EAAY78C,CAAM,IAAK,QAElC68C,EAAY78C,CAAI,EAAKk9C,GAAiB5nD,CAAK,EAC3CunD,EAAY78C,CAAI,EAAG,OAAO,iBAAkB,UAAW,KAAK,YAI5D68C,EAAY78C,CAAI,EAAG,MAAQ1K,EAIrB,IAEP,CAED,UAAW,CAEV,OAAO,KAAK,mBAAmB,UAE/B,CAED,gBAAiB0K,EAAO,CAEvB,IAAIwiC,EAAY,KAAK,WAAYxiC,CAAI,EAErC,OAAKwiC,IAECA,EAAU,mBAAmBA,EAAYA,EAAU,iBAAgB,GAExEA,EAAU,OAAO,oBAAqB,UAAW,KAAK,SAAS,GAIzD,IAEP,CAED,iBAAkB,CAEjB,UAAYxiC,KAAQ,OAAO,KAAM,KAAK,UAAU,EAE/C,KAAK,gBAAiBA,GAIvB,YAAK,YAAc,GAEZ,IAEP,CAED,KAAMA,KAAS+P,EAAS,CAGvB,MAAMhT,EADS,KAAK,YACGiD,GAEvB,GAAK,OAAOjD,GAAW,WAEtB,OAAOA,EAAQ,GAAGgT,EAInB,CAED,MAAM,UAAW/P,KAAS+P,EAAS,CAGlC,MAAMhT,EADS,KAAK,YACGiD,GAEvB,GAAK,OAAOjD,GAAW,WAEtB,OAAOA,EAAO,YAAY,OAAS,gBAAkB,MAAMA,EAAQ,GAAGgT,CAAQ,EAAGhT,EAAQ,GAAGgT,CAAM,CAInG,CAED,YAAaoB,EAAU,CAEtB,OAAO,KAAK,qBAAoB,EAAG,YAAaA,CAAO,CAEvD,CAED,QAASld,EAAS,KAAO,CAEnBA,IAAW,KAEf,KAAK,UAAWA,CAAQ,EAAC,QAAO,EAIhC,KAAK,SAAQ,CAId,CAED,WAAY,CAGX,GADK,KAAK,aAAc,KAAK,QAAO,EAC/B,KAAK,UAAY,KAAO,OAAO,KAAK,QAIzC,MAAMypD,EAAU,IAAM,KAAK,UACrBC,EAAY,CAAE//C,EAAItI,IAAW,KAAK,UAAWsI,EAAItI,GAEjDunD,EAAa,IAAIO,GAAY,MAE7BQ,EAAQN,GAAO,IAAK,OAAO,EAC3BO,EAAMP,GAAO,IAAK,KAAK,EAEvBvgD,EAAS,KAAK,UAAW,KAAK,QAAQ,EACtCgT,EAAS,CAAE8sC,EAAY,KAAK,OAAQS,GAAQI,EAASC,EAAWC,EAAOC,GAE7E,KAAK,QAAU9gD,EAAQ,GAAGgT,CAAM,EAEhC,MAAMqH,EAAS,KAAK,QAAQ,OAE5B,GAAKA,IAECA,EAAO,QAAU,IAErB,KAAK,OAAO,QAKb,KAAK,QAAQ,WAAaA,EAAO,YAAc,KAE1C,MAAM,QAASA,EAAO,QAAQ,GAElC,UAAYuD,KAAWvD,EAAO,SAAW,CAExC,MAAMxZ,EAAK+c,EAAQ,IAAMA,EAAQ,KAE5BA,EAAQ,YAEP,KAAK,aAAc/c,KAAS,QAAY,KAAK,aAAcA,EAAI,MAEpE,KAAK,aAAcA,CAAE,EAAG,UAAY+c,EAAQ,WAIxCA,EAAQ,aAEP,KAAK,UAAW/c,KAAS,QAAY,KAAK,UAAWA,EAAI,MAE9D,KAAK,UAAWA,CAAE,EAAG,WAAa+c,EAAQ,WAI3C,CAMH,OAAO,KAAK,OAEZ,CAED,YAAarI,EAAO,CAEnB,MAAM,YAAaA,GAEnB,UAAYtS,KAAQ,KAAK,WAAa,CAErC,IAAIwiC,EAAY,KAAK,WAAYxiC,CAAI,EAEhCwiC,EAAU,mBAAmBA,EAAYA,EAAU,iBAAgB,GAExEA,EAAU,OAAO,iBAAkB,UAAW,KAAK,SAAS,CAE5D,CAED,CAED,WAAY,CAEX,OAAO,KAAK,UAAW,EAAC,MAExB,CAED,sBAAuB,CAEtB,MAAMvuC,EAAS,KAAK,iBAAgB,EAAG,MAEvC,OAAKA,GAAUA,EAAO,OAEdA,EAIDgkB,EAAK,CAEZ,CAED,kBAAmB,CAElB,OAAO,KAAK,MAAO,EAAC,OAEpB,CAED,WAAY,CAGX,GADK,KAAK,aAAc,KAAK,QAAO,EAC/B,KAAK,UAAY,KAAO,OAAO,KAAK,QAIzC,MAAM6lC,EAAkB,CAAE,aAAc,QAAS,SAAU,UAAW,YAAa,QAAS,OAGtFnsC,EAFiB,CAAE,SAAU,OAAQ,OAAQ,SAAS,EAE1B,KAAM,IAAI,EACtCosC,EAAe,OAASpsC,EAAa;AAAA,EACrCujB,EAAU;AAAA,sBAA2BvjB,EAAa,MAElDkN,EAAOk/B,EAAe,KAAK,SAAS,KAAO7oB,EAIjD,YAAK,QAAU,IAAI,SAAU,GAAG4oB,EAAiBj/B,CAAI,EAE9C,KAAK,OAEZ,CAED,SAAU,CAEJ,KAAK,UAAY,OAEjB,KAAK,SAAW,OAAO,KAAK,QAAQ,SAAY,YAEpD,KAAK,QAAQ,UAId,KAAK,QAAU,KACf,KAAK,QAAU,KACf,KAAK,QAAU,KACf,KAAK,OAAS,KACd,KAAK,mBAAqB,GAC1B,KAAK,QAAQ,MAAQ,KACrB,KAAK,SAAW,GAEhB,CAED,OAAQ,CAEP,OAAO,KAAK,sBAEZ,CAED,IAAI,YAAavpB,EAAQ,CAEnBA,IAAU,IAAO,KAAK,QAAO,CAElC,CAED,IAAI,aAAc,CAEjB,OAAO,KAAK,SAAW,KAAK,OAE5B,CAED,OAAQ,CAEP,OAAK,KAAK,WAAa,KAAc,MAEhC,KAAK,qBAAuB,KAEhC,KAAK,OAAS,KAAK,KAAM,MAAM,EAE/B,KAAK,mBAAqB,IAI3B,KAAK,QAAQ,MAAQ,KAAK,OAEnB,KAEP,CAED,UAAW,CAEV,KAAK,YAAc,GAEnB,KAAK,MAAK,EAEV,KAAK,QAAQ,SAEb,CAEF,CAIO,MAAM0oD,GAAatlC,EAAW6kC,IAErCroC,EAAgB,aAAc8oC,IAE9BrrC,EAAc,iBAAkB4qC,EAAgB,ECnehD,MAAMU,WAAgBntC,CAAK,CAE1B,YAAa6b,EAAWuxB,EAAa,CAEpC,MAAO,OAAO,EAEd,KAAK,UAAY,GAEjB,KAAK,UAAYvxB,EACjB,KAAK,WAAauxB,CAElB,CAED,aAAc/sC,EAAU,CAEvB,IAAIyxB,EAEJ,MAAMub,EAAWhtC,EAAQ,QAAQ,SAEjC,OAAKgtC,IAAa,SAEjBvb,EAAQub,EAAU,QAIVvb,GAASzS,GAAa,GAAI,OAAM,CAEzC,CAED,OAAQ,CAEP,OAAO,KAAK,UAEZ,CAEF,CAIO,MAAMiuB,GAAM1lC,EAAWulC,IAE9B/oC,EAAgB,MAAOkpC,IAEvBzrC,EAAc,UAAWsrC,EAAS,EC1ClC,MAAMI,WAAqBJ,EAAQ,CAElC,YAAatxB,EAAW2xB,EAAUC,EAAU,CAE3C,MAAO5xB,CAAS,EAEhB,KAAK,eAAiB,GAEtB,KAAK,SAAW2xB,EAChB,KAAK,QAAUC,CAEf,CAED,MAAOptC,EAAU,CAEhB,MAAMyxB,EAAQ,KAAK,aAAczxB,CAAO,EAExC,OAAO2V,GAAY,KAAK,SAAU,KAAK,QAAS8b,EAEhD,CAEF,CAIO,MAAM4b,GAAW9lC,EAAW2lC,IAEnCnpC,EAAgB,WAAYspC,IAE5B7rC,EAAc,eAAgB0rC,EAAc,EC9B5C,MAAMI,WAAoBR,EAAQ,CAEjC,YAAatxB,EAAW+xB,EAAc,CAErC,MAAO/xB,CAAS,EAEhB,KAAK,cAAgB,GAErB,KAAK,YAAc+xB,CAEnB,CAED,MAAOvtC,EAAU,CAEhB,MAAMyxB,EAAQ,KAAK,aAAczxB,CAAO,EAClCwtC,EAAU,KAAK,YAErB,OAAOA,EAAQ,IAAKA,EAAS/b,EAAOA,GAAQ,SAAS,MAAM,UAE3D,CAEF,CAIO,MAAMgc,GAAalmC,EAAW+lC,IAErCvpC,EAAgB,aAAc0pC,IAE9BjsC,EAAc,cAAe8rC,EAAa,ECxB1C,IAAIh5B,GAAM,KACNC,GAAM,KAEV,MAAMm5B,WAAkB/tC,CAAK,CAE5B,YAAaguC,EAAU7mC,EAAO,EAAE8mC,EAAU9mC,EAAK,EAAK,CAEnD,QAEA,KAAK,QAAU6mC,EACf,KAAK,QAAUC,CAEf,CAED,gBAAiB5tC,EAAU,CAE1B,MAAM6tC,EAAY7tC,EAAQ,cAAexB,GAAc,KAAK,QAAQ,KAAK,GACnEsvC,EAAY9tC,EAAQ,cAAexB,GAAc,KAAK,QAAQ,KAAK,GAEzE,OAAOqvC,EAAYC,EAAYD,EAAYC,CAE3C,CAED,YAAa9tC,EAAU,CAEtB,OAAOA,EAAQ,OAAO,MAAQ,EAAIA,EAAQ,kBAAmB,KAAK,gBAAiBA,CAAS,CAAA,EAAK,OAEjG,CAED,MAAOA,EAAU,CAEhB,MAAMlC,EAASkC,EAAQ,OAEvB,IAAIld,EAAS,KAEb,GAAKgb,EAAO,MAAQ,EAAI,CAEvB,MAAMiwC,EAAW,KAAK,QAAQ,MACxBC,EAAW,KAAK,QAAQ,MAExBH,EAAY7tC,EAAQ,cAAexB,GAAcuvC,CAAU,CAAA,EAC3DD,EAAY9tC,EAAQ,cAAexB,GAAcwvC,CAAU,CAAA,EAEjE15B,GAAMA,IAAO,IAAIrV,GACjBsV,GAAMA,IAAO,IAAItV,GAEjBqV,GAAI,UAAW,GACfC,GAAI,UAAW,GAEVs5B,IAAc,EAAIv5B,GAAI,UAAWy5B,CAAQ,EACpCA,EAAS,QAAUz5B,GAAI,IAAKy5B,EAAS,EAAGA,EAAS,EAAGA,EAAS,CAAC,EACnEz5B,GAAI,IAAKy5B,EAAS,EAAGA,EAAS,EAAGA,EAAS,GAAK,EAAGA,EAAS,GAAK,CAAC,EAEjED,IAAc,EAAIv5B,GAAI,UAAWy5B,CAAQ,EACpCA,EAAS,QAAUz5B,GAAI,IAAKy5B,EAAS,EAAGA,EAAS,EAAGA,EAAS,CAAC,EACnEz5B,GAAI,IAAKy5B,EAAS,EAAGA,EAAS,EAAGA,EAAS,GAAK,EAAGA,EAAS,GAAK,CAAC,EAEtE,MAAMpuB,EAAS,EAETnc,EAASmc,EAAS9hB,EAAO,MACzBtW,EAAQ,IAAI,aAAcic,GAEhC,QAAUpc,EAAI,EAAGA,EAAIoc,EAAQpc,IAAO,CAEnC,MAAM8Y,EAAQ9Y,EAAIu4B,EAEZquB,EAAkB35B,GAAI,aAAcnU,CAAK,EACzC+tC,EAAkB35B,GAAI,aAAcpU,CAAK,EAE/C3Y,EAAOH,GAAMyY,GAAU,KAAMmuC,EAAiBC,EAAiB,KAAK,OAAM,EAE1E,CAED,MAAMruC,EAAW,KAAK,YAAaG,CAAO,EAE1C,GAAKlC,EAAO,OAAS,KAEpBhb,EAAS61B,GAAQnxB,EAAO,OAAQsW,EAAO,OAAQ,QAAS0N,EAAa,EAAG,QAAS3L,CAAQ,MAEnF,CAGN,MAAMigB,EAAkB,IAAIe,GAA0Br5B,EAAO,CAAC,EAC9DwY,EAAQ,SAAS,aAAc,UAAY,KAAK,GAAI8f,GAEpDh9B,EAASo9B,GAA0BJ,CAAiB,EAAC,QAASjgB,CAAQ,CAEtE,CAEJ,MAEG/c,EAASgkB,EAAO,GAIjB,OAAOhkB,CAEP,CAEF,CAIqBykB,EAAWmmC,EAAY,EAE5ClsC,EAAc,YAAaksC,EAAW,EC9GtC,MAAMS,WAAoBxuC,CAAK,CAE9B,YAAayuC,EAAa90C,EAAO+0C,EAAgB,CAAE,EAAE,EAAK,CAEzD,MAAO,MAAM,EAEb,KAAK,cAAgB,GAErB,KAAK,YAAcD,EAEnB,KAAK,MAAQ90C,EACb,KAAK,cAAgB+0C,EACrB,KAAK,cAAgB,EAErB,KAAK,QAAU,EACf,KAAK,iBAAmB1wC,EAAe,OAEvC,KAAK,oBAAmB,CAExB,CAED,SAAU,CAET,KAAK,cAAe,CAAE,KAAM,SAAW,CAAA,CAEvC,CAED,IAAI,YAAaxZ,EAAQ,CAEnBA,IAAU,IAAO,KAAK,SAE3B,CAED,qBAAsB,CAErB,KAAM,CAAE,MAAAmV,EAAO,cAAA+0C,CAAe,EAAG,KAEjC,IAAI9sD,EAAO8sD,EAAe,GAE1B,QAAUhnD,EAAI,EAAGA,EAAIgnD,EAAc,OAAQhnD,IAC1C9F,GAAQ8sD,EAAehnD,GAExB,KAAK,cAAgB,KAAK,KAAMiS,EAAQ/X,CAAI,CAE5C,CAED,QAAS,CAAG,CAEZ,aAAc,CAAE,SAAAmmC,GAAa,CAE5BA,EAAS,QAAS,KAElB,CAED,SAAU1nB,EAAU,CAEnB,KAAM,CAAE,YAAAsuC,CAAa,EAAGtuC,EAExB,GAAKsuC,IAAgB,UAAY,CAEhC,MAAM3sC,EAAU,KAAK,YAAY,MAAO3B,EAAS,QAE5C2B,IAAY,IAEhB3B,EAAQ,gBAAiB2B,EAI1B,CAED,CAEF,CAIO,MAAM4sC,GAAU,CAAEnwC,EAAM9E,EAAO+0C,IAAmB7pC,EAAY,IAAI2pC,GAAa3pC,EAAYpG,CAAM,EAAE9E,EAAO+0C,CAAe,CAAA,EAEhItqC,EAAgB,UAAWwqC,IAE3B/sC,EAAc,cAAe2sC,EAAa,EC/E1C,MAAMK,WAAkB7uC,CAAK,CAE5B,YAAa0F,EAAQmpC,GAAU,iBAAkB/nB,EAAQ,KAAO,CAE/D,QAEA,KAAK,MAAQphB,EACb,KAAK,MAAQohB,CAEb,CAED,OAAQ,CAEP,KAAM,CAAE,MAAAphB,EAAO,MAAAohB,CAAO,EAAG,KAEzB,IAAI3jC,EAAS,KAEb,OAAKuiB,IAAUmpC,GAAU,mBAExB1rD,EAASq3B,GAAiB,mBAAoBK,GAAgBiM,CAAK,EAAG,IAAKjM,GAAgBiM,EAAM,MAAM,CAAI,CAAA,GAIrG3jC,CAEP,CAED,UAAWqe,EAAO,CAEjB,MAAM,UAAWA,GAEjBA,EAAK,MAAQ,KAAK,KAElB,CAED,YAAaA,EAAO,CAEnB,MAAM,YAAaA,GAEnB,KAAK,MAAQA,EAAK,KAElB,CAEF,CAEAqtC,GAAU,iBAAmB,kBAItB,MAAMC,GAAuBlnC,EAAWinC,GAAWA,GAAU,gBAAgB,EAEpFhtC,EAAc,YAAagtC,EAAW,ECtD/B,MAAME,GAAyB5pC,EAASV,GAAY,CAE1D,KAAM,CAAE,cAAAuqC,EAAe,eAAAC,EAAgB,cAAAC,CAAa,EAAKzqC,EAKnD0qC,EAAkBH,EAAc,IAAKE,CAAe,EAAC,IAAK,KAAO,aAEvE,OAAOD,EAAe,YAAa,CAAC,EAAG,KACtCE,EAAgB,IAAKH,EAAc,IAAKC,CAAgB,EAAC,KAAM,EAAC,SAAU,EAAC,MAAO,EAAC,KAAI,CAAI,EAC3FE,CACF,CAEA,GCNA,MAAMC,WAAuBvoB,EAAkB,CAE9C,YAAaC,EAAQ,KAAO,CAE3B,MAAOA,CAAK,EAEZ,KAAK,mBAAqB1X,EAAS,GACnC,KAAK,kBAAoBA,EAAS,EAElC,CAED,OAAQJ,EAAQ,CAEf,KAAM,CAAE,MAAA8X,CAAO,EAAG,KAElB,MAAM,OAAQ9X,GAEd,KAAK,mBAAmB,MAAQ8X,EAAM,SACtC,KAAK,kBAAkB,MAAQA,EAAM,KAErC,CAED,MAAOzmB,EAAU,CAEhB,KAAM,CAAE,UAAAwb,EAAW,mBAAAwzB,EAAoB,kBAAAC,EAAmB,MAAAxoB,CAAK,EAAK,KAE9D8B,EAAgBvoB,EAAQ,QAAQ,cAEhCkvC,EAAUz0B,GAAoBgM,CAAO,EAAC,IAAKzH,EAAY,EAEvDmwB,EAAiBD,EAAQ,YACzBP,EAAgBO,EAAQ,SAExBE,EAAmBV,GAAwB,CAChD,cAAAC,EACA,eAAgBK,EAChB,cAAeC,CAClB,GAEQI,EAAa7zB,EAAU,IAAK4zB,CAAgB,EAE5CzlB,EAAiB3pB,EAAQ,QAAQ,eAEvCuoB,EAAc,OAAQ,CACrB,eAAA4mB,EACA,WAAAE,EACA,eAAA1lB,EACA,WAAY,KAAK,cACpB,EAAK3pB,EAAQ,MAAOA,EAElB,CAEF,CAIAwB,EAAc,iBAAkButC,IAEhC1lB,GAAcimB,GAAYP,EAAgB,EC7D1C,MAAMQ,WAA6B/oB,EAAkB,CAEpD,YAAaC,EAAQ,KAAO,CAE3B,MAAOA,CAAK,CAEZ,CAED,MAAOzmB,EAAU,CAEhB,MAAM,MAAOA,GAEb,MAAMuoB,EAAgBvoB,EAAQ,QAAQ,cAEhCqvC,EAAa,KAAK,UAClBF,EAAiBV,GAAsB,KAAK,KAAK,EACjD9kB,EAAiB3pB,EAAQ,QAAQ,eAEvCuoB,EAAc,OAAQ,CACrB,eAAA4mB,EACA,WAAAE,EACA,eAAA1lB,EACA,WAAY,KAAK,cACpB,EAAK3pB,EAAQ,MAAOA,EAElB,CAEF,CAIAwB,EAAc,uBAAwB+tC,IAEtClmB,GAAcmmB,GAAkBD,EAAsB,EC/BtD,MAAME,GAAY,IAAItwC,GAChBuwC,GAAY,IAAIvwC,GACtB,IAAIwwC,GAAOC,GAEX,MAAMC,WAA0BrpB,EAAkB,CAEjD,YAAaC,EAAQ,KAAO,CAE3B,MAAOA,CAAK,EAEZ,KAAK,WAAa1X,EAAS,IAAI/P,EAAS,EACxC,KAAK,UAAY+P,EAAS,IAAI/P,EAAS,CAEvC,CAED,OAAQ2P,EAAQ,CAEf,MAAM,OAAQA,GAEd,KAAM,CAAE,MAAA8X,CAAO,EAAG,KAEZqpB,EAAanhC,EAAM,OAAO,mBAEhC+gC,GAAU,SAAQ,EAClBD,GAAU,KAAMhpB,EAAM,aACtBgpB,GAAU,YAAaK,GACvBJ,GAAU,gBAAiBD,IAE3B,KAAK,UAAU,MAAM,IAAKhpB,EAAM,MAAQ,GAAK,EAAK,GAClD,KAAK,WAAW,MAAM,IAAK,EAAKA,EAAM,OAAS,GAAK,GAEpD,KAAK,UAAU,MAAM,aAAcipB,EAAS,EAC5C,KAAK,WAAW,MAAM,aAAcA,EAAS,CAE7C,CAED,MAAO1vC,EAAU,CAEhB,MAAM,MAAOA,GAER2vC,KAAU,SAET3vC,EAAQ,YAAa,sBAEzB2vC,GAAQv4B,GAAS24B,GAAY,aAC7BH,GAAQx4B,GAAS24B,GAAY,eAI7BJ,GAAQv4B,GAAS24B,GAAY,YAC7BH,GAAQx4B,GAAS24B,GAAY,cAM/B,KAAM,CAAE,UAAAv0B,EAAW,MAAAiL,CAAO,EAAG,KACvB8B,EAAgBvoB,EAAQ,QAAQ,cAEhCgwC,EAAgBv1B,GAAoBgM,GACpCkD,EAAiB3pB,EAAQ,QAAQ,eAEvCuoB,EAAc,eAAgB,CAC7B,WAAY/M,EACZ,cAAAw0B,EACA,UAAW,KAAK,UAChB,WAAY,KAAK,WACjB,eAAArmB,EACA,MAAAgmB,GACA,MAAAC,EACH,EAAK5vC,EAAQ,MAAOA,EAElB,CAEF,CAIAwB,EAAc,oBAAqBquC,IAEnCxmB,GAAc4mB,GAAeJ,EAAmB,EC7EhD,MAAMK,WAAsB1pB,EAAkB,CAE7C,YAAaC,EAAQ,KAAO,CAE3B,MAAOA,CAAK,EAEZ,KAAK,YAAc1X,EAAS,GAC5B,KAAK,gBAAkBA,EAAS,GAEhC,KAAK,mBAAqBA,EAAS,GACnC,KAAK,kBAAoBA,EAAS,EAElC,CAED,OAAQJ,EAAQ,CAEf,MAAM,OAAQA,GAEd,KAAM,CAAE,MAAA8X,CAAO,EAAG,KAElB,KAAK,YAAY,MAAQ,KAAK,IAAKA,EAAM,OACzC,KAAK,gBAAgB,MAAQ,KAAK,IAAKA,EAAM,OAAU,EAAIA,EAAM,SAAU,EAE3E,KAAK,mBAAmB,MAAQA,EAAM,SACtC,KAAK,kBAAkB,MAAQA,EAAM,KAErC,CAED,mBAAoB0pB,EAAc,CAEjC,KAAM,CAAE,YAAAC,EAAa,gBAAAC,CAAiB,EAAG,KAEzC,OAAO16B,GAAYy6B,EAAaC,EAAiBF,CAAW,CAE5D,CAED,MAAOnwC,EAAU,CAEhB,MAAM,MAAOA,GAEb,MAAMuoB,EAAgBvoB,EAAQ,QAAQ,cAEhC,CAAE,UAAAwb,EAAW,mBAAAwzB,EAAoB,kBAAAC,EAAmB,MAAAxoB,CAAK,EAAK,KAE9DyoB,EAAUz0B,GAAoBgM,CAAO,EAAC,IAAKzH,EAAY,EAEvDmwB,EAAiBD,EAAQ,YACzBoB,EAAWnB,EAAe,IAAKV,GAAsBhoB,CAAO,CAAA,EAC5D8pB,EAAkB,KAAK,mBAAoBD,CAAQ,EAEnD3B,EAAgBO,EAAQ,SAExBE,EAAmBV,GAAwB,CAChD,cAAAC,EACA,eAAgBK,EAChB,cAAeC,CAClB,GAEQI,EAAa7zB,EAAU,IAAK+0B,CAAe,EAAG,IAAKnB,GAEnDzlB,EAAiB3pB,EAAQ,QAAQ,eAEvCuoB,EAAc,OAAQ,CACrB,eAAA4mB,EACA,WAAAE,EACA,eAAA1lB,EACA,WAAY,KAAK,cACpB,EAAK3pB,EAAQ,MAAOA,EAElB,CAEF,CAIAwB,EAAc,gBAAiB0uC,IAE/B7mB,GAAcmnB,GAAWN,EAAe,ECvFxC,MAAMO,WAAqBD,EAAU,CAEpC,YAAazoC,EAAOgnB,EAAWra,EAAUo2B,EAAO4F,EAAUC,EAAQ,CAEjE,MAAO5oC,EAAOgnB,EAAWra,EAAUo2B,EAAO4F,EAAUC,GAEpD,KAAK,OAAS,IAEd,CAED,KAAM7mC,EAAQ8mC,EAAY,CAEzB,aAAM,KAAM9mC,EAAQ8mC,GAEpB,KAAK,OAAS9mC,EAAO,OAEd,IAEP,CAEF,CCdA,MAAM+mC,WAAyBX,EAAc,CAE5C,mBAAoBC,EAAc,CAEjC,MAAMW,EAAS,KAAK,MAAM,OAE1B,IAAIP,EAAkB,KAEtB,GAAKO,GAAUA,EAAO,YAAc,GAAO,CAE1C,MAAMhG,EAAQqF,EAAY,KAAM,EAAC,IAAK,EAAM,KAAK,IAEjDI,EAAkBn5B,GAAS05B,EAAQ9oC,EAAM8iC,EAAO,CAAG,EAAE,CAAG,EAAC,CAE5D,MAEGyF,EAAkB,MAAM,mBAAoBJ,GAI7C,OAAOI,CAEP,CAEF,CAIA/uC,EAAc,mBAAoBqvC,IAElCxnB,GAAconB,GAAcI,EAAkB,EChC9C,MAAME,WAAyBvqB,EAAkB,CAEhD,YAAaC,EAAQ,KAAO,CAE3B,MAAOA,CAAK,CAEZ,CAED,MAAO,CAAE,QAAAtb,GAAY,CAEpBA,EAAQ,WAAW,UAAW,KAAK,SAAS,CAE5C,CAEF,CAIA3J,EAAc,mBAAoBuvC,IAElC1nB,GAAc2nB,GAAcD,EAAkB,EChB9C,MAAME,WAA4BzqB,EAAkB,CAEnD,YAAaC,EAAQ,KAAO,CAE3B,MAAOA,CAAK,EAEZ,KAAK,kBAAoBjM,GAAgBiM,GACzC,KAAK,mBAAqB,KAAK,kBAAkB,UAAS,EAE1D,KAAK,gBAAkB1X,EAAS,IAAIjQ,EAAO,CAE3C,CAED,OAAQ6P,EAAQ,CAEf,KAAM,CAAE,MAAA8X,CAAO,EAAG,KAElB,MAAM,OAAQ9X,GAEd,KAAK,kBAAkB,SAAW8X,EAElC,KAAK,gBAAgB,MAAM,KAAMA,EAAM,WAAW,EAAG,eAAgBA,EAAM,UAE3E,CAED,MAAOzmB,EAAU,CAEhB,KAAM,CAAE,UAAAwb,EAAW,gBAAA01B,EAAiB,mBAAAC,CAAkB,EAAK,KAGrDC,EADQn2B,GAAW,IAAKk2B,CAAkB,EAChB,IAAK,EAAG,EAAG,IAAK,IAE1ChiB,EAAa9Z,GAAK67B,EAAiB11B,EAAW41B,CAAiB,EAErEpxC,EAAQ,QAAQ,WAAW,UAAWmvB,CAAU,CAEhD,CAEF,CAIA3tB,EAAc,sBAAuByvC,IAErC5nB,GAAcgoB,GAAiBJ,EAAqB,ECjDpD,MAAMK,GAAoBxsC,EAASV,GAAY,CAE9C,MAAM8K,EAAK9K,EAAO,GAAG,IAAK,CAAG,EAEvBk2B,EAAKprB,EAAG,EAAE,MAAK,EACfqrB,EAAKrrB,EAAG,EAAE,MAAK,EAGrB,OAFeorB,EAAG,IAAKC,CAAE,EAAG,IAAK,GAEnB,MAEf,GAEA,MAAMgX,WAAoB7vC,CAAS,CAElC,YAAa+V,EAASvI,KAAO,CAE5B,MAAO,OAAO,EAEd,KAAK,OAASuI,CAEd,CAED,OAAQ,CAEP,OAAO65B,GAAmB,CAAE,GAAI,KAAK,MAAQ,CAAA,CAE7C,CAEF,CAIO,MAAME,GAAUjqC,EAAWgqC,IAElCxtC,EAAgB,UAAWytC,IAE3BhwC,EAAc,cAAe+vC,EAAa,EC1B1C,MAAME,GAAgB,IAAIC,GAE1B,MAAMC,WAAoCve,EAAa,CAEtD,YAAax0B,EAAS,GAAK,CAE1B,QAEA,KAAK,QAAU,GAEf,KAAK,OAAS,GAEd,KAAK,mBAAqB,GAE1B,KAAK,SAAWA,EAAO,aAEvB,KAAK,WAAa,EAElB,KAAK,eAAiB,KAEtB,KAAK,iBAAkB6yC,IAEvB,KAAK,aAAY,EAEjB,KAAK,UAAW7yC,EAEhB,CAED,cAAe,CAEd,MAAMgzC,EAAqB,KAAK,gBAC1BC,EAAW,KAAK,SAEtB,KAAK,WAAa/sC,EAAO,IAAM,CAG9BsF,GAASpC,EAAI,EAAI,KAAO,EAAC,OAAQkH,GAAE,GAEnC,MAAM4R,EAAmBtW,GAAW,oBAG9BsnC,EAAQ7zC,GAAU,OAAQ,OAAO,EACvC6zC,EAAM,OAAQn3B,GAAgB,IAAKnS,EAAMsY,EAAkB,CAAK,CAAA,GAEhE,MAAMixB,EAASzhB,GAAS,EAAE,IAAKA,GAAS,GAGlC0hB,EAAU93B,GAAuB,IAAK43B,CAAK,EAG3C55C,EAAS+F,GAAU,OAAQ,QAAQ,EACzC,OAAA/F,EAAO,OAAQ0mB,GAAiB,IAChC1mB,EAAO,OAAQA,EAAO,IAAKwmB,EAAoB,CAAA,EAC/CxmB,EAAO,OAAQA,EAAO,IAAKo4B,GAAS,CAAC,GACrCp4B,EAAO,EAAE,OAAQA,EAAO,EAAE,IAAK65C,CAAM,GAGrC75C,EAAO,OAAQA,EAAO,IAAK85C,EAAQ,CAAC,GAGpCA,EAAQ,OAAQA,EAAQ,IAAKxpC,EAAMtQ,EAAQ,EAAG,CAAG,CAAA,GAE1C85C,CAIP,CAAA,IAED,KAAK,aAAeltC,EAAO,IAAM,CAEhC,MAAMmtC,EAAM7nC,GAASpC,EAAM,EAAE,KAAK,EAG5BkqC,EAAQj0C,GAAU,QAAS,OAAO,EACxCi0C,EAAM,OAAQ,GAEd,MAAM7uD,EAAI4uD,EAAI,EACR3uD,EAAI2uD,EAAI,EAERE,EAAO9uD,EAAE,IAAKA,CAAC,EAAG,IAAKC,EAAE,IAAKA,CAAC,GAErC,GAAKsuD,EAAqB,CAGzB,MAAMQ,EAAOn0C,GAAU,QAAS,MAAM,EACtCm0C,EAAK,OAAQD,EAAK,OAAQ,CAAA,EAE1BD,EAAM,OAAQv8B,GAAYy8B,EAAK,SAAQ,EAAIA,EAAK,IAAK,CAAC,EAAID,GAAO,SAAU,CAAA,CAE/E,MAEIA,EAAK,YAAa,CAAK,EAAC,QAAO,EAIhC,IAAIE,EAEJ,OAAK,KAAK,eAETA,EAAiB,KAAK,eAIjBR,EAIJQ,EAFsB7nC,GAAW,iBAEF,IAAKmS,IAIpC01B,EAAiB11B,GAMZnU,EAAM6pC,EAAgBH,EAE7B,CAAA,IAED,KAAK,YAAc,EAEnB,CAED,IAAI,iBAAkB,CAErB,OAAO,KAAK,kBAEZ,CAED,IAAI,gBAAiB/tD,EAAQ,CAEvB,KAAK,qBAAuBA,IAEhC,KAAK,mBAAqBA,EAC1B,KAAK,aAAY,EAIlB,CAEF,CAIAowC,GAAiB,8BAA+Bod,EAA6B,EC7J7E,MAAMF,GAAgB,IAAIa,GAE1B,MAAMC,WAA8Bnf,EAAa,CAEhD,YAAasY,EAAa,CAEzB,QAEA,KAAK,wBAA0B,GAE/B,KAAK,OAAS,GACd,KAAK,QAAU,GAEf,KAAK,iBAAkB+F,IAEvB,KAAK,UAAW/F,EAEhB,CAEF,CAIAnX,GAAiB,wBAAyBge,EAAuB,ECnBjE,MAAMd,GAAgB,IAAIe,GAE1B,MAAMC,WAA+Brf,EAAa,CAEjD,YAAasY,EAAa,CAEzB,QAEA,KAAK,yBAA2B,GAEhC,KAAK,OAAS,GACd,KAAK,QAAU,GAEf,KAAK,iBAAkB+F,IAEvB,KAAK,WAAa,KAClB,KAAK,cAAgB,KACrB,KAAK,aAAe,KACpB,KAAK,YAAc,KAEnB,KAAK,UAAW/F,EAEhB,CAED,eAAgB,CAEf,MAAMgH,EAAa,KAAK,WAClBC,EAAgB,KAAK,cAAgB7rC,EAAO,KAAK,aAAe,EAAGuX,GACnEu0B,EAAe,KAAK,aAAe9rC,EAAO,KAAK,YAAc,EAAGwX,GAChEu0B,EAAc,KAAK,aAAe/rC,EAAO,KAAK,WAAa,EAAGyX,GAEpEvR,GAAS,OAAQ4lC,GACjB3lC,GAAQ,OAAQ4lC,GAEhB,MAAMC,EAAgB1oC,GAASI,GAAW,cAAc,EAAG,IAAKmoC,CAAa,IACjDD,EAAaI,EAAc,IAAKJ,CAAY,EAAGI,GAEvD,IAAK9lC,GAAS,IAAKC,GAAW,EAAC,YAAaD,IAAW,SAE3E,CAEF,CAIAunB,GAAiB,yBAA0Bke,EAAwB,ECpCnE,MAAMhB,GAAgB,IAAIe,GAE1B,MAAMO,WAA0B3f,EAAa,CAE5C,YAAax0B,EAAS,GAAK,CAE1B,QAEA,KAAK,QAAU,GACf,KAAK,OAAS,GAEd,KAAK,iBAAkB6yC,IAEvB,KAAK,mBAAqB,GAC1B,KAAK,SAAW7yC,EAAO,aACvB,KAAK,QAAUA,EAAO,OACtB,KAAK,cAAgB,GAErB,KAAK,WAAa,EAClB,KAAK,UAAY,EAEjB,KAAK,cAAgB,KAErB,KAAK,WAAa,KAClB,KAAK,cAAgB,KACrB,KAAK,aAAe,KACpB,KAAK,YAAc,KAEnB,KAAK,UAAWA,EAEhB,CAED,MAAOoB,EAAU,CAEhB,KAAK,aAAY,EAEjB,MAAM,MAAOA,EAEb,CAED,cAAe,CAEd,MAAM4xC,EAAqB,KAAK,gBAC1BC,EAAW,KAAK,SAChBmB,EAAU,KAAK,OACfC,EAAgB,KAAK,WAErBC,EAAcpuC,EAAO,CAAE,CAAE,MAAA5d,EAAO,IAAAC,CAAG,IAAQ,CAEhD,MAAM9D,EAAI62B,GAAuB,QAAS,CAAC,EAAG,QAAS,GAIjDg4B,EAHIh4B,GAAuB,QAAS,CAAC,EAAG,QAAS,GAChC,IAAK,KAAQ,IAAK72B,GAEd,IAAK6D,EAAM,CAAG,EAAC,IAAKC,EAAI,EAAE,IAAKD,EAAM,CAAG,CAAA,EAEnE,OAAOshB,EAAM6M,GAAKnuB,EAAM,IAAKC,EAAI,IAAK+qD,CAAO,EAAE/qD,EAAI,EAEtD,GAEE,KAAK,WAAa2d,EAAO,IAAM,CAE9BgH,GAAiB,OAAQ,KAAK,EAAG,OAAQoD,GAAI,CAAA,EAE7C,MAAMikC,EAAgB3oC,GAAW,iBAC3B4oC,EAAc5oC,GAAW,eAIzBtjB,EAAQ+W,GAAU,OAAQ,OAAO,EACjC9W,EAAM8W,GAAU,OAAQ,KAAK,EAEnC/W,EAAM,OAAQyzB,GAAgB,IAAKnS,EAAM2qC,EAAe,CAAK,CAAA,GAC7DhsD,EAAI,OAAQwzB,GAAgB,IAAKnS,EAAM4qC,EAAa,CAAK,CAAA,GAEpDH,IAEJnnC,GAAiB,OAAQ,YAAY,EAAG,OAAQ5kB,EAAM,KACtD4kB,GAAiB,OAAQ,UAAU,EAAG,OAAQ3kB,EAAI,MAInD,MAAM4qD,EAASzhB,GAAS,EAAE,IAAKA,GAAS,GAOlC+iB,EAAcn5B,GAAuB,QAAS,CAAG,EAAC,QAAS,GAAI,MAAO,IAE5ErS,GAAIwrC,EAAa,IAAM,CAEtBxrC,GAAI3gB,EAAM,EAAE,SAAU,CAAK,EAAC,IAAKC,EAAI,EAAE,YAAa,CAAG,CAAI,EAAE,IAAM,CAElEA,EAAI,OAAQ+rD,EAAa,CAAE,MAAOhsD,EAAO,IAAKC,CAAK,CAAA,EAEnD,CAAA,EAAG,OAAQA,EAAI,EAAE,SAAU,CAAG,EAAG,IAAKD,EAAM,EAAE,iBAAkB,CAAG,CAAI,EAAE,IAAM,CAE/EA,EAAM,OAAQgsD,EAAa,CAAE,MAAO/rD,EAAK,IAAKD,CAAO,CAAA,EAE1D,EAEA,GAGG,MAAMosD,EAAYp5B,GAAuB,IAAKhzB,CAAK,EAC7CqsD,EAAUr5B,GAAuB,IAAK/yB,CAAG,EAGzCqsD,EAAWF,EAAU,IAAI,IAAKA,EAAU,GACxCG,EAASF,EAAQ,IAAI,IAAKA,EAAQ,GAGlCze,EAAM2e,EAAO,GAAG,IAAKD,EAAS,EAAE,EAAG,OAGzC1e,EAAI,EAAE,OAAQA,EAAI,EAAE,IAAKid,CAAM,GAC/Bjd,EAAI,OAAQA,EAAI,UAAW,CAAA,EAE3B,MAAM4e,EAAO9nC,GAAMpD,EAAI,GAEvB,GAAKyqC,EAAgB,CAIpB,MAAMU,EAAWxsD,EAAI,IAAI,IAAKD,EAAM,GAAG,EAAG,YACpC0sD,EAASv+B,GAAKnuB,EAAM,IAAKC,EAAI,IAAK,IAAM,YACxC0sD,EAAUF,EAAS,MAAOC,CAAQ,EAAC,UAAS,EAC5CE,EAAWH,EAAS,MAAOE,CAAO,EAElCE,EAAWjoC,GAAiB,OAAQ,UAAU,EAEpDioC,EAAS,OAAQn1B,GAAiB,EAAE,SAAU,EAAK,EAAC,KAAM13B,EAAOC,CAAG,GAGpE,MAAM6sD,EAAKx1B,GAAkB,IAAK,EAAG,EACrCu1B,EAAS,UAAWvrC,EAAMoW,GAAiB,EAAE,SAAU,GAAM,KAAMi1B,EAAQ,IAAKG,CAAI,EAAEH,EAAQ,IAAKG,CAAI,EAAC,OAAQ,CAAA,EAAI,CAAC,GAI9GhB,IAGNe,EAAS,UAAWvrC,EAAMoW,GAAiB,EAAE,SAAU,IAAM,KAAM+0B,EAAS,IAAKK,CAAI,EAAC,OAAM,EAAIL,EAAS,IAAKK,CAAI,CAAA,EAAI,CAAC,GAGvHD,EAAS,UAAWvrC,EAAMsrC,EAAS,IAAKE,CAAI,EAAE,CAAC,GAG/CnsC,GAAI+W,GAAiB,EAAE,YAAa,CAAK,EAAC,GAAIA,GAAiB,EAAE,SAAU,CAAG,CAAI,EAAE,IAAM,CAEzFm1B,EAAS,UAAWvrC,EAAMsrC,EAAS,IAAK,CAAK,EAAC,IAAKE,GAAM,CAAG,CAAA,CAElE,IAKIN,EAAK,OAAQx5B,GAAuB,IAAK65B,CAAU,CAAA,EAInD,MAAME,GAAWroC,GAAMxD,EAAI,GAE3B6rC,GAAS,OAAQr1B,GAAiB,EAAE,SAAU,EAAK,EAAC,KAAM40B,EAAUC,CAAM,GAC1EC,EAAK,EAAE,OAAQO,GAAS,EAAE,IAAKP,EAAK,CAAC,EAEzC,KAAU,CAEN,MAAMx7C,EAAS+F,GAAU,OAAQ,QAAQ,EAEzC/F,EAAO,OAAQ8P,EAAM8sB,EAAI,EAAGA,EAAI,EAAE,OAAQ,CAAA,GAG1CA,EAAI,EAAE,OAAQA,EAAI,EAAE,IAAKid,CAAM,GAC/B75C,EAAO,EAAE,OAAQA,EAAO,EAAE,IAAK65C,CAAM,GAGrC75C,EAAO,OAAQ0mB,GAAiB,EAAE,SAAU,GAAM,KAAM1mB,EAAO,SAAUA,CAAQ,CAAA,EAGjF2P,GAAI+W,GAAiB,EAAE,SAAU,CAAK,EAAE,IAAM,CAE7C1mB,EAAO,OAAQA,EAAO,IAAK48B,CAAK,CAAA,CAErC,CAAO,EAAC,OAAQlW,GAAiB,EAAE,YAAa,CAAG,EAAI,IAAM,CAExD1mB,EAAO,OAAQA,EAAO,IAAK48B,CAAK,CAAA,CAErC,GAGI58B,EAAO,OAAQA,EAAO,IAAKsmB,EAAmB,CAAA,EAG9CtmB,EAAO,OAAQA,EAAO,IAAKo4B,GAAS,CAAC,GAGrCojB,EAAK,OAAQ90B,GAAiB,EAAE,SAAU,EAAK,EAAC,KAAM00B,EAAWC,CAAO,GAGxEr7C,EAAO,OAAQA,EAAO,IAAKw7C,EAAK,CAAC,GAEjCA,EAAK,OAAQA,EAAK,IAAKlrC,EAAMtQ,EAAQ,EAAG,CAAG,CAAA,EAE3C,CAED,OAAOw7C,CAEP,CAAA,IAED,MAAMQ,EAAoBpvC,EAAO,CAAE,CAAE,GAAAy3B,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAA0X,KAAU,CAE1D,MAAMC,EAAM7X,EAAG,IAAKE,CAAE,EAChB4X,EAAMF,EAAG,IAAK1X,CAAE,EAEhB6X,EAAM9X,EAAG,IAAKD,CAAE,EAEhBgY,EAAQH,EAAI,IAAKC,CAAG,EACpBG,EAAQH,EAAI,IAAKC,CAAG,EACpBG,EAAQL,EAAI,IAAKE,CAAG,EACpBI,EAAQL,EAAI,IAAKA,CAAG,EAGpBM,EAFQL,EAAI,IAAKA,CAAG,EAEN,IAAKI,CAAK,EAAG,IAAKF,EAAM,IAAKA,CAAK,GAGhDI,EAFQL,EAAM,IAAKC,CAAK,EAAG,IAAKC,EAAM,IAAKC,CAAK,GAEpC,IAAKC,CAAO,EAAC,MAAK,EAC9BE,EAAMN,EAAM,IAAKC,EAAM,IAAKI,CAAK,CAAA,EAAG,IAAKF,CAAO,EAAC,MAAK,EAE5D,OAAO1sC,EAAM4sC,EAAKC,EAErB,GAEE,KAAK,aAAe/vC,EAAO,IAAM,CAEhC,MAAMmtC,EAAMnmC,GAAiB,OAAQ,KAAK,EAE1C,GAAKknC,EAAU,CAEd,MAAMN,EAAa,KAAK,WAAa5rC,EAAO,KAAK,cAAgB,EAAG2X,GAC9Dk0B,EAAgB,KAAK,cAAgB7rC,EAAO,KAAK,aAAe,EAAGuX,GACnEu0B,EAAe,KAAK,aAAe9rC,EAAO,KAAK,YAAc,EAAGwX,GAChEu0B,EAAc,KAAK,aAAe/rC,EAAO,KAAK,WAAa,EAAGyX,GAEpEvR,GAAS,OAAQ4lC,GACjB3lC,GAAQ,OAAQ4lC,GAEhB,MAAMiC,EAAwBtqC,GAAW,yBACnCuqC,EAAsBvqC,GAAW,uBAEjCwqC,EAAep2B,GAAiB,EAAE,SAAU,EAAK,EAAC,KAAM+zB,EAAc,IAAKmC,CAAqB,EAAIz2B,GAAkB,IAAK02B,CAAqB,CAAA,EAEhJjC,EAAgB1oC,GAAS4qC,EAAa,IAAKv2B,EAAwB,CAAA,EACnEw2B,EAAsBvC,EAAaI,EAAc,IAAKJ,CAAY,EAAGI,EAE3Eb,EAAI,EAAE,SAAU,EAAO,EAAC,GAAIA,EAAI,EAAE,YAAa,EAAO,EAAC,QAAO,EAC9DgD,EAAoB,IAAKjoC,GAAS,IAAKC,GAAW,EAAC,YAAaD,IAAW,SAE3E,CAGD,MAAMklC,EAAQj0C,GAAU,QAAS,OAAO,EAGxC,GAFAi0C,EAAM,OAAQ,GAETe,EAAgB,CAEpB,MAAMiC,EAAappC,GAAiB,OAAQ,YAAY,EAClDqpC,EAAWrpC,GAAiB,OAAQ,UAAU,EAG9CspC,EAAStpC,GAAiB,OAAQ,UAAU,EAAG,IAAI,UAAW,EAAC,IAAK,KACpEupC,EAAUF,EAAS,IAAKD,CAAU,EAClCt2C,EAASs1C,EAAmB,CAAE,GAAIgB,EAAY,GAAIC,EAAU,GAAI/sC,EAAM,EAAK,EAAK,CAAK,EAAE,GAAIgtC,CAAM,GAEjG7Y,EAAK2Y,EAAW,IAAKG,EAAQ,IAAKz2C,EAAO,CAAC,GAC1C49B,EAAK4Y,EAAO,IAAKx2C,EAAO,CAAC,EAGzB02C,EAFQ/Y,EAAG,IAAKC,CAAE,EACN,SACD,IAAKhe,EAAiB,EAEvC,GAAK,CAAEw0B,EAEN,GAAKpB,EAAqB,CAEzB,MAAM2D,EAAQD,EAAK,SACnBpD,EAAM,OAAQv8B,GAAY4/B,EAAM,OAAM,EAAG,IAAK,EAAK,EAAEA,EAAM,IAAK,EAAG,EAAID,CAAM,EAAC,SAAQ,EAE5F,MAEMA,EAAK,YAAa,EAAK,EAAC,QAAO,CAMrC,SAIS1D,EAAqB,CAEzB,MAAMvuD,EAAI4uD,EAAI,EACR3uD,EAAI2uD,EAAI,EAAE,YAAa,CAAG,EAAG,KAAMA,EAAI,EAAE,IAAK,CAAG,EAAIA,EAAI,EAAE,IAAK,CAAG,GAEnEE,EAAO9uD,EAAE,IAAKA,CAAC,EAAG,IAAKC,EAAE,IAAKA,CAAC,GAG/B8uD,EAAOn0C,GAAU,QAAS,MAAM,EACtCm0C,EAAK,OAAQD,EAAK,OAAQ,CAAA,EAE1BtqC,GAAIoqC,EAAI,EAAE,IAAK,EAAC,YAAa,CAAG,EAAI,IAAM,CAEzCC,EAAM,OAAQv8B,GAAYy8B,EAAK,SAAQ,EAAIA,EAAK,IAAK,CAAC,EAAID,GAAO,SAAU,CAAA,CAEjF,EAEA,MAEKtqC,GAAIoqC,EAAI,EAAE,IAAK,EAAC,YAAa,CAAG,EAAI,IAAM,CAEzC,MAAM5uD,EAAI4uD,EAAI,EACR3uD,EAAI2uD,EAAI,EAAE,YAAa,CAAG,EAAG,KAAMA,EAAI,EAAE,IAAK,CAAG,EAAIA,EAAI,EAAE,IAAK,CAAG,GAC5D5uD,EAAE,IAAKA,CAAC,EAAG,IAAKC,EAAE,IAAKA,CAAC,GAEhC,YAAa,CAAK,EAAC,QAAO,CAErC,GAMG,IAAIkyD,EAEJ,GAAK,KAAK,cAETA,EAAgB,KAAK,sBAIhB3D,EAAW,CAEf,MAAM4D,EAAqBjrC,GAAW,sBAChCkrC,EAAmBlrC,GAAW,oBAIpCgrC,EAFsB52B,GAAiB,EAAE,SAAU,EAAG,EAAG,KAAM62B,EAAoBC,GAErD,IAAK/4B,GAExC,MAEK64B,EAAgB74B,GAMlB,OAAOnU,EAAMgtC,EAAetD,EAE5B,CAAA,GAED,CAGD,IAAI,YAAa,CAEhB,OAAO,KAAK,aAEZ,CAED,IAAI,WAAY/tD,EAAQ,CAElB,KAAK,gBAAkBA,IAE3B,KAAK,cAAgBA,EACrB,KAAK,YAAc,GAIpB,CAGD,IAAI,QAAS,CAEZ,OAAO,KAAK,OAEZ,CAED,IAAI,OAAQA,EAAQ,CAEd,KAAK,UAAYA,IAErB,KAAK,QAAUA,EACf,KAAK,YAAc,GAIpB,CAGD,IAAI,iBAAkB,CAErB,OAAO,KAAK,kBAEZ,CAED,IAAI,gBAAiBA,EAAQ,CAEvB,KAAK,qBAAuBA,IAEhC,KAAK,mBAAqBA,EAC1B,KAAK,YAAc,GAIpB,CAEF,CAIAowC,GAAiB,oBAAqBwe,EAAmB,EC9azD,MAAMtB,GAAgB,IAAIkE,GAE1B,MAAMC,WAA+BxiB,EAAa,CAEjD,YAAasY,EAAa,CAEzB,QAEA,KAAK,OAAS,GAEd,KAAK,yBAA2B,GAEhC,KAAK,iBAAkB+F,IAEvB,KAAK,UAAW/F,EAEhB,CAED,mBAAoB,CAEnB,MAAMjwB,EAAc,KAAK,YAAc3U,EAAO,KAAK,WAAa,EAAGgW,GAEnE/Q,EAAa,OAAQvD,EAAMivB,GAAkBtc,EAAuB,EAAEM,CAAW,EAEjF,CAEF,CAIA8Y,GAAiB,yBAA0BqhB,EAAwB,ECnCnE,MAAMnE,GAAgB,IAAIoE,GAE1B,MAAMC,WAA8B1iB,EAAa,CAEhD,YAAasY,EAAa,CAEzB,QAEA,KAAK,wBAA0B,GAE/B,KAAK,OAAS,GAGd,KAAK,iBAAkB+F,IAEvB,KAAK,UAAW/F,EAEhB,CAEF,CAIAnX,GAAiB,wBAAyBuhB,EAAuB,ECzBjE,MAAMC,GAAYjxC,EAAO,CAAE,CAAE,GAAAkxC,EAAI,IAAAC,EAAK,MAAAC,CAAK,IAAQ,CAOlD,MAAMC,EAAUD,EAAM,IAAK,QAAW,EAAC,IAAK,OAAS,EAAC,IAAKA,CAAO,EAAC,KAAI,EAEvE,OAAOF,EAAG,IAAKG,EAAQ,SAAU,CAAA,EAAG,IAAKF,EAAI,IAAKE,CAAO,EAE1D,GCXMC,GAAetxC,EAASV,GAEtBA,EAAO,aAAa,IAAK,EAAI,KAAK,KCMpCiyC,GAAwB,IAAMvvC,EAAO,KAErCwvC,GAAexxC,EAAO,CAAE,CAAE,MAAAyxC,KAExBxpC,GAAU,IAAKjG,EAAO,EAAK,CAAA,EAAG,IAAK,CAAG,EAAG,IAAKA,EAAO,EAAI,KAAK,GAAM,EAAC,IAAKyvC,EAAM,IAAKxpC,EAAS,IAIhGypC,GAAkB1xC,EAAO,CAAE,CAAE,eAAAqqC,KAAsB,CAExD,MAAMsH,EAAUtH,EAAe,IAAKlwB,CAAuB,EAAC,UAAS,EAE/Ds3B,EAAQp7B,GAAsB,IAAKs7B,CAAS,EAAC,MAAK,EAClDP,EAAQj3B,EAAsB,IAAKw3B,CAAS,EAAC,MAAK,EAElDrnD,EAAI2mD,GAAW,CAAE,GAAIlpC,GAAe,IAAK,EAAK,MAAAqpC,CAAK,GACnDrM,EAAIwM,KACJK,EAAIJ,GAAc,CAAE,MAAAC,CAAO,CAAA,EAEjC,OAAOnnD,EAAE,IAAKy6C,CAAG,EAAC,IAAK6M,CAAC,CAEzB,GAEA,MAAMC,WAA2BjrC,EAAc,CAE9C,YAAakrC,EAAW,GAAO,CAE9B,QAEA,KAAK,SAAWA,CAEhB,CAED,OAAQ,CAAE,eAAAzH,EAAgB,WAAAE,EAAY,eAAA1lB,CAAc,EAAK,CAGxD,MAAMwF,EADQhU,GAAsB,IAAKg0B,CAAgB,EAAC,MAAK,EACtC,IAAKE,CAAU,EAExC1lB,EAAe,cAAc,UAAWwF,EAAW,IAAKinB,GAAc,CAAE,aAAcrqC,EAAa,GAAK,CAAA,CAAI,CAAA,EAEvG,KAAK,WAAa,IAEtB4d,EAAe,eAAe,UAAWwF,EAAW,IAAKqnB,GAAiB,CAAE,eAAArH,CAAgB,CAAA,CAAI,EAAC,IAAKjyB,EAA0B,CAAA,CAIjI,CAED,gBAAiB,CAAE,WAAAiS,EAAY,eAAAxF,GAAmB,CAEjDA,EAAe,gBAAgB,UAAWwF,EAAW,IAAKinB,GAAc,CAAE,aAAArqC,EAAgB,CAAA,EAE1F,CAEF,CC3DA,MAAM0lC,GAAgB,IAAIoF,GAE1B,MAAMC,WAAgC1jB,EAAa,CAElD,YAAasY,EAAa,CAEzB,QAEA,KAAK,0BAA4B,GAEjC,KAAK,OAAS,GAEd,KAAK,iBAAkB+F,IAEvB,KAAK,UAAW/F,EAEhB,CAED,oBAAkC,CAEjC,OAAO,IAAIiL,GAAoB,GAE/B,CAEF,CAIApiB,GAAiB,0BAA2BuiB,EAAyB,ECzBrE,MAAMrF,GAAgB,IAAIsF,GAE1B,MAAMC,WAA8B5jB,EAAa,CAEhD,YAAasY,EAAa,CAEzB,QAEA,KAAK,wBAA0B,GAE/B,KAAK,OAAS,GAEd,KAAK,cAAgB,KACrB,KAAK,aAAe,KAEpB,KAAK,iBAAkB+F,IAEvB,KAAK,UAAW/F,EAEhB,CAED,oBAAkC,CAEjC,OAAO,IAAIiL,EAEX,CAED,eAAgB,CAIf,MAAMM,GAAkB,KAAK,cAAgBnwC,EAAO,KAAK,eAAkB8V,IAAoB,IAAK,IAAI,EAExG7P,GAAU,OAAQkqC,GAIlB,MAAMC,EAAe,KAAK,cAAgBn6B,GAE1ClQ,GAAc,OAAQqqC,EAEtB,CAED,KAAMptC,EAAS,CAEd,YAAK,cAAgBA,EAAO,cAC5B,KAAK,aAAeA,EAAO,aAEpB,MAAM,KAAMA,EAEnB,CAEF,CAIAyqB,GAAiB,wBAAyByiB,EAAuB,EC7DjE,MAAMG,GAAuBryC,EAAO,IAAM,CAEzC,MAAMsyC,EAAMr8B,GAAe,KAAI,EAAG,IAAG,EAAG,IAAKA,GAAe,OAAO,IAAK,CAAA,EAGxE,OAF0Bq8B,EAAI,EAAE,IAAKA,EAAI,CAAC,EAAG,IAAKA,EAAI,EAIvD,CAAG,ECPGC,GAAevyC,EAASV,GAAY,CAEzC,KAAM,CAAE,UAAA4H,CAAW,EAAG5H,EAEhBkzC,EAAoBH,KAE1B,IAAII,EAAkBvrC,EAAU,IAAK,KAAM,EAC3C,OAAAurC,EAAkBA,EAAgB,IAAKD,GACvCC,EAAkBA,EAAgB,IAAK,GAEhCA,CAER,CAAG,ECTGC,GAAwB1yC,EAAO,CAAE,CAAE,MAAAotC,EAAO,MAAAuF,EAAO,MAAAC,CAAK,IAAQ,CAEnE,MAAMC,EAAKzF,EAAM,OAEX0F,EAAKH,EAAM,IAAKE,EAAG,IAAKA,EAAG,SAAU,EAAC,IAAKD,EAAM,KAAI,CAAI,CAAA,EAAG,KAAM,CAAA,EAClEG,EAAKH,EAAM,IAAKC,EAAG,IAAKA,EAAG,SAAU,EAAC,IAAKF,EAAM,KAAI,CAAI,CAAA,EAAG,KAAM,CAAA,EAExE,OAAOtgD,GAAK,GAAKygD,EAAG,IAAKC,GAAK,IAAKxlC,EAAO,EAE3C,CAAC,EAAG,UAAW,CACd,KAAM,wBACN,KAAM,QACN,OAAQ,CACP,CAAE,KAAM,QAAS,KAAM,OAAS,EAChC,CAAE,KAAM,QAAS,KAAM,OAAS,EAChC,CAAE,KAAM,QAAS,KAAM,OAAS,CAChC,CACF,GClBMylC,GAAoChzC,EAAO,CAAE,CAAE,OAAA2H,EAAQ,OAAAsrC,EAAQ,MAAAC,EAAO,MAAAC,EAAO,MAAAC,EAAO,MAAAC,EAAO,MAAAT,EAAO,MAAAD,CAAK,IAAQ,CAEpH,MAAMG,EAAKH,EAAM,IAAKrvC,EAAMqE,EAAO,IAAKurC,CAAO,EAAED,EAAO,IAAKE,CAAK,EAAIP,CAAO,EAAC,OAAM,GAC9EG,EAAKH,EAAM,IAAKtvC,EAAMqE,EAAO,IAAKyrC,CAAO,EAAEH,EAAO,IAAKI,CAAK,EAAIV,CAAO,EAAC,OAAM,GAGpF,OAFUtgD,GAAK,GAAKygD,EAAG,IAAKC,CAAE,GAErB,UAEV,CAAC,EAAG,UAAW,CACd,KAAM,oCACN,KAAM,QACN,OAAQ,CACP,CAAE,KAAM,SAAU,KAAM,QAAS,UAAW,IAAM,EAClD,CAAE,KAAM,SAAU,KAAM,QAAS,UAAW,IAAM,EAClD,CAAE,KAAM,QAAS,KAAM,QAAS,UAAW,IAAM,EACjD,CAAE,KAAM,QAAS,KAAM,QAAS,UAAW,IAAM,EACjD,CAAE,KAAM,QAAS,KAAM,QAAS,UAAW,IAAM,EACjD,CAAE,KAAM,QAAS,KAAM,QAAS,UAAW,IAAM,EACjD,CAAE,KAAM,QAAS,KAAM,QAAS,UAAW,IAAM,EACjD,CAAE,KAAM,QAAS,KAAM,QAAS,UAAW,IAAM,CACjD,CACF,CAAG,ECrBGO,GAAQtzC,EAAO,CAAE,CAAE,MAAAotC,EAAO,MAAAqE,CAAK,IAAQ,CAE5C,MAAMoB,EAAKzF,EAAM,OAEXyC,EAAQ4B,EAAM,OAAO,IAAKoB,EAAG,SAAQ,GAAK,WAEhD,OAAOA,EAAG,IAAKhD,EAAM,KAAI,GAAK,IAAK,EAAI,KAAK,GAE7C,CAAC,EAAG,UAAW,CACd,KAAM,QACN,KAAM,QACN,OAAQ,CACP,CAAE,KAAM,QAAS,KAAM,OAAS,EAChC,CAAE,KAAM,QAAS,KAAM,OAAS,CAChC,CACF,GClBM0D,GAAgBvxC,EAAO,EAAI,KAAK,EAAE,EAIlCwxC,GAAoBxzC,EAAO,CAAE,CAAE,OAAA2H,EAAQ,OAAAsrC,EAAQ,MAAAxB,EAAO,MAAAgC,EAAO,MAAAC,KAAa,CAE/E,MAAMb,EAAKlrC,EAAO,IAAKsrC,CAAM,EACvBjpD,EAAIsZ,EAAM2vC,EAAO,IAAKQ,CAAK,EAAI9rC,EAAO,IAAK+rC,CAAK,EAAIb,EAAG,IAAKpB,CAAO,CAAA,EACnEkC,EAAK3pD,EAAE,IAAKA,CAAC,EACbssC,EAAKuc,EAAG,IAAKc,CAAE,EAErB,OAAOJ,GAAc,IAAKV,EAAG,IAAKvc,EAAG,KAAM,CAAA,EAE5C,CAAC,EAAG,UAAW,CACd,KAAM,oBACN,KAAM,QACN,OAAQ,CACP,CAAE,KAAM,SAAU,KAAM,QAAS,UAAW,IAAM,EAClD,CAAE,KAAM,SAAU,KAAM,QAAS,UAAW,IAAM,EAClD,CAAE,KAAM,QAAS,KAAM,QAAS,UAAW,IAAM,EACjD,CAAE,KAAM,QAAS,KAAM,QAAS,UAAW,IAAM,EACjD,CAAE,KAAM,QAAS,KAAM,QAAS,UAAW,IAAM,CACjD,CACF,CAAG,ECdGsd,GAAW5zC,EAASV,GAAY,CAErC,KAAM,CAAE,eAAA+qC,EAAgB,GAAA6G,EAAI,IAAAC,EAAK,UAAAjqC,EAAW,EAAA3T,EAAG,gBAAAsgD,EAAiB,eAAAC,CAAgB,EAAGx0C,EAE7E6W,EAAa7W,EAAO,YAAc+W,GAElC+2B,EAAQlmC,EAAU,OAElByqC,EAAUtH,EAAe,IAAKlwB,CAAuB,EAAC,UAAS,EAE/Dw4B,EAAQx8B,EAAW,IAAKk0B,CAAgB,EAAC,MAAK,EAC9CuI,EAAQz8B,EAAW,IAAKgE,CAAuB,EAAC,MAAK,EACrDs3B,EAAQt7B,EAAW,IAAKw7B,CAAS,EAAC,MAAK,EACvCP,EAAQj3B,EAAsB,IAAKw3B,CAAS,EAAC,MAAK,EAExD,IAAIrnD,EAAI2mD,GAAW,CAAE,GAAAC,EAAI,IAAAC,EAAK,MAAAC,CAAK,GAC/B2C,EAAGnC,EAQP,GANKtvC,GAASuxC,KAEbvpD,EAAIkd,GAAY,IAAKld,EAAGiJ,CAAC,GAIrB+O,GAASwxC,GAAmB,CAEhC,MAAMV,EAAQvrC,GAAY,IAAKwiC,CAAc,EACvC6I,EAAQrrC,GAAY,IAAKsS,CAAqB,EAC9Cs5B,EAAQ5rC,GAAY,IAAK8pC,CAAO,EAChC0B,EAAQvrC,GAAY,IAAKuiC,CAAc,EACvC8I,EAAQrrC,GAAY,IAAKqS,CAAqB,EAC9Cu5B,EAAQ5rC,GAAY,IAAK6pC,CAAO,EAEtCoC,EAAIf,GAAmC,CAAE,OAAArrC,GAAQ,OAAQylC,EAAO,MAAA8F,EAAO,MAAAC,EAAO,MAAAC,EAAO,MAAAC,EAAO,MAAAT,EAAO,MAAAD,CAAO,CAAA,EAC1Gf,EAAI4B,GAAmB,CAAE,OAAA7rC,GAAQ,OAAQylC,EAAO,MAAAqE,EAAO,MAAAgC,EAAO,MAAAC,CAAK,EAErE,MAEEK,EAAIrB,GAAuB,CAAE,MAAAtF,EAAO,MAAAuF,EAAO,MAAAC,CAAO,CAAA,EAClDhB,EAAI0B,GAAO,CAAE,MAAAlG,EAAO,MAAAqE,CAAO,CAAA,EAI5B,OAAOnnD,EAAE,IAAKypD,CAAG,EAAC,IAAKnC,CAAC,CAEzB,GClDMoC,GAAYh0C,EAAO,CAAE,CAAE,UAAAkH,EAAW,MAAA0rC,CAAK,IAAQ,CAEpD,MAAMqB,EAAKvwC,EAAM,GAAK,OAAU,MAAS,MAEnCwwC,EAAKxwC,EAAM,EAAG,MAAQ,KAAM,MAE5BtgB,EAAI8jB,EAAU,IAAK+sC,CAAE,EAAG,IAAKC,GAE7BC,EAAO/wD,EAAE,EAAE,IAAKA,EAAE,CAAG,EAAC,IAAKwvD,EAAM,IAAK,OAAS,MAAQ,EAAC,IAAKxvD,EAAE,CAAC,EAAG,IAAKA,EAAE,GAIhF,OAFY8f,EAAM,MAAQ,IAAM,EAAC,IAAKixC,GAAO,IAAK/wD,EAAE,EAAE,CAIvD,CAAC,EAAG,UAAW,CACd,KAAM,YACN,KAAM,OACN,OAAQ,CACP,CAAE,KAAM,YAAa,KAAM,OAAS,EACpC,CAAE,KAAM,QAAS,KAAM,MAAQ,CAC/B,CACF,CAAG,ECxBGgxD,GAAkBp0C,EAASV,GAAY,CAE5C,KAAM,CAAE,MAAAszC,EAAO,cAAA7qC,EAAe,YAAAC,EAAa,UAAAd,CAAS,EAAK5H,EAEnD+0C,EAAML,GAAW,CAAE,MAAApB,EAAO,UAAA1rC,CAAW,CAAA,EAC3C,OAAOa,EAAc,IAAKssC,EAAI,CAAG,EAAC,IAAKrsC,EAAY,IAAKqsC,EAAI,CAAG,CAAA,CAEhE,CAAG,ECRGC,GAAgBt0C,EAAO,CAAE,CAAE,EAAAzM,EAAG,IAAA49C,EAAK,MAAAC,CAAK,IAAQ,CAErD,MAAMjjD,EAAIijD,EAAM,SAAU,EAAC,SAAQ,EAC7B7S,EAAKpwC,EAAE,IAAKA,CAAC,EACbomD,EAAKpmD,EAAE,IAAKowC,EAAIA,CAAE,EAAG,MAAO,EAAG,OAErC,OAAOhrC,EAAE,IAAK+P,EAAM6tC,CAAG,EAAG,IAAKoD,CAAE,CAAI,EAAC,IAAKA,EAAG,SAAU,CAAA,CAEzD,CAAC,EAAG,UAAW,CACd,KAAM,gBACN,KAAM,OACN,OAAQ,CACP,CAAE,KAAM,IAAK,KAAM,MAAQ,EAC3B,CAAE,KAAM,MAAO,KAAM,OAAS,EAC9B,CAAE,KAAM,QAAS,KAAM,OAAS,CAChC,CACF,CAAG,ECZGC,GAAYx0C,EAAO,CAAE,CAAE,UAAAkH,EAAW,MAAAuqC,CAAK,IAAQ,CAEpD,MAAMrE,EAAQlmC,EAAU,OAGlButC,EAAWzyC,EAAO,CAAK,EAAC,IAAKorC,CAAK,EAElCsH,EADQjD,EAAM,OACA,SAAU,EAAC,IAAK,QAAS,EAE7C,OAAOzvC,EAAO,GAAM,IAAKyyC,GAAW,IAAKC,EAAM,IAAKD,EAAS,IAAK,EAAG,EAAM,EAAC,IAAK,EAAM,KAAK,GAE7F,CAAC,EAAG,UAAW,CACd,KAAM,YACN,KAAM,QACN,OAAQ,CACP,CAAE,KAAM,YAAa,KAAM,OAAS,EACpC,CAAE,KAAM,QAAS,KAAM,OAAS,CAChC,CACF,GAGME,GAAY30C,EAAO,CAAE,CAAE,MAAA4yC,EAAO,MAAAD,CAAK,IAGjC3wC,EAAO,GAAM,IAAKA,EAAO,CAAK,EAAC,IAAK2wC,EAAM,IAAKC,CAAO,EAAC,IAAKD,EAAM,IAAKC,CAAK,CAAI,CAAA,EAEvF,EAAG,UAAW,CACd,KAAM,YACN,KAAM,QACN,OAAQ,CACP,CAAE,KAAM,QAAS,KAAM,OAAS,EAChC,CAAE,KAAM,QAAS,KAAM,OAAS,CAChC,CACF,GAEMgC,GAAa50C,EAAO,CAAE,CAAE,eAAAqqC,KAAsB,CAEnD,MAAMsH,EAAUtH,EAAe,IAAKlwB,CAAuB,EAAC,UAAS,EAE/Dw4B,EAAQt8B,GAAsB,IAAKg0B,CAAgB,EAAC,MAAK,EACzDuI,EAAQv8B,GAAsB,IAAK8D,CAAuB,EAAC,MAAK,EAChEs3B,EAAQp7B,GAAsB,IAAKs7B,CAAS,EAAC,MAAK,EAElDC,EAAI4C,GAAW,CAAE,UAAWjtC,GAAgB,MAAAkqC,CAAK,GACjDsC,EAAIY,GAAW,CAAE,MAAA/B,EAAO,MAAAD,CAAO,CAAA,EAErC,OAAOrrC,GAAM,IAAKsqC,CAAG,EAAC,IAAKmC,CAAC,CAE7B,CAAG,EC7CGc,GAAS70C,EAAO,CAAE,CAAE,EAAA68B,EAAG,EAAAkX,EAAG,UAAA7sC,CAAS,IAAQ,CAIhD,MAAM4tC,EAAW,SAEXlC,EAAQ/V,EAAE,IAAKkX,CAAG,EAAC,SAAQ,EAG3B3pC,EAAKlH,EAAMgE,EAAW0rC,EAAM,SAAU,EAAC,KAAI,GAEjD,OAAAxoC,EAAG,OAAQA,EAAG,IAAK,OAAS,EAAG,IAAK0qC,CAAQ,GAErC1qC,CAER,CAAC,EAAG,UAAW,CACd,KAAM,SACN,KAAM,OACN,OAAQ,CACP,CAAE,KAAM,IAAK,KAAM,MAAQ,EAC3B,CAAE,KAAM,IAAK,KAAM,MAAQ,EAC3B,CAAE,KAAM,YAAa,KAAM,OAAS,CACpC,CACF,GAEM2qC,GAA8B/0C,EAAO,CAAE,CAAE,EAAAzM,KAAS,CAKvD,MAAME,EAAIF,EAAE,SAEZ,OAAOkc,GAAKhc,EAAE,IAAKA,CAAG,EAAC,IAAKF,EAAE,CAAC,EAAG,IAAKE,EAAE,IAAK,CAAK,CAAA,EAAI,EAExD,CAAC,EAAG,UAAW,CACd,KAAM,8BACN,KAAM,QACN,OAAQ,CACP,CAAE,KAAM,IAAK,KAAM,MAAQ,CAC3B,CACF,GAEMuhD,GAA2Bh1C,EAAO,CAAE,CAAE,GAAAi1C,EAAI,GAAAtB,CAAE,IAAQ,CAEzD,MAAMxlD,EAAI8mD,EAAG,IAAKtB,CAAE,EACd/vD,EAAIuK,EAAE,IAAK,EAAC,MAAK,EAGjB5P,EAAIqF,EAAE,IAAK,QAAS,EAAG,IAAK,QAAW,EAAC,IAAKA,CAAC,EAAG,IAAK,QAAW,EAAC,MAAK,EACvEpF,EAAIoF,EAAE,IAAK,SAAS,EAAG,IAAKA,CAAC,EAAG,IAAK,QAAW,EAAC,MAAK,EACtDoG,EAAIzL,EAAE,IAAKC,CAAC,EAEZ02D,EAAiB/mD,EAAE,YAAa,CAAG,EAAG,KAAMnE,EAAGylB,GAAKthB,EAAE,IAAKA,CAAG,EAAC,SAAU,EAAE,IAAM,EAAC,YAAa,EAAC,IAAK,IAAM,IAAKnE,CAAC,GAEvH,OAAOirD,EAAG,MAAOtB,CAAI,EAAC,IAAKuB,CAAc,CAE1C,CAAC,EAAG,UAAW,CACd,KAAM,2BACN,KAAM,OACN,OAAQ,CACP,CAAE,KAAM,KAAM,KAAM,MAAQ,EAC5B,CAAE,KAAM,KAAM,KAAM,MAAQ,CAC5B,CACF,GAEMC,GAAen1C,EAAO,CAAE,CAAE,EAAA68B,EAAG,EAAAkX,EAAG,EAAAqB,EAAG,KAAAC,EAAM,GAAA7d,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,CAAE,IAAQ,CAIpE,MAAMsd,EAAKxd,EAAG,IAAKD,CAAI,EAAC,MAAK,EACvBmc,EAAKhc,EAAG,IAAKH,CAAI,EAAC,MAAK,EAEvB8d,EAAcL,EAAG,MAAOtB,CAAE,EAC1B3hD,EAASsR,IAAO,QAEtB,OAAAP,GAAIuyC,EAAY,IAAKF,EAAE,IAAK5d,CAAE,GAAK,iBAAkB,CAAG,EAAI,IAAM,CAGjE,MAAM+d,EAAKxB,EAAE,IAAKlX,EAAE,IAAKkX,EAAE,IAAKlX,CAAC,EAAM,EAAC,UAAS,EAC3C2Y,EAAK3Y,EAAE,MAAO0Y,CAAI,EAAC,OAAM,EAGzBE,EAAMJ,EAAK,IAAKnxC,GAAMqxC,EAAIC,EAAI3Y,GAAI,WAAa,EAAC,MAAK,EAIrD6Y,EAAUD,EAAI,IAAKje,EAAG,IAAK4d,CAAC,GAAK,YAAY,QAC7CO,EAAUF,EAAI,IAAKhe,EAAG,IAAK2d,CAAC,GAAK,YAAY,QAC7CQ,EAAUH,EAAI,IAAK/d,EAAG,IAAK0d,CAAC,GAAK,YAAY,QAC7CS,EAAUJ,EAAI,IAAK9d,EAAG,IAAKyd,CAAC,GAAK,YAAY,QAG7CU,EAAmBxyC,EAAM,CAAG,EAAC,MAAK,EACxCwyC,EAAiB,UAAWd,GAA0B,CAAE,GAAIU,EAAS,GAAIC,CAAS,CAAA,GAClFG,EAAiB,UAAWd,GAA0B,CAAE,GAAIW,EAAS,GAAIC,CAAS,CAAA,GAClFE,EAAiB,UAAWd,GAA0B,CAAE,GAAIY,EAAS,GAAIC,CAAS,CAAA,GAClFC,EAAiB,UAAWd,GAA0B,CAAE,GAAIa,EAAS,GAAIH,CAAS,CAAA,GAGlF1jD,EAAO,OAAQsR,EAAMyxC,GAA6B,CAAE,EAAGe,CAAgB,CAAI,CAAA,EAE7E,GAEQ9jD,CAER,CAAC,EAAG,UAAW,CACd,KAAM,eACN,KAAM,OACN,OAAQ,CACP,CAAE,KAAM,IAAK,KAAM,MAAQ,EAC3B,CAAE,KAAM,IAAK,KAAM,MAAQ,EAC3B,CAAE,KAAM,IAAK,KAAM,MAAQ,EAC3B,CAAE,KAAM,OAAQ,KAAM,MAAQ,EAC9B,CAAE,KAAM,KAAM,KAAM,MAAQ,EAC5B,CAAE,KAAM,KAAM,KAAM,MAAQ,EAC5B,CAAE,KAAM,KAAM,KAAM,MAAQ,EAC5B,CAAE,KAAM,KAAM,KAAM,MAAQ,CAC5B,CACF,CAAG,ECrGG+jD,GAA2B/1C,EAAO,CAAE,CAAE,EAAGhW,EAAGse,EAAWF,EAAK4tC,KAAmB,CAGpF,MAAMC,EAAmB3yC,EAAMsN,GAAS5mB,EAAE,OAAQ,EAAEqjB,GAAW,CAAG,EAAEhb,GAAK,EAAK+V,CAAG,CAAI,CAAA,EAG/E8tC,EAAa5yC,EAClB3E,GAAQq3C,EAAa,CAAG,EAAC,GAAK,EAC9Br3C,GAAQq3C,EAAa,CAAG,EAAC,GAAK,EAC9Br3C,GAAQq3C,EAAa,CAAG,EAAC,GAAK,CAChC,EAGC,OAAO3oC,GAAW4oC,GAAmB,IAAK3tC,EAAU,IAAK4tC,CAAU,EAEpE,CAAC,EAAG,UAAW,CACd,KAAM,2BACN,KAAM,OACN,OAAQ,CACP,CAAE,KAAM,IAAK,KAAM,MAAQ,EAC3B,CAAE,KAAM,IAAK,KAAM,MAAQ,EAC3B,CAAE,KAAM,YAAa,KAAM,OAAS,EACpC,CAAE,KAAM,MAAO,KAAM,OAAS,EAC9B,CAAE,KAAM,cAAe,KAAM,MAAQ,CACrC,CACF,GAEMC,GAAsBn2C,EAAO,CAAE,CAAEkH,EAAWkB,CAAG,IAI7ClB,EAAU,IAAKsJ,GAAOpI,EAAI,IAAK,GAAM,IAAK,CAAK,EAAE,EAAK,CAAK,CAAA,CAElE,EAAG,UAAW,CACd,KAAM,sBACN,KAAM,QACN,OAAQ,CACP,CAAE,KAAM,YAAa,KAAM,OAAS,EACpC,CAAE,KAAM,MAAO,KAAM,OAAS,CAC9B,CACF,GAEMguC,GAA2BlqB,GAAkB,EAE7CmqB,GAAwBr2C,EAAO,CAAE,CAAEs2C,EAAWpvC,EAAWkB,CAAG,IAAQ,CAEzE,MAAMmuC,EAAqBH,GAAyB,GAAIE,CAAS,EAG3Dxf,EAAM7oB,GAAMjM,EAAOopB,GAAmB,CAAC,GAAK,IAAK+qB,GAAqBjvC,EAAWkB,CAAK,CAAA,EAE5F,OAAOmuC,EAAmB,QAASzf,EAEpC,GAEM0f,GAAoBx2C,EAAO,CAAE,CAAEy2C,EAAsBjuC,EAAkBD,CAAmB,KAE/FxF,GAAIwF,EAAoB,SAAU,CAAG,EAAE,IAAM,CAG5C,MAAMmuC,EAAyB1oC,GAAKxF,CAAgB,EAAG,SAAS,IAAKD,GAGrE,OAFsBuF,GAAK4oC,EAAuB,OAAM,EAAG,IAAKD,CAAoB,EAItF,GAGQnzC,EAAM,GAEb,EAAG,UAAW,CACd,KAAM,oBACN,KAAM,OACN,OAAQ,CACP,CAAE,KAAM,uBAAwB,KAAM,OAAS,EAC/C,CAAE,KAAM,mBAAoB,KAAM,MAAQ,EAC1C,CAAE,KAAM,sBAAuB,KAAM,OAAS,CAC9C,CACF,GAEMqzC,GAAyB32C,EAAO,CAAE,CAAE,EAAGhW,EAAGkd,EAAWD,EAAcc,EAAeC,EAAasS,EAAU07B,EAAahL,EAAY4L,EAAYxuC,EAAKE,EAAWE,EAAkBD,EAAqBE,KAAkB,CAE5N,IAAIouC,EAAkBC,EAEtB,GAAKruC,EAAa,CAEjBouC,EAAmBnzC,IAAO,QAC1BozC,EAAgBxzC,IAAO,QAEvB,MAAMyzC,EAAa3uC,EAAI,IAAK,CAAG,EAAG,IAAKK,EAAW,IAAK,IAAK,GACtDuuC,EAAO1zC,EAAM8E,EAAI,IAAK2uC,GAAc3uC,EAAKA,EAAI,IAAK2uC,CAAY,CAAA,EAEpEh4B,GAAM,CAAE,MAAO,EAAG,IAAK,GAAK,CAAE,CAAE,EAAAx8B,KAAS,CAExC,MAAM6lB,EAAM4uC,EAAK,QAASz0D,CAAC,EAErB00D,GAAkBlB,GAA0B,EAAG/rD,EAAGse,EAAWF,EAAK4tC,GAClEkB,GAAmB58B,EAAS,IAAK28B,EAAe,EAGhDE,GAASP,EAAW,IAAK5L,EAAW,IAAKtnC,EAAMwzC,GAAkB,CAAK,CAAA,GACtEE,GAAmBl0C,EAAMi0C,GAAO,GAAG,IAAKA,GAAO,CAAC,GAAK,QAC3DC,GAAiB,UAAW,GAC5BA,GAAiB,UAAW,GAC5BA,GAAiB,OAAQl0C,EAAMk0C,GAAiB,EAAGA,GAAiB,EAAE,SAAU,CAAA,GAGhF,MAAMb,GAAqBF,GAAuBe,GAAkBlwC,EAAWkB,CAAG,EAElFyuC,EAAiB,QAASt0D,GAAI,OAAQg0D,GAAmB,QAASh0D,CAAC,GACnEs0D,EAAiB,EAAE,UAAWN,GAAmB,CAAC,EAElDO,EAAc,QAASv0D,GAAI,OAAQ0kB,EAAa,QAAS1kB,CAAC,EAAG,IAAKi0D,GAAmB73C,GAAQs4C,EAAiB,EAAEzuC,EAAkBD,CAAqB,EAAC,QAAShmB,CAAG,CAAA,EAEvK,GAEEs0D,EAAiB,EAAE,UAAW,EAEhC,KAAQ,CAEN,MAAMI,EAAkBlB,GAA0B,EAAG/rD,EAAGse,EAAWF,EAAK4tC,GAClEkB,EAAmB58B,EAAS,IAAK28B,CAAe,EAGhDE,EAASP,EAAW,IAAK5L,EAAW,IAAKtnC,EAAMwzC,EAAkB,CAAK,CAAA,GACtEE,EAAmBl0C,EAAMi0C,EAAO,GAAG,IAAKA,EAAO,CAAC,GAAK,QAC3DC,EAAiB,UAAW,GAC5BA,EAAiB,UAAW,GAC5BA,EAAiB,OAAQl0C,EAAMk0C,EAAiB,EAAGA,EAAiB,EAAE,SAAU,CAAA,GAGhFP,EAAmBR,GAAuBe,EAAkBlwC,EAAWkB,CAAG,EAC1E0uC,EAAgB7vC,EAAa,IAAKuvC,GAAmB73C,GAAQs4C,GAAmBzuC,EAAkBD,CAAmB,EAErH,CAED,MAAM8uC,EAAkBP,EAAc,IAAI,IAAKD,EAAiB,KAC1DjE,EAAQ,EAAE,IAAK5oD,CAAG,EAAC,MAAK,EAGxBM,EAAIgZ,EAAM8wC,GAAiB,CAChC,MAAAxB,EACA,cAAA7qC,EACA,YAAAC,EACA,UAAAd,CACA,CAAA,GAIKowC,EAAsBR,EAAc,EAAE,IAAKA,EAAc,EAAGA,EAAc,CAAC,EAAG,IAAK,CAAG,EAE5F,OAAOpzC,EAAMpZ,EAAE,SAAU,EAAC,IAAK+sD,CAAe,EAAIR,EAAiB,EAAE,SAAU,EAAC,IAAKS,CAAmB,EAAG,SAAU,CAAA,CAEtH,GAOMC,GAAgBrzC,GACrB,UAAW,SAAa,SACxB,WAAa,UAAW,UACxB,UAAa,QAAW,SACzB,EAIMszC,GAAkBC,GAAc,CAErC,MAAMC,EAASD,EAAS,OACxB,OAAOn0C,EAAM,GAAM,IAAKo0C,CAAQ,EAAC,IAAKp0C,EAAM,CAAK,EAAC,IAAKo0C,CAAQ,CAAA,CAEhE,EAGMC,GAAgB,CAAEC,EAAgBC,IAEhCD,EAAe,IAAKC,CAAW,EAAG,IAAKD,EAAe,IAAKC,CAAW,GAAK,OAO7EC,GAAkB,CAAEC,EAAKC,IAAW,CAEzC,MAAMC,EAAQF,EAAI,IAAK,EAAM,KAAK,GAAK,MACjCn7D,EAAM0mB,EAAM,UAAY,UAAY,SAAU,EAC9CjP,EAAMiP,EAAM,OAAY,QAAY,OAAU,EAC9C40C,EAAM50C,EAAM,QAAY,QAAY,OAAU,EAE9CnV,EAAI6T,EAAO,SAAa,KAAK,KAAM,EAAM,KAAK,GAAK,OAAY,CAAA,EAAG,IAAKi2C,EAAM,IAAK,SAAa,IAAKD,EAAM,CAAG,EAAC,IAAG,CAAI,EAAC,IAAKC,EAAM,KAAI,EAAG,IAAK,QAAY,EAAG,IAAK,CAAA,EAEvK,IAAIE,EAAMv7D,EAAI,IAAKs7D,EAAI,IAAK,EAAM,KAAK,EAAE,EAAG,KAAM,CAAA,EAAG,IAAK7jD,EAAI,IAAK4jD,GAAQ,IAAKD,CAAO,EAAC,IAAG,CAAI,EAAC,IAAKC,EAAM,KAAI,EAAG,OAAQ,EAAC,IAAKC,CAAG,EAAG,IAAK,CAAA,EAC3I,OAAAC,EAAM70C,EAAM60C,EAAI,EAAE,IAAKhqD,CAAG,EAAEgqD,EAAI,EAAGA,EAAI,CAAG,EAAC,IAAK,SAAS,EAE7CZ,GAAc,IAAKY,CAAG,CAInC,EAEMC,GAAkBp4C,EAAO,CAAE,CAAE,WAAAq4C,EAAY,KAAAC,EAAM,UAAAC,EAAW,kBAAAC,EAAmB,OAAAC,KAAc,CAGhG,MAAMhxC,EAAiB8I,GAAK8nC,EAAYC,EAAMznC,GAAY,EAAK,IAAM2nC,CAAiB,GAEhFE,EAAcL,EAAW,IAAK5wC,CAAgB,EAAC,KAAI,EAAG,IAAKzF,EAAO,CAAG,EAAC,IAAKu2C,EAAU,KAAI,CAAI,CAAA,EAU7FI,EAPc32C,EAAO,CAAG,EAAC,IAAK02C,CAAW,EAOjB,OAGxBE,EAAKjB,GAAelwC,EAAgB4wC,CAAU,EAC9CQ,EAAM5H,GAAW,CAAE,GAAI2H,EAAI,IAAK,EAAK,MAAOL,CAAS,GAErDO,EAAOD,EAAI,WACXE,EAAQtxC,EAAe,SAAU4wC,CAAU,EAAG,KAAM,KAAK,GAAI,GAC7DW,EAAQh3C,EAAO,KAAK,EAAE,EAAG,IAAK+2C,GAG9BE,EAAUzB,GAAeiB,EAAO,MAAO,EAAK,KAAM,GAClD1d,EAAK4c,GAAesB,EAASxxC,EAAe,OAAQ,CAAA,EACpDyxC,EAAMjI,GAAW,CAAE,GAAIlW,EAAI,IAAK,EAAK,MAAO4d,CAAS,GACrDQ,EAAQ71C,EACb21C,EAAQ,EAAE,SAAUxxC,CAAc,EAAG,KAAM,KAAK,GAAI,CAAK,EACzDwxC,EAAQ,EAAE,SAAUxxC,CAAc,EAAG,KAAM,KAAK,GAAI,CAAK,EACzDwxC,EAAQ,EAAE,SAAUxxC,CAAc,EAAG,KAAM,KAAK,GAAI,CAAK,CAC3D,EAGOswC,EAAMtwC,EAAe,IAAK+wC,EAAmBG,EAAW,GACxDS,EAAM91C,EAAM01C,CAAO,EAAC,IAAKG,CAAK,EAG9BE,EAAOR,EAAI,IAAKK,CAAK,EAAC,MAAO,KAAM,OACnCI,EAAOD,EAAK,OACZE,EAAKT,EAAK,KAAM,EAAC,IAAKI,CAAG,EAAG,IAAK51C,EAAM,CAAG,EAAG,IAAK+1C,CAAM,CAAA,EAI9D,IAAIG,EADOX,EAAI,IAAKU,CAAE,EAIlBE,GAAKF,EAAG,IAAKT,CAAI,EACrB,QAAUj1D,GAAI,EAAGA,IAAK,EAAG,EAAGA,GAAI,CAE/B41D,GAAKA,GAAG,IAAKH,GACb,MAAMI,GAAK5B,GAAiB91C,EAAOne,EAAG,EAAC,IAAKk0D,CAAK,EAAE/1C,EAAOne,EAAC,EAAG,IAAKu1D,CAAK,CAAA,EAAG,IAAK,GAChFI,EAAIA,EAAE,IAAKC,GAAG,IAAKC,EAAE,EAErB,CAGD,OAAOF,EAAE,IAAKl2C,EAAM,CAAK,CAAA,CAE1B,CAAC,EAAG,UAAW,CACd,KAAM,kBACN,KAAM,OACN,OAAQ,CACP,CAAE,KAAM,aAAc,KAAM,OAAS,EACrC,CAAE,KAAM,OAAQ,KAAM,OAAS,EAC/B,CAAE,KAAM,YAAa,KAAM,OAAS,EACpC,CAAE,KAAM,oBAAqB,KAAM,OAAS,EAC5C,CAAE,KAAM,SAAU,KAAM,MAAQ,CAChC,CACF,GASMq2C,GAAe35C,EAAO,CAAE,CAAE,OAAA+4B,EAAQ,QAAA6gB,EAAS,UAAA1yC,CAAS,IAAQ,CAEjE,MAAM0rC,EAAQ7Z,EAAO,IAAK6gB,CAAS,EAAC,SAAQ,EAEtCC,EAAK3yC,EAAU,OAEf3oB,EAAIunC,GACT5e,EAAU,SAAU,GAAM,EAC1BlF,EAAO,MAAO,EAAG,IAAK63C,CAAI,EAAC,IAAK73C,EAAO,KAAK,EAAG,IAAKkF,CAAW,CAAA,EAAG,IAAK,IAAM,EAC7ElF,EAAO,KAAM,EAAG,IAAK63C,CAAI,EAAC,IAAK73C,EAAO,IAAI,EAAG,IAAKkF,CAAW,CAAA,EAAG,IAAK,IAAM,CAC7E,EAEO1oB,EAAIsnC,GACT5e,EAAU,SAAU,GAAM,EAC1BlF,EAAO,EAAM,EAAC,IAAK63C,CAAE,EAAG,IAAK73C,EAAO,IAAI,EAAG,IAAKkF,CAAW,CAAA,EAAG,IAAK,IAAM,EACzElF,EAAO,IAAM,EAAC,IAAK63C,CAAE,EAAG,IAAK73C,EAAO,IAAI,EAAG,IAAKkF,CAAW,CAAA,EAAG,IAAK,GAAM,CAC3E,EAIC,OAFW4e,GAAM5e,EAAU,SAAU,KAAQ,EAAKlF,EAAO,EAAK,EAAC,IAAKkF,CAAS,EAAG,IAAK,IAAO,CAAA,EAAG,IAAK3oB,EAAE,IAAKq0D,CAAO,EAAC,IAAKp0D,GAAI,IAAK,CAAA,EAEvH,IAAK,EAAM,KAAK,EAAE,EAAG,UAEhC,GAEMs7D,GAAcx2C,EAAM,KACpBy2C,GAAe/3C,EAAO,GAI5B,MAAMg4C,WAA8BpzC,EAAc,CAEjD,YAAaQ,EAAY,GAAOE,EAAQ,GAAOE,EAAc,GAAOI,EAAa,GAAOS,EAAe,GAAOI,EAAa,GAAQ,CAElI,QAEA,KAAK,UAAYrB,EACjB,KAAK,MAAQE,EACb,KAAK,YAAcE,EACnB,KAAK,WAAaI,EAClB,KAAK,aAAeS,EACpB,KAAK,WAAaI,EAElB,KAAK,kBAAoB,KACzB,KAAK,wBAA0B,KAC/B,KAAK,0BAA4B,KACjC,KAAK,oBAAsB,KAC3B,KAAK,sBAAwB,KAC7B,KAAK,mBAAqB,KAC1B,KAAK,cAAgB,IAErB,CAED,MAAOpC,EAAU,CAiBhB,GAfK,KAAK,YAAc,KAEvB,KAAK,kBAAoB/C,EAAM,EAAC,KAAM,mBAAmB,EACzD,KAAK,wBAA0BA,EAAM,EAAC,KAAM,yBAAyB,EACrE,KAAK,0BAA4BA,EAAM,EAAC,KAAM,2BAA2B,GAIrE,KAAK,QAAU,KAEnB,KAAK,oBAAsBA,EAAM,EAAC,KAAM,qBAAqB,EAC7D,KAAK,sBAAwBA,EAAM,EAAC,KAAM,uBAAuB,GAI7D,KAAK,cAAgB,GAAO,CAEhC,MAAM22C,EAAS5jC,GAAsB,IAAK8D,CAAuB,EAAC,MAAK,EAEvE,KAAK,mBAAqBi+B,GAAiB,CAC1C,WAAYp2C,EAAO,CAAK,EACxB,KAAMyF,GACN,UAAWwyC,EACX,kBAAmBvyC,GACnB,OAAQK,EACZ,GAEG,KAAK,cAAgBusC,GAAe,CAAE,EAAG,KAAK,mBAAoB,IAAK,EAAK,MAAO2F,CAAQ,CAAA,CAE3F,CAED,GAAK,KAAK,eAAiB,GAAO,CAEjC,MAAM3/B,EAAWN,GACXhwB,EAAIsrB,GAAe,IAAK0E,EAAe,EAAC,UAAS,EACjDp4B,EAAI00B,GAEVjQ,EAAQ,SAAWswC,GAClB/0D,EACAoI,EACAkd,GACAD,EACAc,GACAC,GACAsS,EACAvE,GACAV,GACAD,GACAhN,GACAE,GACAE,GACAD,GACA,KAAK,WAAaE,GAAa,IACnC,EAEGpC,EAAQ,cAAgBgC,GAExBpB,EAAa,EAAE,UAAWsJ,GAAK,EAAGlK,EAAQ,SAAS,EAAGgC,EAAY,EAElE,CAED,CAMD,uBAAwB6xC,EAAeC,EAAcnyC,EAAc,CAElE,MAAM4qC,EAAQv8B,GAAsB,IAAK8D,CAAuB,EAAC,MAAK,EAEhEk6B,EAAML,GAAW,CAAE,UAAA9sC,GAAW,MAAA0rC,CAAO,CAAA,EAIrCwH,GAFK,KAAK,cAAgB5yC,GAAY,IAAKO,GAAe,KAAK,aAAe,EAAGA,IAErE,IAAKssC,EAAI,CAAC,EAAG,IAAKrsC,EAAY,IAAKqsC,EAAI,CAAG,CAAA,EAGtDgG,EADMhG,EAAI,EAAE,IAAKA,EAAI,GACX,WAEViG,EAAOvyC,GAAc,IAAKA,GAAc,WAAW,IAAK,OAAQ,GAChEwyC,EAAMH,EAAO,IAAKE,CAAI,EAAG,IAAKD,EAAI,IAAKC,GAAO,SAAU,CAAA,EAE9DJ,EAAc,UAAWE,GACzBD,EAAa,UAAWI,EAAI,IAAKF,CAAK,CAAA,CAEtC,CAED,OAAQ,CAAE,eAAAhQ,EAAgB,WAAAE,EAAY,eAAA1lB,CAAc,EAAK,CAGxD,MAAMwF,EADQhU,GAAsB,IAAKg0B,CAAgB,EAAC,MAAK,EACtC,IAAKE,CAAU,EAQxC,GANK,KAAK,QAAU,IAEnB,KAAK,oBAAoB,UAAWlgB,EAAW,IAAKuqB,GAAY,CAAE,eAAAvK,EAAkB,CAAA,GAIhF,KAAK,YAAc,GAAO,CAG9B,MAAMmQ,EADUjkC,GAA+B,IAAK8zB,CAAgB,EAAC,MAAK,EAC7C,IAAKE,CAAU,EAE5C,KAAK,wBAAwB,UAAWiQ,EAAa,IAAK5G,GAAU,CAAE,eAAAvJ,EAAgB,GAAIyP,GAAa,IAAKC,GAAc,UAAW1yC,GAAoB,WAAYkP,EAA8B,CAAI,CAAA,EAEvM,CAEDsO,EAAe,cAAc,UAAWwF,EAAW,IAAKinB,GAAc,CAAE,aAAcrqC,EAAa,GAAK,CAAA,CAAI,CAAA,EAE5G4d,EAAe,eAAe,UAAWwF,EAAW,IAAKupB,GAAU,CAAE,eAAAvJ,EAAgB,GAAItiC,GAAe,IAAK,EAAG,UAAAb,GAAW,YAAa,KAAK,YAAa,EAAG,KAAK,mBAAoB,gBAAiB,KAAK,YAAa,eAAgB,KAAK,UAAY,CAAA,CAAI,CAAA,CAE9P,CAED,eAAgB,CAAE,WAAAqjC,EAAY,cAAAW,EAAe,UAAAuP,EAAW,WAAAC,EAAY,eAAA71B,EAAgB,MAAAgmB,EAAO,MAAAC,GAAU,CAEpG,MAAMtT,EAAK0T,EAAc,IAAKuP,CAAS,EAAG,IAAKC,GACzCjjB,EAAKyT,EAAc,IAAKuP,CAAS,EAAG,IAAKC,GACzChjB,EAAKwT,EAAc,IAAKuP,CAAS,EAAG,IAAKC,GACzC/iB,EAAKuT,EAAc,IAAKuP,CAAS,EAAG,IAAKC,GAEzC7d,EAAIxmB,GACJ09B,EAAI55B,EACJi7B,EAAIl7B,GAAa,QAEjB9P,EAAKyqC,GAAQ,CAAE,EAAAhY,EAAG,EAAAkX,EAAG,UAAA7sC,EAAS,GAE9ByzC,EAAK9P,EAAM,GAAIzgC,CAAI,EAAC,MAAK,EACzBwwC,EAAK9P,EAAM,GAAI1gC,CAAI,EAAC,MAAK,EAEzBirC,EAAOnxC,GACZZ,EAAMq3C,EAAG,EAAG,EAAGA,EAAG,CAAG,EACrBr3C,EAAM,EAAG,EAAG,CAAG,EACfA,EAAMq3C,EAAG,EAAG,EAAGA,EAAG,CAAG,CACrB,EAAC,MAAK,EAIDtJ,EAAUtpC,GAAc,IAAK6yC,EAAG,CAAG,EAAC,IAAK7yC,GAAc,SAAQ,EAAG,IAAK6yC,EAAG,CAAG,CAAA,EAAG,QAEtF/1B,EAAe,eAAe,UAAW0lB,EAAW,IAAK8G,CAAS,EAAC,IAAK8D,GAAc,CAAE,EAAAtY,EAAG,EAAAkX,EAAG,EAAAqB,EAAG,KAAAC,EAAM,GAAA7d,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,EAAM,CAAA,GAEzH9S,EAAe,cAAc,UAAW0lB,EAAW,IAAKtjC,CAAc,EAAC,IAAKkuC,GAAc,CAAE,EAAAtY,EAAG,EAAAkX,EAAG,EAAAqB,EAAG,KAAMlxC,GAAM,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,CAAC,EAAI,GAAAszB,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,CAAI,CAAA,CAAI,CAAA,CAElK,CAED,gBAAiB,CAAE,WAAAtN,EAAY,eAAAxF,GAAmB,CAEjDA,EAAe,gBAAgB,UAAWwF,EAAW,IAAKinB,GAAc,CAAE,aAAArqC,EAAgB,CAAA,EAE1F,CAED,iBAAkB,CAAE,SAAAkjB,EAAU,cAAA0wB,EAAe,eAAAh2B,CAAc,EAAK,CAe/D,GAbK,KAAK,QAAU,IAEnB,KAAK,sBAAsB,UAAWg2B,EAAc,IACnDvzC,GACAqyC,GAAc,CACb,OAAQtjC,GACR,QAAS8D,EACT,UAAW5S,EAChB,CAAO,CACP,GAIO,KAAK,YAAc,GAAO,CAE9B,MAAMuzC,EAAUvkC,GAA+B,IAAK4D,CAAuB,EAAC,MAAK,EAE3E4gC,EAAe3G,GAAiB,CACrC,MAAO0G,EACP,cAAehB,GACf,YAAaC,GACb,UAAW1yC,EACf,GAEG,KAAK,0BAA0B,UAAW,KAAK,kBAAkB,IAAK0zC,CAAY,EAElF,CAID,MAAMC,EAAmB13C,EAAI,EAAG,KAAM,kBAAkB,EAClD23C,EAAkB33C,EAAI,EAAG,KAAM,iBAAiB,EAChD43C,EAA2BL,EAAc,IAAK,EAAI,KAAK,IAE7D,KAAK,uBAAwBG,EAAkBC,EAAiBjzC,EAAW,EAE3E,MAAMmzC,EAAkBH,EAAiB,IAAKC,CAAe,EAEvDG,EAAUn0C,EAAa,IAAKk0C,EAAgB,EAAE,IAAKA,EAAgB,CAAG,EAAC,IAAKA,EAAgB,CAAC,EAAG,SAAU,CAAA,EAEhHt2B,EAAe,iBAAiB,UAAWsF,EAAS,IAAK6wB,CAAgB,GACzEn2B,EAAe,iBAAiB,UAAWo2B,EAAgB,IAAKC,CAAwB,GAExFr2B,EAAe,gBAAgB,UAAWu2B,EAAQ,IAAKF,CAAwB,EAE/E,CAED,iBAAkB,CAAE,iBAAAG,EAAkB,eAAAx2B,GAAmB,CAIxD,MAAMy2B,EAFQjlC,GAAsB,IAAK8D,CAAuB,EAAC,MAAK,EAEnD,IAAKkhC,CAAgB,EAClCE,EAAQr0C,GAAU,IAAK,KAAS,WAAW,SAAS,OAEpDud,EAAS42B,EAAiB,IAAKC,EAAK,IAAKC,CAAK,EAAG,SAAQ,GAAK,QAE/D,KAAK,YAAc,IAEvB,KAAK,0BAA0B,UAAWF,GAItC,KAAK,QAAU,IAEnB,KAAK,sBAAsB,UAAWA,GAIvCx2B,EAAe,gBAAgB,UAAWw2B,GAC1Cx2B,EAAe,iBAAiB,UAAWJ,EAE3C,CAED,OAAQpe,EAAU,CAEjB,KAAM,CAAE,cAAAm1C,CAAe,EAAGn1C,EAE1B,GAAK,KAAK,YAAc,GAAO,CAE9B,MAAMy0C,EAAUvkC,GAA+B,IAAK4D,CAAuB,EAAC,MAAK,EAE3EshC,EAAMxK,GAAW,CACtB,MAAO6J,EACP,GAAIhB,GACJ,IAAKC,EACT,GAES2B,EAAiBF,EAAc,IAAKp0C,GAAU,IAAKq0C,CAAG,EAAG,UAAY,EAAC,IAAK,KAAK,wBAAwB,IAAK,KAAK,yBAAyB,EAAG,IAAKr0C,EAAS,GAElKo0C,EAAc,OAAQE,EAEtB,CAED,GAAK,KAAK,QAAU,GAAO,CAE1B,MAAMC,EAAkBr0C,GAAM,EAAE,IAAKA,GAAM,CAAG,EAAC,IAAKA,GAAM,CAAC,EAAG,IAAK,IAAO,EAAC,SAAQ,EAC7Es0C,EAAaJ,EAAc,IAAKG,CAAiB,EAAC,IAAK,KAAK,oBAAqB,KAAK,uBAE5FH,EAAc,OAAQI,EAEtB,CAED,CAEF,CCnmBA,MAAMjP,GAAgB,IAAIkP,GAE1B,MAAMC,WAAiCxtB,EAAa,CAEnD,YAAasY,EAAa,CAEzB,QAEA,KAAK,2BAA6B,GAElC,KAAK,aAAe,KAEpB,KAAK,cAAgB,KACrB,KAAK,cAAgB,KAErB,KAAK,iBAAkB+F,IAEvB,KAAK,UAAW/F,EAEhB,CAED,oBAAkC,CAEjC,OAAO,IAAIoT,EAEX,CAED,eAAgB,CAEf,MAAMnjC,EAAoBtG,GAAKjN,EAAM,GAAM,EAAE2D,EAAa,IAAKE,IAE/DY,GAAc,OAAQ8O,GACtB7O,GAAY,OAAQ,EAEpB,CAED,eAAgB,CAIf,MAAM+O,EAAgB,KAAK,cAAgB/U,EAAO,KAAK,aAAe,EAAGsW,GAEzEnR,GAAU,OAAQ4P,GAIlB,IAAID,EAAgB,KAAK,cAAgB9U,EAAO,KAAK,aAAe,EAAGqW,GACvEvB,EAAgBy7B,GAAc,CAAE,UAAWz7B,CAAe,CAAA,EAE1D5P,GAAU,OAAQ4P,GAIlB,KAAK,cAAa,EAIlB7P,EAAa,OAAQvD,EAAMuD,EAAa,IAAI,IAAK8P,EAAc,SAAQ,CAAI,EAAE9P,EAAa,CAAG,CAAA,CAE7F,CAED,KAAMjC,EAAS,CAEd,YAAK,aAAeA,EAAO,aAE3B,KAAK,cAAgBA,EAAO,cAC5B,KAAK,cAAgBA,EAAO,cAErB,MAAM,KAAMA,EAEnB,CAEF,CAIAyqB,GAAiB,2BAA4BqsB,EAA0B,EC1EvE,MAAMnP,GAAgB,IAAIoP,GAE1B,MAAMC,WAAiCF,EAAyB,CAE/D,YAAalV,EAAa,CAEzB,QAEA,KAAK,2BAA6B,GAElC,KAAK,cAAgB,KACrB,KAAK,uBAAyB,KAC9B,KAAK,oBAAsB,KAE3B,KAAK,UAAY,KACjB,KAAK,mBAAqB,KAE1B,KAAK,gBAAkB,KACvB,KAAK,mBAAqB,KAC1B,KAAK,yBAA2B,KAEhC,KAAK,sBAAwB,KAC7B,KAAK,kBAAoB,KAEzB,KAAK,QAAU,KACf,KAAK,iBAAmB,KACxB,KAAK,cAAgB,KACrB,KAAK,wBAA0B,KAC/B,KAAK,qBAAuB,KAC5B,KAAK,eAAiB,KAEtB,KAAK,eAAiB,KAEtB,KAAK,iBAAkB+F,IAEvB,KAAK,UAAW/F,EAEhB,CAED,IAAI,cAAe,CAElB,OAAO,KAAK,UAAY,GAAK,KAAK,gBAAkB,IAEpD,CAED,IAAI,gBAAiB,CAEpB,OAAO,KAAK,YAAc,GAAK,KAAK,kBAAoB,IAExD,CAED,IAAI,UAAW,CAEd,OAAO,KAAK,MAAQ,GAAK,KAAK,YAAc,IAE5C,CAED,IAAI,eAAgB,CAEnB,OAAO,KAAK,WAAa,GAAK,KAAK,iBAAmB,IAEtD,CAED,IAAI,iBAAkB,CAErB,OAAO,KAAK,aAAe,GAAK,KAAK,mBAAqB,IAE1D,CAED,IAAI,eAAgB,CAEnB,OAAO,KAAK,WAAa,GAAK,KAAK,iBAAmB,IAEtD,CAED,eAAgB,CAEf,MAAMqV,EAAU,KAAK,QAAUj6C,EAAO,KAAK,OAAS,EAAGoX,GAEvDhR,GAAI,OAAQ6zC,GACZl0C,GAAc,OAAQwI,GAAKf,GAAKS,GAAM7H,GAAI,IAAK,CAAG,EAAG,IAAKA,GAAI,IAAK,CAAG,EAAM,EAAC,IAAK+P,EAAqB,EAAI7U,EAAM,CAAG,CAAI,EAAC,IAAK4U,EAA2B,EAAEjR,EAAa,IAAKE,EAAW,CAAA,EACxLa,GAAY,OAAQuI,GAAK2H,GAA2B,EAAK/Q,EAAS,EAElE,CAED,oBAAkC,CAEjC,OAAO,IAAI6yC,GAAuB,KAAK,aAAc,KAAK,SAAU,KAAK,eAAgB,KAAK,cAAe,KAAK,gBAAiB,KAAK,aAAa,CAErJ,CAED,cAAe9+C,EAAU,CAMxB,GAJA,MAAM,cAAeA,GAIhB,KAAK,aAAe,CAExB,MAAM+b,EAAgB,KAAK,cAAgBjV,EAAO,KAAK,aAAe,EAAGwW,GACnEtB,EAAyB,KAAK,uBAAyBlV,EAAO,KAAK,sBAAwB,EAAGyW,GAEpGrR,GAAU,OAAQ6P,GAClB5P,GAAmB,OAAQkrC,GAAc,CAAE,UAAWr7B,CAAwB,CAAA,EAE9E,CAID,GAAK,KAAK,SAAW,CAEpB,MAAMC,EAAY,KAAK,UAAY7T,EAAM,KAAK,SAAW,EAAGsV,GACtDxB,EAAqB,KAAK,mBAAqBpV,EAAO,KAAK,kBAAoB,EAAG6W,GAExFvR,GAAM,OAAQ6P,GACd5P,GAAe,OAAQ6P,EAEvB,CAID,GAAK,KAAK,eAAiB,CAE1B,MAAM8kC,EAAkB,KAAK,gBAAkBl6C,EAAO,KAAK,eAAiB,EAAG+W,GACzEojC,EAAqB,KAAK,mBAAqBn6C,EAAO,KAAK,kBAAoB,EAAGgX,GAClFojC,EAA2B,KAAK,yBAA2Bp6C,EAAO,KAAK,wBAA0B,EAAGiX,GAE1GzR,GAAY,OAAQ00C,GACpBz0C,GAAe,OAAQ00C,GACvBz0C,GAAqB,OAAQ00C,EAE7B,CAID,GAAK,KAAK,cAAgB,CAEzB,MAAMC,GAAgB,KAAK,eAAiBn5C,EAAM,KAAK,cAAgB,EAAG4V,IAAqB,QAE/FlR,GAAW,OAAQy0C,EAAY,OAAQ,CAAA,EAEvCt5C,GAAI6E,GAAW,MAAO,CAAK,EAAE,IAAM,CAElCy0C,EAAY,OAAQn5C,EAAM,EAAK,CAAK,CAAA,CAExC,CAAM,EAAC,KAAM,IAAM,CAEfm5C,EAAY,UAAWn5C,EAAM0E,EAAY,CAAA,EACzCA,GAAW,OAAQA,GAAW,SAAU,CAAA,CAE5C,GAGGD,GAAO,OAAQC,GAAW,KAAM,EAAC,IAAKV,GAAU,KAAI,EAAI,CAAG,GAE3DW,GAAY,OAAQqd,GAAe,CAAC,EAAG,IAAKm3B,EAAY,CAAC,EAAG,IAAKn3B,GAAe,GAAI,IAAKm3B,EAAY,CAAG,CAAA,GACxGv0C,GAAY,OAAQod,GAAe,CAAC,EAAG,IAAKm3B,EAAY,CAAC,EAAG,IAAKn3B,GAAe,GAAI,IAAKm3B,EAAY,CAAG,CAAA,EAExG,CAID,GAAK,KAAK,gBAAkB,CAE3B,MAAM5kC,EAAmB,KAAK,iBAAmBzV,EAAO,KAAK,gBAAkB,EAAGkX,GAC5ExB,EAAgB,KAAK,cAAgB1V,EAAO,KAAK,aAAe,EAAGmX,GACnEmjC,EAA0B,KAAK,wBAA0Bt6C,EAAO,KAAK,uBAAyB,EAAGqX,GACjGkjC,EAAuB,KAAK,qBAAuBj5C,EAAM,KAAK,oBAAsB,EAAGgW,GAO7F,GALAjR,GAAa,OAAQoP,GACrBnP,GAAU,OAAQoP,GAClBnP,GAAoB,OAAQ+zC,GAC5B9zC,GAAiB,OAAQ+zC,GAEpB,KAAK,cAAgB,CAEzB,MAAMC,EAAiB,KAAK,eAAiBx6C,EAAO,KAAK,cAAgB,EAAG6X,GAE5EpR,GAAW,OAAQ+zC,EAEnB,CAED,CAED,CAED,YAAathD,EAAU,CAEtB,MAAM,YAAaA,GAInB,MAAMuhD,EAAsB,KAAK,oBAAsBn5C,EAAM,KAAK,mBAAqB,EAAGoV,GAE1FnC,GAA+B,OAAQkmC,EAEvC,CAED,KAAMz3C,EAAS,CAEd,YAAK,cAAgBA,EAAO,cAC5B,KAAK,uBAAyBA,EAAO,uBACrC,KAAK,oBAAsBA,EAAO,oBAElC,KAAK,UAAYA,EAAO,UACxB,KAAK,mBAAqBA,EAAO,mBAEjC,KAAK,gBAAkBA,EAAO,gBAC9B,KAAK,mBAAqBA,EAAO,mBACjC,KAAK,yBAA2BA,EAAO,yBAEvC,KAAK,sBAAwBA,EAAO,sBACpC,KAAK,kBAAoBA,EAAO,kBAEhC,KAAK,iBAAmBA,EAAO,iBAC/B,KAAK,cAAgBA,EAAO,cAC5B,KAAK,wBAA0BA,EAAO,wBACtC,KAAK,qBAAuBA,EAAO,qBACnC,KAAK,eAAiBA,EAAO,eAE7B,KAAK,eAAiBA,EAAO,eAEtB,MAAM,KAAMA,EAEnB,CAEF,CAIAyqB,GAAiB,2BAA4BusB,EAA0B,EC3OvE,MAAMU,WAAyB1C,EAAsB,CAEpD,YAAa2C,EAAcC,EAAUC,EAAgBC,EAAS,CAE7D,MAAOH,EAAcC,EAAUC,GAE/B,KAAK,OAASC,CAEd,CAED,OAAQ,CAAE,eAAAzS,EAAgB,WAAAE,EAAY,eAAA1lB,CAAgB,EAAEhiB,EAAO3H,EAAU,CAExE,GAAK,KAAK,SAAW,GAAO,CAE3B,MAAM2Z,EAAW3Z,EAAQ,SAEnB,CAAE,mBAAA6hD,EAAoB,wBAAAC,EAAyB,qBAAAC,EAAsB,yBAAAC,EAA0B,mBAAAC,EAAoB,mBAAAC,CAAoB,EAAGvoC,EAE1IwoC,EAAiBhT,EAAe,IAAKh0B,GAAsB,IAAK2mC,CAAuB,GAAK,YAC5FM,EAAgBt7C,EAAOmY,EAAsB,IAAKkjC,EAAe,OAAQ,CAAA,EAAG,SAAU,EAAC,IAAKF,CAAkB,EAAG,IAAKC,CAAoB,CAAA,EAC1IG,EAAiBj6C,EAAMg6C,EAAc,IAAKL,GAAuB,IAAKF,CAAkB,GAE9Fl4B,EAAe,cAAc,UAAW04B,EAAe,IAAKL,EAAyB,IAAK3S,CAAY,CAAA,EAEtG,CAED,MAAM,OAAQ,CAAE,eAAAF,EAAgB,WAAAE,EAAY,eAAA1lB,GAAkBhiB,EAAO3H,EAErE,CAEF,CAEA,MAAMsiD,WAA4BxB,EAAyB,CAE1D,YAAapV,EAAa,CAEzB,MAAOA,CAAU,EAEjB,KAAK,mBAAqB,KAC1B,KAAK,wBAA0B5kC,EAAO,IACtC,KAAK,qBAAuBA,EAAO,GACnC,KAAK,yBAA2BA,EAAO,IACvC,KAAK,mBAAqBA,EAAO,GACjC,KAAK,mBAAqBA,EAAO,GAEjC,CAED,IAAI,QAAS,CAEZ,OAAO,KAAK,qBAAuB,IAEnC,CAED,oBAAkC,CAEjC,OAAO,IAAI06C,GAAkB,KAAK,aAAc,KAAK,SAAU,KAAK,eAAgB,KAAK,OAEzF,CAED,KAAM13C,EAAS,CAEd,YAAK,mBAAqBA,EAAO,mBACjC,KAAK,wBAA0BA,EAAO,wBACtC,KAAK,qBAAuBA,EAAO,qBACnC,KAAK,yBAA2BA,EAAO,yBACvC,KAAK,mBAAqBA,EAAO,mBACjC,KAAK,mBAAqBA,EAAO,mBAE1B,MAAM,KAAMA,EAEnB,CAEF,CAIAyqB,GAAiB,sBAAuB+tB,EAAqB,EC3E7D,MAAMC,GAAwBz9C,EAAO,CAAE,CAAE,OAAA+4B,EAAQ,eAAAsR,EAAgB,QAAAnvC,CAAO,IAAQ,CAG/E,MAAMy3C,EAAQ5Z,EAAO,IAAKsR,CAAc,EAClC9e,EAAQroB,EAAMyvC,EAAM,IAAK,EAAK,EAAC,IAAK,IAAO,GAEjD,GAAKz3C,EAAQ,SAAS,YAAc,CAEnC,MAAMwiD,EAAc5oC,GAAmB,cAAe,SAAS,EAAG,QAAS,CAAE,MAAO,IAAMyW,CAAK,GAE/F,OAAOjoB,EAAMo6C,EAAY,EAE3B,KAAQ,CAEN,MAAMC,EAAKpyB,EAAM,OAAQ,EAAC,IAAK,EAAG,EAElC,OAAOhb,GAAKjN,EAAM,EAAG,EAAIA,EAAM,CAAK,EAAEuN,GAAY7O,EAAO,EAAG,EAAG,IAAK27C,EAAG,GAAK37C,EAAO,EAAG,EAAG,IAAK27C,EAAG,GAAKpyB,EAAM,CAAC,EAE7G,CAEF,GAEA,MAAMqyB,WAA0Bh3C,EAAc,CAE7C,OAAQ,CAAE,eAAAyjC,EAAgB,WAAAE,EAAY,eAAA1lB,CAAgB,EAAEhiB,EAAO3H,EAAU,CAExE,MAAMmvB,EAAaozB,GAAuB,CAAE,OAAQxnC,GAAgB,eAAAo0B,EAAgB,QAAAnvC,EAAW,EAAC,IAAKqvC,GAErG1lB,EAAe,cAAc,UAAWwF,EAAW,IAAKinB,GAAc,CAAE,aAAcrqC,EAAa,GAAK,CAAA,CAAI,CAAA,CAE5G,CAED,gBAAiB,CAAE,WAAAojB,EAAY,eAAAxF,GAAmB,CAEjDA,EAAe,gBAAgB,UAAWwF,EAAW,IAAKinB,GAAc,CAAE,aAAArqC,EAAgB,CAAA,EAE1F,CAEF,CCzCA,MAAM0lC,GAAgB,IAAIkR,GAE1B,MAAMC,WAA6BxvB,EAAa,CAE/C,YAAasY,EAAa,CAEzB,QAEA,KAAK,uBAAyB,GAE9B,KAAK,OAAS,GAEd,KAAK,iBAAkB+F,IAEvB,KAAK,UAAW/F,EAEhB,CAED,oBAAkC,CAEjC,OAAO,IAAIgX,EAEX,CAEF,CAIAnuB,GAAiB,uBAAwBquB,EAAsB,ECzB/D,MAAMnR,GAAgB,IAAIoR,GAE1B,MAAMC,WAA+B1vB,EAAa,CAEjD,YAAasY,EAAa,CAEzB,QAEA,KAAK,OAAS,GAEd,KAAK,yBAA2B,GAEhC,KAAK,iBAAkB+F,IAEvB,KAAK,UAAW/F,EAEhB,CAED,cAAe1rC,EAAU,CAExB,MAAMkP,EAAK+nB,GAEX,IAAI8rB,EAEC/iD,EAAQ,SAAS,OAErB+iD,EAAcnpC,GAAmB,SAAU,SAAW,EAAC,QAAS,CAAE,MAAO,IAAM1K,CAAE,GAIjF6zC,EAAc36C,EAAMiN,GAAK,GAAK,GAAKnG,EAAG,CAAC,GAIxCnD,EAAa,IAAI,UAAWg3C,EAAY,GAAG,CAE3C,CAEF,CAKAxuB,GAAiB,yBAA0BuuB,EAAwB,EC/CnE,MAAMrR,GAAgB,IAAIC,GAE1B,MAAMsR,WAA2B5vB,EAAa,CAE7C,YAAasY,EAAa,CAEzB,QAEA,KAAK,qBAAuB,GAE5B,KAAK,OAAS,GACd,KAAK,QAAU,GACf,KAAK,YAAc,GAEnB,KAAK,SAAW,KAEhB,KAAK,iBAAkB+F,IAEvB,KAAK,UAAW/F,EAEhB,CAED,KAAM5hC,EAAS,CAEd,YAAK,SAAWA,EAAO,SAEhB,MAAM,KAAMA,EAEnB,CAEF,CAIAyqB,GAAiB,qBAAsByuB,EAAoB,EC5B3D,MAAMvR,GAAgB,IAAIwR,GAE1B,MAAMC,WAA2B9vB,EAAa,CAE7C,YAAasY,EAAa,CAEzB,QAEA,KAAK,qBAAuB,GAE5B,KAAK,OAAS,GACd,KAAK,QAAU,GAEf,KAAK,aAAe,KACpB,KAAK,aAAe,KACpB,KAAK,UAAY,KAEjB,KAAK,iBAAkB+F,IAEvB,KAAK,UAAW/F,EAEhB,CAED,cAAe,CAAE,OAAA5tC,EAAQ,QAAAqN,GAAY,CAIpC,KAAM,CAAE,aAAAgU,EAAc,aAAAiZ,EAAc,UAAA0B,CAAS,EAAK,KAE5CqpB,EAAStkC,GAEf,IAAIukC,EAAazoC,GAAgB,IAAKvS,EAAM+W,GAAgB,CAAC,GAEzDgY,EAAQnvB,EAAM6S,GAAkB,CAAG,EAAC,IAAI,OAAQ,EAAEA,GAAkB,CAAC,EAAG,IAAI,OAAQ,CAAA,EAEnFif,IAAc,OAElB3C,EAAQA,EAAM,IAAK2C,IAIpB,IAAIupB,EAAkBF,EAAO,GAExBrlD,EAAO,QAAUA,EAAO,OAAO,YAAc,KAEjDulD,EAAkBA,EAAgB,IAAKt0C,EAASjR,EAAO,QAAS,IAAK,EAAG,IAIzEulD,EAAkBA,EAAgB,IAAKlsB,GAEvC,MAAMuB,EAAW5xB,EAAOsxB,GAAgB3a,EAAgB,EAElD6lC,EAAkBD,EAAgB,OAAQ3qB,CAAQ,EAExD0qB,EAAa56C,EAAM46C,EAAW,GAAG,IAAKE,CAAiB,EAAEF,EAAW,IAEpE,MAAM/jC,EAAsBnF,GAAuB,IAAKkpC,CAAU,EAElE,OAAAj4C,EAAQ,OAASg4C,EAEV9jC,CAEP,CAED,KAAMvV,EAAS,CAEd,YAAK,aAAeA,EAAO,aAC3B,KAAK,aAAeA,EAAO,aAC3B,KAAK,UAAYA,EAAO,UAEjB,MAAM,KAAMA,EAEnB,CAEF,CAIAyqB,GAAiB,qBAAsB2uB,EAAoB,ECrF3D,MAAMK,WAAwB73C,EAAc,CAE3C,aAAc,CAEb,QAEA,KAAK,WAAa5E,EAAO,CAAC,EAAG,MAAO,aAEpC,CAED,OAAQ,CAAE,WAAA08C,GAAe,CAExB,KAAK,WAAW,UAAWA,EAE3B,CAED,OAAQr4C,EAAU,CAEjBY,EAAa,EAAE,UAAW,KAAK,WAAW,SAAQ,GAElDZ,EAAQ,cAAc,IAAI,OAAQY,EAAa,GAAG,CAElD,CAEF,CCvBA,MAAM0lC,GAAgB,IAAIgS,GAE1B,MAAMC,WAA2BtwB,EAAa,CAE7C,YAAasY,EAAa,CAEzB,QAEA,KAAK,qBAAuB,GAE5B,KAAK,OAAS,GAEd,KAAK,iBAAkB+F,IAEvB,KAAK,UAAW/F,EAEhB,CAED,oBAAkC,CAEjC,OAAO,IAAI6X,EAEX,CAEF,CAIAhvB,GAAiB,qBAAsBmvB,EAAoB,ECrB3D,MAAMC,WAA2BvwB,EAAa,CAE7C,YAAax0B,EAAS,GAAK,CAE1B,QAEA,KAAK,QAAU,GACf,KAAK,OAAS,GACd,KAAK,qBAAuB,GAC5B,KAAK,SAAW,KAEhB,KAAK,UAAWA,EAEhB,CAED,MAAOoB,EAAU,CAEhB,MAAM2mC,EAAM3I,GAAW,KAAK,IAAK,KAAM,GAEjC4lB,EAAS9+C,EAAO,CAAE,CAAE,KAAA++C,EAAM,IAAA/uB,CAAG,IAAQ,CAE1C,MAAMgvB,EAAU17C,EAAM,KAChB27C,EAAU37C,EAAM,IAEhB47C,EAAUlvB,EAAI,aAEdmvB,EAAWH,EAAQ,IAAKD,CAAI,EAAG,IAAKG,GACpCE,EAAWH,EAAQ,IAAKF,CAAI,EAAG,IAAKG,GAEpCG,EAAO7vC,GAAK2vC,EAAUC,CAAQ,EAC9BE,EAAO7vC,GAAK0vC,EAAUC,CAAQ,EAE9BG,EAAK9vC,GAAK4vC,EAAK,EAAG5vC,GAAK4vC,EAAK,EAAGA,EAAK,CAAC,GACrC1E,EAAKnrC,GAAK8vC,EAAK,EAAG9vC,GAAK8vC,EAAK,EAAGA,EAAK,CAAC,GAE3C,OAAOp8C,EAAMq8C,EAAI5E,EAEpB,GAEE,KAAK,aAAe36C,EAAO,IAAM,CAEhC,MAAMw/C,EAAUl6C,GAAShC,EAAM0S,GAAwB,IAAKtS,EAAM4R,GAAgB,EAAO,CAAA,GAGnFmqC,EAFan6C,GAASwU,GAAiB,IAAK0lC,CAAS,CAAA,EAEjC,YACpBE,EAASvmD,GAAU,OAAQ,QAAU,EAAC,OAAQ2lD,EAAQ,CAAE,KAAMU,EAAS,IAAKC,CAAM,CAAI,CAAA,EAE5FC,EAAO,EAAE,YAAaA,EAAO,CAAC,EAAG,UAEjCA,EAAO,OAAQx8C,EAAMuM,GAAKiwC,EAAO,EAAG,GAAOA,EAAO,CAAC,GAEnD,MAAM3uB,EAAI53B,GAAU,OAAQ,GAAG,EAAG,OAAQqmD,EAAQ,IAAKE,EAAO,EAAE,IAAKD,CAAM,CAAI,CAAA,EACzE/pD,EAAMyD,GAAU,OAAQ,KAAK,EAAG,OAAQmK,EAAMm8C,EAAO,IAAG,EAAG,WAAU,CAAI,CAAA,EACzEE,EAAQxmD,GAAU,QAAS,OAAS,EAAC,OAAQqW,GAAK9Z,EAAI,EAAG8Z,GAAK9Z,EAAI,EAAGA,EAAI,CAAG,CAAA,GAElFiqD,EAAM,UAAW7qC,GAAmB,QAAS,OAAS,CAAA,EAEtD,MAAM8qC,EAAKzmD,GAAU,OAAQ,IAAM,EAAC,OAAQuK,EAAMoR,GAAmB,OAAQ,SAAW,CAAK,CAAA,EAE7F,OAAAiK,GAAM,CAAE,KAAM,QAAS,MAAO2gC,EAAO,EAAG,IAAKA,EAAO,EAAG,OAAQ,UAAY,EAAE,IAAM,CAElF,MAAM,EAAIvmD,GAAU,QAAS,GAAG,EAAG,OAAQ0oC,EAAI,GAAI9Q,EAAE,IAAK,EAAG,CAAI,EAAC,CAAC,EAE9D,KAAK,WAAa,KAEtB,KAAK,SAAU,CAAE,IAAK8Q,EAAK,SAAU,EAAG,MAAO9Q,EAAG,WAAY6uB,CAAE,CAAI,EAAC,OAAM,GAK3EA,EAAG,EAAE,OAAQ,GACb5gC,MAID+R,EAAE,UAAW0uB,EAAO,IAAKE,CAAO,CAAA,CAEpC,GAEGC,EAAG,EAAE,MAAO,CAAG,EAAC,QAAO,EAEhBl8C,EAAMk8C,EAEb,CAAA,IAED,MAAM,MAAO1kD,EAEb,CAEF,CAIAu0B,GAAiB,qBAAsBovB,EAAoB,ECtG3D,MAAMgB,GAAwBC,GAAe,uBAE7CA,GAAe,uBAAyB,SAAWjmD,EAAO,CAEzD,MAAMgb,EAAW2a,GAA4B31B,GAE7C,OAAKgb,IAAa,OAEVA,EAIDgrC,GAAsB,KAAM,KAAMhmD,CAAI,CAE9C,ECXA,MAAMkmD,GAAa,CAAC,SAAU,SAAU,UAAW,YAAa,WAAY,SAAU,UAAU,EAC1FC,GAAU,CACZ,CAAE,KAAM,MAAO,IAAK,UAAW,OAAQ,SAAU,EACjD,CAAE,KAAM,OAAQ,IAAK,UAAW,OAAQ,SAAU,EAClD,CAAE,KAAM,QAAS,IAAK,UAAW,OAAQ,SAAU,EACnD,CAAE,KAAM,SAAU,IAAK,UAAW,OAAQ,SAAU,EACpD,CAAE,KAAM,SAAU,IAAK,UAAW,OAAQ,SAAU,EACpD,CAAE,KAAM,SAAU,IAAK,UAAW,OAAQ,SAAU,CACxD,EAKMC,GAAY,MAAM,KAAK,CAAE,OAAQ,GAAK,CAACrsD,EAAGrR,IAAM,CAC5C,MAAA29D,GAAa39D,EAAI,GAAK,EAC5B,OAAO,MAAM,KAAK,CAAE,OAAQ,KAAK,MAAM,KAAK,OAAO,EAAI,EAAE,CAAK,EAAA,CAACqR,EAAGjE,KAAO,CACrE,IAAKowD,GAAWG,CAAS,EACzB,wBAAyB,KAAK,MAAM,GAAK,KAAK,SAAW,GAAG,EAC5D,GAAI,QAAQ39D,EAAI,GAAKoN,EAAI,CAAC,GAC1B,MAAO,CAACqwD,GAAQ,KAAK,MAAM,KAAK,OAAO,EAAIA,GAAQ,MAAM,CAAC,EAAE,GAAG,CAEjE,EAAA,CACN,CAAC,EAAE,KAAK,EAKFG,GAAiB3gE,GAAU,CACvB,MAAA8I,EAAO,CAAC,SAAU,SAAU,UAAW,YAAa,WAAY,SAAU,UAAU,EACpF83D,EAAOC,UAAO,CAAA,CAAE,EAChB,CAACC,EAAOC,CAAQ,EAAIC,YAASP,EAAS,EAG5CQ,GAAAA,UAAU,IAAM,CACZL,EAAK,QAAU93D,EAAK,IAAI,IAAMo4D,GAAM,WAAW,EAC3BC,GAAA,EAAE,KAAMtkD,GAAS,CAEzB,QAAA,IACJA,EAAK,IAAKukD,GACNC,GAAeD,EAAa,YAAY,EAAE,KAAME,IACrC,CAAE,GAAGF,EAAc,iBAAAE,GAC7B,CACL,CAAA,EACF,KAAMC,GAAgB,CAEpBR,EAASQ,CAAW,CAAA,CACvB,CAAA,CAGJ,CAEL,EAAG,CAAE,CAAA,EAGL,MAAMC,EAAiB,CAACC,EAAUnxD,EAAMoxD,IAAQ,CACxC,GAAAd,EAAK,QAAQa,CAAQ,GAAKb,EAAK,QAAQa,CAAQ,EAAE,QAAS,CAC1D,MAAMv8C,EAAU07C,EAAK,QAAQa,CAAQ,EAAE,QAC/Bv8C,EAAA,MAAM,KAAO,GAAG5U,CAAI,KACpB4U,EAAA,MAAM,IAAM,GAAGw8C,CAAG,IAC9B,CAAA,EAGJ,OACMC,GAAA,KAAAC,YAAA,CAAA,SAAA,CAAAC,GAAA,IAAC,KAAA,CACC,MAAOC,GAAa,SAAA,aAAA,CACxB,EAIID,GAAA,IAACE,GAAA,CAAQ,YAAY,WACjB,MAAO,CACH,SAAU,WACV,KAAM,KACV,EACA,GAAI,CACA,gBAAiB,EACjB,gBAAiB,SACjB,gBAAiB,QACjB,iBAAkB,EAClB,OAAQ,KAEZ,CAAA,CAAG,EAEPF,GAAA,IAACG,GAAA,CACG,MAAO,CACH,SAAU,WAGV,IAAK,KACL,MAAO,MACP,KAAM,KACV,EACC,SAAWzB,GAAA,IAAKl4D,WAGX,MAGE,CAAA,SAAA,CAAAw5D,GAAA,IAAC,KAAA,CACG,MAAO,CACH,SAAU,WACV,KAAM,MACV,EAEC,SAAAx5D,CAAA,EANIA,CAOT,EAGAs5D,GAAA,KAAC/gE,GAAA,CAAK,UAAS,GAEX,WAAY,CAAE,GAAI,CAAE,EACpB,cAAe,CAAE,GAAI,CAAE,EACvB,EAAG,EACH,UAAU,MACV,eAAe,aACf,WAAW,aAGV,SAAA,CAAA4gE,EAAejB,GAAW,QAAQl4D,CAAG,EAAG,EAAG,CAAC,EAC5Cy4D,EAAM,OAAQmB,GAASA,EAAK,MAAQ55D,CAAG,EAAE,IAAK45D,GAE1CJ,GAAAA,IAAAjhE,GAAA,CAAK,KAAI,GAAC,GAAIqhE,EAAK,wBAA0B,GAE1C,SAAAJ,GAAA,IAACK,GAAA,CACG,GAAI,CACA,OAAQ,GAAI,QAAS,OAAQ,WAAY,SAAU,eAAgB,SACnE,gBAAiBD,EAAK,MACtB,WAAY,wBACZ,UAAW,CACP,gBAAiB,OACrB,CACJ,EACA,QAAS,IAAM,CAAEjiE,EAAM,cAAciiE,CAAI,CAAG,EAG3C,SAAKA,EAAA,IAAA,CAAA,CACV,EAfmDA,EAAK,EAgB5D,CAIJ,CAAA,CAAA,CAEJ,EAEAJ,GAAAA,IAACE,GAAQ,CAAA,GAAI,CAAE,kBAAmB,EAAG,YAAa,SAAU,YAAa,OAAY,CAAA,CAAA,CAAA,CAAA,EAlD9E15D,CAoDX,CACH,CAAA,CACL,CAEJ,CAAA,CAAA,CAER","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204]}